main start at this time 1651556716.7702284
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024311065673828125
number of batches is  32
batch size is  2842
random selection method spend 0.00823068618774414
time for parepare:  0.01920461654663086
local_output_nid generation:  0.0012717247009277344
local_in_edges_tensor generation:  0.003607511520385742
mini_batch_src_global generation:  0.0017447471618652344
r_  generation:  0.009731769561767578
local_output_nid generation:  0.0013775825500488281
local_in_edges_tensor generation:  0.0008606910705566406
mini_batch_src_global generation:  0.0012640953063964844
r_  generation:  0.007126569747924805
local_output_nid generation:  0.0014605522155761719
local_in_edges_tensor generation:  0.0007781982421875
mini_batch_src_global generation:  0.0008225440979003906
r_  generation:  0.006620168685913086
local_output_nid generation:  0.0014662742614746094
local_in_edges_tensor generation:  0.0007467269897460938
mini_batch_src_global generation:  0.0007631778717041016
r_  generation:  0.006852388381958008
local_output_nid generation:  0.0014145374298095703
local_in_edges_tensor generation:  0.0006990432739257812
mini_batch_src_global generation:  0.0007271766662597656
r_  generation:  0.006844758987426758
local_output_nid generation:  0.0013980865478515625
local_in_edges_tensor generation:  0.0006861686706542969
mini_batch_src_global generation:  0.0007383823394775391
r_  generation:  0.006870269775390625
local_output_nid generation:  0.0013766288757324219
local_in_edges_tensor generation:  0.0006768703460693359
mini_batch_src_global generation:  0.0007073879241943359
r_  generation:  0.006762266159057617
local_output_nid generation:  0.0013680458068847656
local_in_edges_tensor generation:  0.0006670951843261719
mini_batch_src_global generation:  0.0007021427154541016
r_  generation:  0.006955385208129883
local_output_nid generation:  0.0013551712036132812
local_in_edges_tensor generation:  0.0006875991821289062
mini_batch_src_global generation:  0.0007119178771972656
r_  generation:  0.007008552551269531
local_output_nid generation:  0.0013585090637207031
local_in_edges_tensor generation:  0.0006802082061767578
mini_batch_src_global generation:  0.0007171630859375
r_  generation:  0.006972551345825195
local_output_nid generation:  0.0013308525085449219
local_in_edges_tensor generation:  0.0006706714630126953
mini_batch_src_global generation:  0.0007107257843017578
r_  generation:  0.007184505462646484
local_output_nid generation:  0.0013575553894042969
local_in_edges_tensor generation:  0.0006830692291259766
mini_batch_src_global generation:  0.0007367134094238281
r_  generation:  0.007247447967529297
local_output_nid generation:  0.0013439655303955078
local_in_edges_tensor generation:  0.0006628036499023438
mini_batch_src_global generation:  0.00074005126953125
r_  generation:  0.007280826568603516
local_output_nid generation:  0.00135040283203125
local_in_edges_tensor generation:  0.0006692409515380859
mini_batch_src_global generation:  0.0007441043853759766
r_  generation:  0.007250785827636719
local_output_nid generation:  0.0013396739959716797
local_in_edges_tensor generation:  0.0006601810455322266
mini_batch_src_global generation:  0.0007281303405761719
r_  generation:  0.007170915603637695
local_output_nid generation:  0.0013496875762939453
local_in_edges_tensor generation:  0.0006632804870605469
mini_batch_src_global generation:  0.000732421875
r_  generation:  0.007177591323852539
local_output_nid generation:  0.0013582706451416016
local_in_edges_tensor generation:  0.000667572021484375
mini_batch_src_global generation:  0.0007417201995849609
r_  generation:  0.007203578948974609
local_output_nid generation:  0.0013384819030761719
local_in_edges_tensor generation:  0.0006630420684814453
mini_batch_src_global generation:  0.0007493495941162109
r_  generation:  0.007380247116088867
local_output_nid generation:  0.0013570785522460938
local_in_edges_tensor generation:  0.0006697177886962891
mini_batch_src_global generation:  0.0007355213165283203
r_  generation:  0.007038116455078125
local_output_nid generation:  0.0013511180877685547
local_in_edges_tensor generation:  0.0006649494171142578
mini_batch_src_global generation:  0.0007390975952148438
r_  generation:  0.007053375244140625
local_output_nid generation:  0.001329183578491211
local_in_edges_tensor generation:  0.0006630420684814453
mini_batch_src_global generation:  0.0007562637329101562
r_  generation:  0.007330179214477539
local_output_nid generation:  0.0013382434844970703
local_in_edges_tensor generation:  0.0006649494171142578
mini_batch_src_global generation:  0.0007739067077636719
r_  generation:  0.007333517074584961
local_output_nid generation:  0.0013306140899658203
local_in_edges_tensor generation:  0.00066375732421875
mini_batch_src_global generation:  0.0007681846618652344
r_  generation:  0.007464885711669922
local_output_nid generation:  0.0013611316680908203
local_in_edges_tensor generation:  0.0006563663482666016
mini_batch_src_global generation:  0.0007569789886474609
r_  generation:  0.007152557373046875
local_output_nid generation:  0.0013508796691894531
local_in_edges_tensor generation:  0.004728555679321289
mini_batch_src_global generation:  0.0009403228759765625
r_  generation:  0.0072939395904541016
local_output_nid generation:  0.0012445449829101562
local_in_edges_tensor generation:  0.0006985664367675781
mini_batch_src_global generation:  0.0008699893951416016
r_  generation:  0.007309913635253906
local_output_nid generation:  0.0012545585632324219
local_in_edges_tensor generation:  0.0006723403930664062
mini_batch_src_global generation:  0.0008113384246826172
r_  generation:  0.007244586944580078
local_output_nid generation:  0.0012774467468261719
local_in_edges_tensor generation:  0.0006618499755859375
mini_batch_src_global generation:  0.0007984638214111328
r_  generation:  0.007294893264770508
local_output_nid generation:  0.0012862682342529297
local_in_edges_tensor generation:  0.0006735324859619141
mini_batch_src_global generation:  0.0007834434509277344
r_  generation:  0.007293701171875
local_output_nid generation:  0.001279592514038086
local_in_edges_tensor generation:  0.0006716251373291016
mini_batch_src_global generation:  0.0007753372192382812
r_  generation:  0.007321596145629883
local_output_nid generation:  0.001277923583984375
local_in_edges_tensor generation:  0.0006554126739501953
mini_batch_src_global generation:  0.0007503032684326172
r_  generation:  0.007132053375244141
local_output_nid generation:  0.0013058185577392578
local_in_edges_tensor generation:  0.0006961822509765625
mini_batch_src_global generation:  0.0007731914520263672
r_  generation:  0.007335662841796875
----------------------check_connections_block total spend ----------------------------- 0.4206557273864746
generate_one_block  0.012450695037841797
generate_one_block  0.012055158615112305
generate_one_block  0.011547327041625977
generate_one_block  0.011628150939941406
generate_one_block  0.011449337005615234
generate_one_block  0.011503219604492188
generate_one_block  0.011315584182739258
generate_one_block  0.011389970779418945
generate_one_block  0.012239933013916016
generate_one_block  0.011384725570678711
generate_one_block  0.01160430908203125
generate_one_block  0.011812448501586914
generate_one_block  0.011663675308227539
generate_one_block  0.011643648147583008
generate_one_block  0.011545896530151367
generate_one_block  0.01162576675415039
generate_one_block  0.01172637939453125
generate_one_block  0.011761188507080078
generate_one_block  0.011534929275512695
generate_one_block  0.011405229568481445
generate_one_block  0.011901140213012695
generate_one_block  0.011613607406616211
generate_one_block  0.011713504791259766
generate_one_block  0.011480569839477539
generate_one_block  0.011700153350830078
generate_one_block  0.011692523956298828
generate_one_block  0.011544942855834961
generate_one_block  0.01149749755859375
generate_one_block  0.011891603469848633
generate_one_block  0.012410163879394531
generate_one_block  0.011444568634033203
generate_one_block  0.01167440414428711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02649974822998047
gen group dst list time:  0.021638870239257812
time for parepare:  0.018496990203857422
local_output_nid generation:  0.004185199737548828
local_in_edges_tensor generation:  0.010092496871948242
mini_batch_src_global generation:  0.006119966506958008
r_  generation:  0.05702090263366699
local_output_nid generation:  0.0068662166595458984
local_in_edges_tensor generation:  0.005245685577392578
mini_batch_src_global generation:  0.0067288875579833984
r_  generation:  0.06135129928588867
local_output_nid generation:  0.006654024124145508
local_in_edges_tensor generation:  0.005245685577392578
mini_batch_src_global generation:  0.0054721832275390625
r_  generation:  0.059035539627075195
local_output_nid generation:  0.006561279296875
local_in_edges_tensor generation:  0.0055310726165771484
mini_batch_src_global generation:  0.005948305130004883
r_  generation:  0.06223559379577637
local_output_nid generation:  0.006545066833496094
local_in_edges_tensor generation:  0.005882740020751953
mini_batch_src_global generation:  0.006558895111083984
r_  generation:  0.06136345863342285
local_output_nid generation:  0.006472587585449219
local_in_edges_tensor generation:  0.005888938903808594
mini_batch_src_global generation:  0.006651401519775391
r_  generation:  0.06198453903198242
local_output_nid generation:  0.006422519683837891
local_in_edges_tensor generation:  0.006243467330932617
mini_batch_src_global generation:  0.006821393966674805
r_  generation:  0.061173200607299805
local_output_nid generation:  0.0064809322357177734
local_in_edges_tensor generation:  0.006264686584472656
mini_batch_src_global generation:  0.00691676139831543
r_  generation:  0.06212162971496582
local_output_nid generation:  0.006600141525268555
local_in_edges_tensor generation:  0.0059316158294677734
mini_batch_src_global generation:  0.0069653987884521484
r_  generation:  0.06264686584472656
local_output_nid generation:  0.0065228939056396484
local_in_edges_tensor generation:  0.006323099136352539
mini_batch_src_global generation:  0.007025003433227539
r_  generation:  0.06267404556274414
local_output_nid generation:  0.006636857986450195
local_in_edges_tensor generation:  0.0064961910247802734
mini_batch_src_global generation:  0.007136106491088867
r_  generation:  0.06461620330810547
local_output_nid generation:  0.006694793701171875
local_in_edges_tensor generation:  0.006657600402832031
mini_batch_src_global generation:  0.007629871368408203
r_  generation:  0.06476974487304688
local_output_nid generation:  0.006637096405029297
local_in_edges_tensor generation:  0.006525278091430664
mini_batch_src_global generation:  0.0071332454681396484
r_  generation:  0.0646514892578125
local_output_nid generation:  0.006643056869506836
local_in_edges_tensor generation:  0.0060155391693115234
mini_batch_src_global generation:  0.007815122604370117
r_  generation:  0.06513333320617676
local_output_nid generation:  0.006634950637817383
local_in_edges_tensor generation:  0.00558161735534668
mini_batch_src_global generation:  0.007170677185058594
r_  generation:  0.06525039672851562
local_output_nid generation:  0.006538867950439453
local_in_edges_tensor generation:  0.005441904067993164
mini_batch_src_global generation:  0.00722503662109375
r_  generation:  0.06313180923461914
local_output_nid generation:  0.006546735763549805
local_in_edges_tensor generation:  0.005558490753173828
mini_batch_src_global generation:  0.007010221481323242
r_  generation:  0.06422185897827148
local_output_nid generation:  0.006699800491333008
local_in_edges_tensor generation:  0.006498098373413086
mini_batch_src_global generation:  0.007401466369628906
r_  generation:  0.06526350975036621
local_output_nid generation:  0.006536006927490234
local_in_edges_tensor generation:  0.005927085876464844
mini_batch_src_global generation:  0.006910562515258789
r_  generation:  0.06475234031677246
local_output_nid generation:  0.00659489631652832
local_in_edges_tensor generation:  0.006536245346069336
mini_batch_src_global generation:  0.007382631301879883
r_  generation:  0.06335020065307617
local_output_nid generation:  0.006784677505493164
local_in_edges_tensor generation:  0.0066297054290771484
mini_batch_src_global generation:  0.007391929626464844
r_  generation:  0.06618952751159668
local_output_nid generation:  0.006713390350341797
local_in_edges_tensor generation:  0.0060024261474609375
mini_batch_src_global generation:  0.007180213928222656
r_  generation:  0.06534528732299805
local_output_nid generation:  0.006665229797363281
local_in_edges_tensor generation:  0.005949735641479492
mini_batch_src_global generation:  0.00726771354675293
r_  generation:  0.0660400390625
local_output_nid generation:  0.0065915584564208984
local_in_edges_tensor generation:  0.005983114242553711
mini_batch_src_global generation:  0.007198333740234375
r_  generation:  0.06426191329956055
local_output_nid generation:  0.0066874027252197266
local_in_edges_tensor generation:  0.005599260330200195
mini_batch_src_global generation:  0.0070836544036865234
r_  generation:  0.06512594223022461
local_output_nid generation:  0.006639719009399414
local_in_edges_tensor generation:  0.0060672760009765625
mini_batch_src_global generation:  0.0073130130767822266
r_  generation:  0.06466126441955566
local_output_nid generation:  0.006463050842285156
local_in_edges_tensor generation:  0.005468845367431641
mini_batch_src_global generation:  0.007086038589477539
r_  generation:  0.06343650817871094
local_output_nid generation:  0.006606340408325195
local_in_edges_tensor generation:  0.005568027496337891
mini_batch_src_global generation:  0.007163286209106445
r_  generation:  0.0647130012512207
local_output_nid generation:  0.006714344024658203
local_in_edges_tensor generation:  0.005971193313598633
mini_batch_src_global generation:  0.007158756256103516
r_  generation:  0.06528210639953613
local_output_nid generation:  0.006665229797363281
local_in_edges_tensor generation:  0.0060808658599853516
mini_batch_src_global generation:  0.0071392059326171875
r_  generation:  0.06545019149780273
local_output_nid generation:  0.0065271854400634766
local_in_edges_tensor generation:  0.00558924674987793
mini_batch_src_global generation:  0.007135868072509766
r_  generation:  0.06363177299499512
local_output_nid generation:  0.006577014923095703
local_in_edges_tensor generation:  0.0053751468658447266
mini_batch_src_global generation:  0.007616758346557617
r_  generation:  0.06419515609741211
----------------------check_connections_block total spend ----------------------------- 3.162055253982544
generate_one_block  0.08144140243530273
generate_one_block  0.09853124618530273
generate_one_block  0.07920980453491211
generate_one_block  0.08226847648620605
generate_one_block  0.08167505264282227
generate_one_block  0.08046984672546387
generate_one_block  0.08075547218322754
generate_one_block  0.08201742172241211
generate_one_block  0.08185029029846191
generate_one_block  0.0807962417602539
generate_one_block  0.08371376991271973
generate_one_block  0.08309149742126465
generate_one_block  0.0842139720916748
generate_one_block  0.08308172225952148
generate_one_block  0.08255529403686523
generate_one_block  0.08302855491638184
generate_one_block  0.08278203010559082
generate_one_block  0.08340573310852051
generate_one_block  0.07930350303649902
generate_one_block  0.0823218822479248
generate_one_block  0.08419966697692871
generate_one_block  0.08327674865722656
generate_one_block  0.08318972587585449
generate_one_block  0.08162951469421387
generate_one_block  0.08236265182495117
generate_one_block  0.08251738548278809
generate_one_block  0.08023524284362793
generate_one_block  0.08306503295898438
generate_one_block  0.08284425735473633
generate_one_block  0.08263087272644043
generate_one_block  0.08009743690490723
generate_one_block  0.08358192443847656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  3.162055253982544
block generation total time  2.646143674850464
average batch blocks generation time:  0.082691989839077
pseudo mini batch 0 input nodes size: 69440
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0526123046875 GB
    Memory Allocated: 0.0359807014465332  GigaBytes
Max Memory Allocated: 0.0359807014465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0526123046875 GB
    Memory Allocated: 0.036002159118652344  GigaBytes
Max Memory Allocated: 0.036002159118652344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0526123046875 GB
    Memory Allocated: 0.036002159118652344  GigaBytes
Max Memory Allocated: 0.036002159118652344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.03738880157470703  GigaBytes
Max Memory Allocated: 0.03738880157470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.03738880157470703  GigaBytes
Max Memory Allocated: 0.03738880157470703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.03738880157470703  GigaBytes
Max Memory Allocated: 0.03738880157470703  GigaBytes

torch.Size([69440, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.03738880157470703  GigaBytes
Max Memory Allocated: 0.03738880157470703  GigaBytes

m.shape torch.Size([896, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.11794424057006836  GigaBytes
Max Memory Allocated: 0.12000608444213867  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.11794424057006836  GigaBytes
Max Memory Allocated: 0.12000608444213867  GigaBytes

 h.shape torch.Size([1, 896, 128]), torch.Size([1, 896, 128])
----------------------------------------3
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.11879873275756836  GigaBytes
Max Memory Allocated: 0.12000608444213867  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.12563467025756836  GigaBytes
Max Memory Allocated: 0.12606191635131836  GigaBytes

rst.shape  torch.Size([1, 896, 128])
m.shape torch.Size([1050, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.12620878219604492  GigaBytes
Max Memory Allocated: 0.12623262405395508  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.12620878219604492  GigaBytes
Max Memory Allocated: 0.12623262405395508  GigaBytes

 h.shape torch.Size([1, 1050, 128]), torch.Size([1, 1050, 128])
----------------------------------------3
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.12721014022827148  GigaBytes
Max Memory Allocated: 0.12721014022827148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.14223051071166992  GigaBytes
Max Memory Allocated: 0.1436171531677246  GigaBytes

rst.shape  torch.Size([1, 1050, 128])
m.shape torch.Size([1152, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.14337778091430664  GigaBytes
Max Memory Allocated: 0.1436171531677246  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.14337778091430664  GigaBytes
Max Memory Allocated: 0.1436171531677246  GigaBytes

 h.shape torch.Size([1, 1152, 128]), torch.Size([1, 1152, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.14447641372680664  GigaBytes
Max Memory Allocated: 0.14447641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.16895151138305664  GigaBytes
Max Memory Allocated: 0.17059946060180664  GigaBytes

rst.shape  torch.Size([1, 1152, 128])
m.shape torch.Size([1115, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.17052888870239258  GigaBytes
Max Memory Allocated: 0.17059946060180664  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.17052888870239258  GigaBytes
Max Memory Allocated: 0.17059946060180664  GigaBytes

 h.shape torch.Size([1, 1115, 128]), torch.Size([1, 1115, 128])
----------------------------------------3
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.17159223556518555  GigaBytes
Max Memory Allocated: 0.17159223556518555  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.20274972915649414  GigaBytes
Max Memory Allocated: 0.20487642288208008  GigaBytes

rst.shape  torch.Size([1, 1115, 128])
m.shape torch.Size([1046, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.2047119140625  GigaBytes
Max Memory Allocated: 0.20487642288208008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.2047119140625  GigaBytes
Max Memory Allocated: 0.20487642288208008  GigaBytes

 h.shape torch.Size([1, 1046, 128]), torch.Size([1, 1046, 128])
----------------------------------------3
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.20570945739746094  GigaBytes
Max Memory Allocated: 0.20570945739746094  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.24203968048095703  GigaBytes
Max Memory Allocated: 0.24453353881835938  GigaBytes

rst.shape  torch.Size([1, 1046, 128])
m.shape torch.Size([1000, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.2444019317626953  GigaBytes
Max Memory Allocated: 0.24453353881835938  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.2444019317626953  GigaBytes
Max Memory Allocated: 0.24453353881835938  GigaBytes

 h.shape torch.Size([1, 1000, 128]), torch.Size([1, 1000, 128])
----------------------------------------3
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.24535560607910156  GigaBytes
Max Memory Allocated: 0.24535560607910156  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4959716796875 GB
    Memory Allocated: 0.2868213653564453  GigaBytes
Max Memory Allocated: 0.28968238830566406  GigaBytes

rst.shape  torch.Size([1, 1000, 128])
m.shape torch.Size([918, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4959716796875 GB
    Memory Allocated: 0.28940868377685547  GigaBytes
Max Memory Allocated: 0.28968238830566406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4959716796875 GB
    Memory Allocated: 0.28940868377685547  GigaBytes
Max Memory Allocated: 0.28968238830566406  GigaBytes

 h.shape torch.Size([1, 918, 128]), torch.Size([1, 918, 128])
----------------------------------------3
 Nvidia-smi: 1.4959716796875 GB
    Memory Allocated: 0.2902841567993164  GigaBytes
Max Memory Allocated: 0.2902841567993164  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.3345680236816406  GigaBytes
Max Memory Allocated: 0.3376321792602539  GigaBytes

rst.shape  torch.Size([1, 918, 128])
m.shape torch.Size([828, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.33728885650634766  GigaBytes
Max Memory Allocated: 0.3376321792602539  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.33728885650634766  GigaBytes
Max Memory Allocated: 0.3376321792602539  GigaBytes

 h.shape torch.Size([1, 828, 128]), torch.Size([1, 828, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.33807849884033203  GigaBytes
Max Memory Allocated: 0.33807849884033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.3836679458618164  GigaBytes
Max Memory Allocated: 0.3868265151977539  GigaBytes

rst.shape  torch.Size([1, 828, 128])
m.shape torch.Size([777, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.38660764694213867  GigaBytes
Max Memory Allocated: 0.3868265151977539  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.38660764694213867  GigaBytes
Max Memory Allocated: 0.3868265151977539  GigaBytes

 h.shape torch.Size([1, 777, 128]), torch.Size([1, 777, 128])
----------------------------------------3
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.38734865188598633  GigaBytes
Max Memory Allocated: 0.38734865188598633  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.43582725524902344  GigaBytes
Max Memory Allocated: 0.4391617774963379  GigaBytes

rst.shape  torch.Size([1, 777, 128])
m.shape torch.Size([12104, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.4940505027770996  GigaBytes
Max Memory Allocated: 0.4954037666320801  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.4940505027770996  GigaBytes
Max Memory Allocated: 0.4954037666320801  GigaBytes

 h.shape torch.Size([1, 12104, 128]), torch.Size([1, 12104, 128])
----------------------------------------3
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.5055937767028809  GigaBytes
Max Memory Allocated: 0.5055937767028809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6131591796875 GB
    Memory Allocated: 1.3356947898864746  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

rst.shape  torch.Size([1, 12104, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6131591796875 GB
    Memory Allocated: 1.2613611221313477  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6131591796875 GB
    Memory Allocated: 1.2812795639038086  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6131591796875 GB
    Memory Allocated: 1.3011980056762695  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.6131591796875 GB
    Memory Allocated: 1.2811236381530762  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

torch.Size([20886, 256])
first layer input nodes number: 69440
first layer output nodes number: 20886
edges number: 163225
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.6131591796875 GB
    Memory Allocated: 1.3017172813415527  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.6131591796875 GB
    Memory Allocated: 1.3216357231140137  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.6131591796875 GB
    Memory Allocated: 1.326615333557129  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6131591796875 GB
    Memory Allocated: 1.326615333557129  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

m.shape torch.Size([444, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.349039077758789  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.349039077758789  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.3498859405517578  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.3577499389648438  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([389, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.35807466506958  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.35807466506958  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.3588166236877441  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6385498046875 GB
    Memory Allocated: 1.373608112335205  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([268, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.6385498046875 GB
    Memory Allocated: 1.3740100860595703  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6385498046875 GB
    Memory Allocated: 1.3740100860595703  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 2.6385498046875 GB
    Memory Allocated: 1.374521255493164  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6405029296875 GB
    Memory Allocated: 1.3876185417175293  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([227, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.6405029296875 GB
    Memory Allocated: 1.3882360458374023  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6405029296875 GB
    Memory Allocated: 1.3882360458374023  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 2.6405029296875 GB
    Memory Allocated: 1.3886690139770508  GigaBytes
Max Memory Allocated: 1.3942885398864746  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6522216796875 GB
    Memory Allocated: 1.4012250900268555  GigaBytes
Max Memory Allocated: 1.4020910263061523  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([191, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.6522216796875 GB
    Memory Allocated: 1.4019265174865723  GigaBytes
Max Memory Allocated: 1.4020910263061523  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6522216796875 GB
    Memory Allocated: 1.4019265174865723  GigaBytes
Max Memory Allocated: 1.4020910263061523  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 2.6522216796875 GB
    Memory Allocated: 1.4022908210754395  GigaBytes
Max Memory Allocated: 1.4022908210754395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 1.4154057502746582  GigaBytes
Max Memory Allocated: 1.4163165092468262  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([157, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 1.4161291122436523  GigaBytes
Max Memory Allocated: 1.4163165092468262  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 1.4161291122436523  GigaBytes
Max Memory Allocated: 1.4163165092468262  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 1.416428565979004  GigaBytes
Max Memory Allocated: 1.416428565979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 1.429305076599121  GigaBytes
Max Memory Allocated: 1.4302034378051758  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 1.4300236701965332  GigaBytes
Max Memory Allocated: 1.4302034378051758  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 1.4300236701965332  GigaBytes
Max Memory Allocated: 1.4302034378051758  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 1.430269718170166  GigaBytes
Max Memory Allocated: 1.430269718170166  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6951904296875 GB
    Memory Allocated: 1.4425721168518066  GigaBytes
Max Memory Allocated: 1.4434332847595215  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.6951904296875 GB
    Memory Allocated: 1.443333625793457  GigaBytes
Max Memory Allocated: 1.4434332847595215  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6951904296875 GB
    Memory Allocated: 1.443333625793457  GigaBytes
Max Memory Allocated: 1.4434332847595215  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 2.6951904296875 GB
    Memory Allocated: 1.4435529708862305  GigaBytes
Max Memory Allocated: 1.4435529708862305  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 1.4560556411743164  GigaBytes
Max Memory Allocated: 1.4569330215454102  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([120, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 1.456984043121338  GigaBytes
Max Memory Allocated: 1.4569883346557617  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 1.456984043121338  GigaBytes
Max Memory Allocated: 1.4569883346557617  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 1.4572129249572754  GigaBytes
Max Memory Allocated: 1.4572129249572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7225341796875 GB
    Memory Allocated: 1.4718613624572754  GigaBytes
Max Memory Allocated: 1.4728913307189941  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.7225341796875 GB
    Memory Allocated: 1.472487449645996  GigaBytes
Max Memory Allocated: 1.4728913307189941  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7225341796875 GB
    Memory Allocated: 1.472487449645996  GigaBytes
Max Memory Allocated: 1.4728913307189941  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 2.7225341796875 GB
    Memory Allocated: 1.4726343154907227  GigaBytes
Max Memory Allocated: 1.4728913307189941  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 1.4830617904663086  GigaBytes
Max Memory Allocated: 1.4837961196899414  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 1.4835805892944336  GigaBytes
Max Memory Allocated: 1.4837961196899414  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 1.4835805892944336  GigaBytes
Max Memory Allocated: 1.4837961196899414  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 1.483687400817871  GigaBytes
Max Memory Allocated: 1.4837961196899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 1.492018699645996  GigaBytes
Max Memory Allocated: 1.4926061630249023  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 1.4925422668457031  GigaBytes
Max Memory Allocated: 1.4926061630249023  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 1.4925422668457031  GigaBytes
Max Memory Allocated: 1.4926061630249023  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 1.4926376342773438  GigaBytes
Max Memory Allocated: 1.4926376342773438  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7498779296875 GB
    Memory Allocated: 1.5007438659667969  GigaBytes
Max Memory Allocated: 1.5013160705566406  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.7498779296875 GB
    Memory Allocated: 1.501296043395996  GigaBytes
Max Memory Allocated: 1.5013160705566406  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7498779296875 GB
    Memory Allocated: 1.501296043395996  GigaBytes
Max Memory Allocated: 1.5013160705566406  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.7498779296875 GB
    Memory Allocated: 1.501387596130371  GigaBytes
Max Memory Allocated: 1.501387596130371  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7596435546875 GB
    Memory Allocated: 1.509810447692871  GigaBytes
Max Memory Allocated: 1.5104055404663086  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.7596435546875 GB
    Memory Allocated: 1.5102629661560059  GigaBytes
Max Memory Allocated: 1.5104055404663086  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7596435546875 GB
    Memory Allocated: 1.5102629661560059  GigaBytes
Max Memory Allocated: 1.5104055404663086  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.7596435546875 GB
    Memory Allocated: 1.51033353805542  GigaBytes
Max Memory Allocated: 1.5104055404663086  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7655029296875 GB
    Memory Allocated: 1.517320156097412  GigaBytes
Max Memory Allocated: 1.5178141593933105  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.7655029296875 GB
    Memory Allocated: 1.5177607536315918  GigaBytes
Max Memory Allocated: 1.5178141593933105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7655029296875 GB
    Memory Allocated: 1.5177607536315918  GigaBytes
Max Memory Allocated: 1.5178141593933105  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.7655029296875 GB
    Memory Allocated: 1.5178236961364746  GigaBytes
Max Memory Allocated: 1.5178236961364746  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.5244956016540527  GigaBytes
Max Memory Allocated: 1.5249676704406738  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.5248947143554688  GigaBytes
Max Memory Allocated: 1.5249676704406738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.5248947143554688  GigaBytes
Max Memory Allocated: 1.5249676704406738  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.5249481201171875  GigaBytes
Max Memory Allocated: 1.5249676704406738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7791748046875 GB
    Memory Allocated: 1.5309829711914062  GigaBytes
Max Memory Allocated: 1.5314102172851562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.7791748046875 GB
    Memory Allocated: 1.5314631462097168  GigaBytes
Max Memory Allocated: 1.5314655303955078  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7791748046875 GB
    Memory Allocated: 1.5314631462097168  GigaBytes
Max Memory Allocated: 1.5314655303955078  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.7791748046875 GB
    Memory Allocated: 1.531522274017334  GigaBytes
Max Memory Allocated: 1.531522274017334  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7869873046875 GB
    Memory Allocated: 1.5386176109313965  GigaBytes
Max Memory Allocated: 1.5391201972961426  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.7869873046875 GB
    Memory Allocated: 1.539055347442627  GigaBytes
Max Memory Allocated: 1.5391201972961426  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7869873046875 GB
    Memory Allocated: 1.539055347442627  GigaBytes
Max Memory Allocated: 1.5391201972961426  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.7869873046875 GB
    Memory Allocated: 1.539106845855713  GigaBytes
Max Memory Allocated: 1.5391201972961426  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 1.545647144317627  GigaBytes
Max Memory Allocated: 1.5461106300354004  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 1.5460233688354492  GigaBytes
Max Memory Allocated: 1.5461106300354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 1.5460233688354492  GigaBytes
Max Memory Allocated: 1.5461106300354004  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 1.546065330505371  GigaBytes
Max Memory Allocated: 1.5461106300354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8006591796875 GB
    Memory Allocated: 1.5516881942749023  GigaBytes
Max Memory Allocated: 1.5520868301391602  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8006591796875 GB
    Memory Allocated: 1.552109718322754  GigaBytes
Max Memory Allocated: 1.5521116256713867  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8006591796875 GB
    Memory Allocated: 1.552109718322754  GigaBytes
Max Memory Allocated: 1.5521116256713867  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.8006591796875 GB
    Memory Allocated: 1.5521535873413086  GigaBytes
Max Memory Allocated: 1.5521535873413086  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8065185546875 GB
    Memory Allocated: 1.5583391189575195  GigaBytes
Max Memory Allocated: 1.5587778091430664  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8065185546875 GB
    Memory Allocated: 1.5588016510009766  GigaBytes
Max Memory Allocated: 1.5588035583496094  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8065185546875 GB
    Memory Allocated: 1.5588016510009766  GigaBytes
Max Memory Allocated: 1.5588035583496094  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.8065185546875 GB
    Memory Allocated: 1.558847427368164  GigaBytes
Max Memory Allocated: 1.558847427368164  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.565622329711914  GigaBytes
Max Memory Allocated: 1.5661029815673828  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.5659589767456055  GigaBytes
Max Memory Allocated: 1.5661029815673828  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.5659589767456055  GigaBytes
Max Memory Allocated: 1.5661029815673828  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.5659914016723633  GigaBytes
Max Memory Allocated: 1.5661029815673828  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8201904296875 GB
    Memory Allocated: 1.5710172653198242  GigaBytes
Max Memory Allocated: 1.5713739395141602  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8201904296875 GB
    Memory Allocated: 1.5713772773742676  GigaBytes
Max Memory Allocated: 1.5713791847229004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8201904296875 GB
    Memory Allocated: 1.5713772773742676  GigaBytes
Max Memory Allocated: 1.5713791847229004  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.8201904296875 GB
    Memory Allocated: 1.5714097023010254  GigaBytes
Max Memory Allocated: 1.5714097023010254  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8240966796875 GB
    Memory Allocated: 1.576662540435791  GigaBytes
Max Memory Allocated: 1.5770354270935059  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.8240966796875 GB
    Memory Allocated: 1.5769004821777344  GigaBytes
Max Memory Allocated: 1.5770354270935059  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8240966796875 GB
    Memory Allocated: 1.5769004821777344  GigaBytes
Max Memory Allocated: 1.5770354270935059  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.8240966796875 GB
    Memory Allocated: 1.5769214630126953  GigaBytes
Max Memory Allocated: 1.5770354270935059  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.5804672241210938  GigaBytes
Max Memory Allocated: 1.580718994140625  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([301, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.5876893997192383  GigaBytes
Max Memory Allocated: 1.5877175331115723  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.5876893997192383  GigaBytes
Max Memory Allocated: 1.5877175331115723  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 2.8299560546875 GB
    Memory Allocated: 1.5882635116577148  GigaBytes
Max Memory Allocated: 1.5882635116577148  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.690321922302246  GigaBytes
Max Memory Allocated: 1.6974983215332031  GigaBytes

rst.shape  torch.Size([1, 301, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.671717643737793  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.6721415519714355  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9061279296875 GB
    Memory Allocated: 1.6725654602050781  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9061279296875 GB
    Memory Allocated: 1.6721200942993164  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

torch.Size([2842, 40])
input nodes number: 20886
output nodes number: 2842
edges number: 22754
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9061279296875 GB
    Memory Allocated: 1.6727213859558105  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9061279296875 GB
    Memory Allocated: 1.672722339630127  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9315185546875 GB
    Memory Allocated: 0.043163299560546875  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

pseudo mini batch 1 input nodes size: 71846
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9315185546875 GB
    Memory Allocated: 0.039202213287353516  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9315185546875 GB
    Memory Allocated: 0.039202213287353516  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9315185546875 GB
    Memory Allocated: 0.07346105575561523  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9315185546875 GB
    Memory Allocated: 0.07348251342773438  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9315185546875 GB
    Memory Allocated: 0.040257930755615234  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9315185546875 GB
    Memory Allocated: 0.04171323776245117  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9315185546875 GB
    Memory Allocated: 0.04171323776245117  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9315185546875 GB
    Memory Allocated: 0.04171323776245117  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

torch.Size([71846, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9315185546875 GB
    Memory Allocated: 0.04171323776245117  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

m.shape torch.Size([801, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1262197494506836  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1262197494506836  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 801, 128]), torch.Size([1, 801, 128])
----------------------------------------3
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.126983642578125  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.13309478759765625  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 801, 128])
m.shape torch.Size([1074, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.13373708724975586  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.13373708724975586  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 1074, 128]), torch.Size([1, 1074, 128])
----------------------------------------3
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.13476133346557617  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.15012502670288086  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 1074, 128])
m.shape torch.Size([1122, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1512455940246582  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1512455940246582  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 1122, 128]), torch.Size([1, 1122, 128])
----------------------------------------3
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.15231561660766602  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.17612695693969727  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 1122, 128])
m.shape torch.Size([1110, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.17770910263061523  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.17770910263061523  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.17876768112182617  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.20994329452514648  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([1119, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.2120819091796875  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.2120819091796875  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 1119, 128]), torch.Size([1, 1119, 128])
----------------------------------------3
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.2131490707397461  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.2518892288208008  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 1119, 128])
m.shape torch.Size([1075, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.25443124771118164  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.25443124771118164  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 1075, 128]), torch.Size([1, 1075, 128])
----------------------------------------3
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.25545644760131836  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.29954004287719727  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 1075, 128])
m.shape torch.Size([912, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.30207157135009766  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.30207157135009766  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 912, 128]), torch.Size([1, 912, 128])
----------------------------------------3
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.30294132232666016  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.34718942642211914  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 912, 128])
m.shape torch.Size([899, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.35018396377563477  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.35018396377563477  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 899, 128]), torch.Size([1, 899, 128])
----------------------------------------3
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.351041316986084  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.401125431060791  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 899, 128])
m.shape torch.Size([785, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.40479564666748047  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.40479564666748047  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 785, 128]), torch.Size([1, 785, 128])
----------------------------------------3
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.4055442810058594  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.45359039306640625  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 785, 128])
m.shape torch.Size([12792, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.5142130851745605  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.5142130851745605  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 12792, 128]), torch.Size([1, 12792, 128])
----------------------------------------3
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.5264124870300293  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.3925700187683105  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 12792, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.3143692016601562  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.3350534439086914  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.3557376861572266  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.3348917961120605  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

torch.Size([21689, 256])
first layer input nodes number: 71846
first layer output nodes number: 21689
edges number: 171361
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.3562750816345215  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.3769593238830566  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.38279390335083  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.38279390335083  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

m.shape torch.Size([415, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.406935214996338  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.406935214996338  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.407726764678955  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.4140591621398926  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 415, 256])
m.shape torch.Size([371, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.4143767356872559  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.4143767356872559  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.4150843620300293  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.4272475242614746  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([266, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.4276609420776367  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.4276609420776367  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.4281682968139648  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.4406824111938477  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([220, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.441274642944336  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.441274642944336  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.4416942596435547  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.4538631439208984  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([188, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.454556941986084  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.454556941986084  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.4549155235290527  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.4678244590759277  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([168, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.468614101409912  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.468614101409912  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.4689345359802246  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.482713222503662  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([113, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.4833135604858398  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.4833135604858398  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.4835290908813477  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.4943056106567383  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([114, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.49507474899292  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.49507474899292  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.4952921867370605  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5076861381530762  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5083732604980469  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5083732604980469  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5085487365722656  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5197792053222656  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5203933715820312  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5203933715820312  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5205326080322266  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5304183959960938  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5310468673706055  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5310468673706055  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.531172752380371  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5409917831420898  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5416326522827148  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5416326522827148  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5417490005493164  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5516386032104492  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5522551536560059  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5522551536560059  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5523581504821777  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5618338584899902  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.562455177307129  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.562455177307129  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5625505447387695  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5719919204711914  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5727229118347168  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5727229118347168  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5728259086608887  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5837435722351074  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5843534469604492  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5843534469604492  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5844354629516602  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.593703269958496  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5942182540893555  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.5942182540893555  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.594283103942871  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.602065086364746  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.602482795715332  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.602482795715332  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6025323867797852  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.608830451965332  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6092805862426758  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6092805862426758  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.609330177307129  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6159753799438477  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.616335391998291  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.616335391998291  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6163735389709473  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6217522621154785  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.622117042541504  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.622117042541504  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6221532821655273  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.627516746520996  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6277313232421875  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6277313232421875  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6277523040771484  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6310043334960938  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6313037872314453  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6313037872314453  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6313304901123047  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6356563568115234  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6361274719238281  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6361274719238281  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6361675262451172  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6429367065429688  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([323, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6506781578063965  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.6506781578063965  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 3.7615966796875 GB
    Memory Allocated: 1.651294231414795  GigaBytes
Max Memory Allocated: 1.6989192962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7733154296875 GB
    Memory Allocated: 1.7606759071350098  GigaBytes
Max Memory Allocated: 1.7683768272399902  GigaBytes

rst.shape  torch.Size([1, 323, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7733154296875 GB
    Memory Allocated: 1.7395682334899902  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7733154296875 GB
    Memory Allocated: 1.7399921417236328  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7733154296875 GB
    Memory Allocated: 1.7404160499572754  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7733154296875 GB
    Memory Allocated: 1.7399706840515137  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([2842, 40])
input nodes number: 21689
output nodes number: 2842
edges number: 23884
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7733154296875 GB
    Memory Allocated: 1.7401537895202637  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7733154296875 GB
    Memory Allocated: 1.7401542663574219  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.04440021514892578  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

pseudo mini batch 2 input nodes size: 68905
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.040257930755615234  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.040257930755615234  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.07346105575561523  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.07348251342773438  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.039202213287353516  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.04057455062866211  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.04057455062866211  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.04057455062866211  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([68905, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.04057455062866211  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([797, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.11996078491210938  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.11996078491210938  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 797, 128]), torch.Size([1, 797, 128])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.12072086334228516  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.1268014907836914  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 797, 128])
m.shape torch.Size([1106, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.12752151489257812  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.12752151489257812  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1106, 128]), torch.Size([1, 1106, 128])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.12857627868652344  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.14439773559570312  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1106, 128])
m.shape torch.Size([1092, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.14618396759033203  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.14618396759033203  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.14722537994384766  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.17092227935791016  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([1103, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.17250537872314453  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.17250537872314453  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.17355728149414062  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.20465946197509766  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([1114, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.20678949356079102  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.20678949356079102  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1114, 128]), torch.Size([1, 1114, 128])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.20785188674926758  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.2465062141418457  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1114, 128])
m.shape torch.Size([954, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.2487044334411621  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.2487044334411621  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 954, 128]), torch.Size([1, 954, 128])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.24961423873901367  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.2890019416809082  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 954, 128])
m.shape torch.Size([853, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.2913942337036133  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.2913942337036133  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 853, 128]), torch.Size([1, 853, 128])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.2922077178955078  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.332918643951416  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 853, 128])
m.shape torch.Size([876, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.33585357666015625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.33585357666015625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 876, 128]), torch.Size([1, 876, 128])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.3366889953613281  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.384307861328125  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 876, 128])
m.shape torch.Size([817, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.38739633560180664  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.38739633560180664  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 817, 128]), torch.Size([1, 817, 128])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.38817548751831055  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.4388728141784668  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 817, 128])
m.shape torch.Size([11921, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.4953269958496094  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.4953269958496094  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 11921, 128]), torch.Size([1, 11921, 128])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 0.5066957473754883  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3348770141601562  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 11921, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.2616138458251953  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.2812910079956055  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3009681701660156  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.2811369895935059  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([20633, 256])
first layer input nodes number: 68905
first layer output nodes number: 20633
edges number: 161533
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3014836311340332  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3211607933044434  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3268742561340332  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3268742561340332  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([429, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3491601943969727  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3491601943969727  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3499784469604492  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3576154708862305  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([370, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3579177856445312  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3579177856445312  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3586235046386719  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3692355155944824  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([278, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3696846961975098  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3696846961975098  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3702149391174316  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3826818466186523  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([243, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3833513259887695  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3833513259887695  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.383814811706543  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3972558975219727  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3979806900024414  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.3979806900024414  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.398360252380371  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4120244979858398  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([148, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4126882553100586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4126882553100586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4129705429077148  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4251089096069336  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.425849437713623  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.425849437713623  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4260993003845215  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4385924339294434  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4393596649169922  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4393596649169922  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4395809173583984  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4521923065185547  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([105, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4529900550842285  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4529900550842285  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4531903266906738  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4660077095031738  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4666767120361328  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4666767120361328  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4668292999267578  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4776630401611328  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.478379726409912  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.478379726409912  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.478522777557373  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4896807670593262  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4901747703552246  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4901747703552246  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4902682304382324  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4982123374938965  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4987030029296875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4987030029296875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.4987850189208984  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5063304901123047  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5068550109863281  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5068550109863281  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5069351196289062  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5148658752441406  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5154461860656738  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5154461860656738  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5155282020568848  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5242218971252441  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5247807502746582  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5247807502746582  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.524855136871338  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5332608222961426  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5337305068969727  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5337305068969727  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5337896347045898  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5408849716186523  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5413575172424316  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5413575172424316  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5414128303527832  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5484375953674316  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5488848686218262  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5488848686218262  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5489344596862793  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.555579662322998  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5560550689697266  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5560550689697266  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5561046600341797  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5630970001220703  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5634961128234863  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5634961128234863  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5635361671447754  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5694642066955566  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5699729919433594  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5699729919433594  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5700206756591797  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5774116516113281  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.577807903289795  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.577807903289795  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5778441429138184  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5837149620056152  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5841121673583984  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5841121673583984  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.584146499633789  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5899486541748047  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([257, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.596107006072998  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.596107006072998  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.5965971946716309  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.6880550384521484  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 257, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.6688694953918457  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.6692934036254883  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.6697173118591309  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.6692719459533691  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([2842, 40])
input nodes number: 20633
output nodes number: 2842
edges number: 22625
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.669447422027588  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7752685546875 GB
    Memory Allocated: 1.669447898864746  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.04312419891357422  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

pseudo mini batch 3 input nodes size: 70448
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.039202213287353516  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.039202213287353516  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.07279443740844727  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.0728158950805664  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.039591312408447266  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.04102468490600586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.04102468490600586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.04102468490600586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([70448, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.04102468490600586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([840, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.12400341033935547  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.12400341033935547  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 840, 128]), torch.Size([1, 840, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.12480449676513672  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.13121318817138672  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 840, 128])
m.shape torch.Size([1048, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.13232660293579102  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.13232660293579102  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1048, 128]), torch.Size([1, 1048, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.13332605361938477  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.14831781387329102  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1048, 128])
m.shape torch.Size([1094, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.1493830680847168  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.1493830680847168  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.15042638778686523  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.17413091659545898  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([1069, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.17564821243286133  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.17564821243286133  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.1766676902770996  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.20623254776000977  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([1055, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2082381248474121  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2082381248474121  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1055, 128]), torch.Size([1, 1055, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2092442512512207  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2462759017944336  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1055, 128])
m.shape torch.Size([1008, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2486567497253418  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2486567497253418  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1008, 128]), torch.Size([1, 1008, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2496180534362793  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2912592887878418  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1008, 128])
m.shape torch.Size([881, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2937192916870117  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2937192916870117  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 881, 128]), torch.Size([1, 881, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2945594787597656  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.33656883239746094  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 881, 128])
m.shape torch.Size([878, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.33949804306030273  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.33949804306030273  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 878, 128]), torch.Size([1, 878, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.3403353691101074  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.3880629539489746  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 878, 128])
m.shape torch.Size([811, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.3911247253417969  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.3911247253417969  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 811, 128]), torch.Size([1, 811, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.39189815521240234  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.44333553314208984  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 811, 128])
m.shape torch.Size([12655, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.5032925605773926  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.5032925605773926  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 12655, 128]), torch.Size([1, 12655, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.5153613090515137  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3731064796447754  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 12655, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.2963261604309082  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3166766166687012  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3370270729064941  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3165173530578613  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([21339, 256])
first layer input nodes number: 70448
first layer output nodes number: 21339
edges number: 168857
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3375539779663086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3579044342041016  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3638200759887695  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3638200759887695  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([440, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3868489265441895  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3868489265441895  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.387688159942627  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3948798179626465  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([344, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3951215744018555  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3951215744018555  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.395777702331543  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4062128067016602  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([288, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4067153930664062  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4067153930664062  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4072647094726562  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.420300006866455  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([223, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4208827018737793  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4208827018737793  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4213080406188965  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.433642864227295  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([180, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.434295654296875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.434295654296875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4346389770507812  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4469985961914062  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([147, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4476747512817383  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4476747512817383  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4479551315307617  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4600114822387695  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4607462882995605  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4607462882995605  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4609942436218262  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4733920097351074  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4741830825805664  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4741830825805664  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.474410057067871  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4873476028442383  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.487978458404541  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.487978458404541  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.488142490386963  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.498640537261963  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4993276596069336  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4993276596069336  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4994802474975586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5103139877319336  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.511030673980713  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.511030673980713  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5111737251281738  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.522331714630127  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5230331420898438  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5230331420898438  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5231609344482422  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5340232849121094  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5346217155456543  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5346217155456543  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5347228050231934  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.544023036956787  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5446858406066895  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5446858406066895  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5447869300842285  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5547947883605957  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5552492141723633  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5552492141723633  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5553159713745117  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.562392234802246  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5629124641418457  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5629124641418457  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.562981128692627  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5707402229309082  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5712618827819824  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5712618827819824  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.571326732635498  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.579108715057373  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5796995162963867  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5796995162963867  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.579768180847168  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5884885787963867  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.588965892791748  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.588965892791748  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5890192985534668  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5961756706237793  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5966682434082031  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5966682434082031  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.596719741821289  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6039810180664062  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6045207977294922  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6045207977294922  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.604574203491211  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.612478256225586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6127266883850098  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6127266883850098  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6127514839172363  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6165947914123535  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6169586181640625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6169586181640625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6169910430908203  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.622243881225586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6225509643554688  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6225509643554688  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6225776672363281  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6270904541015625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([289, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.634021282196045  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.634021282196045  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6345725059509277  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.7396492958068848  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 289, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.7197065353393555  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.720130443572998  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.7205543518066406  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.720108985900879  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([2842, 40])
input nodes number: 21339
output nodes number: 2842
edges number: 23387
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.720289707183838  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.720290184020996  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.04366779327392578  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

pseudo mini batch 4 input nodes size: 70278
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.039591312408447266  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.039591312408447266  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.07310247421264648  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.07312393188476562  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.039510250091552734  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.0409245491027832  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.0409245491027832  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.0409245491027832  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([70278, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.0409245491027832  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([846, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.12282514572143555  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.12282514572143555  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 846, 128]), torch.Size([1, 846, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.12363195419311523  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.13104534149169922  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 846, 128])
m.shape torch.Size([1055, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.13164806365966797  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.13164806365966797  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1055, 128]), torch.Size([1, 1055, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.13265419006347656  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.14774608612060547  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1055, 128])
m.shape torch.Size([1138, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.14887094497680664  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.14887094497680664  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.14995622634887695  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.17383241653442383  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([1107, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.17545652389526367  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.17545652389526367  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1107, 128]), torch.Size([1, 1107, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.1765122413635254  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2075972557067871  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1107, 128])
m.shape torch.Size([1053, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2095799446105957  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2095799446105957  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1053, 128]), torch.Size([1, 1053, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.21058416366577148  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.24727725982666016  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1053, 128])
m.shape torch.Size([991, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.24961042404174805  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.24961042404174805  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 991, 128]), torch.Size([1, 991, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.25055551528930664  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2918238639831543  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 991, 128])
m.shape torch.Size([891, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2943253517150879  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2943253517150879  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 891, 128]), torch.Size([1, 891, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.29517507553100586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.33937931060791016  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 891, 128])
m.shape torch.Size([835, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.34213972091674805  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.34213972091674805  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 835, 128]), torch.Size([1, 835, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.34293603897094727  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.38884878158569336  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 835, 128])
m.shape torch.Size([769, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.3917508125305176  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.3917508125305176  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 769, 128]), torch.Size([1, 769, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.392484188079834  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.4398837089538574  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 769, 128])
m.shape torch.Size([12479, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.4990215301513672  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.4990215301513672  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 12479, 128]), torch.Size([1, 12479, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.5109224319458008  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.355886459350586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 12479, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.2801671028137207  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3003506660461426  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3205342292785645  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3001928329467773  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([21164, 256])
first layer input nodes number: 70278
first layer output nodes number: 21164
edges number: 166637
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3210601806640625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3412437438964844  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3462896347045898  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3462896347045898  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([425, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3690204620361328  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3690204620361328  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3698310852050781  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3764920234680176  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([349, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3767576217651367  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3767576217651367  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3774232864379883  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3883943557739258  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([317, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3889756202697754  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3889756202697754  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.389580249786377  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4059901237487793  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([226, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4065570831298828  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4065570831298828  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4069881439208984  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4194889068603516  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([179, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4201335906982422  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4201335906982422  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4204750061035156  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4327659606933594  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4334607124328613  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4334607124328613  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4337468147277832  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4460492134094238  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([118, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.446700096130371  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.446700096130371  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.446925163269043  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4581785202026367  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([114, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4589428901672363  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4589428901672363  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.459160327911377  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4715542793273926  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4722504615783691  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4722504615783691  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4724278450012207  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4837803840637207  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4845571517944336  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4845571517944336  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4847288131713867  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4969167709350586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4975500106811523  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4975500106811523  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4976797103881836  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.507796287536621  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([72, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5085620880126953  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5085620880126953  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5086994171142578  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5203723907470703  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5210037231445312  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5210037231445312  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5211105346679688  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5309371948242188  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.531395435333252  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.531395435333252  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5314679145812988  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5386433601379395  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5392417907714844  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5392417907714844  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5393257141113281  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5482215881347656  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.548717975616455  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.548717975616455  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5487847328186035  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.556328296661377  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5568180084228516  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5568180084228516  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5568790435791016  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5642032623291016  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5646920204162598  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5646920204162598  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5647492408752441  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5720162391662598  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5725722312927246  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5725722312927246  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5726332664489746  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5808119773864746  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5811467170715332  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5811467170715332  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5811829566955566  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5862927436828613  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5866785049438477  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5866785049438477  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.586716651916504  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.592362403869629  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.592787742614746  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.592787742614746  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5928277969360352  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5990362167358398  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.599370002746582  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.599370002746582  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.599400520324707  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.604344367980957  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6047677993774414  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6047677993774414  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6048040390014648  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6109285354614258  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([279, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6176142692565918  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6176142692565918  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6181464195251465  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.7260727882385254  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 279, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.7064213752746582  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.7068452835083008  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.7072691917419434  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.7068238258361816  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([2842, 40])
input nodes number: 21164
output nodes number: 2842
edges number: 23093
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.707003116607666  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.7070035934448242  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.043541908264160156  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

pseudo mini batch 5 input nodes size: 70213
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.039510250091552734  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.039510250091552734  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.07299041748046875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.07301187515258789  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.03947925567626953  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.040889739990234375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.040889739990234375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.040889739990234375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([70213, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.040889739990234375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([812, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.12249612808227539  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.12249612808227539  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.12327051162719727  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.12946557998657227  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([1071, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.13037538528442383  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.13037538528442383  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1071, 128]), torch.Size([1, 1071, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.13139677047729492  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.14671754837036133  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1071, 128])
m.shape torch.Size([1122, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.1478118896484375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.1478118896484375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1122, 128]), torch.Size([1, 1122, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.1488819122314453  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.17285442352294922  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1122, 128])
m.shape torch.Size([1116, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.1747303009033203  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.1747303009033203  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1116, 128]), torch.Size([1, 1116, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.1757946014404297  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2070331573486328  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1116, 128])
m.shape torch.Size([1071, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.20905447006225586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.20905447006225586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1071, 128]), torch.Size([1, 1071, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.21007585525512695  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2472238540649414  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1071, 128])
m.shape torch.Size([1028, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.24965429306030273  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.24965429306030273  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1028, 128]), torch.Size([1, 1028, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.25063467025756836  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2936129570007324  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1028, 128])
m.shape torch.Size([902, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.29613351821899414  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.29613351821899414  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 902, 128]), torch.Size([1, 902, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.2969937324523926  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.34133100509643555  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 902, 128])
m.shape torch.Size([860, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.34418153762817383  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.34418153762817383  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.3450016975402832  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.3917508125305176  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 860, 128])
m.shape torch.Size([867, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.3950614929199219  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.3950614929199219  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 867, 128]), torch.Size([1, 867, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.3958883285522461  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.4488058090209961  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 867, 128])
m.shape torch.Size([12276, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.506986141204834  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.506986141204834  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 12276, 128]), torch.Size([1, 12276, 128])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 0.5186934471130371  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3505988121032715  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 12276, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.2752318382263184  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.2953782081604004  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3155245780944824  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.2952203750610352  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([21125, 256])
first layer input nodes number: 70213
first layer output nodes number: 21125
edges number: 166064
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3160500526428223  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3361964225769043  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3414406776428223  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3414406776428223  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([405, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3641667366027832  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3641667366027832  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3649392127990723  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3723950386047363  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([364, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.372708797454834  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.372708797454834  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3734030723571777  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3856730461120605  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([302, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3861970901489258  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3861970901489258  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.3867731094360352  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.40089750289917  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([230, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.401494026184082  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.401494026184082  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.401932716369629  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4146547317504883  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([197, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4153823852539062  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4153823852539062  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4157581329345703  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4292850494384766  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([161, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4300260543823242  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4300260543823242  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.430333137512207  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.443537712097168  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([118, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4441781044006348  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4441781044006348  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4444031715393066  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4556565284729004  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4563822746276855  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4563822746276855  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.456590175628662  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4684405326843262  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([99, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4691929817199707  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4691929817199707  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4693818092346191  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4814667701721191  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([91, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4822473526000977  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4822473526000977  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4824209213256836  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4947443008422852  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4953556060791016  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4953556060791016  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.4954814910888672  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.505300521850586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5059757232666016  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5059757232666016  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5060977935791016  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5164737701416016  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([29, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.516775131225586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.516775131225586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5168304443359375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5219192504882812  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5225510597229004  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5225510597229004  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5226445198059082  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5318970680236816  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5325713157653809  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5325713157653809  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5326666831970215  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5427756309509277  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5433430671691895  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5433430671691895  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.543419361114502  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5520405769348145  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5525093078613281  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5525093078613281  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5525684356689453  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5596637725830078  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.560187816619873  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.560187816619873  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.560248851776123  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.568000316619873  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.568408489227295  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.568408489227295  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5684542655944824  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5745882987976074  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5751805305480957  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5751805305480957  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5752415657043457  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5838475227355957  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5841803550720215  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5841803550720215  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.584214687347412  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5892958641052246  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5895538330078125  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5895538330078125  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.589578628540039  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5934219360351562  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5938520431518555  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5938520431518555  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.5938901901245117  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6000699996948242  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6005353927612305  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6005353927612305  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6005754470825195  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.607344627380371  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([277, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.613980770111084  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.613980770111084  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.614509105682373  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.709700584411621  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 277, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6900367736816406  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6904606819152832  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6908845901489258  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.690439224243164  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([2842, 40])
input nodes number: 21125
output nodes number: 2842
edges number: 23108
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6906185150146484  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 1.6906189918518066  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.0435028076171875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

pseudo mini batch 6 input nodes size: 69795
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.03947925567626953  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.03947925567626953  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07276010513305664  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07278156280517578  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.039279937744140625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04067420959472656  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04067420959472656  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04067420959472656  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([69795, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04067420959472656  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([806, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12141036987304688  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12141036987304688  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12217903137207031  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12894392013549805  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([1005, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1295180320739746  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1295180320739746  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1005, 128]), torch.Size([1, 1005, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1304764747619629  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1448531150817871  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1005, 128])
m.shape torch.Size([1160, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14603328704833984  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14603328704833984  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1160, 128]), torch.Size([1, 1160, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1471395492553711  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17188549041748047  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1160, 128])
m.shape torch.Size([1109, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1734476089477539  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1734476089477539  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1109, 128]), torch.Size([1, 1109, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17450523376464844  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.20567035675048828  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1109, 128])
m.shape torch.Size([1087, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.207733154296875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.207733154296875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1087, 128]), torch.Size([1, 1087, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2087697982788086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.24718809127807617  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1087, 128])
m.shape torch.Size([985, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.24948787689208984  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.24948787689208984  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 985, 128]), torch.Size([1, 985, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.25042724609375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2916135787963867  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 985, 128])
m.shape torch.Size([945, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2942981719970703  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2942981719970703  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 945, 128]), torch.Size([1, 945, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2951993942260742  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.34041547775268555  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 945, 128])
m.shape torch.Size([894, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.34337520599365234  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.34337520599365234  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 894, 128]), torch.Size([1, 894, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.34422779083251953  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3941793441772461  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 894, 128])
m.shape torch.Size([801, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39719057083129883  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39719057083129883  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 801, 128]), torch.Size([1, 801, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39795446395874023  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.44684362411499023  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 801, 128])
m.shape torch.Size([12124, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5050554275512695  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5050554275512695  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 12124, 128]), torch.Size([1, 12124, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5166177749633789  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.346928596496582  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 12124, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.272383689880371  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.2923307418823242  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3122777938842773  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.2921748161315918  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([20916, 256])
first layer input nodes number: 69795
first layer output nodes number: 20916
edges number: 164293
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3127999305725098  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.332746982574463  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3381128311157227  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3381128311157227  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([429, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3604559898376465  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3604559898376465  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.361274242401123  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3690896034240723  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([362, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3693766593933105  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3693766593933105  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3700671195983887  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3838849067687988  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([319, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3844594955444336  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3844594955444336  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3850679397583008  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4000630378723145  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([231, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4006471633911133  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4006471633911133  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.401087760925293  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.413865089416504  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([180, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4145102500915527  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4145102500915527  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.414853572845459  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.427213191986084  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4279584884643555  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4279584884643555  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4282617568969727  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4413022994995117  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([142, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4421062469482422  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4421062469482422  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4423770904541016  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4559192657470703  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4565834999084473  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4565834999084473  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4567818641662598  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4680886268615723  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4688029289245605  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4688029289245605  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.468982219696045  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.480456829071045  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.481203556060791  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.481203556060791  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4813694953918457  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4931511878967285  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.493776798248291  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.493776798248291  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4939045906066895  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5038723945617676  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5044546127319336  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5044546127319336  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.504561424255371  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5136404037475586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.514087200164795  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.514087200164795  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5141634941101074  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5211825370788574  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5216827392578125  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5216827392578125  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.521759033203125  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5293121337890625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.529952049255371  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.529952049255371  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5300416946411133  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5395441055297852  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.539884090423584  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.539884090423584  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5399317741394043  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5453200340270996  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5457701683044434  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5457701683044434  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.545825481414795  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5524630546569824  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.552781581878662  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.552781581878662  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5528197288513184  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.557664394378662  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.558156967163086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.558156967163086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5582103729248047  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5653667449951172  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5658206939697266  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5658206939697266  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5658683776855469  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.572591781616211  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5729517936706543  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5729517936706543  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5729880332946777  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5783514976501465  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.578671932220459  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.578671932220459  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.578702449798584  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.583432674407959  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5837273597717285  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5837273597717285  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.583754062652588  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5880799293518066  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5885744094848633  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5885744094848633  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5886163711547852  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.595707893371582  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([287, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.602583408355713  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.602583408355713  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.60313081741333  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.702624797821045  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 287, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.683354377746582  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6837782859802246  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6842021942138672  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6837568283081055  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([2842, 40])
input nodes number: 20916
output nodes number: 2842
edges number: 22685
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.683934211730957  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6839346885681152  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.0432591438293457  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

pseudo mini batch 7 input nodes size: 69944
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.039279937744140625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.039279937744140625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.0726318359375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07265329360961914  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.03935098648071289  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.040750980377197266  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.040750980377197266  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.040750980377197266  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([69944, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.040750980377197266  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([861, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12174415588378906  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12174415588378906  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 861, 128]), torch.Size([1, 861, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12256526947021484  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1293182373046875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 861, 128])
m.shape torch.Size([1152, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1300063133239746  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1300063133239746  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1152, 128]), torch.Size([1, 1152, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1311049461364746  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1475844383239746  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1152, 128])
m.shape torch.Size([1156, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14868879318237305  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14868879318237305  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1156, 128]), torch.Size([1, 1156, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14979124069213867  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17404508590698242  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1156, 128])
m.shape torch.Size([1073, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17554044723510742  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17554044723510742  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1073, 128]), torch.Size([1, 1073, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17656373977661133  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.20719289779663086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1073, 128])
m.shape torch.Size([1049, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2091822624206543  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2091822624206543  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1049, 128]), torch.Size([1, 1049, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.21018266677856445  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2469921112060547  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1049, 128])
m.shape torch.Size([1001, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.24935579299926758  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.24935579299926758  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1001, 128]), torch.Size([1, 1001, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.25031042098999023  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.291841983795166  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1001, 128])
m.shape torch.Size([893, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2943453788757324  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2943453788757324  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 893, 128]), torch.Size([1, 893, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2951970100402832  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3395719528198242  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 893, 128])
m.shape torch.Size([869, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.34246110916137695  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.34246110916137695  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 869, 128]), torch.Size([1, 869, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.343289852142334  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39052820205688477  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 869, 128])
m.shape torch.Size([811, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39359426498413086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39359426498413086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 811, 128]), torch.Size([1, 811, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39436769485473633  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.44580507278442383  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 811, 128])
m.shape torch.Size([12208, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5040121078491211  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5040121078491211  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 12208, 128]), torch.Size([1, 12208, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5156545639038086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.346846580505371  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 12208, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.2721128463745117  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.2922096252441406  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3123064041137695  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.2920522689819336  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([21073, 256])
first layer input nodes number: 69944
first layer output nodes number: 21073
edges number: 164758
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3128294944763184  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3329262733459473  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.338071346282959  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.338071346282959  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([425, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3606343269348145  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3606343269348145  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3614449501037598  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3692688941955566  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([391, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3696155548095703  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3696155548095703  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.370361328125  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3839759826660156  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([292, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3844451904296875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3844451904296875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3850021362304688  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3978896141052246  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([219, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3984532356262207  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3984532356262207  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3988709449768066  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4109845161437988  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([187, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4116744995117188  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4116744995117188  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4120311737060547  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4248714447021484  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4256277084350586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4256277084350586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4259366989135742  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.439223289489746  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4399704933166504  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4399704933166504  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4402260780334473  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.453005313873291  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.453723430633545  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.453723430633545  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4539332389831543  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4658923149108887  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4665226936340332  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4665226936340332  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4666848182678223  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4770607948303223  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.477806568145752  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.477806568145752  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4779706001281738  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.489616870880127  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4902753829956055  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4902753829956055  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4904088973999023  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5008230209350586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5013561248779297  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5013561248779297  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.501455307006836  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5098857879638672  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5104236602783203  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5104236602783203  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5105133056640625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5187606811523438  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5191736221313477  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5191736221313477  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5192384719848633  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5256586074829102  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5261311531066895  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5261311531066895  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.526197910308838  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5332741737365723  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5337486267089844  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5337486267089844  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5338115692138672  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.540924072265625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5414319038391113  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5414319038391113  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5414948463439941  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5490479469299316  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5494318008422852  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5494318008422852  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5494775772094727  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5552911758422852  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5556883811950684  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5556883811950684  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.555732250213623  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5616106986999512  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5621657371520996  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5621657371520996  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.562222957611084  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5702910423278809  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5707874298095703  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5707874298095703  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5708370208740234  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.578176498413086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5785536766052246  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5785536766052246  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.578589916229248  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5842070579528809  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5845208168029785  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5845208168029785  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5845494270324707  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.589184284210205  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5895390510559082  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5895390510559082  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5895695686340332  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5947270393371582  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([294, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.601776123046875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.601776123046875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6023368835449219  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7040367126464844  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 294, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6845378875732422  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6849617958068848  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6853857040405273  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6849403381347656  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([2842, 40])
input nodes number: 21073
output nodes number: 2842
edges number: 22916
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6851191520690918  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.68511962890625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04334831237792969  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

pseudo mini batch 8 input nodes size: 70797
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.03935098648071289  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.03935098648071289  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07310962677001953  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07313108444213867  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.039757728576660156  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04117298126220703  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04117298126220703  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04117298126220703  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([70797, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04117298126220703  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([842, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1230306625366211  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1230306625366211  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 842, 128]), torch.Size([1, 842, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12383365631103516  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13025760650634766  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 842, 128])
m.shape torch.Size([1117, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1309213638305664  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1309213638305664  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1319866180419922  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1479654312133789  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([1188, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1499037742614746  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1499037742614746  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1188, 128]), torch.Size([1, 1188, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.15103673934936523  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17596197128295898  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1188, 128])
m.shape torch.Size([1100, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17749357223510742  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17749357223510742  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1100, 128]), torch.Size([1, 1100, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1785426139831543  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.20944547653198242  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1100, 128])
m.shape torch.Size([1049, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.21142196655273438  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.21142196655273438  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1049, 128]), torch.Size([1, 1049, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.21242237091064453  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.24897432327270508  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1049, 128])
m.shape torch.Size([989, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.25130367279052734  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.25130367279052734  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 989, 128]), torch.Size([1, 989, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2522468566894531  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2934713363647461  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 989, 128])
m.shape torch.Size([957, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.29619407653808594  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.29619407653808594  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 957, 128]), torch.Size([1, 957, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2971067428588867  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3427400588989258  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 957, 128])
m.shape torch.Size([887, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.34566736221313477  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.34566736221313477  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 887, 128]), torch.Size([1, 887, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3465132713317871  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39577150344848633  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 887, 128])
m.shape torch.Size([760, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39861011505126953  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39861011505126953  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 760, 128]), torch.Size([1, 760, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3993349075317383  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.44690847396850586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 760, 128])
m.shape torch.Size([12369, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.505526065826416  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.505526065826416  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 12369, 128]), torch.Size([1, 12369, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5173220634460449  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3548378944396973  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 12369, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.279259204864502  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.299532413482666  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.31980562210083  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.2993736267089844  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([21258, 256])
first layer input nodes number: 70797
first layer output nodes number: 21258
edges number: 166544
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3203353881835938  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3406085968017578  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3456768989562988  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3456768989562988  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([425, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3685388565063477  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3685388565063477  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.369349479675293  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3763666152954102  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([352, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3766379356384277  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3766379356384277  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3773093223571777  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3897204399108887  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([284, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3902039527893066  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3902039527893066  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3907456398010254  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4063434600830078  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([216, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4069032669067383  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4069032669067383  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4073152542114258  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4192628860473633  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4199366569519043  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4199366569519043  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.420285701751709  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4328513145446777  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([174, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4336957931518555  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4336957931518555  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4340276718139648  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.448298454284668  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([143, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4490947723388672  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4490947723388672  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4493675231933594  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4630050659179688  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4637298583984375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4637298583984375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4639434814453125  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4761199951171875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4768266677856445  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4768266677856445  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.477005958557129  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.488480567932129  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4891314506530762  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4891314506530762  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4892783164978027  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4997057914733887  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5003409385681152  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5003409385681152  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5004687309265137  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5104365348815918  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.511110782623291  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.511110782623291  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.511232852935791  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.521608829498291  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5221600532531738  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5221600532531738  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5222535133361816  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5308518409729004  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([57, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5315723419189453  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5315723419189453  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5316810607910156  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5424442291259766  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5429954528808594  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5429954528808594  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5430755615234375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5515670776367188  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5521268844604492  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5521268844604492  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.552201271057129  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5606069564819336  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5610928535461426  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5610928535461426  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5611538887023926  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5684781074523926  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5688629150390625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5688629150390625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.56890869140625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5747222900390625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5751194953918457  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5751194953918457  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5751633644104004  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5810418128967285  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.58150053024292  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.58150053024292  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5815482139587402  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5882716178894043  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5886516571044922  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5886516571044922  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5886898040771484  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5943355560302734  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5948877334594727  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5948877334594727  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5949392318725586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.602921485900879  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6030726432800293  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6030726432800293  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6030879020690918  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6055598258972168  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6059675216674805  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6059675216674805  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.606001853942871  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6118040084838867  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([287, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6186833381652832  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6186833381652832  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6192307472229004  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7371182441711426  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 287, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7173290252685547  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7177529335021973  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7181768417358398  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7177314758300781  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([2842, 40])
input nodes number: 21258
output nodes number: 2842
edges number: 23229
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.717911720275879  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.717912197113037  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04379892349243164  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

pseudo mini batch 9 input nodes size: 70457
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.039757728576660156  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.039757728576660156  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07335424423217773  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07337570190429688  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.039595603942871094  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.040999412536621094  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.040999412536621094  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.040999412536621094  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([70457, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.040999412536621094  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([856, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12233877182006836  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12233877182006836  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 856, 128]), torch.Size([1, 856, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12315511703491211  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1296858787536621  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 856, 128])
m.shape torch.Size([1124, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13077211380004883  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13077211380004883  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1124, 128]), torch.Size([1, 1124, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13184404373168945  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14792299270629883  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1124, 128])
m.shape torch.Size([1102, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14896345138549805  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14896345138549805  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1102, 128]), torch.Size([1, 1102, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.15001440048217773  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17374944686889648  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1102, 128])
m.shape torch.Size([1095, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17531251907348633  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17531251907348633  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17635679244995117  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.20737504959106445  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([1081, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.20943021774291992  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.20943021774291992  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1081, 128]), torch.Size([1, 1081, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.21046113967895508  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2489013671875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1081, 128])
m.shape torch.Size([936, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.25106382369995117  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.25106382369995117  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 936, 128]), torch.Size([1, 936, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2519564628601074  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.29061365127563477  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 936, 128])
m.shape torch.Size([906, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.29319143295288086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.29319143295288086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 906, 128]), torch.Size([1, 906, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2940554618835449  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.33873414993286133  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 906, 128])
m.shape torch.Size([869, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3416171073913574  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3416171073913574  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 869, 128]), torch.Size([1, 869, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.34244585037231445  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.38970518112182617  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 869, 128])
m.shape torch.Size([801, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.392728328704834  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.392728328704834  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 801, 128]), torch.Size([1, 801, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3934922218322754  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.44267845153808594  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 801, 128])
m.shape torch.Size([12316, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5010237693786621  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5010237693786621  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 12316, 128]), torch.Size([1, 12316, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5127692222595215  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.346696376800537  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 12316, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.271573543548584  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.2916827201843262  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3117918968200684  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.2915253639221191  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([21086, 256])
first layer input nodes number: 70457
first layer output nodes number: 21086
edges number: 165474
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3123188018798828  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.332427978515625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3382091522216797  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3382091522216797  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([460, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.360724925994873  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.360724925994873  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3616023063659668  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.369056224822998  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([362, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3693137168884277  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3693137168884277  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3700041770935059  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3828411102294922  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([313, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3833985328674316  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3833985328674316  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.383995532989502  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4015069007873535  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([228, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.402085304260254  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.402085304260254  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4025201797485352  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4151315689086914  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([181, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4157843589782715  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4157843589782715  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4161295890808105  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4285578727722168  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4292793273925781  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4292793273925781  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.429574966430664  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4422874450683594  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([115, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.44291353225708  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.44291353225708  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4431328773498535  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4541001319885254  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([92, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.454698085784912  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.454698085784912  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4548735618591309  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4648756980895996  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([64, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.465341567993164  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.465341567993164  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.465463638305664  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.473276138305664  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.474012851715088  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.474012851715088  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4741711616516113  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4854111671447754  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([90, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.486283779144287  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.486283779144287  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4864554405212402  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.499845027923584  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5004053115844727  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5004053115844727  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5005121231079102  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5095911026000977  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5102124214172363  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5102124214172363  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5103154182434082  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5197911262512207  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5203723907470703  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5203723907470703  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5204620361328125  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.529336929321289  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5297822952270508  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5297822952270508  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5298471450805664  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5367212295532227  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5372424125671387  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5372424125671387  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.53731107711792  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5450701713562012  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5455427169799805  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5455427169799805  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5456018447875977  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5526971817016602  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5531005859375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5531005859375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5531482696533203  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5592041015625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.55967378616333  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.55967378616333  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.559725284576416  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5666260719299316  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5671005249023438  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5671005249023438  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5671501159667969  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5741424560546875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5745415687561035  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5745415687561035  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5745816230773926  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5805096626281738  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5808706283569336  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5808706283569336  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5809049606323242  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.586226463317871  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.586474895477295  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.586474895477295  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5864977836608887  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5902056694030762  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.590494155883789  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.590494155883789  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5905189514160156  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5947093963623047  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([299, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.601881504058838  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.601881504058838  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6024518013000488  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7201876640319824  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 299, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7007641792297363  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.701188087463379  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7016119956970215  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7011666297912598  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([2842, 40])
input nodes number: 21086
output nodes number: 2842
edges number: 22835
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.701345443725586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7013459205627441  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04360342025756836  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

pseudo mini batch 10 input nodes size: 70731
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.039595603942871094  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.039595603942871094  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07332277297973633  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07334423065185547  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.03972625732421875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.041164398193359375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.041164398193359375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.041164398193359375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([70731, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.041164398193359375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([785, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12444305419921875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12444305419921875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 785, 128]), torch.Size([1, 785, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12519168853759766  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1311807632446289  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 785, 128])
m.shape torch.Size([1044, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1320037841796875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1320037841796875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1044, 128]), torch.Size([1, 1044, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13299942016601562  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1479339599609375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1044, 128])
m.shape torch.Size([1132, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14905548095703125  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14905548095703125  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1132, 128]), torch.Size([1, 1132, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.15013504028320312  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17398452758789062  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1132, 128])
m.shape torch.Size([1116, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17557334899902344  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17557334899902344  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1116, 128]), torch.Size([1, 1116, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1766376495361328  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.20787620544433594  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1116, 128])
m.shape torch.Size([1063, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.20987844467163086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.20987844467163086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1063, 128]), torch.Size([1, 1063, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2108922004699707  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.24775981903076172  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1063, 128])
m.shape torch.Size([1006, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.25013113021850586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.25013113021850586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1006, 128]), torch.Size([1, 1006, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.25109052658081055  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.29268789291381836  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1006, 128])
m.shape torch.Size([999, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.29554271697998047  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.29554271697998047  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 999, 128]), torch.Size([1, 999, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2964954376220703  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3455348014831543  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 999, 128])
m.shape torch.Size([888, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3484458923339844  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3484458923339844  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 888, 128]), torch.Size([1, 888, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3492927551269531  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3984642028808594  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 888, 128])
m.shape torch.Size([800, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.4014739990234375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.4014739990234375  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 800, 128]), torch.Size([1, 800, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.4022369384765625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.45191383361816406  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 800, 128])
m.shape torch.Size([12614, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5116806030273438  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5116806030273438  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 12614, 128]), torch.Size([1, 12614, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5237102508544922  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3786225318908691  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 12614, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3015942573547363  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3220477104187012  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.342501163482666  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.321887493133545  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([21447, 256])
first layer input nodes number: 70731
first layer output nodes number: 21447
edges number: 169521
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3430304527282715  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3634839057922363  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3685975074768066  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3685975074768066  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([404, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3915987014770508  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3915987014770508  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.392369270324707  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3993444442749023  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([362, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3996553421020508  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3996553421020508  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.400345802307129  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4111757278442383  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([297, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.411686897277832  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.411686897277832  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4122533798217773  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4263429641723633  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([235, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4269633293151855  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4269633293151855  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4274115562438965  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4404101371765137  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([189, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4410943984985352  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4410943984985352  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4414548873901367  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.454432487487793  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4551115036010742  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4551115036010742  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4553956985473633  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.467616081237793  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([141, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4684228897094727  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4684228897094727  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4686918258666992  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4821386337280273  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4828195571899414  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4828195571899414  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4830217361450195  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4945459365844727  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4951977729797363  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4951977729797363  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.495363712310791  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.505983829498291  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5066123008728027  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5066123008728027  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5067534446716309  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5167746543884277  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([85, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5176029205322266  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5176029205322266  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5177650451660156  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5304107666015625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.531114101409912  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.531114101409912  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5312438011169434  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5422682762145996  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5428533554077148  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5428533554077148  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.542952537536621  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.552077293395996  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5525259971618652  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5525259971618652  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5525965690612793  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5595831871032715  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5601825714111328  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5601825714111328  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5602664947509766  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.569162368774414  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5696587562561035  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5696587562561035  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.569725513458252  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5772690773010254  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5776119232177734  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5776119232177734  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5776557922363281  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5829200744628906  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.58353853225708  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.58353853225708  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5836091041564941  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.59257173538208  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5929017066955566  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5929017066955566  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.592939853668213  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5980515480041504  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5985326766967773  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5985326766967773  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5985822677612305  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.605574607849121  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6058931350708008  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6058931350708008  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6059255599975586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6107244491577148  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.611067771911621  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.611067771911621  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.611100196838379  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6161260604858398  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6163530349731445  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6163530349731445  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6163740158081055  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6197729110717773  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6201777458190918  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6201777458190918  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6202120780944824  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.626014232635498  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([308, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6333980560302734  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6333980560302734  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6339855194091797  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.746267318725586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 308, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.72629976272583  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7267236709594727  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7271475791931152  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7267022132873535  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([2842, 40])
input nodes number: 21447
output nodes number: 2842
edges number: 23394
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.726883888244629  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.726884365081787  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04381752014160156  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

pseudo mini batch 11 input nodes size: 71950
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.03972625732421875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.03972625732421875  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.0740346908569336  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07405614852905273  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04030752182006836  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04176187515258789  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04176187515258789  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04176187515258789  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([71950, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04176187515258789  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([816, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12627553939819336  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12627553939819336  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12705373764038086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13327932357788086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([1051, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13389253616333008  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13389253616333008  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13489484786987305  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14992952346801758  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([1148, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1512603759765625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1512603759765625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1148, 128]), torch.Size([1, 1148, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.15235519409179688  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17644119262695312  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1148, 128])
m.shape torch.Size([1132, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1780529022216797  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1780529022216797  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1132, 128]), torch.Size([1, 1132, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17913246154785156  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2105083465576172  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1132, 128])
m.shape torch.Size([1153, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.21271753311157227  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.21271753311157227  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1153, 128]), torch.Size([1, 1153, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.21381711959838867  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2534022331237793  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1153, 128])
m.shape torch.Size([1013, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2557506561279297  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2557506561279297  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 1013, 128]), torch.Size([1, 1013, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2567167282104492  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2985553741455078  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 1013, 128])
m.shape torch.Size([998, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3014035224914551  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3014035224914551  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 998, 128]), torch.Size([1, 998, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3023552894592285  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.35129690170288086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 998, 128])
m.shape torch.Size([911, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3542962074279785  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3542962074279785  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 911, 128]), torch.Size([1, 911, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3551650047302246  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.40555715560913086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 911, 128])
m.shape torch.Size([870, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.4088563919067383  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.4088563919067383  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.4096860885620117  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.4636497497558594  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([12645, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5235309600830078  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5235309600830078  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 12645, 128]), torch.Size([1, 12645, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5355901718139648  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3919610977172852  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 12645, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3138542175292969  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3345842361450195  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3553142547607422  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3344221115112305  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

torch.Size([21737, 256])
first layer input nodes number: 71950
first layer output nodes number: 21737
edges number: 171287
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3558526039123535  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3765826225280762  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.381765365600586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.381765365600586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

m.shape torch.Size([398, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4058918952941895  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4058918952941895  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4066510200500488  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4138474464416504  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([328, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4140987396240234  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4140987396240234  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.414724349975586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.424234390258789  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([295, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4247722625732422  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4247722625732422  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4253349304199219  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.439035415649414  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([226, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4396233558654785  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4396233558654785  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4400544166564941  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4525551795959473  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([205, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4533414840698242  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4533414840698242  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4537324905395508  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.467808723449707  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([141, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4684267044067383  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4684267044067383  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4686956405639648  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.480259895324707  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4810609817504883  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4810609817504883  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4813261032104492  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.494582176208496  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([124, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4954032897949219  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4954032897949219  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4956398010253906  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5091209411621094  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5098681449890137  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5098681449890137  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.510058879852295  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.522265911102295  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.522958755493164  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.522958755493164  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5231151580810547  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.534219741821289  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([81, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5349979400634766  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5349979400634766  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5351524353027344  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5472030639648438  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5478296279907227  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5478296279907227  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5479459762573242  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.557835578918457  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([65, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5585899353027344  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5585899353027344  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5587139129638672  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.570119857788086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5706367492675781  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5706367492675781  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.570718765258789  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5788383483886719  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5793886184692383  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5793886184692383  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5794668197631836  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5877561569213867  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5883479118347168  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5883479118347168  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.588426113128662  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5972628593444824  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5977468490600586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5977468490600586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5978078842163086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6051321029663086  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.605482578277588  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.605482578277588  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6055245399475098  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.610853672027588  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.611252784729004  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.611252784729004  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6112966537475586  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6171751022338867  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6174802780151367  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6174802780151367  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6175127029418945  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.622084617614746  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6224722862243652  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6224722862243652  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6225104331970215  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6281561851501465  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6286449432373047  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6286449432373047  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6286907196044922  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6357860565185547  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6360950469970703  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6360950469970703  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6361236572265625  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6407585144042969  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.640998363494873  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.640998363494873  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.641019344329834  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6445651054382324  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([308, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6519556045532227  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6519556045532227  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.652543067932129  GigaBytes
Max Memory Allocated: 1.7685070037841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7629623413085938  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 308, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.741899013519287  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7423229217529297  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7427468299865723  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7423014640808105  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([2842, 40])
input nodes number: 21737
output nodes number: 2842
edges number: 23714
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7424850463867188  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.742485523223877  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.0444488525390625  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

pseudo mini batch 12 input nodes size: 71171
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04030752182006836  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04030752182006836  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07424449920654297  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07426595687866211  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.039936065673828125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04137897491455078  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04137897491455078  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04137897491455078  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([71171, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04137897491455078  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([872, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12487602233886719  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12487602233886719  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 872, 128]), torch.Size([1, 872, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12570762634277344  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13236045837402344  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 872, 128])
m.shape torch.Size([1064, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13296842575073242  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13296842575073242  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1064, 128]), torch.Size([1, 1064, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13398313522338867  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14920377731323242  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1064, 128])
m.shape torch.Size([1087, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1510615348815918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1510615348815918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1087, 128]), torch.Size([1, 1087, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1520981788635254  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17577600479125977  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1087, 128])
m.shape torch.Size([1097, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17735004425048828  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17735004425048828  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1097, 128]), torch.Size([1, 1097, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17839622497558594  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.20943546295166016  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1097, 128])
m.shape torch.Size([1080, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2114872932434082  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2114872932434082  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.21251726150512695  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.24994325637817383  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([962, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2521805763244629  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2521805763244629  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 962, 128]), torch.Size([1, 962, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2530980110168457  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.29254770278930664  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 962, 128])
m.shape torch.Size([910, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.29512643814086914  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.29512643814086914  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 910, 128]), torch.Size([1, 910, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.29599428176879883  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3404994010925293  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 910, 128])
m.shape torch.Size([894, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3434758186340332  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3434758186340332  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 894, 128]), torch.Size([1, 894, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3443284034729004  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39438295364379883  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 894, 128])
m.shape torch.Size([818, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39746713638305664  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39746713638305664  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 818, 128]), torch.Size([1, 818, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39824724197387695  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.45084524154663086  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 818, 128])
m.shape torch.Size([12718, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5110993385314941  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5110993385314941  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 12718, 128]), torch.Size([1, 12718, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5232281684875488  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3847742080688477  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 12718, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3075485229492188  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.328054428100586  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3485603332519531  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3278942108154297  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([21502, 256])
first layer input nodes number: 71171
first layer output nodes number: 21502
edges number: 169885
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.349092960357666  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3695988655090332  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.374725341796875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.374725341796875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([436, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3988838195800781  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3988838195800781  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3997154235839844  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4065608978271484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([382, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4068794250488281  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4068794250488281  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4076080322265625  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4185714721679688  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([262, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4189629554748535  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4189629554748535  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4194626808166504  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4316582679748535  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([238, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4323234558105469  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4323234558105469  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4327774047851562  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4459419250488281  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([175, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4465560913085938  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4465560913085938  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.446889877319336  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4589061737060547  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([142, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4595584869384766  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4595584869384766  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.459829330444336  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.471475601196289  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([113, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4721007347106934  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4721007347106934  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4723162651062012  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4830927848815918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4838924407958984  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4838924407958984  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4841175079345703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4969463348388672  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4976210594177246  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4976210594177246  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4977946281433105  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5089030265808105  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.509556770324707  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.509556770324707  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5097036361694336  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5201311111450195  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5208616256713867  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5208616256713867  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5210065841674805  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.532313346862793  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.532933235168457  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.532933235168457  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5330476760864258  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5427751541137695  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([60, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5434679985046387  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5434679985046387  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5435824394226074  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5541110038757324  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5545382499694824  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5545382499694824  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5546069145202637  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5614047050476074  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5618896484375  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5618896484375  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5619583129882812  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5692367553710938  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.569725513458252  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.569725513458252  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5697903633117676  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5771183967590332  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.577690601348877  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.577690601348877  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.577761173248291  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5862298011779785  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5865755081176758  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5865755081176758  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5866174697875977  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5919466018676758  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5923457145690918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5923457145690918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5923895835876465  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5982680320739746  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5988612174987793  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5988612174987793  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5989222526550293  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6075282096862793  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6080026626586914  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6080026626586914  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6080503463745117  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.615107536315918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.615464687347412  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.615464687347412  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6154990196228027  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6208205223083496  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6211352348327637  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6211352348327637  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6211638450622559  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6257987022399902  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6261768341064453  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6261768341064453  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6262092590332031  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6316890716552734  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([317, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6392898559570312  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6392898559570312  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6398944854736328  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.748645305633545  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 317, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7275443077087402  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7279682159423828  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7283921241760254  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7279467582702637  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([2842, 40])
input nodes number: 21502
output nodes number: 2842
edges number: 23614
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.728128433227539  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7281289100646973  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.044042110443115234  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

pseudo mini batch 13 input nodes size: 71278
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.039936065673828125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.039936065673828125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07392406463623047  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07394552230834961  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.03998708724975586  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04143095016479492  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04143095016479492  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04143095016479492  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([71278, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04143095016479492  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([877, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12595891952514648  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12595891952514648  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 877, 128]), torch.Size([1, 877, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12679529190063477  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13348627090454102  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 877, 128])
m.shape torch.Size([1052, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13407135009765625  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13407135009765625  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1052, 128]), torch.Size([1, 1052, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13507461547851562  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.15012359619140625  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1052, 128])
m.shape torch.Size([1133, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.15124273300170898  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.15124273300170898  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1133, 128]), torch.Size([1, 1133, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.15232324600219727  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17671680450439453  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1133, 128])
m.shape torch.Size([1079, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17823457717895508  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17823457717895508  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1079, 128]), torch.Size([1, 1079, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17926359176635742  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.21001100540161133  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1079, 128])
m.shape torch.Size([1093, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.21210241317749023  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.21210241317749023  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1093, 128]), torch.Size([1, 1093, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.21314477920532227  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2518196105957031  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1093, 128])
m.shape torch.Size([961, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.25404787063598633  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.25404787063598633  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 961, 128]), torch.Size([1, 961, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.25496435165405273  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2943730354309082  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 961, 128])
m.shape torch.Size([927, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2970089912414551  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2970089912414551  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 927, 128]), torch.Size([1, 927, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.29789304733276367  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.34250736236572266  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 927, 128])
m.shape torch.Size([880, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.34542226791381836  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.34542226791381836  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 880, 128]), torch.Size([1, 880, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.34626150131225586  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3948073387145996  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 880, 128])
m.shape torch.Size([793, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39779090881347656  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39779090881347656  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3985471725463867  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.4469480514526367  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([12742, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5073285102844238  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5073285102844238  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 12742, 128]), torch.Size([1, 12742, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5194802284240723  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.382554531097412  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 12742, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3043079376220703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3248472213745117  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3453865051269531  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3246865272521973  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([21537, 256])
first layer input nodes number: 71278
first layer output nodes number: 21537
edges number: 170013
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3459196090698242  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3664588928222656  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.371593952178955  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.371593952178955  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([444, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3957595825195312  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3957595825195312  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3966064453125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4034290313720703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([366, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4037094116210938  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4037094116210938  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4044075012207031  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4151649475097656  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([282, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4156293869018555  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4156293869018555  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4161672592163086  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4281034469604492  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([210, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4286422729492188  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4286422729492188  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4290428161621094  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4406585693359375  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4415345191955566  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4415345191955566  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4419312477111816  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4562134742736816  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([126, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4567418098449707  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4567418098449707  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.456982135772705  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4673161506652832  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4680371284484863  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4680371284484863  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.468275547027588  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.480196475982666  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([92, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4807848930358887  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4807848930358887  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4809603691101074  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4909625053405762  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4917054176330566  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4917054176330566  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4918885231018066  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5036072731018066  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([92, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5044002532958984  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5044002532958984  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5045757293701172  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5170345306396484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5176763534545898  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5176763534545898  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.517807960510254  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5280733108520508  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5286073684692383  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5286073684692383  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5287065505981445  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5371370315551758  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.53776216506958  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.53776216506958  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.537865161895752  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5473408699035645  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5478816032409668  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5478816032409668  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5479655265808105  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5562739372253418  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5568089485168457  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5568089485168457  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5568852424621582  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5649724006652832  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5653958320617676  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5653958320617676  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.565453052520752  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5719189643859863  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5723152160644531  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5723152160644531  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5723648071289062  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5783157348632812  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([44, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.579052448272705  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.579052448272705  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5791363716125488  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.589794635772705  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5901727676391602  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5901727676391602  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5902166366577148  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.596095085144043  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5964961051940918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5964961051940918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5965380668640137  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.602454662322998  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6030192375183105  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6030192375183105  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.603074550628662  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6112608909606934  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6115293502807617  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6115293502807617  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.611556053161621  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6156949996948242  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6162123680114746  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6162123680114746  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.616258144378662  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.623673915863037  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6239972114562988  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6239972114562988  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.624025821685791  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6288609504699707  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([315, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.636415958404541  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.636415958404541  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.637016773223877  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7466707229614258  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 315, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.72645902633667  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7268829345703125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.727306842803955  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7268614768981934  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([2842, 40])
input nodes number: 21537
output nodes number: 2842
edges number: 23649
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.727043628692627  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7270441055297852  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.0440974235534668  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

pseudo mini batch 14 input nodes size: 71059
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.03998708724975586  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.03998708724975586  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07387065887451172  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07389211654663086  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.039882659912109375  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04131793975830078  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04131793975830078  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04131793975830078  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([71059, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04131793975830078  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([812, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12439775466918945  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12439775466918945  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12517213821411133  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13136720657348633  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([1008, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1319413185119629  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1319413185119629  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1008, 128]), torch.Size([1, 1008, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1329026222229004  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1473221778869629  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1008, 128])
m.shape torch.Size([1095, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1484079360961914  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1484079360961914  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14945220947265625  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17316055297851562  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([1114, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17476320266723633  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17476320266723633  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1114, 128]), torch.Size([1, 1114, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1758255958557129  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.20704317092895508  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1114, 128])
m.shape torch.Size([1062, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2090439796447754  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2090439796447754  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.21005678176879883  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.24691534042358398  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([1012, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.24930429458618164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.24930429458618164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1012, 128]), torch.Size([1, 1012, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.25026941299438477  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.29199838638305664  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1012, 128])
m.shape torch.Size([931, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.29462337493896484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.29462337493896484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 931, 128]), torch.Size([1, 931, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.29551124572753906  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3400449752807617  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 931, 128])
m.shape torch.Size([877, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.34294652938842773  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.34294652938842773  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 877, 128]), torch.Size([1, 877, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.343782901763916  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3923792839050293  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 877, 128])
m.shape torch.Size([791, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3953557014465332  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3953557014465332  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 791, 128]), torch.Size([1, 791, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39611005783081055  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.4444541931152344  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 791, 128])
m.shape torch.Size([12649, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.504392147064209  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.504392147064209  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 12649, 128]), torch.Size([1, 12649, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5164551734924316  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.373514175415039  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 12649, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.2966299057006836  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3169918060302734  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3373537063598633  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3168325424194336  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([21351, 256])
first layer input nodes number: 71059
first layer output nodes number: 21351
edges number: 169093
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3378853797912598  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3582472801208496  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3633379936218262  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3633379936218262  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([443, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3863615989685059  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3863615989685059  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3872065544128418  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3944611549377441  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 443, 256])
m.shape torch.Size([328, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.394669532775879  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.394669532775879  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3952951431274414  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.404759407043457  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([259, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.40519380569458  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.40519380569458  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4056878089904785  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4185070991516113  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([239, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4191789627075195  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4191789627075195  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4196348190307617  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4328546524047852  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([228, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4338998794555664  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4338998794555664  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4343347549438477  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4499902725219727  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([169, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4507474899291992  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4507474899291992  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4510698318481445  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.464930534362793  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4656105041503906  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4656105041503906  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4658489227294922  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4777698516845703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4784350395202637  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4784350395202637  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4786295890808105  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4897189140319824  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4904265403747559  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4904265403747559  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4906039237976074  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5019564628601074  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5026178359985352  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5026178359985352  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5027666091918945  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5133295059204102  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5138683319091797  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5138683319091797  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5139789581298828  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5226078033447266  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5233025550842285  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5233025550842285  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5234265327453613  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5339646339416504  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5344152450561523  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5344152450561523  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5344934463500977  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5416879653930664  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.542241096496582  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.542241096496582  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5423250198364258  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.550633430480957  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.551182746887207  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.551182746887207  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5512609481811523  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5595502853393555  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5599265098571777  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5599265098571777  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5599780082702637  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5657973289489746  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5665068626403809  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5665068626403809  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5665926933288574  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.576892375946045  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5773515701293945  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5773515701293945  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.577406883239746  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5844316482543945  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5850067138671875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5850067138671875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5850696563720703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5935039520263672  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5939340591430664  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5939340591430664  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.593979835510254  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6004343032836914  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.600895881652832  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.600895881652832  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6009416580200195  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6077165603637695  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.608011245727539  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.608011245727539  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6080398559570312  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6124744415283203  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6129026412963867  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6129026412963867  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.612940788269043  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6191205978393555  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6194705963134766  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6194705963134766  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6195011138916016  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6246585845947266  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([296, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6317558288574219  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6317558288574219  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6323204040527344  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.740595817565918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 296, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7206544876098633  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7210783958435059  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7215023040771484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7210569381713867  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([2842, 40])
input nodes number: 21351
output nodes number: 2842
edges number: 23380
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7212376594543457  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.721238136291504  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04396772384643555  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

pseudo mini batch 15 input nodes size: 69975
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.039882659912109375  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.039882659912109375  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07324934005737305  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07327079772949219  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.03936576843261719  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04076671600341797  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04076671600341797  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04076671600341797  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([69975, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04076671600341797  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([883, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12183141708374023  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12183141708374023  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 883, 128]), torch.Size([1, 883, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12267351150512695  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1294560432434082  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 883, 128])
m.shape torch.Size([1103, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13008689880371094  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13008689880371094  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13113880157470703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14691734313964844  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([1167, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14806079864501953  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14806079864501953  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1167, 128]), torch.Size([1, 1167, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14917373657226562  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1739354133605957  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1167, 128])
m.shape torch.Size([1165, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17560100555419922  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17560100555419922  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1165, 128]), torch.Size([1, 1165, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1767120361328125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.20893192291259766  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1165, 128])
m.shape torch.Size([1065, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.21091556549072266  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.21091556549072266  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1065, 128]), torch.Size([1, 1065, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2119312286376953  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.24849510192871094  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1065, 128])
m.shape torch.Size([979, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.25078821182250977  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.25078821182250977  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 979, 128]), torch.Size([1, 979, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2517218589782715  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.292726993560791  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 979, 128])
m.shape torch.Size([926, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2953510284423828  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2953510284423828  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 926, 128]), torch.Size([1, 926, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.296234130859375  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3406853675842285  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 926, 128])
m.shape torch.Size([845, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.34346723556518555  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.34346723556518555  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 845, 128]), torch.Size([1, 845, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.34427309036254883  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.390653133392334  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 845, 128])
m.shape torch.Size([789, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39363622665405273  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39363622665405273  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 789, 128]), torch.Size([1, 789, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39438867568969727  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.44310760498046875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 789, 128])
m.shape torch.Size([12208, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5013251304626465  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5013251304626465  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 12208, 128]), torch.Size([1, 12208, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.512967586517334  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3441596031188965  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 12208, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.2693943977355957  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.2895455360412598  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3096966743469238  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.2893877029418945  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([21130, 256])
first layer input nodes number: 69975
first layer output nodes number: 21130
edges number: 164872
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3102202415466309  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.330371379852295  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3354473114013672  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3354473114013672  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([418, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3580751419067383  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3580751419067383  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.358872413635254  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3666696548461914  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([358, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.366959571838379  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.366959571838379  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3676424026489258  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3809423446655273  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([303, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3814749717712402  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3814749717712402  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3820528984069824  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3958640098571777  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([236, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3964824676513672  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3964824676513672  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.396932601928711  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4099864959716797  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([179, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4106216430664062  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4106216430664062  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4109630584716797  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4232540130615234  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4239773750305176  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4239773750305176  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4242730140686035  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4369854927062988  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4376988410949707  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4376988410949707  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4379429817199707  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4501500129699707  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([93, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4507431983947754  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4507431983947754  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.450920581817627  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.461031436920166  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.461747646331787  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.461747646331787  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4619250297546387  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4732775688171387  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([103, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4742116928100586  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4742116928100586  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4744081497192383  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.488356590270996  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([78, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4890832901000977  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4890832901000977  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.489232063293457  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5008363723754883  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5014657974243164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5014657974243164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.501582145690918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5114717483520508  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5120882987976074  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5120882987976074  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5121912956237793  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5216670036315918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5221138000488281  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5221138000488281  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5221843719482422  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5291709899902344  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5297703742980957  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5297703742980957  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5298542976379395  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.538750171661377  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5392775535583496  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5392775535583496  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5393481254577637  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5473227500915527  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5479249954223633  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5479249954223633  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.547999382019043  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5569257736206055  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.557459831237793  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.557459831237793  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5575227737426758  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.565516471862793  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.566124439239502  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.566124439239502  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5661911964416504  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.575136661529541  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5753536224365234  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5753536224365234  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.57537841796875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5788745880126953  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5792255401611328  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5792255401611328  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5792598724365234  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.584341049194336  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.584831714630127  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.584831714630127  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5848774909973145  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.591972827911377  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.59230375289917  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.59230375289917  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.592334270477295  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.597278118133545  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5976781845092773  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5976781845092773  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.597712516784668  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6035146713256836  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([269, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6099615097045898  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6099615097045898  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6104745864868164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7031488418579102  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 269, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6836023330688477  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6840262413024902  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6844501495361328  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.684004783630371  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([2842, 40])
input nodes number: 21130
output nodes number: 2842
edges number: 22994
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6841840744018555  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6841845512390137  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04336738586425781  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

pseudo mini batch 16 input nodes size: 70788
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.03936576843261719  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.03936576843261719  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.0731201171875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07314157485961914  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.03975343704223633  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04117918014526367  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04117918014526367  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04117918014526367  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([70788, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04117918014526367  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([795, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12370824813842773  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12370824813842773  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1244664192199707  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1309504508972168  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([1051, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13157367706298828  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13157367706298828  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13257598876953125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14761066436767578  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([1071, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14864158630371094  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14864158630371094  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1071, 128]), torch.Size([1, 1071, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14966297149658203  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1721334457397461  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1071, 128])
m.shape torch.Size([1128, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17377424240112305  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17377424240112305  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1128, 128]), torch.Size([1, 1128, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1748499870300293  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.20621442794799805  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1128, 128])
m.shape torch.Size([1109, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.20832061767578125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.20832061767578125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1109, 128]), torch.Size([1, 1109, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.20937824249267578  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.24794673919677734  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1109, 128])
m.shape torch.Size([985, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.25023603439331055  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.25023603439331055  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 985, 128]), torch.Size([1, 985, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2511754035949707  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.29340028762817383  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 985, 128])
m.shape torch.Size([902, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2959413528442383  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2959413528442383  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 902, 128]), torch.Size([1, 902, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2968015670776367  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3412971496582031  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 902, 128])
m.shape torch.Size([879, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3442201614379883  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3442201614379883  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 879, 128]), torch.Size([1, 879, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3450584411621094  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3928403854370117  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 879, 128])
m.shape torch.Size([859, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39610767364501953  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.39610767364501953  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 859, 128]), torch.Size([1, 859, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3969268798828125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.4502263069152832  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 859, 128])
m.shape torch.Size([12482, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5093355178833008  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5093355178833008  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 12482, 128]), torch.Size([1, 12482, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5212392807006836  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3664064407348633  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 12482, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.2900919914245605  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3103680610656738  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.330644130706787  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3102092742919922  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([21261, 256])
first layer input nodes number: 70788
first layer output nodes number: 21261
edges number: 167974
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3311738967895508  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.351449966430664  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3565192222595215  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3565192222595215  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([405, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3793902397155762  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3793902397155762  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3801627159118652  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3864569664001465  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([380, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3868012428283691  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3868012428283691  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.387526035308838  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.399050235748291  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([281, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.399498462677002  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.399498462677002  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4000344276428223  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.415168285369873  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([218, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.415738582611084  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.415738582611084  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.416154384613037  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4282126426696777  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4289851188659668  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4289851188659668  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4293742179870605  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4433817863464355  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([172, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4441967010498047  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4441967010498047  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4445247650146484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4586315155029297  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([115, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4592413902282715  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4592413902282715  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.459460735321045  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4704279899597168  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4712104797363281  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4712104797363281  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4714317321777344  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4840431213378906  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4847545623779297  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4847545623779297  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4849357604980469  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4965324401855469  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4971919059753418  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4971919059753418  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4973406791687012  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5079035758972168  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5085482597351074  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5085482597351074  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5086779594421387  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5187945365905762  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5194334983825684  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5194334983825684  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.51954984664917  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5294394493103027  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5300064086914062  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5300064086914062  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5301017761230469  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5388755798339844  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.539487361907959  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.539487361907959  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5395808219909668  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5488333702087402  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5493202209472656  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5493202209472656  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5493907928466797  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5568714141845703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5574207305908203  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5574207305908203  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5574932098388672  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.565683364868164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5661211013793945  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5661211013793945  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.566176414489746  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5728139877319336  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5732364654541016  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5732364654541016  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5732860565185547  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5795841217041016  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5799431800842285  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5799431800842285  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5799832344055176  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.585350513458252  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5859651565551758  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5859651565551758  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5860280990600586  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5949029922485352  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5953559875488281  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5953559875488281  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5954017639160156  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6021766662597656  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6025347709655762  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6025347709655762  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6025691032409668  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6078906059265137  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6081390380859375  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6081390380859375  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6081619262695312  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6118698120117188  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.612227439880371  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.612227439880371  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.612257957458496  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.617415428161621  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([296, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6245126724243164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6245126724243164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.625077247619629  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7399077415466309  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 296, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7200818061828613  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.720505714416504  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7209296226501465  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7204842567443848  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([2842, 40])
input nodes number: 21261
output nodes number: 2842
edges number: 23259
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7206645011901855  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7206649780273438  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04381561279296875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

pseudo mini batch 17 input nodes size: 71489
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.03975343704223633  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.03975343704223633  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07384204864501953  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.07386350631713867  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04008769989013672  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04153919219970703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04153919219970703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04153919219970703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([71489, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.04153919219970703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([808, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12604141235351562  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12604141235351562  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.12681198120117188  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13297653198242188  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([1042, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13358497619628906  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13358497619628906  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1042, 128]), torch.Size([1, 1042, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.13457870483398438  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.14948463439941406  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1042, 128])
m.shape torch.Size([1102, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.15097713470458984  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.15097713470458984  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1102, 128]), torch.Size([1, 1102, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.15202808380126953  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17576313018798828  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1102, 128])
m.shape torch.Size([1087, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17731094360351562  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17731094360351562  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1087, 128]), torch.Size([1, 1087, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.17834758758544922  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.20928192138671875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1087, 128])
m.shape torch.Size([1108, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.21140527725219727  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.21140527725219727  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1108, 128]), torch.Size([1, 1108, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2124619483947754  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2511563301086426  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1108, 128])
m.shape torch.Size([1016, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.25353479385375977  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.25353479385375977  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1016, 128]), torch.Size([1, 1016, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2545037269592285  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.297091007232666  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1016, 128])
m.shape torch.Size([967, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2998342514038086  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.2998342514038086  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 967, 128]), torch.Size([1, 967, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.30075645446777344  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3468666076660156  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 967, 128])
m.shape torch.Size([956, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3500523567199707  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3500523567199707  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 956, 128]), torch.Size([1, 956, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.3509640693664551  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.40293169021606445  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 956, 128])
m.shape torch.Size([856, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.40614938735961914  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.40614938735961914  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 856, 128]), torch.Size([1, 856, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.4069657325744629  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.46018457412719727  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 856, 128])
m.shape torch.Size([12668, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5201821327209473  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5201821327209473  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 12668, 128]), torch.Size([1, 12668, 128])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.5326924324035645  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3907966613769531  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 12668, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3126206398010254  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3332295417785645  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3538384437561035  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3330683708190918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([21610, 256])
first layer input nodes number: 71489
first layer output nodes number: 21610
edges number: 170983
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3543734550476074  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3749823570251465  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3801345825195312  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.3801345825195312  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([413, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4042730331420898  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4042730331420898  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4050607681274414  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4126038551330566  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([365, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4129118919372559  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4129118919372559  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4136080741882324  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4241538047790527  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 365, 256])
m.shape torch.Size([290, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4246420860290527  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4246420860290527  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4251952171325684  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4384264945983887  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([226, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4390192031860352  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4390192031860352  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4394502639770508  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.451951026916504  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([197, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4526824951171875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4526824951171875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4530582427978516  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4665851593017578  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.467268466949463  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.467268466949463  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4675564765930176  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4799408912658691  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([112, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.480550765991211  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.480550765991211  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.480764389038086  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.491445541381836  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4922537803649902  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.4922537803649902  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.492480754852295  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.505418300628662  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5060229301452637  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5060229301452637  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.506181240081787  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.516313076019287  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5169358253479004  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5169358253479004  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5170750617980957  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.526960849761963  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5275259017944336  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5275259017944336  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5276403427124023  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5365667343139648  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([72, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5373401641845703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5373401641845703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5374774932861328  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5491504669189453  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5496068000793457  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5496068000793457  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5496869087219238  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5570569038391113  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([57, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.557784080505371  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.557784080505371  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5578927993774414  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5686559677124023  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.569178581237793  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.569178581237793  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5692548751831055  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5773420333862305  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5779037475585938  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5779037475585938  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5779781341552734  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5863838195800781  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5868535041809082  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5868535041809082  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5869126319885254  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.594007968902588  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5944113731384277  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5944113731384277  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.594459056854248  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6005148887634277  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6009297370910645  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6009297370910645  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.600975513458252  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.607109546661377  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6077790260314941  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6077790260314941  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6078476905822754  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6175293922424316  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6179394721984863  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6179394721984863  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6179814338684082  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6241917610168457  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.624593734741211  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.624593734741211  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6246318817138672  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.630544662475586  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.631166934967041  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.631166934967041  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6312222480773926  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6401829719543457  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6404094696044922  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6404094696044922  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6404304504394531  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6439762115478516  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([305, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6512947082519531  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.6512947082519531  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.651876449584961  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.76096773147583  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 305, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7398772239685059  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7403011322021484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.740725040435791  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7402796745300293  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([2842, 40])
input nodes number: 21610
output nodes number: 2842
edges number: 23724
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.740462303161621  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.7404627799987793  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04421710968017578  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

pseudo mini batch 18 input nodes size: 69655
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04008769989013672  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04008769989013672  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07330179214477539  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07332324981689453  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03921318054199219  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.040599822998046875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.040599822998046875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.040599822998046875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([69655, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.040599822998046875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([841, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12112569808959961  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12112569808959961  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 841, 128]), torch.Size([1, 841, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12192773818969727  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12834405899047852  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 841, 128])
m.shape torch.Size([1073, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1289663314819336  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1289663314819336  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1073, 128]), torch.Size([1, 1073, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1299896240234375  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1453390121459961  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1073, 128])
m.shape torch.Size([1099, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14639949798583984  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14639949798583984  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1099, 128]), torch.Size([1, 1099, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1474475860595703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17050552368164062  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1099, 128])
m.shape torch.Size([1100, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17207956314086914  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17207956314086914  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1100, 128]), torch.Size([1, 1100, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17312860488891602  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20420122146606445  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1100, 128])
m.shape torch.Size([1043, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2061634063720703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2061634063720703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1043, 128]), torch.Size([1, 1043, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20715808868408203  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24355268478393555  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1043, 128])
m.shape torch.Size([958, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24579620361328125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24579620361328125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 958, 128]), torch.Size([1, 958, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24670982360839844  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2859954833984375  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 958, 128])
m.shape torch.Size([890, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2885093688964844  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2885093688964844  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.28935813903808594  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.33354854583740234  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([873, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3364543914794922  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3364543914794922  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 873, 128]), torch.Size([1, 873, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.33728694915771484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3847637176513672  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 873, 128])
m.shape torch.Size([815, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3878450393676758  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3878450393676758  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 815, 128]), torch.Size([1, 815, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3886222839355469  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.44019317626953125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 815, 128])
m.shape torch.Size([12111, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.4983983039855957  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.4983983039855957  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 12111, 128]), torch.Size([1, 12111, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5099482536315918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3401226997375488  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 12111, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2657480239868164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2855873107910156  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3054265975952148  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2854318618774414  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([20803, 256])
first layer input nodes number: 69655
first layer output nodes number: 20803
edges number: 163306
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3059477806091309  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.32578706741333  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3313274383544922  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3313274383544922  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([428, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3537564277648926  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3537564277648926  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3545727729797363  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3623356819152832  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([356, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.362612247467041  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.362612247467041  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3632912635803223  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3777761459350586  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([293, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.378281593322754  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.378281593322754  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.378840446472168  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3918418884277344  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([235, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3924660682678223  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3924660682678223  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3929142951965332  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4059128761291504  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([201, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4066548347473145  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4066548347473145  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4070382118225098  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.420839786529541  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([142, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4214673042297363  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4214673042297363  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4217381477355957  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4333844184875488  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4341306686401367  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4341306686401367  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4343805313110352  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.446873664855957  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4476714134216309  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4476714134216309  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4479002952575684  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4609465599060059  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4615764617919922  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4615764617919922  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.461740493774414  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.472238540649414  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4729738235473633  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4729738235473633  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4731359481811523  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4846467971801758  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4853167533874512  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4853167533874512  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4854521751403809  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4960150718688965  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4966740608215332  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4966740608215332  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4967942237854004  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5070080757141113  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5076603889465332  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5076603889465332  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5077691078186035  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5177712440490723  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.518336296081543  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.518336296081543  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5184240341186523  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5271100997924805  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5276288986206055  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5276288986206055  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5277032852172852  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.535588264465332  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.536074161529541  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.536074161529541  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5361390113830566  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5434670448303223  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5440068244934082  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5440068244934082  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5440735816955566  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5520844459533691  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5526223182678223  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5526223182678223  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.552685260772705  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5606789588928223  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.561141014099121  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.561141014099121  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.561192512512207  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5680932998657227  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5685482025146484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5685482025146484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5685958862304688  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5753192901611328  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5756993293762207  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5756993293762207  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.575737476348877  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.581383228302002  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.581660270690918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.581660270690918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5816869735717773  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5858259201049805  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5861225128173828  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5861225128173828  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5861492156982422  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.590475082397461  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5909233093261719  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5909233093261719  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5909614562988281  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5974082946777344  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([267, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6038050651550293  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6038050651550293  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6043143272399902  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.696547508239746  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 267, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6772093772888184  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.677633285522461  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6780571937561035  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6776118278503418  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([2842, 40])
input nodes number: 20803
output nodes number: 2842
edges number: 22775
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6777887344360352  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6777892112731934  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04317426681518555  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

pseudo mini batch 19 input nodes size: 70452
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03921318054199219  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03921318054199219  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07280731201171875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07282876968383789  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03959321975708008  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.040997982025146484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.040997982025146484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.040997982025146484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([70452, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.040997982025146484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([821, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12231302261352539  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12231302261352539  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12309598922729492  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1293644905090332  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([1109, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13003063201904297  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13003063201904297  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1109, 128]), torch.Size([1, 1109, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1310882568359375  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14695262908935547  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1109, 128])
m.shape torch.Size([1149, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14806747436523438  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14806747436523438  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1149, 128]), torch.Size([1, 1149, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14916324615478516  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17365121841430664  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1149, 128])
m.shape torch.Size([1153, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17530250549316406  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17530250549316406  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1153, 128]), torch.Size([1, 1153, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17640209197998047  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20829010009765625  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1153, 128])
m.shape torch.Size([1149, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.210479736328125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.210479736328125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1149, 128]), torch.Size([1, 1149, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21157550811767578  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2510232925415039  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1149, 128])
m.shape torch.Size([980, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2532792091369629  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2532792091369629  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 980, 128]), torch.Size([1, 980, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.254213809967041  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2957310676574707  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 980, 128])
m.shape torch.Size([948, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2984280586242676  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2984280586242676  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 948, 128]), torch.Size([1, 948, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2993321418762207  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.34453630447387695  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 948, 128])
m.shape torch.Size([848, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3473191261291504  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3473191261291504  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3481278419494629  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3952946662902832  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([829, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.39844799041748047  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.39844799041748047  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 829, 128]), torch.Size([1, 829, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.39923858642578125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.45095062255859375  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 829, 128])
m.shape torch.Size([12185, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5091490745544434  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5091490745544434  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 12185, 128]), torch.Size([1, 12185, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5207695960998535  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3522396087646484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 12185, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.277228832244873  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2974190711975098  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3176093101501465  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2972612380981445  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([21171, 256])
first layer input nodes number: 70452
first layer output nodes number: 21171
edges number: 165454
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.318136215209961  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3383264541625977  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.343526840209961  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.343526840209961  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([398, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3661437034606934  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3661437034606934  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3669028282165527  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3747224807739258  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([373, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3750600814819336  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3750600814819336  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3757715225219727  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3886489868164062  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([274, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3890833854675293  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3890833854675293  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.38960599899292  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4022111892700195  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([263, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.402961254119873  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.402961254119873  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4034628868103027  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.418375015258789  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([226, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.419210433959961  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.419210433959961  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4196414947509766  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.435159683227539  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([138, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4357399940490723  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4357399940490723  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4360032081604004  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4473214149475098  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4480443000793457  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4480443000793457  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.448286533355713  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4603981971740723  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([91, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4609770774841309  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4609770774841309  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4611506462097168  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4710440635681152  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4718050956726074  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4718050956726074  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.471992015838623  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.483954906463623  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4845824241638184  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4845824241638184  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4847254753112793  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4948821067810059  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4954767227172852  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4954767227172852  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4955968856811523  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.504969596862793  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5056939125061035  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5056939125061035  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5058236122131348  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.516848087310791  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5174956321716309  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5174956321716309  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5176043510437012  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.52760648727417  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5281848907470703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5281848907470703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5282745361328125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.537149429321289  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5377678871154785  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5377678871154785  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.537855625152588  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5471558570861816  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5476198196411133  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5476198196411133  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.547682762145996  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.554795265197754  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5553522109985352  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5553522109985352  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5554208755493164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5636606216430664  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5640935897827148  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5640935897827148  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5641450881958008  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5706853866577148  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.571153163909912  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.571153163909912  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.571204662322998  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5781054496765137  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5784645080566406  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5784645080566406  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5785026550292969  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5838813781738281  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5844883918762207  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5844883918762207  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.584547519683838  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5932984352111816  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5937767028808594  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5937767028808594  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5938224792480469  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6009178161621094  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6012487411499023  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6012487411499023  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6012792587280273  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6062231063842773  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6064157485961914  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6064157485961914  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6064329147338867  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6093339920043945  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([275, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6159334182739258  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6159334182739258  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6164579391479492  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7109146118164062  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 275, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6913542747497559  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6917781829833984  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.692202091217041  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6917567253112793  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([2842, 40])
input nodes number: 21171
output nodes number: 2842
edges number: 23000
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6919360160827637  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6919364929199219  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.043605804443359375  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

pseudo mini batch 20 input nodes size: 71149
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03959321975708008  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03959321975708008  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07351970672607422  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07354116439819336  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.039925575256347656  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.041375160217285156  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.041375160217285156  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.041375160217285156  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([71149, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.041375160217285156  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([802, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12587261199951172  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12587261199951172  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12663745880126953  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13275623321533203  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([1062, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13338661193847656  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13338661193847656  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1343994140625  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14959144592285156  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([1133, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.15086078643798828  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.15086078643798828  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1133, 128]), torch.Size([1, 1133, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.15194129943847656  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1757946014404297  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1133, 128])
m.shape torch.Size([1093, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1773390769958496  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1773390769958496  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1093, 128]), torch.Size([1, 1093, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17838144302368164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20937871932983398  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1093, 128])
m.shape torch.Size([1103, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2114872932434082  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2114872932434082  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2125391960144043  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.25115203857421875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([982, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2534356117248535  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2534356117248535  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 982, 128]), torch.Size([1, 982, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.25437211990356445  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.295443058013916  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 982, 128])
m.shape torch.Size([899, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2979755401611328  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2979755401611328  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 899, 128]), torch.Size([1, 899, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29883289337158203  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3431515693664551  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 899, 128])
m.shape torch.Size([895, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.34613704681396484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.34613704681396484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 895, 128]), torch.Size([1, 895, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.34699058532714844  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3971261978149414  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 895, 128])
m.shape torch.Size([819, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.40021419525146484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.40021419525146484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 819, 128]), torch.Size([1, 819, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.40099525451660156  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.45349740982055664  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 819, 128])
m.shape torch.Size([12782, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5140562057495117  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5140562057495117  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 12782, 128]), torch.Size([1, 12782, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5262460708618164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3920140266418457  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 12782, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3137645721435547  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3343353271484375  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3549060821533203  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3341741561889648  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([21570, 256])
first layer input nodes number: 71149
first layer output nodes number: 21570
edges number: 170748
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.355438232421875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3760089874267578  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3817882537841797  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3817882537841797  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([415, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.405928611755371  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.405928611755371  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4067201614379883  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4130525588989258  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 415, 256])
m.shape torch.Size([356, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4133415222167969  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4133415222167969  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4140205383300781  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4245491027832031  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([292, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4250516891479492  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4250516891479492  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4256086349487305  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4390201568603516  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([217, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4395761489868164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4395761489868164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4399900436401367  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4519929885864258  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([201, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4527521133422852  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4527521133422852  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4531354904174805  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4669370651245117  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([157, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4676508903503418  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4676508903503418  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4679503440856934  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4808268547058105  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([107, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4813971519470215  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4813971519470215  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4816012382507324  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4918055534362793  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4926185607910156  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4926185607910156  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4928455352783203  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5057830810546875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.506500244140625  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.506500244140625  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.506683349609375  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.518402099609375  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5190796852111816  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5190796852111816  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5192322731018066  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5300660133361816  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.530634880065918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.530634880065918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5307512283325195  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5398263931274414  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5404605865478516  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5404605865478516  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5405750274658203  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.550302505493164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([75, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.551182746887207  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.551182746887207  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.551325798034668  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5644865036010742  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5650343894958496  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5650343894958496  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.565122127532959  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.573808193206787  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5741972923278809  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5741972923278809  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5742545127868652  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.580319881439209  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5807833671569824  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5807833671569824  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5808444023132324  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5877413749694824  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5882830619812012  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5882830619812012  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5883498191833496  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.596360683441162  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5967426300048828  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5967426300048828  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5967884063720703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6026020050048828  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6031088829040527  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6031088829040527  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6031641960144043  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6105761528015137  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6111831665039062  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6111831665039062  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.611246109008789  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6201210021972656  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6203317642211914  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6203317642211914  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6203546524047852  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6237421035766602  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6239848136901855  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6239848136901855  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6240077018737793  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6275553703308105  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6278977394104004  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6278977394104004  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6279282569885254  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6328721046447754  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6332721710205078  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6332721710205078  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6333065032958984  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.639108657836914  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([319, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.646756649017334  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.646756649017334  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6473650932312012  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7559905052185059  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 319, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.734886646270752  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7353105545043945  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.735734462738037  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7352890968322754  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([2842, 40])
input nodes number: 21570
output nodes number: 2842
edges number: 23684
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7354717254638672  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7354722023010254  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.044048309326171875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

pseudo mini batch 21 input nodes size: 70824
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.039925575256347656  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.039925575256347656  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07369709014892578  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07371854782104492  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03977060317993164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04120779037475586  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04120779037475586  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04120779037475586  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([70824, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04120779037475586  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([877, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12442207336425781  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12442207336425781  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 877, 128]), torch.Size([1, 877, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1252584457397461  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13194942474365234  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 877, 128])
m.shape torch.Size([1150, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13283824920654297  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13283824920654297  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1150, 128]), torch.Size([1, 1150, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13393497467041016  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.15038585662841797  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1150, 128])
m.shape torch.Size([1117, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.15143537521362305  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.15143537521362305  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.15250062942504883  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17682552337646484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([1080, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17835283279418945  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17835283279418945  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1793828010559082  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2101731300354004  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([1036, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2121281623840332  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2121281623840332  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1036, 128]), torch.Size([1, 1036, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21311616897583008  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24951791763305664  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1036, 128])
m.shape torch.Size([1025, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2519564628601074  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2519564628601074  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1025, 128]), torch.Size([1, 1025, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.25293397903442383  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29586267471313477  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1025, 128])
m.shape torch.Size([982, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29865169525146484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29865169525146484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 982, 128]), torch.Size([1, 982, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2995882034301758  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3482189178466797  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 982, 128])
m.shape torch.Size([857, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.35101985931396484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.35101985931396484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 857, 128]), torch.Size([1, 857, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.351837158203125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.39865589141845703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 857, 128])
m.shape torch.Size([817, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.40175342559814453  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.40175342559814453  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 817, 128]), torch.Size([1, 817, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.40253257751464844  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.45406150817871094  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 817, 128])
m.shape torch.Size([12603, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5137677192687988  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5137677192687988  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 12603, 128]), torch.Size([1, 12603, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5257868766784668  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3799309730529785  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 12603, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3030619621276855  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3236079216003418  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.344153881072998  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3234472274780273  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([21544, 256])
first layer input nodes number: 70824
first layer output nodes number: 21544
edges number: 169291
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3446836471557617  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.365229606628418  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.370366096496582  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.370366096496582  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([421, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3934264183044434  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3934264183044434  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 421, 256]), torch.Size([1, 421, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3942294120788574  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.401451587677002  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 421, 256])
m.shape torch.Size([368, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4017577171325684  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4017577171325684  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4024596214294434  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4135804176330566  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([281, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4140400886535645  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4140400886535645  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4145760536193848  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4283971786499023  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4290213584899902  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4290213584899902  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4294638633728027  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4422965049743652  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4429550170898438  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4429550170898438  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4433040618896484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4558696746826172  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([147, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.45654296875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.45654296875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4568233489990234  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4688796997070312  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([141, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4696884155273438  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4696884155273438  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4699573516845703  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4834041595458984  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([105, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4840774536132812  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4840774536132812  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4842777252197266  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4956932067871094  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.49638032913208  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.49638032913208  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.496553897857666  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.507662296295166  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5083351135253906  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5083351135253906  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5084857940673828  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5191841125488281  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5198912620544434  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5198912620544434  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5200324058532715  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5310416221618652  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5317440032958984  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5317440032958984  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5318717956542969  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.542734146118164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5432953834533691  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5432953834533691  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5433907508850098  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5521645545959473  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5526151657104492  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5526151657104492  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5526857376098633  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5596723556518555  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5601272583007812  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5601272583007812  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5601921081542969  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5670661926269531  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5674800872802734  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5674800872802734  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.567535400390625  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5737857818603516  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5744118690490723  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5744118690490723  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5744881629943848  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5836434364318848  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([41, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5843148231506348  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5843148231506348  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.58439302444458  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5943245887756348  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.594797134399414  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.594797134399414  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5948505401611328  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6020069122314453  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6024227142333984  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6024227142333984  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6024665832519531  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.608652114868164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6090140342712402  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6090140342712402  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6090502738952637  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6144137382507324  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.614734172821045  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.614734172821045  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.61476469039917  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.619494915008545  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6197896003723145  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6197896003723145  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6198163032531738  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6241421699523926  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.624497890472412  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.624497890472412  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.624528408050537  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.629685878753662  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([306, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6370234489440918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6370234489440918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6376070976257324  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7498536109924316  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 306, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7298460006713867  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7302699089050293  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7306938171386719  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7302484512329102  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([2842, 40])
input nodes number: 21544
output nodes number: 2842
edges number: 23438
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7304306030273438  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.730431079864502  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04386329650878906  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

pseudo mini batch 22 input nodes size: 70910
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03977060317993164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03977060317993164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07358312606811523  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07360458374023438  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03981161117553711  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04126405715942383  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04126405715942383  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04126405715942383  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([70910, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04126405715942383  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([756, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12574052810668945  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12574052810668945  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 756, 128]), torch.Size([1, 756, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12646150588989258  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13222932815551758  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 756, 128])
m.shape torch.Size([1034, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13285493850708008  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13285493850708008  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1034, 128]), torch.Size([1, 1034, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13384103775024414  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14863252639770508  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1034, 128])
m.shape torch.Size([1045, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.15052556991577148  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.15052556991577148  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1045, 128]), torch.Size([1, 1045, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.15152215957641602  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1734471321105957  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1045, 128])
m.shape torch.Size([1057, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17496490478515625  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17496490478515625  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1057, 128]), torch.Size([1, 1057, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17597293853759766  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20520591735839844  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1057, 128])
m.shape torch.Size([1096, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20731496810913086  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20731496810913086  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 1096, 128]), torch.Size([1, 1096, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2083601951599121  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24719762802124023  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 1096, 128])
m.shape torch.Size([971, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24945306777954102  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24945306777954102  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 971, 128]), torch.Size([1, 971, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2503790855407715  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29019784927368164  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 971, 128])
m.shape torch.Size([919, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2928023338317871  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2928023338317871  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 919, 128]), torch.Size([1, 919, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29367876052856445  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3382396697998047  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 919, 128])
m.shape torch.Size([917, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.34129953384399414  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.34129953384399414  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 917, 128]), torch.Size([1, 917, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.34217405319213867  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3925938606262207  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 917, 128])
m.shape torch.Size([839, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.39575719833374023  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.39575719833374023  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3965573310852051  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.44890880584716797  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([12831, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5096917152404785  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5096917152404785  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 12831, 128]), torch.Size([1, 12831, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5219283103942871  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4158053398132324  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 12831, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.33748197555542  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.35795259475708  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3784232139587402  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3577923774719238  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

torch.Size([21465, 256])
first layer input nodes number: 70910
first layer output nodes number: 21465
edges number: 171123
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.378953456878662  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3994240760803223  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.405118465423584  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.405118465423584  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

m.shape torch.Size([390, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4292349815368652  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4292349815368652  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.429978847503662  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4360346794128418  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([368, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4363703727722168  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4363703727722168  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4370722770690918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4480509757995605  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([271, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.448481559753418  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.448481559753418  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4489984512329102  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.461951732635498  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([233, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4625892639160156  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4625892639160156  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.463033676147461  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.475921630859375  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.476679801940918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.476679801940918  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4770689010620117  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4910764694213867  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([147, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.491729736328125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.491729736328125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4920101165771484  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5040664672851562  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5047807693481445  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5047807693481445  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5050230026245117  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.517134666442871  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([128, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5179977416992188  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5179977416992188  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5182418823242188  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5321578979492188  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([109, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5329790115356445  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5329790115356445  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.533186912536621  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.546492576599121  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5471577644348145  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5471577644348145  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5473103523254395  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5581440925598145  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5587973594665527  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5587973594665527  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5589289665222168  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5691943168640137  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([41, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5696015357971191  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5696015357971191  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5696797370910645  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.576326847076416  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5769500732421875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5769500732421875  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5770511627197266  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5863513946533203  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5869064331054688  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5869064331054688  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5869922637939453  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.595489501953125  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5961675643920898  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5961675643920898  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5962629318237305  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6063718795776367  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.606785774230957  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.606785774230957  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6068429946899414  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6133089065551758  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6138033866882324  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6138033866882324  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6138644218444824  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6211886405944824  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6215214729309082  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6215214729309082  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6215615272521973  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6266484260559082  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6270670890808105  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6270670890808105  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.627112865447998  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.633246898651123  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.63368558883667  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.63368558883667  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6337313652038574  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.640185832977295  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.64072847366333  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.64072847366333  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6407818794250488  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6486859321594238  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6490612030029297  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6490612030029297  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6490974426269531  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.654714584350586  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.655050277709961  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.655050277709961  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.655080795288086  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.660024642944336  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6605401039123535  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6605401039123535  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6605839729309082  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6679978370666504  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([310, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6754250526428223  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6754250526428223  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6760163307189941  GigaBytes
Max Memory Allocated: 1.7711257934570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7837567329406738  GigaBytes
Max Memory Allocated: 1.7911477088928223  GigaBytes

rst.shape  torch.Size([1, 310, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7626614570617676  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7630853652954102  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7635092735290527  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.763063907623291  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([2842, 40])
input nodes number: 21465
output nodes number: 2842
edges number: 23801
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7632455825805664  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7632460594177246  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.043935298919677734  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

pseudo mini batch 23 input nodes size: 70835
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03981161117553711  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03981161117553711  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07358837127685547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07360982894897461  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.039775848388671875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04119682312011719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04119682312011719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04119682312011719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([70835, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04119682312011719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([794, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12350702285766602  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12350702285766602  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 794, 128]), torch.Size([1, 794, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12426424026489258  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13095951080322266  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 794, 128])
m.shape torch.Size([1054, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13158607482910156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13158607482910156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1054, 128]), torch.Size([1, 1054, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13259124755859375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14766883850097656  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1054, 128])
m.shape torch.Size([1150, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14881134033203125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14881134033203125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1150, 128]), torch.Size([1, 1150, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14990806579589844  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17403602600097656  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1150, 128])
m.shape torch.Size([1160, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17570018768310547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17570018768310547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1160, 128]), torch.Size([1, 1160, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17680644989013672  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20888805389404297  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1160, 128])
m.shape torch.Size([1166, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21111488342285156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21111488342285156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1166, 128]), torch.Size([1, 1166, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21222686767578125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.25225830078125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1166, 128])
m.shape torch.Size([957, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2544403076171875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2544403076171875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 957, 128]), torch.Size([1, 957, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2553529739379883  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2947807312011719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 957, 128])
m.shape torch.Size([930, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29742860794067383  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29742860794067383  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 930, 128]), torch.Size([1, 930, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29831552505493164  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.34290170669555664  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 930, 128])
m.shape torch.Size([916, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.34595251083374023  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.34595251083374023  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 916, 128]), torch.Size([1, 916, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.34682607650756836  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3971114158630371  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 916, 128])
m.shape torch.Size([843, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.4004817008972168  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.4004817008972168  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 843, 128]), torch.Size([1, 843, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.40128564834594727  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.45335912704467773  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 843, 128])
m.shape torch.Size([12353, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5118608474731445  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5118608474731445  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 12353, 128]), torch.Size([1, 12353, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5236415863037109  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3603262901306152  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 12353, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.284318447113037  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3046536445617676  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.324988842010498  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3044943809509277  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([21323, 256])
first layer input nodes number: 70835
first layer output nodes number: 21323
edges number: 167519
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3255186080932617  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3458538055419922  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.350937843322754  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.350937843322754  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([383, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3736639022827148  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3736639022827148  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.374394416809082  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.381342887878418  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([362, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.381673812866211  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.381673812866211  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.382364273071289  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3954105377197266  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([302, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3959364891052246  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3959364891052246  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.396512508392334  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4131250381469727  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([252, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4138059616088867  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4138059616088867  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4142866134643555  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4282255172729492  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([205, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4298224449157715  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4298224449157715  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.430213451385498  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4442896842956543  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.444976806640625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.444976806640625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4452686309814453  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4578170776367188  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4584789276123047  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4584789276123047  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4587078094482422  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4701519012451172  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([103, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4708294868469238  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4708294868469238  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4710259437561035  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4822239875793457  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([108, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.483060359954834  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.483060359954834  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4832663536071777  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4964499473571777  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4970970153808594  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4970970153808594  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4972457885742188  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5078086853027344  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([82, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5086016654968262  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5086016654968262  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5087580680847168  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5209574699401855  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.521583080291748  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.521583080291748  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5216994285583496  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5315890312194824  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5322680473327637  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5322680473327637  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5323805809020996  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5427336692810059  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5433640480041504  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5433640480041504  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5434613227844238  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5530915260314941  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5535907745361328  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5535907745361328  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5536632537841797  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5613460540771484  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.56172513961792  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.56172513961792  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5617766380310059  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5675959587097168  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5678644180297852  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5678644180297852  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5678987503051758  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5720186233520508  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5725550651550293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5725550651550293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5726161003112793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5803675651550293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5808849334716797  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5808849334716797  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.580942153930664  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5886096954345703  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5889272689819336  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5889272689819336  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5889616012573242  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5938024520874023  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5942497253417969  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5942497253417969  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5942935943603516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6007862091064453  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6010394096374512  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6010394096374512  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6010642051696777  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.604907512664795  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6052050590515137  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6052050590515137  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.605231761932373  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6095576286315918  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.609959602355957  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.609959602355957  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6099939346313477  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6157960891723633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([292, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.622795581817627  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.622795581817627  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6233525276184082  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.740025520324707  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 292, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7203259468078613  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.720749855041504  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7211737632751465  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7207283973693848  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([2842, 40])
input nodes number: 21323
output nodes number: 2842
edges number: 23132
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7209091186523438  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.720909595489502  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.043828487396240234  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

pseudo mini batch 24 input nodes size: 71071
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.039775848388671875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.039775848388671875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07366514205932617  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07368659973144531  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03988838195800781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04132270812988281  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04132270812988281  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04132270812988281  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([71071, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04132270812988281  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([849, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.124359130859375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.124359130859375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 849, 128]), torch.Size([1, 849, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1251688003540039  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13164615631103516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 849, 128])
m.shape torch.Size([1090, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13271093368530273  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13271093368530273  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1090, 128]), torch.Size([1, 1090, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13375043869018555  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14934301376342773  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1090, 128])
m.shape torch.Size([1167, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.15102243423461914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.15102243423461914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1167, 128]), torch.Size([1, 1167, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.15213537216186523  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1766200065612793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1167, 128])
m.shape torch.Size([1104, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17816925048828125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17816925048828125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17922210693359375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21021461486816406  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([1130, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21238231658935547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21238231658935547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1130, 128]), torch.Size([1, 1130, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21345996856689453  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.25238895416259766  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1130, 128])
m.shape torch.Size([990, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2546825408935547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2546825408935547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 990, 128]), torch.Size([1, 990, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2556266784667969  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29750728607177734  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 990, 128])
m.shape torch.Size([948, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3001995086669922  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3001995086669922  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 948, 128]), torch.Size([1, 948, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3011035919189453  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.34630775451660156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 948, 128])
m.shape torch.Size([860, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3491363525390625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3491363525390625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3499565124511719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3972911834716797  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 860, 128])
m.shape torch.Size([822, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.4004087448120117  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.4004087448120117  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 822, 128]), torch.Size([1, 822, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.40119266510009766  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.45279788970947266  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 822, 128])
m.shape torch.Size([12550, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5122489929199219  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5122489929199219  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 12550, 128]), torch.Size([1, 12550, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5242176055908203  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3747563362121582  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 12550, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.298058032989502  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3185715675354004  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3390851020812988  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.318410873413086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([21510, 256])
first layer input nodes number: 71071
first layer output nodes number: 21510
edges number: 168950
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3396167755126953  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3601303100585938  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3652586936950684  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3652586936950684  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([419, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3883256912231445  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3883256912231445  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.389124870300293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3955183029174805  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([363, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3958168029785156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3958168029785156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3965091705322266  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4073028564453125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([280, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4077644348144531  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4077644348144531  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4082984924316406  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4227428436279297  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([243, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.423410415649414  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.423410415649414  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4238739013671875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4373149871826172  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([207, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4381499290466309  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4381499290466309  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.438544750213623  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4527583122253418  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([130, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4533109664916992  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4533109664916992  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4535589218139648  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4642210006713867  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4649920463562012  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4649920463562012  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4652457237243652  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4779295921325684  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([96, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4785408973693848  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4785408973693848  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4787240028381348  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4891610145568848  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4898567199707031  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4898567199707031  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.490030288696289  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.501138687133789  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5018019676208496  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5018019676208496  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.501950740814209  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5125136375427246  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5132112503051758  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5132112503051758  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.513350486755371  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5242109298706055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5247759819030762  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5247759819030762  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5248808860778809  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5337977409362793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.534407615661621  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.534407615661621  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5345087051391602  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.543808937072754  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5444450378417969  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5444450378417969  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5445423126220703  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5541725158691406  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5547008514404297  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5547008514404297  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5547771453857422  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5628643035888672  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5635337829589844  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5635337829589844  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5636215209960938  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5735359191894531  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5740151405334473  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5740151405334473  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5740761756896973  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5814003944396973  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5818371772766113  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5818371772766113  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5818886756896973  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5884289741516113  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.588860034942627  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.588860034942627  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5889077186584473  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5952973365783691  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5957927703857422  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5957927703857422  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5958442687988281  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6031055450439453  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.603503704071045  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.603503704071045  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.603543758392334  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6094717979431152  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.609790325164795  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.609790325164795  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.60982084274292  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.614551067352295  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6150884628295898  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6150884628295898  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6151361465454102  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6228609085083008  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6231369972229004  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6231369972229004  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.623161792755127  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.627352237701416  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([298, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.634500503540039  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.634500503540039  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6350688934326172  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7450804710388184  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 298, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.725071907043457  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7254958152770996  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7259197235107422  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7254743576049805  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([2842, 40])
input nodes number: 21510
output nodes number: 2842
edges number: 23447
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.725656509399414  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7256569862365723  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04397726058959961  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

pseudo mini batch 25 input nodes size: 71068
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03988838195800781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03988838195800781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.0737762451171875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07379770278930664  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.0398869514465332  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04132413864135742  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04132413864135742  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04132413864135742  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([71068, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04132413864135742  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([814, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12445402145385742  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12445402145385742  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 814, 128]), torch.Size([1, 814, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1252303123474121  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1314406394958496  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 814, 128])
m.shape torch.Size([1080, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1324143409729004  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1324143409729004  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13344430923461914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1488938331604004  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([1192, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1508927345275879  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1508927345275879  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1192, 128]), torch.Size([1, 1192, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.15202951431274414  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17703866958618164  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1192, 128])
m.shape torch.Size([1127, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1786198616027832  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1786198616027832  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1127, 128]), torch.Size([1, 1127, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17969465255737305  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21092462539672852  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1127, 128])
m.shape torch.Size([1099, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21300745010375977  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21300745010375977  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1099, 128]), torch.Size([1, 1099, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21405553817749023  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.25245237350463867  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1099, 128])
m.shape torch.Size([1025, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.25486087799072266  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.25486087799072266  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1025, 128]), torch.Size([1, 1025, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.25583839416503906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.298281192779541  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1025, 128])
m.shape torch.Size([935, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.30091333389282227  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.30091333389282227  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 935, 128]), torch.Size([1, 935, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3018050193786621  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3465418815612793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 935, 128])
m.shape torch.Size([846, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3493232727050781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3493232727050781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 846, 128]), torch.Size([1, 846, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3501300811767578  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.39713287353515625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 846, 128])
m.shape torch.Size([780, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.40007686614990234  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.40007686614990234  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 780, 128]), torch.Size([1, 780, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.4008207321166992  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.44891834259033203  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 780, 128])
m.shape torch.Size([12614, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5086946487426758  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5086946487426758  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 12614, 128]), torch.Size([1, 12614, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5207242965698242  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3754758834838867  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 12614, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2986397743225098  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.319155216217041  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3396706581115723  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3189945220947266  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([21512, 256])
first layer input nodes number: 71068
first layer output nodes number: 21512
edges number: 169176
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3402023315429688  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3607177734375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3658466339111328  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3658466339111328  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([385, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3899579048156738  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3899579048156738  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3906922340393066  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3966212272644043  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([377, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3969788551330566  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3969788551330566  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.397697925567627  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4089374542236328  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([320, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4095005989074707  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4095005989074707  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4101109504699707  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4245343208312988  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4250826835632324  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4250826835632324  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4255061149597168  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4377856254577637  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([185, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4384632110595703  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4384632110595703  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4388160705566406  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4515190124511719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4522194862365723  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4522194862365723  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4525094032287598  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4649758338928223  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.465712547302246  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.465712547302246  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4659624099731445  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4784555435180664  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([98, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4790844917297363  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4790844917297363  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.479271411895752  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4899258613586426  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4905591011047363  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4905591011047363  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4907193183898926  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5009732246398926  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5017390251159668  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5017390251159668  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5019068717956543  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5138239860534668  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5144381523132324  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5144381523132324  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.514564037322998  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5243830680847168  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5249433517456055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5249433517456055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5250463485717773  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5338010787963867  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.534411907196045  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.534411907196045  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.534512996673584  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5438132286071777  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5444355010986328  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5444355010986328  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5445308685302734  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5539722442626953  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.554530143737793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.554530143737793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.554610252380371  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5631017684936523  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.563584804534912  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.563584804534912  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5636496543884277  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5709776878356934  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.571549892425537  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.571549892425537  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5716204643249512  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5800890922546387  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5806941986083984  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5806941986083984  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5807647705078125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5897274017333984  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.59014892578125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.59014892578125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5901966094970703  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5965862274169922  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5969853401184082  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5969853401184082  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.59702730178833  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6029438972473145  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6033673286437988  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6033673286437988  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6034092903137207  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6096196174621582  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6099371910095215  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6099371910095215  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6099677085876465  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6146979331970215  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6150808334350586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6150808334350586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6151151657104492  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6206769943237305  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6209831237792969  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6209831237792969  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6210098266601562  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6255226135253906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([310, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6329584121704102  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6329584121704102  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.633549690246582  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7454051971435547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 310, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7243094444274902  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7247333526611328  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7251572608947754  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7247118949890137  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([2842, 40])
input nodes number: 21512
output nodes number: 2842
edges number: 23622
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7248940467834473  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7248945236206055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.043982505798339844  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

pseudo mini batch 26 input nodes size: 69459
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.0398869514465332  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.0398869514465332  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.0730900764465332  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07311153411865234  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.039202213287353516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04060792922973633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04060792922973633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04060792922973633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([69459, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04060792922973633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([805, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1217503547668457  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1217503547668457  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 805, 128]), torch.Size([1, 805, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12251806259155273  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12888431549072266  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 805, 128])
m.shape torch.Size([1077, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12952756881713867  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12952756881713867  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1077, 128]), torch.Size([1, 1077, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1305546760559082  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14596128463745117  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1077, 128])
m.shape torch.Size([1175, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14712858200073242  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14712858200073242  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1175, 128]), torch.Size([1, 1175, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14824914932250977  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17362308502197266  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1175, 128])
m.shape torch.Size([1107, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17517423629760742  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17517423629760742  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1107, 128]), torch.Size([1, 1107, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17622995376586914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20737409591674805  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1107, 128])
m.shape torch.Size([1054, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20935916900634766  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20935916900634766  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1054, 128]), torch.Size([1, 1054, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21036434173583984  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24708175659179688  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1054, 128])
m.shape torch.Size([958, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24932003021240234  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24932003021240234  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 958, 128]), torch.Size([1, 958, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.25023365020751953  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2895193099975586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 958, 128])
m.shape torch.Size([958, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29226016998291016  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29226016998291016  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 958, 128]), torch.Size([1, 958, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29317378997802734  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3388547897338867  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 958, 128])
m.shape torch.Size([847, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3416290283203125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3416290283203125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 847, 128]), torch.Size([1, 847, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3424367904663086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3896169662475586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 847, 128])
m.shape torch.Size([821, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.39273643493652344  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.39273643493652344  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.39351940155029297  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.4444565773010254  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([12232, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5026588439941406  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5026588439941406  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 12232, 128]), torch.Size([1, 12232, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5143241882324219  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3457679748535156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 12232, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2708301544189453  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2908897399902344  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3109493255615234  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2907328605651855  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([21034, 256])
first layer input nodes number: 69459
first layer output nodes number: 21034
edges number: 165121
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3114690780639648  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.331528663635254  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3368597030639648  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3368597030639648  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([397, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.359778881072998  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.359778881072998  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3605360984802246  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.368150234222412  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([367, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3684773445129395  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3684773445129395  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3691773414611816  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3822484016418457  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([289, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3827319145202637  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3827319145202637  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3832831382751465  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3972630500793457  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([235, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3978910446166992  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3978910446166992  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3983392715454102  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4113378524780273  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([194, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4120464324951172  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4120464324951172  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4124164581298828  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4257373809814453  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4264636039733887  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4264636039733887  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.426764965057373  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4397234916687012  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([148, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4405689239501953  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4405689239501953  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4408512115478516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.454965591430664  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4556474685668945  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4556474685668945  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4558515548706055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.467484474182129  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4681353569030762  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4681353569030762  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4683012962341309  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4789214134216309  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4795308113098145  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4795308113098145  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.479668140411377  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4894185066223145  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4901113510131836  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4901113510131836  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.490248680114746  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.500960350036621  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.501572608947754  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.501572608947754  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5016851425170898  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5112504959106445  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5118441581726074  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5118441581726074  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5119433403015137  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5210680961608887  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5216240882873535  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5216240882873535  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.52170991897583  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5302071571350098  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5306692123413086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5306692123413086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.530735969543457  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5378122329711914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.538332462310791  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.538332462310791  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5384011268615723  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5461602210998535  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5466980934143066  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5466980934143066  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.546764850616455  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5547757148742676  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5552787780761719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5552787780761719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.555337905883789  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5628471374511719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5633654594421387  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5633654594421387  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.563422679901123  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5710902214050293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5717344284057617  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5717344284057617  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5718011856079102  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5812139511108398  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5817255973815918  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5817255973815918  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5817770957946777  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5893988609313965  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5897541046142578  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5897541046142578  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5897884368896484  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5951099395751953  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5955352783203125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5955352783203125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5955734252929688  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6017532348632812  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6020574569702148  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6020574569702148  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6020841598510742  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6065969467163086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([279, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6132874488830566  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6132874488830566  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6138195991516113  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.710421085357666  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 279, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.690556526184082  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6909804344177246  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6914043426513672  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6909589767456055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([2842, 40])
input nodes number: 21034
output nodes number: 2842
edges number: 23315
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6911373138427734  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6911377906799316  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04320955276489258  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

pseudo mini batch 27 input nodes size: 70943
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.039202213287353516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.039202213287353516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07303047180175781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07305192947387695  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03982734680175781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04125690460205078  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04125690460205078  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04125690460205078  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([70943, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04125690460205078  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([817, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12404489517211914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12404489517211914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 817, 128]), torch.Size([1, 817, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12482404708862305  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13119268417358398  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 817, 128])
m.shape torch.Size([1134, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13188457489013672  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13188457489013672  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1134, 128]), torch.Size([1, 1134, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1329660415649414  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14918804168701172  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1134, 128])
m.shape torch.Size([1117, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1510028839111328  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1510028839111328  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1520681381225586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17586040496826172  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([1104, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17743349075317383  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17743349075317383  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17848634719848633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20959901809692383  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([1041, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21155452728271484  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21155452728271484  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1041, 128]), torch.Size([1, 1041, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21254730224609375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24897146224975586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1041, 128])
m.shape torch.Size([1000, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.25133609771728516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.25133609771728516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1000, 128]), torch.Size([1, 1000, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2522897720336914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29375553131103516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1000, 128])
m.shape torch.Size([933, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29639291763305664  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29639291763305664  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 933, 128]), torch.Size([1, 933, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29728269577026367  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3419170379638672  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 933, 128])
m.shape torch.Size([884, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.34484434127807617  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.34484434127807617  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 884, 128]), torch.Size([1, 884, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3456873893737793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.39440107345581055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 884, 128])
m.shape torch.Size([850, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3976273536682129  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3976273536682129  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 850, 128]), torch.Size([1, 850, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3984379768371582  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.45134878158569336  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 850, 128])
m.shape torch.Size([12517, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5106291770935059  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5106291770935059  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 12517, 128]), torch.Size([1, 12517, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5225663185119629  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3709945678710938  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 12517, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2944860458374023  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3148918151855469  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3352975845336914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3147320747375488  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([21397, 256])
first layer input nodes number: 70943
first layer output nodes number: 21397
edges number: 168480
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3358283042907715  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.356234073638916  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3613357543945312  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3613357543945312  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([429, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3841819763183594  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3841819763183594  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.385000228881836  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3915462493896484  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([392, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3918910026550293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3918910026550293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3926386833190918  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.403979778289795  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 392, 256])
m.shape torch.Size([274, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4043960571289062  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4043960571289062  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4049186706542969  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4196033477783203  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([212, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4201574325561523  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4201574325561523  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4205617904663086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4322881698608398  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([181, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4329562187194824  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4329562187194824  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4333014488220215  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4457297325134277  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([160, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4464797973632812  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4464797973632812  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4467849731445312  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4599075317382812  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4606366157531738  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4606366157531738  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4608864784240723  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4733796119689941  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([105, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.474062442779541  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.474062442779541  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4742627143859863  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4856781959533691  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4864087104797363  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4864087104797363  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4865918159484863  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4983105659484863  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4989690780639648  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4989690780639648  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4991178512573242  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5096807479858398  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.510209083557129  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.510209083557129  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5103178024291992  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5187978744506836  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.519608974456787  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.519608974456787  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.519752025604248  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5319113731384277  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5325522422790527  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5325522422790527  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.532660961151123  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5426630973815918  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.543200969696045  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.543200969696045  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5432848930358887  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.55159330368042  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5520272254943848  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5520272254943848  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5520901679992676  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5587620735168457  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5592384338378906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5592384338378906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5593013763427734  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5664138793945312  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5668892860412598  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5668892860412598  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.566948413848877  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5740437507629395  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5745854377746582  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5745854377746582  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.574648380279541  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5826420783996582  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.583085536956787  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.583085536956787  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5831351280212402  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.589780330657959  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5903902053833008  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5903902053833008  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5904531478881836  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5993280410766602  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5997610092163086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5997610092163086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5998048782348633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.606297492980957  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.606550693511963  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.606550693511963  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6065754890441895  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6104187965393066  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6107163429260254  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6107163429260254  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6107430458068848  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6150689125061035  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6154017448425293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6154017448425293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6154303550720215  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6202654838562012  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([297, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6273880004882812  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6273880004882812  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6279544830322266  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7397561073303223  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 297, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7199769020080566  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7204008102416992  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7208247184753418  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.72037935256958  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([2842, 40])
input nodes number: 21397
output nodes number: 2842
edges number: 23207
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7205605506896973  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7205610275268555  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04390096664428711  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

pseudo mini batch 28 input nodes size: 70400
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03982734680175781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03982734680175781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07339668273925781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07341814041137695  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.039568424224853516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04099702835083008  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04099702835083008  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04099702835083008  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([70400, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04099702835083008  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([823, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12352514266967773  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12352514266967773  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12431001663208008  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13097143173217773  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([1110, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1316375732421875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1316375732421875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13269615173339844  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1485748291015625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([1155, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14969778060913086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14969778060913086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1155, 128]), torch.Size([1, 1155, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.15079927444458008  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1750321388244629  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1155, 128])
m.shape torch.Size([1119, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17661571502685547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17661571502685547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1119, 128]), torch.Size([1, 1119, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17768287658691406  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20888423919677734  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1119, 128])
m.shape torch.Size([1094, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21095895767211914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21095895767211914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21200227737426758  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.25031328201293945  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([968, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.252561092376709  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.252561092376709  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.25348424911499023  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2934727668762207  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([973, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29625892639160156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29625892639160156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 973, 128]), torch.Size([1, 973, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29718685150146484  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3445558547973633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 973, 128])
m.shape torch.Size([827, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3472466468811035  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3472466468811035  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3480353355407715  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.394381046295166  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([811, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.39746713638305664  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.39746713638305664  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 811, 128]), torch.Size([1, 811, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3982405662536621  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.4500160217285156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 811, 128])
m.shape torch.Size([12495, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5092101097106934  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5092101097106934  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 12495, 128]), torch.Size([1, 12495, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5211262702941895  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.367283821105957  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 12495, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2910327911376953  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.311417579650879  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3318023681640625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.311258316040039  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([21375, 256])
first layer input nodes number: 70400
first layer output nodes number: 21375
edges number: 167938
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3323287963867188  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3527135848999023  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3578100204467773  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3578100204467773  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([403, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.38193941116333  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.38193941116333  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3827080726623535  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3889203071594238  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([358, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3892245292663574  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3892245292663574  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3899073600769043  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4012031555175781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([312, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.401761531829834  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.401761531829834  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4023566246032715  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4183955192565918  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([213, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.418917179107666  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.418917179107666  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.419323444366455  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.431105136871338  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([213, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4319400787353516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4319400787353516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4323463439941406  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4469718933105469  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([135, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.447547435760498  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.447547435760498  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4478049278259277  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4588770866394043  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4596433639526367  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4596433639526367  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4598970413208008  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.472580909729004  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4732155799865723  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4732155799865723  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4734044075012207  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4841675758361816  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4848175048828125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4848175048828125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4849815368652344  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4954795837402344  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4962148666381836  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4962148666381836  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4963769912719727  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.507887840270996  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5085258483886719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5085258483886719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5086555480957031  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5187721252441406  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5193419456481934  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5193419456481934  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.519446849822998  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5283637046813965  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5289735794067383  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5289735794067383  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5290746688842773  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.538374900817871  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([60, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5391321182250977  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5391321182250977  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5392465591430664  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5505762100219727  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5511679649353027  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5511679649353027  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5512537956237793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.560351848602295  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5608320236206055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5608320236206055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.560896873474121  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5682249069213867  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5687317848205566  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5687317848205566  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5687947273254395  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.576347827911377  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([41, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5770258903503418  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5770258903503418  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.577104091644287  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5870356559753418  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5873804092407227  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5873804092407227  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5874204635620117  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.592787742614746  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5932483673095703  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5932483673095703  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5932960510253906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6000194549560547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6005005836486816  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6005005836486816  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.600548267364502  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6076054573059082  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6078143119812012  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6078143119812012  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.607835292816162  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6110873222351074  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6113643646240234  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6113643646240234  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.61138916015625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6154060363769531  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6157169342041016  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6157169342041016  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.615743637084961  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6202564239501953  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([307, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.627619743347168  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.627619743347168  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6282052993774414  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7443103790283203  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 307, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7232165336608887  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7236404418945312  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7240643501281738  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.723618984222412  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([2842, 40])
input nodes number: 21375
output nodes number: 2842
edges number: 23560
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.723799705505371  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7238001823425293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04363679885864258  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

pseudo mini batch 29 input nodes size: 71134
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.039568424224853516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.039568424224853516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07348775863647461  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07350921630859375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03991842269897461  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04135274887084961  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04135274887084961  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04135274887084961  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([71134, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04135274887084961  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([860, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12443304061889648  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12443304061889648  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12525320053100586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13181447982788086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 860, 128])
m.shape torch.Size([1061, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13283157348632812  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13283157348632812  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1061, 128]), torch.Size([1, 1061, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13384342193603516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14902114868164062  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1061, 128])
m.shape torch.Size([1089, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.15098333358764648  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.15098333358764648  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1520218849182129  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17570734024047852  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([1083, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17725372314453125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17725372314453125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1083, 128]), torch.Size([1, 1083, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17828655242919922  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20917892456054688  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1083, 128])
m.shape torch.Size([1097, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21127796173095703  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21127796173095703  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1097, 128]), torch.Size([1, 1097, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2123241424560547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.25097036361694336  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1097, 128])
m.shape torch.Size([1031, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.25339698791503906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.25339698791503906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1031, 128]), torch.Size([1, 1031, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2543802261352539  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2972574234008789  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1031, 128])
m.shape torch.Size([883, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.299713134765625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.299713134765625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 883, 128]), torch.Size([1, 883, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3005552291870117  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.34338808059692383  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 883, 128])
m.shape torch.Size([923, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.34648799896240234  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.34648799896240234  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 923, 128]), torch.Size([1, 923, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3473682403564453  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3981027603149414  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 923, 128])
m.shape torch.Size([768, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.4009585380554199  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.4009585380554199  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 768, 128]), torch.Size([1, 768, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.4016909599304199  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.4490542411804199  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 768, 128])
m.shape torch.Size([12631, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5089173316955566  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5089173316955566  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 12631, 128]), torch.Size([1, 12631, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.520963191986084  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3768019676208496  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 12631, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2999849319458008  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.320418357849121  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3408517837524414  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.320258617401123  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([21426, 256])
first layer input nodes number: 71134
first layer output nodes number: 21426
edges number: 169039
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.341383934020996  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3618173599243164  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3669257164001465  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3669257164001465  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([444, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.389967441558838  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.389967441558838  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3908143043518066  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.398425579071045  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([367, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3987078666687012  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3987078666687012  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3994078636169434  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4102826118469238  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([289, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4107661247253418  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4107661247253418  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4113173484802246  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.425036907196045  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([223, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4256186485290527  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4256186485290527  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.42604398727417  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4383788108825684  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([194, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.439098834991455  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.439098834991455  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4394688606262207  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4527897834777832  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.453481674194336  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.453481674194336  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4537715911865234  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.466238021850586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([107, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.466813087463379  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.466813087463379  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4670171737670898  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4772214889526367  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.477980613708496  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.477980613708496  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.478194236755371  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.490370750427246  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4910860061645508  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4910860061645508  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.491267204284668  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.502863883972168  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5034847259521484  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5034847259521484  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5036258697509766  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5136470794677734  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5142321586608887  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5142321586608887  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.514350414276123  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5235743522644043  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5243110656738281  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5243110656738281  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5244426727294922  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5356292724609375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5360636711120605  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5360636711120605  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.536139965057373  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.543159008026123  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.543619155883789  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.543619155883789  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5436897277832031  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5506763458251953  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5511460304260254  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5511460304260254  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5512127876281738  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5582890510559082  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5587787628173828  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5587787628173828  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5588436126708984  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.566171646118164  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.566678524017334  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.566678524017334  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5667414665222168  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5742945671081543  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.574730396270752  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.574730396270752  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.574781894683838  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.581322193145752  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5817713737487793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5817713737487793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5818209648132324  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5884661674499512  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5888643264770508  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5888643264770508  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5889062881469727  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.594822883605957  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5954885482788086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5954885482788086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5955533981323242  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6051511764526367  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6055841445922852  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6055841445922852  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.605626106262207  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6121301651000977  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6125073432922363  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6125073432922363  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.612541675567627  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6181035041809082  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6185708045959473  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6185708045959473  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6186108589172363  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.625380039215088  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([305, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6326889991760254  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6326889991760254  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6332707405090332  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.744217872619629  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 305, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7242507934570312  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7246747016906738  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7250986099243164  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7246532440185547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([2842, 40])
input nodes number: 21426
output nodes number: 2842
edges number: 23398
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7248344421386719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.72483491897583  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.044003963470458984  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

pseudo mini batch 30 input nodes size: 70035
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03991842269897461  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03991842269897461  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07331371307373047  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07333517074584961  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.039394378662109375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.040787696838378906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.040787696838378906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.040787696838378906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([70035, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.040787696838378906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([793, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12146425247192383  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12146425247192383  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12222051620483398  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12898683547973633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([1081, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1296396255493164  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1296396255493164  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1081, 128]), torch.Size([1, 1081, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13067054748535156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1461343765258789  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1081, 128])
m.shape torch.Size([1122, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14722394943237305  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14722394943237305  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1122, 128]), torch.Size([1, 1122, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14829397201538086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17270612716674805  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1122, 128])
m.shape torch.Size([1140, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17458200454711914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17458200454711914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1140, 128]), torch.Size([1, 1140, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17566919326782227  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2071976661682129  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1140, 128])
m.shape torch.Size([1051, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20915985107421875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20915985107421875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.21016216278076172  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24668645858764648  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([974, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24897193908691406  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24897193908691406  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 974, 128]), torch.Size([1, 974, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24990081787109375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29079627990722656  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 974, 128])
m.shape torch.Size([873, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.293245792388916  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.293245792388916  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 873, 128]), torch.Size([1, 873, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29407835006713867  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.33577680587768555  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 873, 128])
m.shape torch.Size([886, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.33874034881591797  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.33874034881591797  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 886, 128]), torch.Size([1, 886, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3395853042602539  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.38965702056884766  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 886, 128])
m.shape torch.Size([823, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.39276647567749023  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.39276647567749023  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3935513496398926  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.44447755813598633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([12160, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5026788711547852  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5026788711547852  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 12160, 128]), torch.Size([1, 12160, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5142755508422852  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3449640274047852  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 12160, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2704482078552246  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2903828620910645  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3103175163269043  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.290226936340332  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([20903, 256])
first layer input nodes number: 70035
first layer output nodes number: 20903
edges number: 164186
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3108415603637695  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3307762145996094  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3360400199890137  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3360400199890137  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([418, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.358447551727295  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.358447551727295  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3592448234558105  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.366837978363037  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([375, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3671603202819824  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3671603202819824  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.367875576019287  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3814945220947266  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([305, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.382016658782959  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.382016658782959  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3825984001159668  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.396540641784668  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([249, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.397207260131836  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.397207260131836  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3976821899414062  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4114551544189453  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([187, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.412116527557373  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.412116527557373  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.412473201751709  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4253134727478027  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4260063171386719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4260063171386719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4262943267822266  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4386787414550781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([115, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4393086433410645  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4393086433410645  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.439527988433838  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4504952430725098  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([121, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4513163566589355  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4513163566589355  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4515471458435059  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4647021293640137  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4654088020324707  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4654088020324707  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.465590000152588  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.477186679840088  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4779419898986816  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4779419898986816  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4781098365783691  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4900269508361816  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4905142784118652  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4905142784118652  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.490617275238037  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4986510276794434  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4992570877075195  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4992570877075195  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4993658065795898  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5086069107055664  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5091524124145508  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5091524124145508  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5092439651489258  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5176668167114258  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5182404518127441  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5182404518127441  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5183281898498535  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5270142555236816  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5275473594665527  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5275473594665527  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5276236534118652  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5357108116149902  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5362262725830078  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5362262725830078  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.536294937133789  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5440540313720703  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5444445610046387  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5444445610046387  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5444941520690918  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5504450798034668  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5509223937988281  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5509223937988281  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5509777069091797  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5580024719238281  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5585594177246094  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5585594177246094  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5586204528808594  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5667991638183594  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5670380592346191  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5670380592346191  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5670647621154785  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5708298683166504  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5710992813110352  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5710992813110352  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5711259841918945  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.575078010559082  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5753397941589355  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5753397941589355  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.575364589691162  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5792078971862793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.579505443572998  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.579505443572998  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5795321464538574  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5838580131530762  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5841445922851562  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5841445922851562  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5841693878173828  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5883598327636719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([302, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5956039428710938  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5956039428710938  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5961799621582031  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6988372802734375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 302, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6794776916503906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6799015998840332  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6803255081176758  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.679880142211914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([2842, 40])
input nodes number: 20903
output nodes number: 2842
edges number: 22766
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6800575256347656  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6800580024719238  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04337358474731445  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

pseudo mini batch 31 input nodes size: 70479
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.039394378662109375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.039394378662109375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07300138473510742  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07302284240722656  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.03960609436035156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04101848602294922  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04101848602294922  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04101848602294922  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([70479, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04101848602294922  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([813, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12290191650390625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12290191650390625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 813, 128]), torch.Size([1, 813, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12367725372314453  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12987995147705078  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 813, 128])
m.shape torch.Size([1084, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13052606582641602  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13052606582641602  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1084, 128]), torch.Size([1, 1084, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1315598487854004  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14706659317016602  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1084, 128])
m.shape torch.Size([1085, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.148101806640625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.148101806640625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1085, 128]), torch.Size([1, 1085, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14913654327392578  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1728067398071289  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1085, 128])
m.shape torch.Size([1117, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17441987991333008  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17441987991333008  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17548513412475586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20673418045043945  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([1067, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20874547958374023  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20874547958374023  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1067, 128]), torch.Size([1, 1067, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2097630500793457  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2467203140258789  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1067, 128])
m.shape torch.Size([990, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24904394149780273  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24904394149780273  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 990, 128]), torch.Size([1, 990, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24998807907104492  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29123449325561523  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 990, 128])
m.shape torch.Size([910, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29379987716674805  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29379987716674805  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 910, 128]), torch.Size([1, 910, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.29466772079467773  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3390660285949707  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 910, 128])
m.shape torch.Size([869, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.341947078704834  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.341947078704834  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 869, 128]), torch.Size([1, 869, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.342775821685791  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3900141716003418  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 869, 128])
m.shape torch.Size([796, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.39301586151123047  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.39301586151123047  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 796, 128]), torch.Size([1, 796, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.39377498626708984  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.44235897064208984  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 796, 128])
m.shape torch.Size([12417, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5011882781982422  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5011882781982422  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 12417, 128]), torch.Size([1, 12417, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.5130300521850586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.35404634475708  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 12417, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2783503532409668  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2985186576843262  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3186869621276855  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.298360824584961  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([21148, 256])
first layer input nodes number: 70479
first layer output nodes number: 21148
edges number: 166635
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3192143440246582  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3393826484680176  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3444247245788574  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3444247245788574  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([440, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3669462203979492  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3669462203979492  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3677854537963867  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3745851516723633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([401, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.374936580657959  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.374936580657959  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3757014274597168  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.388166904449463  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([299, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3886470794677734  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3886470794677734  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3892173767089844  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4038610458374023  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([200, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4043450355529785  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4043450355529785  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.404726505279541  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4157891273498535  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([191, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4165163040161133  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4165163040161133  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4168806076049805  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4299955368041992  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([160, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4307360649108887  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4307360649108887  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4310412406921387  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4441637992858887  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([123, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4448390007019043  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4448390007019043  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4450736045837402  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.456803798675537  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([93, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4574017524719238  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4574017524719238  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4575791358947754  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4676899909973145  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4683279991149902  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4683279991149902  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4684882164001465  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4787421226501465  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4794120788574219  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4794120788574219  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4795608520507812  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4901237487792969  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4906415939331055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4906415939331055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.490748405456543  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.499079704284668  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.499741554260254  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.499741554260254  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4998598098754883  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5099115371704102  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5105772018432617  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5105772018432617  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5106878280639648  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5208654403686523  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5212812423706055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5212812423706055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.521347999572754  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5279569625854492  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.528529167175293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.528529167175293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.528609275817871  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5371007919311523  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5376453399658203  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5376453399658203  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5377178192138672  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.545907974243164  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5463132858276367  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5463132858276367  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5463647842407227  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5525445938110352  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5531072616577148  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5531072616577148  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5531721115112305  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5614080429077148  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5618324279785156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5618324279785156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.561880111694336  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5682697296142578  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5688228607177734  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5688228607177734  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5688800811767578  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5769481658935547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5773839950561523  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5773839950561523  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.577427864074707  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5839204788208008  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5843005180358887  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5843005180358887  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.584336757659912  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.589953899383545  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5902233123779297  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5902233123779297  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5902481079101562  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5942649841308594  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5947604179382324  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5947604179382324  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5948023796081543  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6018939018249512  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([286, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6087450981140137  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.6087450981140137  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.609290599822998  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7212848663330078  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 286, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.701845645904541  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7022690773010254  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7026925086975098  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7022476196289062  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([2839, 40])
input nodes number: 21148
output nodes number: 2839
edges number: 22861
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7024264335632324  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.7024269104003906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04363298416137695  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04918336868286133  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04918336868286133  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01879715919494629 |0.01237538456916809 |0.1323840618133545 |9.266287088394165e-05 |0.07526156306266785 |0.0058214664459228516 |
----------------------------------------------------------pseudo_mini_loss sum 5.331959247589111
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2939903
Number of first layer input nodes during this epoch:  2258978
Number of first layer output nodes during this epoch:  680925
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.049182891845703125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0243074893951416
number of batches is  32
batch size is  2842
random selection method spend 0.0062944889068603516
time for parepare:  0.022525548934936523
local_output_nid generation:  0.0012187957763671875
local_in_edges_tensor generation:  0.007843971252441406
mini_batch_src_global generation:  0.0012879371643066406
r_  generation:  0.007338523864746094
local_output_nid generation:  0.0014309883117675781
local_in_edges_tensor generation:  0.0009596347808837891
mini_batch_src_global generation:  0.001298666000366211
r_  generation:  0.00709080696105957
local_output_nid generation:  0.0014688968658447266
local_in_edges_tensor generation:  0.0008406639099121094
mini_batch_src_global generation:  0.0008718967437744141
r_  generation:  0.006852388381958008
local_output_nid generation:  0.0014598369598388672
local_in_edges_tensor generation:  0.0008041858673095703
mini_batch_src_global generation:  0.0007846355438232422
r_  generation:  0.006907463073730469
local_output_nid generation:  0.0014235973358154297
local_in_edges_tensor generation:  0.0007791519165039062
mini_batch_src_global generation:  0.0007314682006835938
r_  generation:  0.00680994987487793
local_output_nid generation:  0.0013997554779052734
local_in_edges_tensor generation:  0.0007624626159667969
mini_batch_src_global generation:  0.0008630752563476562
r_  generation:  0.006912708282470703
local_output_nid generation:  0.0013942718505859375
local_in_edges_tensor generation:  0.0007741451263427734
mini_batch_src_global generation:  0.0007472038269042969
r_  generation:  0.0073506832122802734
local_output_nid generation:  0.0014011859893798828
local_in_edges_tensor generation:  0.0007541179656982422
mini_batch_src_global generation:  0.0007114410400390625
r_  generation:  0.006861448287963867
local_output_nid generation:  0.0013756752014160156
local_in_edges_tensor generation:  0.000732421875
mini_batch_src_global generation:  0.0007293224334716797
r_  generation:  0.0071179866790771484
local_output_nid generation:  0.001355886459350586
local_in_edges_tensor generation:  0.0007398128509521484
mini_batch_src_global generation:  0.0007381439208984375
r_  generation:  0.006995439529418945
local_output_nid generation:  0.0013685226440429688
local_in_edges_tensor generation:  0.0007524490356445312
mini_batch_src_global generation:  0.0007236003875732422
r_  generation:  0.007059812545776367
local_output_nid generation:  0.001363992691040039
local_in_edges_tensor generation:  0.0007319450378417969
mini_batch_src_global generation:  0.0007188320159912109
r_  generation:  0.007042884826660156
local_output_nid generation:  0.0013668537139892578
local_in_edges_tensor generation:  0.000732421875
mini_batch_src_global generation:  0.0007529258728027344
r_  generation:  0.0071866512298583984
local_output_nid generation:  0.0013530254364013672
local_in_edges_tensor generation:  0.0007436275482177734
mini_batch_src_global generation:  0.0007765293121337891
r_  generation:  0.0074520111083984375
local_output_nid generation:  0.001354217529296875
local_in_edges_tensor generation:  0.0007257461547851562
mini_batch_src_global generation:  0.0007417201995849609
r_  generation:  0.007345676422119141
local_output_nid generation:  0.0013680458068847656
local_in_edges_tensor generation:  0.0007197856903076172
mini_batch_src_global generation:  0.0007288455963134766
r_  generation:  0.007117748260498047
local_output_nid generation:  0.0013670921325683594
local_in_edges_tensor generation:  0.0007269382476806641
mini_batch_src_global generation:  0.0007421970367431641
r_  generation:  0.007385730743408203
local_output_nid generation:  0.0013535022735595703
local_in_edges_tensor generation:  0.0007236003875732422
mini_batch_src_global generation:  0.0007410049438476562
r_  generation:  0.007041454315185547
local_output_nid generation:  0.0013506412506103516
local_in_edges_tensor generation:  0.0007283687591552734
mini_batch_src_global generation:  0.0008625984191894531
r_  generation:  0.009476900100708008
local_output_nid generation:  0.0013744831085205078
local_in_edges_tensor generation:  0.0008122920989990234
mini_batch_src_global generation:  0.0007596015930175781
r_  generation:  0.007095813751220703
local_output_nid generation:  0.0013842582702636719
local_in_edges_tensor generation:  0.0007274150848388672
mini_batch_src_global generation:  0.0007345676422119141
r_  generation:  0.007510185241699219
local_output_nid generation:  0.0013854503631591797
local_in_edges_tensor generation:  0.0007214546203613281
mini_batch_src_global generation:  0.0007386207580566406
r_  generation:  0.007255077362060547
local_output_nid generation:  0.0013701915740966797
local_in_edges_tensor generation:  0.000713348388671875
mini_batch_src_global generation:  0.0009191036224365234
r_  generation:  0.007688045501708984
local_output_nid generation:  0.0013763904571533203
local_in_edges_tensor generation:  0.0007300376892089844
mini_batch_src_global generation:  0.0007555484771728516
r_  generation:  0.00710296630859375
local_output_nid generation:  0.0013713836669921875
local_in_edges_tensor generation:  0.0007193088531494141
mini_batch_src_global generation:  0.0007359981536865234
r_  generation:  0.0074694156646728516
local_output_nid generation:  0.0013718605041503906
local_in_edges_tensor generation:  0.0007333755493164062
mini_batch_src_global generation:  0.0007364749908447266
r_  generation:  0.007434844970703125
local_output_nid generation:  0.0014057159423828125
local_in_edges_tensor generation:  0.0007333755493164062
mini_batch_src_global generation:  0.0007505416870117188
r_  generation:  0.007268667221069336
local_output_nid generation:  0.0013849735260009766
local_in_edges_tensor generation:  0.0007116794586181641
mini_batch_src_global generation:  0.0007677078247070312
r_  generation:  0.007623434066772461
local_output_nid generation:  0.0014348030090332031
local_in_edges_tensor generation:  0.0007557868957519531
mini_batch_src_global generation:  0.0007758140563964844
r_  generation:  0.007584810256958008
local_output_nid generation:  0.0013785362243652344
local_in_edges_tensor generation:  0.0007350444793701172
mini_batch_src_global generation:  0.0007638931274414062
r_  generation:  0.007740497589111328
local_output_nid generation:  0.0013878345489501953
local_in_edges_tensor generation:  0.0007035732269287109
mini_batch_src_global generation:  0.0007555484771728516
r_  generation:  0.007318973541259766
local_output_nid generation:  0.001383066177368164
local_in_edges_tensor generation:  0.0007061958312988281
mini_batch_src_global generation:  0.0007336139678955078
r_  generation:  0.007216453552246094
----------------------check_connections_block total spend ----------------------------- 0.43118977546691895
generate_one_block  0.01692342758178711
generate_one_block  0.012750625610351562
generate_one_block  0.014569759368896484
generate_one_block  0.015790224075317383
generate_one_block  0.011939525604248047
generate_one_block  0.011872529983520508
generate_one_block  0.012565851211547852
generate_one_block  0.01154780387878418
generate_one_block  0.01215052604675293
generate_one_block  0.011780500411987305
generate_one_block  0.011791706085205078
generate_one_block  0.011852502822875977
generate_one_block  0.011786222457885742
generate_one_block  0.015845060348510742
generate_one_block  0.012233495712280273
generate_one_block  0.01193690299987793
generate_one_block  0.012150049209594727
generate_one_block  0.011680364608764648
generate_one_block  0.013673067092895508
generate_one_block  0.011716842651367188
generate_one_block  0.01190042495727539
generate_one_block  0.011980533599853516
generate_one_block  0.012364864349365234
generate_one_block  0.011728763580322266
generate_one_block  0.012072324752807617
generate_one_block  0.011899948120117188
generate_one_block  0.011800527572631836
generate_one_block  0.012425422668457031
generate_one_block  0.012973785400390625
generate_one_block  0.012144804000854492
generate_one_block  0.01181936264038086
generate_one_block  0.011754989624023438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023812532424926758
gen group dst list time:  0.0210263729095459
time for parepare:  0.019692182540893555
local_output_nid generation:  0.00445246696472168
local_in_edges_tensor generation:  0.012392520904541016
mini_batch_src_global generation:  0.0051860809326171875
r_  generation:  0.05547618865966797
local_output_nid generation:  0.007138252258300781
local_in_edges_tensor generation:  0.0056307315826416016
mini_batch_src_global generation:  0.006640195846557617
r_  generation:  0.06091904640197754
local_output_nid generation:  0.0070760250091552734
local_in_edges_tensor generation:  0.005469083786010742
mini_batch_src_global generation:  0.0054204463958740234
r_  generation:  0.061325788497924805
local_output_nid generation:  0.007250070571899414
local_in_edges_tensor generation:  0.005634784698486328
mini_batch_src_global generation:  0.006288290023803711
r_  generation:  0.06328177452087402
local_output_nid generation:  0.007039785385131836
local_in_edges_tensor generation:  0.00543665885925293
mini_batch_src_global generation:  0.00625920295715332
r_  generation:  0.06120467185974121
local_output_nid generation:  0.0071332454681396484
local_in_edges_tensor generation:  0.005434274673461914
mini_batch_src_global generation:  0.006632566452026367
r_  generation:  0.062280893325805664
local_output_nid generation:  0.0071964263916015625
local_in_edges_tensor generation:  0.005986452102661133
mini_batch_src_global generation:  0.006899833679199219
r_  generation:  0.06470680236816406
local_output_nid generation:  0.006566047668457031
local_in_edges_tensor generation:  0.005400180816650391
mini_batch_src_global generation:  0.0068700313568115234
r_  generation:  0.06036829948425293
local_output_nid generation:  0.0067408084869384766
local_in_edges_tensor generation:  0.005856513977050781
mini_batch_src_global generation:  0.0071985721588134766
r_  generation:  0.06362223625183105
local_output_nid generation:  0.006726741790771484
local_in_edges_tensor generation:  0.006127595901489258
mini_batch_src_global generation:  0.006837368011474609
r_  generation:  0.062316179275512695
local_output_nid generation:  0.006647586822509766
local_in_edges_tensor generation:  0.005274772644042969
mini_batch_src_global generation:  0.0066699981689453125
r_  generation:  0.06281709671020508
local_output_nid generation:  0.006741762161254883
local_in_edges_tensor generation:  0.00563502311706543
mini_batch_src_global generation:  0.008745193481445312
r_  generation:  0.06702113151550293
local_output_nid generation:  0.006909847259521484
local_in_edges_tensor generation:  0.00585174560546875
mini_batch_src_global generation:  0.007304668426513672
r_  generation:  0.06817078590393066
local_output_nid generation:  0.007129669189453125
local_in_edges_tensor generation:  0.005944252014160156
mini_batch_src_global generation:  0.012547016143798828
r_  generation:  0.07146167755126953
local_output_nid generation:  0.007041215896606445
local_in_edges_tensor generation:  0.025960922241210938
mini_batch_src_global generation:  0.006654262542724609
r_  generation:  0.07340288162231445
local_output_nid generation:  0.006995439529418945
local_in_edges_tensor generation:  0.0073833465576171875
mini_batch_src_global generation:  0.007935523986816406
r_  generation:  0.07314133644104004
local_output_nid generation:  0.00759124755859375
local_in_edges_tensor generation:  0.006409883499145508
mini_batch_src_global generation:  0.007749795913696289
r_  generation:  0.07006096839904785
local_output_nid generation:  0.006842374801635742
local_in_edges_tensor generation:  0.005766630172729492
mini_batch_src_global generation:  0.007251739501953125
r_  generation:  0.06535816192626953
local_output_nid generation:  0.006890773773193359
local_in_edges_tensor generation:  0.0057523250579833984
mini_batch_src_global generation:  0.007876157760620117
r_  generation:  0.06584763526916504
local_output_nid generation:  0.006609201431274414
local_in_edges_tensor generation:  0.006768465042114258
mini_batch_src_global generation:  0.007184743881225586
r_  generation:  0.06407284736633301
local_output_nid generation:  0.006842374801635742
local_in_edges_tensor generation:  0.005426168441772461
mini_batch_src_global generation:  0.006973981857299805
r_  generation:  0.06392383575439453
local_output_nid generation:  0.006756305694580078
local_in_edges_tensor generation:  0.005368232727050781
mini_batch_src_global generation:  0.007147789001464844
r_  generation:  0.06533408164978027
local_output_nid generation:  0.007580995559692383
local_in_edges_tensor generation:  0.0064694881439208984
mini_batch_src_global generation:  0.00757598876953125
r_  generation:  0.06610965728759766
local_output_nid generation:  0.006785869598388672
local_in_edges_tensor generation:  0.005307674407958984
mini_batch_src_global generation:  0.007154703140258789
r_  generation:  0.06323575973510742
local_output_nid generation:  0.012252092361450195
local_in_edges_tensor generation:  0.010400533676147461
mini_batch_src_global generation:  0.011194944381713867
r_  generation:  0.06700944900512695
local_output_nid generation:  0.00683283805847168
local_in_edges_tensor generation:  0.006045341491699219
mini_batch_src_global generation:  0.006925821304321289
r_  generation:  0.06522870063781738
local_output_nid generation:  0.007932662963867188
local_in_edges_tensor generation:  0.00572514533996582
mini_batch_src_global generation:  0.0071239471435546875
r_  generation:  0.06299710273742676
local_output_nid generation:  0.006992816925048828
local_in_edges_tensor generation:  0.006340503692626953
mini_batch_src_global generation:  0.007262468338012695
r_  generation:  0.06537342071533203
local_output_nid generation:  0.008725643157958984
local_in_edges_tensor generation:  0.006873607635498047
mini_batch_src_global generation:  0.007585287094116211
r_  generation:  0.0673370361328125
local_output_nid generation:  0.007088661193847656
local_in_edges_tensor generation:  0.006018161773681641
mini_batch_src_global generation:  0.007191181182861328
r_  generation:  0.06542205810546875
local_output_nid generation:  0.0070247650146484375
local_in_edges_tensor generation:  0.005795001983642578
mini_batch_src_global generation:  0.007216930389404297
r_  generation:  0.0640411376953125
local_output_nid generation:  0.006893157958984375
local_in_edges_tensor generation:  0.005405902862548828
mini_batch_src_global generation:  0.0069293975830078125
r_  generation:  0.06319165229797363
----------------------check_connections_block total spend ----------------------------- 3.2677671909332275
generate_one_block  0.08492660522460938
generate_one_block  0.08446478843688965
generate_one_block  0.08288025856018066
generate_one_block  0.08394265174865723
generate_one_block  0.08197236061096191
generate_one_block  0.08210921287536621
generate_one_block  0.08547115325927734
generate_one_block  0.07958412170410156
generate_one_block  0.08389806747436523
generate_one_block  0.08240795135498047
generate_one_block  0.0811619758605957
generate_one_block  0.08187198638916016
generate_one_block  0.08722853660583496
generate_one_block  0.0870058536529541
generate_one_block  0.0847921371459961
generate_one_block  0.08191609382629395
generate_one_block  0.08507299423217773
generate_one_block  0.08110761642456055
generate_one_block  0.09398150444030762
generate_one_block  0.08270764350891113
generate_one_block  0.08325052261352539
generate_one_block  0.08335041999816895
generate_one_block  0.08542561531066895
generate_one_block  0.08350443840026855
generate_one_block  0.08536982536315918
generate_one_block  0.08398747444152832
generate_one_block  0.08095717430114746
generate_one_block  0.08505940437316895
generate_one_block  0.09289002418518066
generate_one_block  0.08573341369628906
generate_one_block  0.08415603637695312
generate_one_block  0.08302164077758789
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.049182891845703125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

connection checking time:  3.2677671909332275
block generation total time  2.695209503173828
average batch blocks generation time:  0.08422529697418213
block dataloader generation time/epoch 7.096298456192017
pseudo mini batch 0 input nodes size: 68664
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04515504837036133  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04515504837036133  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07835817337036133  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.07837963104248047  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04475116729736328  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04611492156982422  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04611492156982422  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04611492156982422  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([68664, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.04611492156982422  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([811, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1250138282775879  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1250138282775879  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 811, 128]), torch.Size([1, 811, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.12578725814819336  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13200855255126953  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 811, 128])
m.shape torch.Size([1061, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13263368606567383  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13263368606567383  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1061, 128]), torch.Size([1, 1061, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.13364553451538086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14882326126098633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1061, 128])
m.shape torch.Size([1125, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14992666244506836  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.14992666244506836  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1125, 128]), torch.Size([1, 1125, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1509995460510254  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17482233047485352  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1125, 128])
m.shape torch.Size([1073, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1763324737548828  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1763324737548828  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1073, 128]), torch.Size([1, 1073, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.17735576629638672  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20703125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1073, 128])
m.shape torch.Size([1031, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20897769927978516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.20897769927978516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1031, 128]), torch.Size([1, 1031, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2099609375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24535751342773438  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1031, 128])
m.shape torch.Size([905, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24745512008666992  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24745512008666992  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.24831819534301758  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.28646326065063477  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 905, 128])
m.shape torch.Size([902, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.28904247283935547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.28904247283935547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 902, 128]), torch.Size([1, 902, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.2899026870727539  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.33406925201416016  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 902, 128])
m.shape torch.Size([832, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.33681297302246094  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.33681297302246094  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 832, 128]), torch.Size([1, 832, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.33760643005371094  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3838973045349121  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 832, 128])
m.shape torch.Size([780, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.38684797286987305  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.38684797286987305  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 780, 128]), torch.Size([1, 780, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.3875918388366699  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.43538999557495117  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 780, 128])
m.shape torch.Size([11935, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.4919285774230957  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.4919285774230957  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 11935, 128]), torch.Size([1, 11935, 128])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.504021167755127  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3323493003845215  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 11935, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2595019340515137  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2790331840515137  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2985405921936035  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2788567543029785  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([20455, 256])
first layer input nodes number: 68664
first layer output nodes number: 20455
edges number: 160525
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.2990541458129883  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3185853958129883  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3242526054382324  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3242526054382324  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([425, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.346208095550537  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.346208095550537  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3470187187194824  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3552393913269043  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([379, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.355562686920166  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.355562686920166  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.356285572052002  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.367128849029541  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([303, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3676414489746094  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3676414489746094  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3682193756103516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3820667266845703  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([223, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3826351165771484  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3826351165771484  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3830604553222656  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.395395278930664  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([194, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3961153030395508  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3961153030395508  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.3964853286743164  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.409806251525879  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([154, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4105095863342285  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4105095863342285  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4108033180236816  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.423433780670166  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4241752624511719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4241752624511719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4244270324707031  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4370155334472656  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4377355575561523  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4377355575561523  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4379453659057617  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.449904441833496  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.450578212738037  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.450578212738037  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4507498741149902  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4617362022399902  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4624099731445312  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4624099731445312  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4625606536865234  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4732589721679688  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([79, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4740190505981445  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4740190505981445  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4741697311401367  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4859228134155273  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.48671293258667  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.48671293258667  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4868559837341309  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4990153312683105  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4996685981750488  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.4996685981750488  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.499779224395752  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5099568367004395  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5105476379394531  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5105476379394531  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5106391906738281  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5197029113769531  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5201621055603027  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5201621055603027  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5202288627624512  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5273051261901855  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5277485847473145  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5277485847473145  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5278077125549316  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5344891548156738  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5349011421203613  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5349011421203613  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5349526405334473  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5411324501037598  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5415740013122559  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5415740013122559  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5416254997253418  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5481657981872559  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5487613677978516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5487613677978516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5488262176513672  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.557516098022461  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5579066276550293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5579066276550293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5579485893249512  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5638651847839355  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.564328670501709  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.564328670501709  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5643744468688965  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5711493492126465  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.571338176727295  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.571338176727295  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.571357250213623  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5743136405944824  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5746140480041504  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5746140480041504  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5746407508850098  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5789666175842285  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5792994499206543  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5792994499206543  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5793280601501465  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5841631889343262  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([254, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.59025239944458  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.59025239944458  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5907368659973145  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6760029792785645  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 254, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6571450233459473  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6575689315795898  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6579928398132324  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6575474739074707  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([2842, 40])
input nodes number: 20455
output nodes number: 2842
edges number: 22285
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.657721996307373  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6577229499816895  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.048648834228515625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

pseudo mini batch 1 input nodes size: 71433
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.07881450653076172  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.07883596420288086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04561138153076172  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04705333709716797  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04705333709716797  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04705333709716797  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([71433, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04705333709716797  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([850, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13051366806030273  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13051366806030273  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 850, 128]), torch.Size([1, 850, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13132429122924805  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13780927658081055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 850, 128])
m.shape torch.Size([1097, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.138458251953125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.138458251953125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1097, 128]), torch.Size([1, 1097, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13950443267822266  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1551971435546875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1097, 128])
m.shape torch.Size([1114, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15678739547729492  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15678739547729492  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1114, 128]), torch.Size([1, 1114, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15784978866577148  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.18163061141967773  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1114, 128])
m.shape torch.Size([1150, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.18329286575317383  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.18329286575317383  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1150, 128]), torch.Size([1, 1150, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.18438959121704102  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.21619462966918945  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1150, 128])
m.shape torch.Size([1102, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.21827363967895508  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.21827363967895508  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1102, 128]), torch.Size([1, 1102, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.21932458877563477  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.25777292251586914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1102, 128])
m.shape torch.Size([948, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.25995969772338867  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.25995969772338867  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 948, 128]), torch.Size([1, 948, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2608637809753418  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2999148368835449  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 948, 128])
m.shape torch.Size([914, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.30251359939575195  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.30251359939575195  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 914, 128]), torch.Size([1, 914, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.30338525772094727  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3479189872741699  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 914, 128])
m.shape torch.Size([926, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.351015567779541  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.351015567779541  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 926, 128]), torch.Size([1, 926, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3518986701965332  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.40253305435180664  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 926, 128])
m.shape torch.Size([789, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.40547752380371094  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.40547752380371094  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 789, 128]), torch.Size([1, 789, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.40622997283935547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.4551253318786621  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 789, 128])
m.shape torch.Size([12673, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5151786804199219  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5151786804199219  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 12673, 128]), torch.Size([1, 12673, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5272645950317383  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3857245445251465  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 12673, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3085761070251465  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3291401863098145  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3497042655944824  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3289794921875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([21563, 256])
first layer input nodes number: 71433
first layer output nodes number: 21563
edges number: 169821
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3502388000488281  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.370802879333496  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3767433166503906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3767433166503906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([420, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4008874893188477  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4008874893188477  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.401688575744629  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4085655212402344  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([351, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4088397026062012  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4088397026062012  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4095091819763184  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4199318885803223  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([288, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4204277992248535  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4204277992248535  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4209771156311035  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4341034889221191  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([219, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4346709251403809  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4346709251403809  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4350886344909668  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.447202205657959  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4482202529907227  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4482202529907227  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4486169815063477  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4628992080688477  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([137, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4634909629821777  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4634909629821777  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.463752269744873  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4749884605407715  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4756922721862793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4756922721862793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.475928783416748  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4877543449401855  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([128, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4886202812194824  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4886202812194824  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4888644218444824  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5027804374694824  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.503359317779541  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.503359317779541  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5035138130187988  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5134015083312988  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([93, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5142183303833008  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5142183303833008  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5143957138061523  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5269899368286133  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([85, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5278000831604004  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5278000831604004  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5279622077941895  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5406079292297363  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.541184425354004  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.541184425354004  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5412931442260742  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5505342483520508  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5511422157287598  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5511422157287598  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5512433052062988  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5605435371398926  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.560950756072998  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.560950756072998  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5610156059265137  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5674357414245605  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5678935050964355  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5678935050964355  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5679583549499512  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5748324394226074  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5752615928649902  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5752615928649902  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5753188133239746  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.581784725189209  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5822138786315918  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5822138786315918  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5822672843933105  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5886759757995605  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5892205238342285  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5892205238342285  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5892834663391113  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5972771644592285  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5978302955627441  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5978302955627441  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5978913307189941  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6060700416564941  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6063857078552246  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6063857078552246  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6064200401306152  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6112608909606934  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6117281913757324  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6117281913757324  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.61177396774292  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.61854887008667  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6191182136535645  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6191182136535645  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6191716194152832  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6274495124816895  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.627842903137207  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.627842903137207  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6278791427612305  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6337499618530273  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6341242790222168  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6341242790222168  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6341567039489746  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.639636516571045  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([301, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.646852970123291  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.646852970123291  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6474270820617676  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7540631294250488  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 301, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7329764366149902  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7334003448486328  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7338242530822754  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7333788871765137  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([2842, 40])
input nodes number: 21563
output nodes number: 2842
edges number: 23577
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7335610389709473  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7335615158081055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04971933364868164  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

pseudo mini batch 2 input nodes size: 70311
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04561138153076172  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04561138153076172  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.07913827896118164  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.07915973663330078  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04507637023925781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04649829864501953  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04649829864501953  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04649829864501953  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([70311, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04649829864501953  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([809, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.12873125076293945  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.12873125076293945  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 809, 128]), torch.Size([1, 809, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1295027732849121  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13636541366577148  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 809, 128])
m.shape torch.Size([1096, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1370248794555664  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1370248794555664  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1096, 128]), torch.Size([1, 1096, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13807010650634766  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1537485122680664  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1096, 128])
m.shape torch.Size([1118, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15482521057128906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15482521057128906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1118, 128]), torch.Size([1, 1118, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15589141845703125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1796875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1118, 128])
m.shape torch.Size([1108, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.18126773834228516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.18126773834228516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1108, 128]), torch.Size([1, 1108, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.18232440948486328  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.21347904205322266  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1108, 128])
m.shape torch.Size([1062, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2154827117919922  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2154827117919922  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.21649551391601562  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2533998489379883  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([1025, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2558259963989258  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2558259963989258  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1025, 128]), torch.Size([1, 1025, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2568035125732422  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2996540069580078  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1025, 128])
m.shape torch.Size([946, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3023228645324707  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3023228645324707  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 946, 128]), torch.Size([1, 946, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.303225040435791  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3484654426574707  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 946, 128])
m.shape torch.Size([861, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.35129880905151367  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.35129880905151367  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 861, 128]), torch.Size([1, 861, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.35211992263793945  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3995795249938965  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 861, 128])
m.shape torch.Size([789, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.402554988861084  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.402554988861084  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 789, 128]), torch.Size([1, 789, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.4033074378967285  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.4514641761779785  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 789, 128])
m.shape torch.Size([12449, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5104494094848633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5104494094848633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 12449, 128]), torch.Size([1, 12449, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5223217010498047  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3652544021606445  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 12449, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2892546653747559  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.309532642364502  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.329810619354248  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3093738555908203  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([21263, 256])
first layer input nodes number: 70311
first layer output nodes number: 21263
edges number: 167348
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.330336570739746  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3506145477294922  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3556842803955078  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3556842803955078  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([410, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3786430358886719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3786430358886719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.379425048828125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3859272003173828  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([383, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3862724304199219  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3862724304199219  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.387002944946289  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3982267379760742  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([285, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3986835479736328  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3986835479736328  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3992271423339844  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4144067764282227  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([231, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4150233268737793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4150233268737793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.415463924407959  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.42824125289917  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4289774894714355  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4289774894714355  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4293570518493652  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.443021297454834  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([160, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4437541961669922  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4437541961669922  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4440593719482422  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4571819305419922  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([118, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4578232765197754  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4578232765197754  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4580483436584473  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.469301700592041  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([90, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.469881534576416  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.469881534576416  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4700531959533691  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4798378944396973  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4805569648742676  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4805569648742676  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4807343482971191  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4920868873596191  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.492757797241211  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.492757797241211  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4929084777832031  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5036067962646484  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5042824745178223  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5042824745178223  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.504417896270752  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5149807929992676  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5156631469726562  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5156631469726562  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.515787124633789  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5263252258300781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5267634391784668  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5267634391784668  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5268397331237793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5338587760925293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.534533977508545  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.534533977508545  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.534635066986084  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5446429252624512  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5451836585998535  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5451836585998535  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5452618598937988  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.553551197052002  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5540504455566406  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5540504455566406  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.554117202758789  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5616607666015625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5621833801269531  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5621833801269531  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5622482299804688  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5700302124023438  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5705862045288086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5705862045288086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5706510543823242  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5788869857788086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5793113708496094  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5793113708496094  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5793590545654297  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5857486724853516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5861477851867676  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5861477851867676  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5861897468566895  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5921063423156738  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5925498008728027  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5925498008728027  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5925936698913574  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5990862846374512  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.599381923675537  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.599381923675537  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5994105339050293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6038451194763184  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6042289733886719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6042289733886719  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6042633056640625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6098251342773438  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6102466583251953  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6102466583251953  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6102828979492188  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6164073944091797  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([299, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6235737800598145  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6235737800598145  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6241440773010254  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7431111335754395  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 299, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7232003211975098  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7236242294311523  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.724048137664795  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7236027717590332  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([2842, 40])
input nodes number: 21263
output nodes number: 2842
edges number: 23344
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.723783016204834  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7237834930419922  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.049128055572509766  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

pseudo mini batch 3 input nodes size: 70332
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04507637023925781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04507637023925781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.07861328125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.07863473892211914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04508638381958008  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04652261734008789  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04652261734008789  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04652261734008789  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([70332, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04652261734008789  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([813, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.12950801849365234  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.12950801849365234  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 813, 128]), torch.Size([1, 813, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13028335571289062  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13648605346679688  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 813, 128])
m.shape torch.Size([1038, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13759326934814453  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13759326934814453  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1038, 128]), torch.Size([1, 1038, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13858318328857422  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15343189239501953  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1038, 128])
m.shape torch.Size([1087, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15449190139770508  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15449190139770508  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1087, 128]), torch.Size([1, 1087, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15552854537963867  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.17920637130737305  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1087, 128])
m.shape torch.Size([1104, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.18079376220703125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.18079376220703125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.18184661865234375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.21295928955078125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([1083, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.21501493453979492  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.21501493453979492  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1083, 128]), torch.Size([1, 1083, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2160477638244629  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.25443363189697266  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1083, 128])
m.shape torch.Size([996, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.25676679611206055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.25676679611206055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 996, 128]), torch.Size([1, 996, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.25771665573120117  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.29909467697143555  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 996, 128])
m.shape torch.Size([930, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3017239570617676  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3017239570617676  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 930, 128]), torch.Size([1, 930, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3026108741760254  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3471865653991699  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 930, 128])
m.shape torch.Size([864, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.350039005279541  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.350039005279541  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 864, 128]), torch.Size([1, 864, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.350862979888916  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.397829532623291  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 864, 128])
m.shape torch.Size([812, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.40090227127075195  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.40090227127075195  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.40167665481567383  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.45312929153442383  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([12621, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5129237174987793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5129237174987793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 12621, 128]), torch.Size([1, 12621, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5249600410461426  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3795390129089355  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 12621, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3027596473693848  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3231186866760254  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.343477725982666  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3229594230651855  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([21348, 256])
first layer input nodes number: 70332
first layer output nodes number: 21348
edges number: 168897
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.344003677368164  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3643627166748047  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3703088760375977  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3703088760375977  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([418, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3944511413574219  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3944511413574219  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3952484130859375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4023504257202148  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([346, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4026169776916504  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4026169776916504  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4032769203186035  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4139494895935059  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([301, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4144878387451172  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4144878387451172  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4150619506835938  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4290542602539062  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([214, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4295902252197266  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4295902252197266  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4299983978271484  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4418354034423828  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([201, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4425973892211914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4425973892211914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4429807662963867  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.456782341003418  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([154, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4574790000915527  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4574790000915527  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4577727317810059  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4704031944274902  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4710907936096191  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4710907936096191  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.471327304840088  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4831528663635254  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4838957786560059  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4838957786560059  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4841094017028809  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4962859153747559  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4969491958618164  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4969491958618164  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4971189498901367  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5079832077026367  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5086674690246582  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5086674690246582  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5088200569152832  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5196537971496582  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5202436447143555  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5202436447143555  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5203638076782227  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5297365188598633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5302762985229492  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5302762985229492  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5303754806518555  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5388059616088867  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5394186973571777  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5394186973571777  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5395197868347168  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5488200187683105  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5494561195373535  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5494561195373535  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.549553394317627  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5591835975646973  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5596542358398438  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5596542358398438  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.559722900390625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5670013427734375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5675053596496582  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5675053596496582  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5675721168518066  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.57511568069458  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5755724906921387  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5755724906921387  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.575629711151123  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.582496166229248  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5831079483032227  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5831079483032227  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5831785202026367  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5921411514282227  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.592580795288086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.592580795288086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.592630386352539  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5992755889892578  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([41, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.600039005279541  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.600039005279541  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6001172065734863  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6111435890197754  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.611649513244629  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.611649513244629  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6117010116577148  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6193227767944336  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6197199821472168  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6197199821472168  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.619758129119873  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6256709098815918  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6261606216430664  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6261606216430664  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.626204490661621  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6333112716674805  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6335663795471191  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6335663795471191  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.633589267730713  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6374573707580566  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([297, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.644582748413086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.644582748413086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6451492309570312  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7523212432861328  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 297, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7312393188476562  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7316632270812988  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7320871353149414  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7316417694091797  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([2842, 40])
input nodes number: 21348
output nodes number: 2842
edges number: 23722
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7318224906921387  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7318229675292969  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.049170494079589844  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

pseudo mini batch 4 input nodes size: 70183
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04508638381958008  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04508638381958008  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.07855224609375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.07857370376586914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04501533508300781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.046410560607910156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.046410560607910156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.046410560607910156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([70183, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.046410560607910156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([830, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1271681785583496  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1271681785583496  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 830, 128]), torch.Size([1, 830, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1279597282409668  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13480567932128906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 830, 128])
m.shape torch.Size([1069, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13542938232421875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13542938232421875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13644886016845703  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15174102783203125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([1105, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15281200408935547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15281200408935547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1105, 128]), torch.Size([1, 1105, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15386581420898438  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1770496368408203  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1105, 128])
m.shape torch.Size([1084, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.17919301986694336  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.17919301986694336  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1084, 128]), torch.Size([1, 1084, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.18022680282592773  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.21112966537475586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1084, 128])
m.shape torch.Size([1035, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.21308040618896484  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.21308040618896484  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1035, 128]), torch.Size([1, 1035, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2140674591064453  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2496013641357422  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1035, 128])
m.shape torch.Size([931, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2517714500427246  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2517714500427246  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 931, 128]), torch.Size([1, 931, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.25265932083129883  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.29152536392211914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 931, 128])
m.shape torch.Size([955, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2942690849304199  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2942690849304199  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 955, 128]), torch.Size([1, 955, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2951798439025879  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.34071779251098633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 955, 128])
m.shape torch.Size([836, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.34345149993896484  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.34345149993896484  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 836, 128]), torch.Size([1, 836, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.34424877166748047  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.39061594009399414  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 836, 128])
m.shape torch.Size([818, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.39372777938842773  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.39372777938842773  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 818, 128]), torch.Size([1, 818, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.39450788497924805  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.445559024810791  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 818, 128])
m.shape torch.Size([12220, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5037627220153809  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5037627220153809  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 12220, 128]), torch.Size([1, 12220, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5154166221618652  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3467345237731934  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 12220, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.272118091583252  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2920336723327637  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3119492530822754  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2918777465820312  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([20883, 256])
first layer input nodes number: 70183
first layer output nodes number: 20883
edges number: 164315
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.312474250793457  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3323898315429688  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.337602138519287  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.337602138519287  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([448, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.360091209411621  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.360091209411621  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.360945701599121  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3688058853149414  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 448, 256])
m.shape torch.Size([353, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3690576553344727  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3690576553344727  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3697309494018555  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3829755783081055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([275, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3834319114685059  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3834319114685059  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3839564323425293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3962750434875488  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3969049453735352  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3969049453735352  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3973474502563477  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4101800918579102  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([177, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4108095169067383  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4108095169067383  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.411147117614746  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4233007431030273  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([141, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.423945426940918  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.423945426940918  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4242143630981445  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4357786178588867  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4365592002868652  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4365592002868652  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4368185997009277  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4497885704040527  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([123, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4506049156188965  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4506049156188965  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4508395195007324  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4642119407653809  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4649686813354492  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4649686813354492  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4651613235473633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4774904251098633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4782400131225586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4782400131225586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.478407859802246  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4903249740600586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([83, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4911189079284668  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4911189079284668  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4912772178649902  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5036253929138184  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5041346549987793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5041346549987793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5042319297790527  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.512500286102295  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5131888389587402  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5131888389587402  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5133013725280762  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5236544609069824  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.524284839630127  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.524284839630127  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5243821144104004  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5340123176574707  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5345983505249023  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5345983505249023  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.534682273864746  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5435781478881836  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.544044017791748  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.544044017791748  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5441069602966309  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5512194633483887  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5518746376037598  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5518746376037598  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.551954746246338  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.561567783355713  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5620298385620117  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5620298385620117  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5620851516723633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5691099166870117  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5695390701293945  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5695390701293945  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5695867538452148  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5759763717651367  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.576279640197754  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.576279640197754  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5763120651245117  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5808839797973633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5811505317687988  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5811505317687988  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5811772346496582  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5851292610168457  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5854754447937012  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5854754447937012  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.585507869720459  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.59053373336792  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5907387733459473  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5907387733459473  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5907578468322754  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5938477516174316  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5941381454467773  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5941381454467773  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.594162940979004  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.598353385925293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([280, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6050691604614258  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6050691604614258  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6056032180786133  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7020039558410645  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 280, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6826133728027344  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.683037281036377  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6834611892700195  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6830158233642578  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([2842, 40])
input nodes number: 20883
output nodes number: 2842
edges number: 22818
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6831932067871094  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6831936836242676  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04900026321411133  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

pseudo mini batch 5 input nodes size: 70902
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04501533508300781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04501533508300781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.07882404327392578  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.07884550094604492  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04535818099975586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04677248001098633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04677248001098633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04677248001098633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([70902, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04677248001098633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([821, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1285710334777832  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1285710334777832  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.12935400009155273  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13561773300170898  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([1047, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1363224983215332  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1363224983215332  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1047, 128]), torch.Size([1, 1047, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13732099533081055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1522984504699707  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1047, 128])
m.shape torch.Size([1134, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15342140197753906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15342140197753906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1134, 128]), torch.Size([1, 1134, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15450286865234375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.17892742156982422  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1134, 128])
m.shape torch.Size([1148, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.18061447143554688  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.18061447143554688  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1148, 128]), torch.Size([1, 1148, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.18170928955078125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.21345901489257812  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1148, 128])
m.shape torch.Size([1104, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2155437469482422  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2155437469482422  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2165966033935547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2550792694091797  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([972, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.25733375549316406  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.25733375549316406  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 972, 128]), torch.Size([1, 972, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.25826072692871094  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2982807159423828  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 972, 128])
m.shape torch.Size([978, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.30108165740966797  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.30108165740966797  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 978, 128]), torch.Size([1, 978, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3020143508911133  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.34952640533447266  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 978, 128])
m.shape torch.Size([901, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3524971008300781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3524971008300781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 901, 128]), torch.Size([1, 901, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.35335636138916016  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.40306663513183594  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 901, 128])
m.shape torch.Size([826, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.40670156478881836  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.40670156478881836  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 826, 128]), torch.Size([1, 826, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.4074892997741699  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.45919179916381836  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 826, 128])
m.shape torch.Size([12270, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5173916816711426  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5173916816711426  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 12270, 128]), torch.Size([1, 12270, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5290932655334473  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3609356880187988  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 12270, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.285423755645752  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3056426048278809  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3258614540100098  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3054842948913574  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([21201, 256])
first layer input nodes number: 70902
first layer output nodes number: 21201
edges number: 166449
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3263916969299316  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3466105461120605  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3517823219299316  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3517823219299316  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([403, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.374579906463623  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.374579906463623  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3753485679626465  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3828225135803223  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([335, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.383082389831543  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.383082389831543  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3837213516235352  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3955488204956055  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([285, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3960514068603516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3960514068603516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3965950012207031  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.410010814666748  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([257, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4107389450073242  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4107389450073242  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.411229133605957  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4271507263183594  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([214, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.427934169769287  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.427934169769287  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.428342342376709  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4430365562438965  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4437437057495117  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4437437057495117  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.444045066833496  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4570035934448242  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4577479362487793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4577479362487793  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4580016136169434  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4706854820251465  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([114, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.471435546875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.471435546875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4716529846191406  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4840469360351562  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.48482084274292  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.48482084274292  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4850153923034668  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4974665641784668  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([109, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4984173774719238  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4984173774719238  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4986252784729004  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5133862495422363  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([51, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5138216018676758  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5138216018676758  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5139188766479492  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5215063095092773  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5221385955810547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5221385955810547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5222511291503906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5318164825439453  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([34, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5321850776672363  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5321850776672363  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.532249927520752  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5382161140441895  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5387892723083496  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5387892723083496  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5388751029968262  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5473723411560059  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.547877311706543  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.547877311706543  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5479497909545898  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5556325912475586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5561347007751465  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5561347007751465  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.556201457977295  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5637450218200684  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5641531944274902  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5641531944274902  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5642046928405762  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5703845024108887  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5708260536193848  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5708260536193848  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5708775520324707  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5774178504943848  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5778307914733887  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5778307914733887  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5778765678405762  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5840106010437012  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5845260620117188  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5845260620117188  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5845794677734375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5921096801757812  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.59248685836792  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.59248685836792  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5925250053405762  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5981707572937012  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5984268188476562  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5984268188476562  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5984516143798828  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.602294921875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6026363372802734  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6026363372802734  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6026668548583984  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6076107025146484  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6081490516662598  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6081490516662598  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6081948280334473  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6159310340881348  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([291, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6229004859924316  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6229004859924316  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.62345552444458  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7246122360229492  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 291, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7048625946044922  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7052865028381348  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7057104110717773  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7052650451660156  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([2842, 40])
input nodes number: 21201
output nodes number: 2842
edges number: 23182
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7054448127746582  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7054452896118164  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04939603805541992  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

pseudo mini batch 6 input nodes size: 71190
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04535818099975586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04535818099975586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.07930421829223633  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.07932567596435547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04549551010131836  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04695844650268555  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04695844650268555  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04695844650268555  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([71190, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04695844650268555  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([774, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1315603256225586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1315603256225586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 774, 128]), torch.Size([1, 774, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13229846954345703  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.138580322265625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 774, 128])
m.shape torch.Size([1059, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13922119140625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13922119140625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1059, 128]), torch.Size([1, 1059, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.14023113250732422  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1553802490234375  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1059, 128])
m.shape torch.Size([1099, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1564474105834961  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1564474105834961  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1099, 128]), torch.Size([1, 1099, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15749549865722656  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18121910095214844  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1099, 128])
m.shape torch.Size([1132, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18285417556762695  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18285417556762695  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1132, 128]), torch.Size([1, 1132, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18393373489379883  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21534013748168945  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1132, 128])
m.shape torch.Size([1151, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2175445556640625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2175445556640625  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1151, 128]), torch.Size([1, 1151, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2186422348022461  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25815868377685547  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1151, 128])
m.shape torch.Size([1034, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.26056814193725586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.26056814193725586  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 1034, 128]), torch.Size([1, 1034, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2615542411804199  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3039565086364746  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 1034, 128])
m.shape torch.Size([938, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3065943717956543  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3065943717956543  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 938, 128]), torch.Size([1, 938, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30748891830444336  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.352569580078125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 938, 128])
m.shape torch.Size([862, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3554105758666992  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3554105758666992  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 862, 128]), torch.Size([1, 862, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3562326431274414  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40380382537841797  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 862, 128])
m.shape torch.Size([816, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4068946838378906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4068946838378906  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4076728820800781  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.45927858352661133  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([12876, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.520287036895752  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.520287036895752  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 12876, 128]), torch.Size([1, 12876, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5325665473937988  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4269537925720215  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 12876, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3486371040344238  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.369370937347412  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3901047706604004  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.369208812713623  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

torch.Size([21741, 256])
first layer input nodes number: 71190
first layer output nodes number: 21741
edges number: 172242
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3906373977661133  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4113712310791016  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4170665740966797  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4170665740966797  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

m.shape torch.Size([402, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4411969184875488  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4411969184875488  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4419636726379395  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.449068546295166  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([363, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.44938325881958  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.44938325881958  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.450075626373291  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.460522174835205  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([272, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4609603881835938  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4609603881835938  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4614791870117188  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4736690521240234  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([205, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4741978645324707  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4741978645324707  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4745888710021973  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4859280586242676  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([220, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4869732856750488  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4869732856750488  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4873929023742676  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5024991035461426  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5031719207763672  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5031719207763672  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5034637451171875  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.516012191772461  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5167880058288574  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5167880058288574  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5170493125915527  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5301146507263184  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.530745506286621  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.530745506286621  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5309343338012695  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5416975021362305  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5423903465270996  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5423903465270996  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5425639152526855  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5536723136901855  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5544028282165527  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5544028282165527  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5545649528503418  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5660758018493652  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5666399002075195  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5666399002075195  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.566756248474121  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.575831413269043  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.57647705078125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.57647705078125  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5765933990478516  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5864830017089844  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5870623588562012  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5870623588562012  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5871596336364746  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5961089134216309  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.596665859222412  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.596665859222412  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5967516899108887  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6052489280700684  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.605898380279541  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.605898380279541  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.605989933013916  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.615694522857666  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6162023544311523  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6162023544311523  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6162710189819336  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6240301132202148  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.624535083770752  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.624535083770752  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6245980262756348  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6321511268615723  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.632777214050293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.632777214050293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6328496932983398  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.642054557800293  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6424751281738281  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6424751281738281  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6425228118896484  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6489124298095703  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.649465560913086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.649465560913086  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6495227813720703  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6575908660888672  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6579256057739258  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6579256057739258  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6579599380493164  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.663041114807129  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6633625030517578  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6633625030517578  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6633930206298828  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6681232452392578  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.668461799621582  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.668461799621582  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.668492317199707  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.673436164855957  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6738824844360352  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6738824844360352  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6739206314086914  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6803674697875977  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([317, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6879653930664062  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6879653930664062  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6885700225830078  GigaBytes
Max Memory Allocated: 1.7915997505187988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7966876029968262  GigaBytes
Max Memory Allocated: 1.8042454719543457  GigaBytes

rst.shape  torch.Size([1, 317, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7755851745605469  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7760090827941895  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.776432991027832  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7759876251220703  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([2842, 40])
input nodes number: 21741
output nodes number: 2842
edges number: 24017
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7761712074279785  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7761716842651367  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04965019226074219  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

pseudo mini batch 7 input nodes size: 68977
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04549551010131836  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04549551010131836  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07869863510131836  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0787200927734375  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046122074127197266  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046122074127197266  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046122074127197266  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([68977, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046122074127197266  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

m.shape torch.Size([829, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12537622451782227  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12537622451782227  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 829, 128]), torch.Size([1, 829, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12616682052612305  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1324915885925293  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 829, 128])
m.shape torch.Size([1035, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13334035873413086  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13334035873413086  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1035, 128]), torch.Size([1, 1035, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13432741165161133  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.14913320541381836  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1035, 128])
m.shape torch.Size([1104, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15021896362304688  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15021896362304688  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15127182006835938  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17501449584960938  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([1104, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17659378051757812  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17659378051757812  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17764663696289062  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.20875930786132812  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([1100, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21085548400878906  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21085548400878906  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1100, 128]), torch.Size([1, 1100, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21190452575683594  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2504119873046875  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1100, 128])
m.shape torch.Size([1010, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.252777099609375  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.252777099609375  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1010, 128]), torch.Size([1, 1010, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2537403106689453  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2963123321533203  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1010, 128])
m.shape torch.Size([897, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2988247871398926  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2988247871398926  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 897, 128]), torch.Size([1, 897, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.299680233001709  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3438720703125  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 897, 128])
m.shape torch.Size([816, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3465571403503418  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3465571403503418  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3473353385925293  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39293813705444336  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([793, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3959522247314453  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3959522247314453  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39670848846435547  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4458928108215332  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([11910, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5023059844970703  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5023059844970703  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 11910, 128]), torch.Size([1, 11910, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5136642456054688  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3417301177978516  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 11910, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.268599510192871  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.288243293762207  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.307887077331543  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2880897521972656  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([20598, 256])
first layer input nodes number: 68977
first layer output nodes number: 20598
edges number: 161231
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3084030151367188  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3280467987060547  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3337936401367188  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3337936401367188  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

m.shape torch.Size([429, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3559088706970215  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3559088706970215  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.356727123260498  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3646903038024902  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([382, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3650155067443848  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3650155067443848  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3657441139221191  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3766732215881348  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([283, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3771252632141113  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3771252632141113  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3776650428771973  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3907685279846191  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([245, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3914408683776855  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3914408683776855  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3919081687927246  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4054598808288574  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([206, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.406270980834961  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.406270980834961  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4066638946533203  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4208087921142578  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([145, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4214487075805664  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4214487075805664  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4217252731323242  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4336175918579102  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4343743324279785  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4343743324279785  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4346280097961426  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4473118782043457  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4480462074279785  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4480462074279785  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4482598304748535  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4604363441467285  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.461047649383545  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.461047649383545  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4612059593200684  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4713377952575684  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.471999168395996  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.471999168395996  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4721460342407227  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4825735092163086  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4831452369689941  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4831452369689941  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4832615852355957  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4923367500305176  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4930286407470703  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4930286407470703  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4931526184082031  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5036907196044922  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5043034553527832  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5043034553527832  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.504406452178955  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5138821601867676  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.51442289352417  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.51442289352417  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5145068168640137  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.522815227508545  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5232782363891602  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5232782363891602  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5233449935913086  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.530421257019043  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5310955047607422  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5310955047607422  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5311832427978516  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.541097640991211  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5415606498718262  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5415606498718262  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5416197776794434  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5487151145935059  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5491700172424316  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5491700172424316  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5492234230041504  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5560059547424316  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5564541816711426  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5564541816711426  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5565037727355957  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5631489753723145  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5634894371032715  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5634894371032715  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.563525676727295  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5686354637145996  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5690817832946777  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5690817832946777  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5691256523132324  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5756182670593262  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.576061725616455  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.576061725616455  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.576103687286377  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5826077461242676  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5829405784606934  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5829405784606934  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5829710960388184  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5879149436950684  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5882229804992676  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5882229804992676  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.588249683380127  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5927624702453613  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([263, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5990686416625977  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5990686416625977  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5995702743530273  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6911430358886719  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 263, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.672121524810791  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6725454330444336  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6729693412780762  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6725239753723145  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([2842, 40])
input nodes number: 20598
output nodes number: 2842
edges number: 22447
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.672698974609375  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6726994514465332  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04866647720336914  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

pseudo mini batch 8 input nodes size: 71149
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07867908477783203  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07870054244995117  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04547595977783203  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046905517578125  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046905517578125  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046905517578125  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([71149, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046905517578125  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

m.shape torch.Size([780, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1295609474182129  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1295609474182129  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 780, 128]), torch.Size([1, 780, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13030481338500977  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13657331466674805  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 780, 128])
m.shape torch.Size([1061, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13721323013305664  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13721323013305664  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1061, 128]), torch.Size([1, 1061, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13822507858276367  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15340280532836914  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1061, 128])
m.shape torch.Size([1144, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15453338623046875  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15453338623046875  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1144, 128]), torch.Size([1, 1144, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1556243896484375  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17962646484375  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1144, 128])
m.shape torch.Size([1135, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1812458038330078  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1812458038330078  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1135, 128]), torch.Size([1, 1135, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1823282241821289  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21374893188476562  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1135, 128])
m.shape torch.Size([1128, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2158970832824707  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2158970832824707  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1128, 128]), torch.Size([1, 1128, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21697282791137695  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25586748123168945  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1128, 128])
m.shape torch.Size([1034, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2582879066467285  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2582879066467285  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1034, 128]), torch.Size([1, 1034, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2592740058898926  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30185747146606445  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1034, 128])
m.shape torch.Size([961, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30457210540771484  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30457210540771484  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 961, 128]), torch.Size([1, 961, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30548858642578125  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35131263732910156  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 961, 128])
m.shape torch.Size([844, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35407400131225586  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35407400131225586  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 844, 128]), torch.Size([1, 844, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35487890243530273  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40166521072387695  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 844, 128])
m.shape torch.Size([811, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4047431945800781  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4047431945800781  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 811, 128]), torch.Size([1, 811, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4055166244506836  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4570956230163574  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 811, 128])
m.shape torch.Size([12475, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5161943435668945  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5161943435668945  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 12475, 128]), torch.Size([1, 12475, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5280914306640625  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3736577033996582  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 12475, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.297269344329834  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3176522254943848  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3380351066589355  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.317492961883545  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([21373, 256])
first layer input nodes number: 71149
first layer output nodes number: 21373
edges number: 168246
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3385672569274902  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.358950138092041  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3640460968017578  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3640460968017578  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

m.shape torch.Size([385, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3871517181396484  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3871517181396484  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3878860473632812  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.394144058227539  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([354, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3944578170776367  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3944578170776367  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3951330184936523  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4067373275756836  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([293, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4072446823120117  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4072446823120117  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4078035354614258  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4240121841430664  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([240, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4246554374694824  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4246554374694824  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4251132011413574  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4383883476257324  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([213, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4392704963684082  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4392704963684082  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4396767616271973  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4543023109436035  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4550161361694336  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4550161361694336  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4553194046020508  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4683599472045898  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([122, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.469029426574707  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.469029426574707  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4692621231079102  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4808969497680664  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.481511116027832  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.481511116027832  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4816923141479492  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.492020606994629  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4927778244018555  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4927778244018555  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.492964744567871  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.504927635192871  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5056705474853516  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5056705474853516  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5058364868164062  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.517618179321289  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([84, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5184235572814941  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5184235572814941  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5185837745666504  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.531080722808838  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5316238403320312  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5316238403320312  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5317268371582031  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5404815673828125  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5411300659179688  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5411300659179688  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5412368774414062  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5510635375976562  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5517101287841797  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5517101287841797  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.551809310913086  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5616283416748047  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5622568130493164  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5622568130493164  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5623464584350586  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5718488693237305  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.572265625  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.572265625  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5723228454589844  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5787887573242188  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5791525840759277  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5791525840759277  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5791983604431152  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5846915245056152  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5849976539611816  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5849976539611816  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.585033893585205  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5896363258361816  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5901846885681152  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5901846885681152  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5902438163757324  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5981669425964355  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5986566543579102  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5986566543579102  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.598708152770996  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6059694290161133  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.606367588043213  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.606367588043213  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.606407642364502  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6123356819152832  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6127386093139648  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6127386093139648  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.612776756286621  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6186895370483398  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.618891716003418  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.618891716003418  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.618910789489746  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6220006942749023  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6224989891052246  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6224989891052246  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6225409507751465  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6296324729919434  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([299, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.636795997619629  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.636795997619629  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6373662948608398  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7503089904785156  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 299, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7302284240722656  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7306523323059082  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7310762405395508  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.730630874633789  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([2842, 40])
input nodes number: 21373
output nodes number: 2842
edges number: 23523
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.730811595916748  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7308120727539062  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04955101013183594  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

pseudo mini batch 9 input nodes size: 70077
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04547595977783203  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04547595977783203  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07889127731323242  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07891273498535156  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04496479034423828  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04636955261230469  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04636955261230469  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04636955261230469  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([70077, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04636955261230469  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

m.shape torch.Size([831, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12766075134277344  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12766075134277344  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 831, 128]), torch.Size([1, 831, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12845325469970703  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13479328155517578  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 831, 128])
m.shape torch.Size([1056, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13597440719604492  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13597440719604492  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1056, 128]), torch.Size([1, 1056, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13698148727416992  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15208768844604492  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1056, 128])
m.shape torch.Size([1144, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15322065353393555  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15322065353393555  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1144, 128]), torch.Size([1, 1144, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1543116569519043  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1787714958190918  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1144, 128])
m.shape torch.Size([1104, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18033170700073242  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18033170700073242  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18138456344604492  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21249723434448242  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([1108, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21461248397827148  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21461248397827148  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1108, 128]), torch.Size([1, 1108, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2156691551208496  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25423383712768555  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1108, 128])
m.shape torch.Size([1044, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25669240951538086  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25669240951538086  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1044, 128]), torch.Size([1, 1044, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.257688045501709  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30095434188842773  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1044, 128])
m.shape torch.Size([930, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.303560733795166  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.303560733795166  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 930, 128]), torch.Size([1, 930, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30444765090942383  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34884023666381836  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 930, 128])
m.shape torch.Size([896, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35181474685668945  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35181474685668945  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 896, 128]), torch.Size([1, 896, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35266923904418945  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4026455879211426  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 896, 128])
m.shape torch.Size([823, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4057502746582031  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4057502746582031  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40653514862060547  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4590926170349121  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([12172, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5172939300537109  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5172939300537109  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 12172, 128]), torch.Size([1, 12172, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5289020538330078  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3597164154052734  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 12172, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2847089767456055  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3048391342163086  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3249692916870117  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3046817779541016  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([21108, 256])
first layer input nodes number: 70077
first layer output nodes number: 21108
edges number: 165400
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.325493335723877  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.34562349319458  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3506717681884766  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3506717681884766  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

m.shape torch.Size([420, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3733186721801758  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3733186721801758  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.374119758605957  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3820791244506836  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([348, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.382347583770752  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.382347583770752  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3830113410949707  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3962979316711426  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([319, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.396885871887207  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.396885871887207  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3974943161010742  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4120359420776367  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([238, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.412646770477295  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.412646770477295  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4131007194519043  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4262652397155762  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([189, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4269466400146484  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4269466400146484  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.42730712890625  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4402847290039062  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([171, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4410910606384277  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4410910606384277  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4414172172546387  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.455441951751709  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([116, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.456059455871582  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.456059455871582  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4562807083129883  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4673433303833008  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([94, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4679555892944336  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4679555892944336  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.468134880065918  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4783544540405273  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([109, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.479207992553711  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.479207992553711  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4794158935546875  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4927215576171875  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4933772087097168  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4933772087097168  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.493527889251709  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5042262077331543  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5048065185546875  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5048065185546875  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5049247741699219  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5141487121582031  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.514897346496582  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.514897346496582  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.515030860900879  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5263795852661133  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5267877578735352  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5267877578735352  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.526860237121582  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5335283279418945  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5340170860290527  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5340170860290527  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5340914726257324  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5414557456970215  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5419235229492188  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5419235229492188  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5419902801513672  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5490665435791016  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.549694538116455  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.549694538116455  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.549776554107666  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.559044361114502  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5594773292541504  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5594773292541504  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.559532642364502  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5661702156066895  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5666098594665527  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5666098594665527  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5666613578796387  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5732016563415527  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5737237930297852  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5737237930297852  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5737810134887695  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5814485549926758  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5818428993225098  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5818428993225098  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5818848609924316  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.587801456451416  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5881843566894531  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5881843566894531  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5882225036621094  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5938682556152344  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5941667556762695  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5941667556762695  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5941953659057617  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5986299514770508  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5991020202636719  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5991020202636719  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5991439819335938  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6059417724609375  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6062440872192383  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6062440872192383  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6062707901000977  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.610783576965332  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([293, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6178107261657715  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6178107261657715  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6183695793151855  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.718885898590088  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 293, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6992993354797363  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.699723243713379  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7001471519470215  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6997017860412598  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([2842, 40])
input nodes number: 21108
output nodes number: 2842
edges number: 23012
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.699880599975586  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6998810768127441  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04897260665893555  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

pseudo mini batch 10 input nodes size: 69078
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04496479034423828  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04496479034423828  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07816791534423828  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07818937301635742  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04613924026489258  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04613924026489258  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04613924026489258  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([69078, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04613924026489258  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

m.shape torch.Size([828, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12665748596191406  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12665748596191406  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 828, 128]), torch.Size([1, 828, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12744712829589844  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13376426696777344  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 828, 128])
m.shape torch.Size([1095, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1344137191772461  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1344137191772461  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13545799255371094  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1511220932006836  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([1120, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15220212936401367  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15220212936401367  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1120, 128]), torch.Size([1, 1120, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15327024459838867  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17760801315307617  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1120, 128])
m.shape torch.Size([1062, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17909955978393555  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17909955978393555  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18011236190795898  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.20948362350463867  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([1051, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21148300170898438  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21148300170898438  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21248531341552734  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2494521141052246  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([961, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25170040130615234  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25170040130615234  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 961, 128]), torch.Size([1, 961, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25261688232421875  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2920255661010742  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 961, 128])
m.shape torch.Size([860, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29443788528442383  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29443788528442383  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2952580451965332  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.33626604080200195  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 860, 128])
m.shape torch.Size([816, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.33896875381469727  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.33896875381469727  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.33974695205688477  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.38552427291870117  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([764, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3884139060974121  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3884139060974121  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 764, 128]), torch.Size([1, 764, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3891425132751465  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.43642377853393555  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 764, 128])
m.shape torch.Size([12213, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.49465322494506836  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.49465322494506836  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 12213, 128]), torch.Size([1, 12213, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5063004493713379  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3375449180603027  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 12213, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.263106346130371  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.282914161682129  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3027219772338867  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.282759189605713  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([20770, 256])
first layer input nodes number: 69078
first layer output nodes number: 20770
edges number: 163201
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.303238868713379  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3230466842651367  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.328629493713379  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.328629493713379  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

m.shape torch.Size([426, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.350998878479004  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.350998878479004  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.351811408996582  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.359330177307129  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([379, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3596525192260742  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3596525192260742  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3603754043579102  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3742918968200684  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([309, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.374821662902832  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.374821662902832  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.375411033630371  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.389573574066162  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([223, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3901362419128418  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3901362419128418  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.390561580657959  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4028964042663574  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([201, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4036498069763184  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4036498069763184  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4040331840515137  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.417834758758545  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([161, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.418571949005127  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.418571949005127  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4188790321350098  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4320836067199707  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4327445030212402  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4327445030212402  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4329752922058105  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4445147514343262  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4452300071716309  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4452300071716309  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4454360008239746  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4571776390075684  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.457775592803955  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.457775592803955  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.457930088043213  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.467817783355713  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4685769081115723  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4685769081115723  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.468742847442627  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4805245399475098  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4810972213745117  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4810972213745117  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.481215476989746  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4904394149780273  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4909801483154297  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4909801483154297  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.491079330444336  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4995098114013672  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5000476837158203  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5000476837158203  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5001373291015625  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5083847045898438  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5089054107666016  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5089054107666016  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5089855194091797  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.516916275024414  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.517481803894043  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.517481803894043  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.517561912536621  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5260534286499023  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5265827178955078  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5265827178955078  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5266532897949219  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.534627914428711  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5350666046142578  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5350666046142578  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5351219177246094  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5417594909667969  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5422682762145996  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5422682762145996  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5423274040222168  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5498366355895996  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5501909255981445  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5501909255981445  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5502309799194336  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.555598258972168  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5559630393981934  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5559630393981934  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5560011863708496  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5613799095153809  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5619463920593262  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5619463920593262  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5620017051696777  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.570188045501709  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5705413818359375  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5705413818359375  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5705757141113281  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.575897216796875  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.576211929321289  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.576211929321289  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5762405395507812  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5808753967285156  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5812997817993164  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5812997817993164  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5813360214233398  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5874605178833008  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([282, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5942187309265137  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5942187309265137  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5947566032409668  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6913628578186035  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 282, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6720681190490723  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6724920272827148  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6729159355163574  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6724705696105957  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([2842, 40])
input nodes number: 20770
output nodes number: 2842
edges number: 22717
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6726469993591309  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.672647476196289  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.048708438873291016  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

pseudo mini batch 11 input nodes size: 70077
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07816791534423828  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07818937301635742  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04496479034423828  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046360015869140625  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046360015869140625  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046360015869140625  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([70077, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046360015869140625  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

m.shape torch.Size([814, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12716960906982422  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12716960906982422  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 814, 128]), torch.Size([1, 814, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1279458999633789  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1346755027770996  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 814, 128])
m.shape torch.Size([1101, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13533735275268555  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13533735275268555  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13638734817504883  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15213727951049805  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1101, 128])
m.shape torch.Size([1155, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15326452255249023  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15326452255249023  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1155, 128]), torch.Size([1, 1155, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15436601638793945  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17907238006591797  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1155, 128])
m.shape torch.Size([1055, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18053388595581055  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18053388595581055  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1055, 128]), torch.Size([1, 1055, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18154001235961914  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21071767807006836  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1055, 128])
m.shape torch.Size([1044, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21270370483398438  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21270370483398438  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1044, 128]), torch.Size([1, 1044, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2136993408203125  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.249542236328125  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1044, 128])
m.shape torch.Size([1005, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2519197463989258  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2519197463989258  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1005, 128]), torch.Size([1, 1005, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25287818908691406  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29445362091064453  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1005, 128])
m.shape torch.Size([890, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29694509506225586  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29694509506225586  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2977938652038574  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3421444892883301  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([873, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3450503349304199  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3450503349304199  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 873, 128]), torch.Size([1, 873, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3458828926086426  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.393338680267334  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 873, 128])
m.shape torch.Size([774, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3962440490722656  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3962440490722656  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 774, 128]), torch.Size([1, 774, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39698219299316406  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4450101852416992  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 774, 128])
m.shape torch.Size([12230, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.50323486328125  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.50323486328125  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 12230, 128]), torch.Size([1, 12230, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5153112411499023  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3467340469360352  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 12230, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.272082805633545  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2920536994934082  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3120245933532715  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2918972969055176  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([20941, 256])
first layer input nodes number: 70077
first layer output nodes number: 20941
edges number: 164431
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3125486373901367  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.33251953125  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3377270698547363  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3377270698547363  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

m.shape torch.Size([428, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3601264953613281  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3601264953613281  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3609428405761719  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3683948516845703  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([378, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.36871337890625  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.36871337890625  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3694343566894531  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3832197189331055  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([275, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3836522102355957  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3836522102355957  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3841767311096191  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.397453784942627  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([230, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.398076057434082  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.398076057434082  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.398514747619629  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4112367630004883  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4122495651245117  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4122495651245117  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4126672744750977  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4277048110961914  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.428436279296875  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.428436279296875  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4287471771240234  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4421157836914062  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4428420066833496  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4428420066833496  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.443091869354248  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.45558500289917  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([92, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4561676979064941  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4561676979064941  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.456343173980713  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4663453102111816  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4669842720031738  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4669842720031738  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.46714448928833  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.47739839553833  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4779624938964844  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4779624938964844  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4780902862548828  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4871635437011719  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.487840175628662  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.487840175628662  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.487973690032959  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4983878135681152  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4990592002868652  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4990592002868652  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4991812705993652  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5095572471618652  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5100712776184082  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5100712776184082  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5101590156555176  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.51823091506958  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5189003944396973  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5189003944396973  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5190014839172363  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5290093421936035  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.529564380645752  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.529564380645752  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.52964448928833  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5381360054016113  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5385422706604004  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5385422706604004  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.538597583770752  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5448479652404785  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.545539379119873  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.545539379119873  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5456233024597168  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5556941032409668  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5562233924865723  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5562233924865723  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.556286334991455  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5642800331115723  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5648512840270996  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5648512840270996  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5649142265319824  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5733485221862793  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5737595558166504  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5737595558166504  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.573803424835205  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.579988956451416  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.580451488494873  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.580451488494873  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5804972648620605  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5872721672058105  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.587545394897461  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.587545394897461  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5875720977783203  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5917110443115234  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5920958518981934  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5920958518981934  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.592130184173584  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5976920127868652  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5979981422424316  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5979981422424316  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.598024845123291  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6025376319885254  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([268, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.608963966369629  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.608963966369629  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6094751358032227  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.700948715209961  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 268, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6816391944885254  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.682063102722168  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6824870109558105  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6820416450500488  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([2842, 40])
input nodes number: 20941
output nodes number: 2842
edges number: 22744
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6822195053100586  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6822199821472168  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04894876480102539  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

pseudo mini batch 12 input nodes size: 70520
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04496479034423828  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04496479034423828  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07859134674072266  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0786128044128418  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045176029205322266  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046590328216552734  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046590328216552734  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046590328216552734  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([70520, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046590328216552734  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

m.shape torch.Size([854, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12846755981445312  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12846755981445312  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 854, 128]), torch.Size([1, 854, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12928199768066406  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1367650032043457  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 854, 128])
m.shape torch.Size([1058, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13736677169799805  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13736677169799805  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1058, 128]), torch.Size([1, 1058, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13837575912475586  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15351057052612305  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1058, 128])
m.shape torch.Size([1150, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15465116500854492  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15465116500854492  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1150, 128]), torch.Size([1, 1150, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1557478904724121  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17987585067749023  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1150, 128])
m.shape torch.Size([1093, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1814122200012207  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1814122200012207  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1093, 128]), torch.Size([1, 1093, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18245458602905273  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21334314346313477  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1093, 128])
m.shape torch.Size([984, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21516799926757812  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21516799926757812  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 984, 128]), torch.Size([1, 984, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21610641479492188  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2507591247558594  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 984, 128])
m.shape torch.Size([924, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2529335021972656  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2529335021972656  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 924, 128]), torch.Size([1, 924, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.253814697265625  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2926177978515625  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 924, 128])
m.shape torch.Size([855, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2950310707092285  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2950310707092285  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 855, 128]), torch.Size([1, 855, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29584646224975586  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3372621536254883  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 855, 128])
m.shape torch.Size([866, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34015798568725586  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34015798568725586  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 866, 128]), torch.Size([1, 866, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34098386764526367  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.388059139251709  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 866, 128])
m.shape torch.Size([802, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39108800888061523  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39108800888061523  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39185285568237305  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4412713050842285  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([12520, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5005888938903809  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5005888938903809  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 12520, 128]), torch.Size([1, 12520, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5125288963317871  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3602690696716309  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 12520, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2845282554626465  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3046565055847168  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.324784755706787  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3044991493225098  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([21106, 256])
first layer input nodes number: 70520
first layer output nodes number: 21106
edges number: 166587
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3253121376037598  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.34544038772583  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3504724502563477  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3504724502563477  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

m.shape torch.Size([440, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3732314109802246  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3732314109802246  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.374070644378662  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3823776245117188  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([387, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.382702350616455  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.382702350616455  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3834404945373535  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3947186470031738  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([291, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.395188808441162  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.395188808441162  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3957438468933105  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.410048007965088  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([211, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4105820655822754  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4105820655822754  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4109845161437988  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4226555824279785  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([182, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4233293533325195  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4233293533325195  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4236764907836914  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.436173439025879  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([137, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4367899894714355  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4367899894714355  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4370512962341309  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4482874870300293  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4490046501159668  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4490046501159668  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4492449760437012  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.46126127243042  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([122, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4620795249938965  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4620795249938965  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4623122215270996  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4755759239196777  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.476264476776123  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.476264476776123  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4764418601989746  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4877943992614746  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4884462356567383  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4884462356567383  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4885931015014648  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4990205764770508  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4996347427368164  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4996347427368164  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4997587203979492  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5094289779663086  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5100131034851074  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5100131034851074  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.510119915008545  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5191988945007324  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5199203491210938  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5199203491210938  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5200386047363281  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5309181213378906  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5315184593200684  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5315184593200684  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5316119194030762  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5408644676208496  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5412507057189941  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5412507057189941  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5413079261779785  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5473732948303223  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.547929286956787  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.547929286956787  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.548001766204834  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5561919212341309  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5566296577453613  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5566296577453613  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.556684970855713  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5633225440979004  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.563727855682373  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.563727855682373  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5637755393981934  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.569831371307373  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5702824592590332  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5702824592590332  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5703320503234863  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.576977252960205  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5774526596069336  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5774526596069336  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5775022506713867  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5844945907592773  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5847525596618652  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5847525596618652  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5847792625427246  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.588731288909912  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5890774726867676  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5890774726867676  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5891098976135254  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5941357612609863  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5946059226989746  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5946059226989746  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5946478843688965  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6014456748962402  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.601747989654541  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.601747989654541  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6017746925354004  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6062874794006348  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([303, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6135549545288086  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6135549545288086  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6141328811645508  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7259235382080078  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 303, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.706235408782959  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7066593170166016  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7070832252502441  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7066378593444824  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([2842, 40])
input nodes number: 21106
output nodes number: 2842
edges number: 23107
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7068166732788086  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7068171501159668  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.049207210540771484  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

pseudo mini batch 13 input nodes size: 71471
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045176029205322266  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045176029205322266  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07925605773925781  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07927751541137695  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04562950134277344  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.047097206115722656  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.047097206115722656  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.047097206115722656  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([71471, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.047097206115722656  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

m.shape torch.Size([841, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1320037841796875  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1320037841796875  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 841, 128]), torch.Size([1, 841, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13280582427978516  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1392221450805664  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 841, 128])
m.shape torch.Size([1090, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.14041423797607422  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.14041423797607422  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1090, 128]), torch.Size([1, 1090, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.14145374298095703  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15704631805419922  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1090, 128])
m.shape torch.Size([1133, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15877151489257812  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15877151489257812  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1133, 128]), torch.Size([1, 1133, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1598520278930664  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18370532989501953  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1133, 128])
m.shape torch.Size([1166, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18538904190063477  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18538904190063477  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1166, 128]), torch.Size([1, 1166, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18650102615356445  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2187485694885254  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1166, 128])
m.shape torch.Size([1140, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.22091054916381836  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.22091054916381836  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1140, 128]), torch.Size([1, 1140, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.22199773788452148  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.261136531829834  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1140, 128])
m.shape torch.Size([1026, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.26352834701538086  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.26352834701538086  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 1026, 128]), torch.Size([1, 1026, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.26450681686401367  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.306760311126709  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 1026, 128])
m.shape torch.Size([967, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30949878692626953  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30949878692626953  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 967, 128]), torch.Size([1, 967, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3104209899902344  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35747861862182617  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 967, 128])
m.shape torch.Size([910, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3604888916015625  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3604888916015625  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 910, 128]), torch.Size([1, 910, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3613567352294922  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.41177940368652344  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 910, 128])
m.shape torch.Size([802, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.41478729248046875  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.41478729248046875  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.41555213928222656  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.46529483795166016  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([12858, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5262241363525391  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5262241363525391  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 12858, 128]), torch.Size([1, 12858, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5384864807128906  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4324932098388672  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 12858, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3540115356445312  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3749284744262695  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3958454132080078  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3747649192810059  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

torch.Size([21933, 256])
first layer input nodes number: 71471
first layer output nodes number: 21933
edges number: 172787
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3963799476623535  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4172968864440918  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.423048496246338  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.423048496246338  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

m.shape torch.Size([400, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.447176456451416  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.447176456451416  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.447939395904541  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.454042911529541  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([370, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4543728828430176  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4543728828430176  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4550786018371582  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.466254711151123  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([276, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4666976928710938  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4666976928710938  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.46722412109375  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4795541763305664  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([243, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4802255630493164  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4802255630493164  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4806890487670898  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4941301345825195  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([165, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4946913719177246  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4946913719177246  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4950060844421387  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.506335735321045  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.507089614868164  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.507089614868164  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5073909759521484  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5203495025634766  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5210132598876953  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5210132598876953  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5212440490722656  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5327835083007812  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5334677696228027  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5334677696228027  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5336661338806152  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5449728965759277  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5455832481384277  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5455832481384277  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5457396507263184  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5557494163513184  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5564789772033691  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5564789772033691  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5566391944885254  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5680146217346191  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.568748950958252  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.568748950958252  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5688958168029785  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5803513526916504  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5809588432312012  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5809588432312012  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.581071376800537  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5906367301940918  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5912055969238281  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5912055969238281  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5913009643554688  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6000747680664062  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6005654335021973  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6005654335021973  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6006417274475098  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6081948280334473  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6088776588439941  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6088776588439941  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6089730262756348  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.619081974029541  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.619710922241211  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.619710922241211  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6197948455810547  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6292781829833984  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6298575401306152  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6298575401306152  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.629930019378662  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.638627529144287  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6391105651855469  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6391105651855469  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6391677856445312  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6464347839355469  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6467900276184082  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6467900276184082  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6468300819396973  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6521973609924316  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6527352333068848  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6527352333068848  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6527905464172363  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6605896949768066  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6612281799316406  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6612281799316406  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6612911224365234  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6706066131591797  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6710405349731445  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6710405349731445  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6710824966430664  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.677586555480957  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6779637336730957  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6779637336730957  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6779980659484863  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6835598945617676  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6839118003845215  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6839118003845215  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6839423179626465  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6890997886657715  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([312, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6965813636779785  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6965813636779785  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.697176456451416  GigaBytes
Max Memory Allocated: 1.8045239448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.805147647857666  GigaBytes
Max Memory Allocated: 1.8125863075256348  GigaBytes

rst.shape  torch.Size([1, 312, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7840514183044434  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.784475326538086  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7848992347717285  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7844538688659668  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([2842, 40])
input nodes number: 21933
output nodes number: 2842
edges number: 24129
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7846388816833496  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7846393585205078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04980134963989258  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

pseudo mini batch 14 input nodes size: 71009
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04562950134277344  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04562950134277344  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07948923110961914  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07951068878173828  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045409202575683594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046840667724609375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046840667724609375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046840667724609375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([71009, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046840667724609375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([827, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12976980209350586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12976980209350586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13055849075317383  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13686800003051758  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([1113, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1380329132080078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1380329132080078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1113, 128]), torch.Size([1, 1113, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13909435272216797  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1550159454345703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1113, 128])
m.shape torch.Size([1135, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15654706954956055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15654706954956055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1135, 128]), torch.Size([1, 1135, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15762948989868164  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18149042129516602  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1135, 128])
m.shape torch.Size([1075, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1829996109008789  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1829996109008789  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1075, 128]), torch.Size([1, 1075, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18402481079101562  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21375560760498047  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1075, 128])
m.shape torch.Size([1094, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2158513069152832  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2158513069152832  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21689462661743164  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25558042526245117  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([957, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2577967643737793  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2577967643737793  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 957, 128]), torch.Size([1, 957, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2587094306945801  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29795408248901367  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 957, 128])
m.shape torch.Size([858, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30036163330078125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30036163330078125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 858, 128]), torch.Size([1, 858, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3011798858642578  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34212398529052734  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 858, 128])
m.shape torch.Size([889, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3451061248779297  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3451061248779297  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 889, 128]), torch.Size([1, 889, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34595394134521484  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3951587677001953  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 889, 128])
m.shape torch.Size([836, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39832258224487305  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39832258224487305  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 836, 128]), torch.Size([1, 836, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39911985397338867  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.45093870162963867  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 836, 128])
m.shape torch.Size([12615, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5106930732727051  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5106930732727051  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 12615, 128]), torch.Size([1, 12615, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5227236747741699  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3775691986083984  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 12615, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3008804321289062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3212881088256836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.341695785522461  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3211283683776855  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([21399, 256])
first layer input nodes number: 71009
first layer output nodes number: 21399
edges number: 168762
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3422269821166992  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3626346588134766  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.36773681640625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.36773681640625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([440, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3905830383300781  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3905830383300781  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3914222717285156  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3988046646118164  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([382, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3991193771362305  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3991193771362305  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3998479843139648  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4109458923339844  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([285, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4114036560058594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4114036560058594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.411947250366211  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4260187149047852  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4266390800476074  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4266390800476074  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.42708158493042  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4399142265319824  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([175, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4405341148376465  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4405341148376465  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4408679008483887  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4528841972351074  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([160, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4536399841308594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4536399841308594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4539451599121094  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4670677185058594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([113, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4676756858825684  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4676756858825684  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4678912162780762  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4786677360534668  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4793906211853027  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4793906211853027  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4795966148376465  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4913382530212402  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4921092987060547  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4921092987060547  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4923019409179688  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5046310424804688  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5052752494812012  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5052752494812012  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5054221153259277  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5158495903015137  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5164742469787598  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5164742469787598  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5166001319885254  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5264191627502441  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5269675254821777  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5269675254821777  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5270686149597168  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.535661220550537  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5362229347229004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5362229347229004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5363163948059082  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.544914722442627  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5454602241516113  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5454602241516113  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.545544147491455  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5538525581359863  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([28, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5542144775390625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5542144775390625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5542678833007812  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5599288940429688  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5605788230895996  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5605788230895996  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5606627464294434  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.570146083831787  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5705780982971191  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5705780982971191  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5706334114074707  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5772709846496582  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.577831745147705  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.577831745147705  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5778965950012207  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.586132526397705  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5862646102905273  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5862646102905273  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5862817764282227  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5885820388793945  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5889387130737305  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5889387130737305  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.588974952697754  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5940847396850586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5945916175842285  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5945916175842285  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5946412086486816  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6019806861877441  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6022734642028809  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6022734642028809  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.602302074432373  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.606736660003662  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6071205139160156  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6071205139160156  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6071548461914062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6127166748046875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6130919456481934  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6130919456481934  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6131243705749512  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6186041831970215  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([318, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6262292861938477  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6262292861938477  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.626835823059082  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7397937774658203  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 318, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7200050354003906  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7204289436340332  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7208528518676758  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.720407485961914  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([2842, 40])
input nodes number: 21399
output nodes number: 2842
edges number: 23199
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7205886840820312  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7205891609191895  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04948711395263672  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

pseudo mini batch 15 input nodes size: 70235
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045409202575683594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045409202575683594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07889986038208008  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07892131805419922  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045040130615234375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046441078186035156  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046441078186035156  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046441078186035156  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([70235, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046441078186035156  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([818, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1275343894958496  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1275343894958496  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 818, 128]), torch.Size([1, 818, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12831449508666992  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13478708267211914  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 818, 128])
m.shape torch.Size([1104, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13544988632202148  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13544988632202148  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13650274276733398  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15229558944702148  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([1162, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15343141555786133  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15343141555786133  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1162, 128]), torch.Size([1, 1162, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1545395851135254  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17932462692260742  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1162, 128])
m.shape torch.Size([1089, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1808476448059082  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1808476448059082  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1818861961364746  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21284151077270508  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([1064, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2148590087890625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2148590087890625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1064, 128]), torch.Size([1, 1064, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21587371826171875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2529716491699219  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1064, 128])
m.shape torch.Size([1000, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2553253173828125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2553253173828125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1000, 128]), torch.Size([1, 1000, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25627899169921875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2977447509765625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1000, 128])
m.shape torch.Size([922, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30034542083740234  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30034542083740234  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 922, 128]), torch.Size([1, 922, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3012247085571289  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3457469940185547  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 922, 128])
m.shape torch.Size([905, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34875965118408203  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34875965118408203  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3496227264404297  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3998403549194336  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 905, 128])
m.shape torch.Size([790, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.402799129486084  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.402799129486084  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4035525321960449  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4517703056335449  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 790, 128])
m.shape torch.Size([12201, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5099873542785645  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5099873542785645  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 12201, 128]), torch.Size([1, 12201, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5216231346130371  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3527417182922363  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 12201, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2778830528259277  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2979626655578613  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.318042278289795  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2978057861328125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([21055, 256])
first layer input nodes number: 70235
first layer output nodes number: 21055
edges number: 165002
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3185677528381348  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3386473655700684  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3436708450317383  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3436708450317383  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([434, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3662009239196777  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3662009239196777  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3670287132263184  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3749170303344727  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([367, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.375208854675293  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.375208854675293  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3759088516235352  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3887629508972168  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([317, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.389327049255371  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.389327049255371  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3899316787719727  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4056267738342285  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([224, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4061856269836426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4061856269836426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4066128730773926  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4190030097961426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([169, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4196019172668457  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4196019172668457  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.419924259185791  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4315285682678223  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([157, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4322729110717773  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4322729110717773  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.432572364807129  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.445448875427246  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.446220874786377  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.446220874786377  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4464821815490723  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.459547519683838  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4602322578430176  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4602322578430176  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4604344367980957  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4719586372375488  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.472541332244873  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.472541332244873  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4726920127868652  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4823355674743652  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4829907417297363  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4829907417297363  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.48313570022583  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4934277534484863  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([78, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4941802024841309  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4941802024841309  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4943289756774902  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5059332847595215  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5065279006958008  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5065279006958008  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.506638526916504  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5160417556762695  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5165491104125977  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5165491104125977  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5166349411010742  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.524531364440918  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5250940322875977  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5250940322875977  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5251798629760742  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.533677101135254  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5341391563415527  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5341391563415527  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5342059135437012  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5412821769714355  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([45, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5419411659240723  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5419411659240723  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5420269966125488  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5517258644104004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.552238941192627  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.552238941192627  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5523037910461426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5600857734680176  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5605378150939941  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5605378150939941  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.560591220855713  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5673737525939941  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5677123069763184  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5677123069763184  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5677504539489746  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.572862148284912  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.573439121246338  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.573439121246338  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.573498249053955  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5818352699279785  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5824518203735352  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5824518203735352  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5825128555297852  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5915460586547852  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5918116569519043  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5918116569519043  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5918383598327637  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5959773063659668  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5964064598083496  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5964064598083496  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5964446067810059  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6026244163513184  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6029744148254395  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6029744148254395  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6030049324035645  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6081624031066895  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([275, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6147551536560059  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6147551536560059  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6152796745300293  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.709538459777832  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 275, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6900982856750488  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6905221939086914  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.690946102142334  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6905007362365723  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([2842, 40])
input nodes number: 21055
output nodes number: 2842
edges number: 22875
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6906790733337402  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6906795501708984  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04903984069824219  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

pseudo mini batch 16 input nodes size: 70947
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045040130615234375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045040130615234375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07887029647827148  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07889175415039062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045379638671875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046822547912597656  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046822547912597656  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046822547912597656  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([70947, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046822547912597656  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([811, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1303243637084961  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1303243637084961  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 811, 128]), torch.Size([1, 811, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13109779357910156  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1372852325439453  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 811, 128])
m.shape torch.Size([1044, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1378941535949707  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1378941535949707  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1044, 128]), torch.Size([1, 1044, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13888978958129883  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1538243293762207  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1044, 128])
m.shape torch.Size([1094, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1552739143371582  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1552739143371582  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15631723403930664  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1800217628479004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([1101, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18160009384155273  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18160009384155273  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18265008926391602  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2137312889099121  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1101, 128])
m.shape torch.Size([1096, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2158193588256836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2158193588256836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1096, 128]), torch.Size([1, 1096, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21686458587646484  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25536632537841797  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1096, 128])
m.shape torch.Size([1032, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2577962875366211  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2577962875366211  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1032, 128]), torch.Size([1, 1032, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25878047943115234  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30168819427490234  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1032, 128])
m.shape torch.Size([949, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3043637275695801  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3043637275695801  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 949, 128]), torch.Size([1, 949, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3052687644958496  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3505263328552246  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 949, 128])
m.shape torch.Size([899, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3535032272338867  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3535032272338867  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 899, 128]), torch.Size([1, 899, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35436058044433594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40409183502197266  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 899, 128])
m.shape torch.Size([831, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4077620506286621  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4077620506286621  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 831, 128]), torch.Size([1, 831, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4085545539855957  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4602971076965332  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 831, 128])
m.shape torch.Size([12638, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5201635360717773  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5201635360717773  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 12638, 128]), torch.Size([1, 12638, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5322160720825195  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3886046409606934  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 12638, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3113799095153809  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3318791389465332  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3523783683776855  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.331718921661377  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([21495, 256])
first layer input nodes number: 70947
first layer output nodes number: 21495
edges number: 169951
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3529090881347656  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.373408317565918  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3785333633422852  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3785333633422852  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([427, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4026846885681152  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4026846885681152  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4034991264343262  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4106230735778809  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([360, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4109082221984863  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4109082221984863  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4115948677062988  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4223031997680664  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([292, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4228019714355469  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4228019714355469  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4233589172363281  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4371566772460938  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([208, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4376778602600098  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4376778602600098  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4380745887756348  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4495797157287598  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([185, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.450270652770996  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.450270652770996  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4506235122680664  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4633264541625977  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([138, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4639458656311035  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4639458656311035  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4642090797424316  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.475527286529541  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.476297378540039  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.476297378540039  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.476552963256836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4893321990966797  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4900503158569336  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4900503158569336  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.490260124206543  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5022192001342773  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5029277801513672  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5029277801513672  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5031070709228516  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5145816802978516  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5152997970581055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5152997970581055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5154600143432617  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5268354415893555  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5274639129638672  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5274639129638672  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5275917053222656  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5375595092773438  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5381994247436523  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5381994247436523  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.538315773010254  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5482053756713867  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.54880952835083  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.54880952835083  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5489106178283691  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.558210849761963  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.558793067932129  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.558793067932129  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.558882713317871  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5677576065063477  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5684051513671875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5684051513671875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5684967041015625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5782012939453125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5787553787231445  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5787553787231445  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5788297653198242  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.587235450744629  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5877866744995117  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5877866744995117  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.587855339050293  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.596095085144043  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5966663360595703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5966663360595703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5967330932617188  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6052112579345703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6057443618774414  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6057443618774414  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6058034896850586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6137266159057617  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6142354011535645  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6142354011535645  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6142888069152832  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.621819019317627  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6221961975097656  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6221961975097656  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6222343444824219  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6278800964355469  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.628262996673584  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.628262996673584  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6282992362976074  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6339163780212402  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6342520713806152  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6342520713806152  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6342825889587402  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6392264366149902  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6397647857666016  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6397647857666016  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.639810562133789  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6475467681884766  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([286, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6543960571289062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6543960571289062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6549415588378906  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7593765258789062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 286, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7383036613464355  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7387275695800781  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7391514778137207  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.738706111907959  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([2842, 40])
input nodes number: 21495
output nodes number: 2842
edges number: 23595
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7388877868652344  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7388882637023926  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0494837760925293  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

pseudo mini batch 17 input nodes size: 70122
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045379638671875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045379638671875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07881641387939453  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07883787155151367  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04498624801635742  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04637861251831055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04637861251831055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04637861251831055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([70122, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04637861251831055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([876, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12705659866333008  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12705659866333008  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 876, 128]), torch.Size([1, 876, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12789201736450195  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13501787185668945  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 876, 128])
m.shape torch.Size([1098, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13564729690551758  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13564729690551758  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13669443130493164  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15240144729614258  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([1101, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15345287322998047  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15345287322998047  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15450286865234375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1781754493713379  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1101, 128])
m.shape torch.Size([1123, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18038177490234375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18038177490234375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1123, 128]), torch.Size([1, 1123, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18145275115966797  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21276473999023438  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1123, 128])
m.shape torch.Size([1117, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21489238739013672  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21489238739013672  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2159576416015625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25466346740722656  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([959, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25687456130981445  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25687456130981445  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 959, 128]), torch.Size([1, 959, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25778913497924805  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2972068786621094  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 959, 128])
m.shape torch.Size([956, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2999405860900879  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2999405860900879  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 956, 128]), torch.Size([1, 956, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30085229873657227  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.346437931060791  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 956, 128])
m.shape torch.Size([884, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34935426712036133  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34935426712036133  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 884, 128]), torch.Size([1, 884, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35019731521606445  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39874696731567383  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 884, 128])
m.shape torch.Size([794, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4017329216003418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4017329216003418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 794, 128]), torch.Size([1, 794, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40249013900756836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4509892463684082  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 794, 128])
m.shape torch.Size([12098, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5092043876647949  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5092043876647949  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 12098, 128]), torch.Size([1, 12098, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5207419395446777  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3507800102233887  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 12098, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2763824462890625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2964153289794922  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3164482116699219  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2962584495544434  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([21006, 256])
first layer input nodes number: 70122
first layer output nodes number: 21006
edges number: 164096
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3169727325439453  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.337005615234375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3421297073364258  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3421297073364258  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([404, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.364436149597168  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.364436149597168  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3652067184448242  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.373016357421875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([397, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.37339448928833  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.37339448928833  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3741517066955566  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3890624046325684  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([286, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3895087242126465  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3895087242126465  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3900542259216309  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.403944492340088  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([230, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4045562744140625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4045562744140625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4049949645996094  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4177169799804688  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([194, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4184303283691406  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4184303283691406  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4188003540039062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4321212768554688  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([147, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.432784080505371  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.432784080505371  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4330644607543945  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4451208114624023  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([141, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4459295272827148  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4459295272827148  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4461984634399414  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4596452713012695  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4604029655456543  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4604029655456543  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4606242179870605  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4732356071472168  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([80, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4738173484802246  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4738173484802246  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4739699363708496  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4837355613708496  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4845051765441895  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4845051765441895  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.484673023223877  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4965901374816895  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.497204303741455  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.497204303741455  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4973301887512207  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5071492195129395  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5078129768371582  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5078129768371582  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5079331398010254  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5181469917297363  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([63, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.518874168395996  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.518874168395996  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5189943313598633  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5300493240356445  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5306220054626465  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5306220054626465  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5307116508483887  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5395865440368652  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5401043891906738  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5401043891906738  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5401787757873535  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5480637550354004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5485496520996094  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5485496520996094  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.548614501953125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5559425354003906  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5564332008361816  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5564332008361816  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5564942359924316  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5638184547424316  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5643072128295898  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5643072128295898  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5643644332885742  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5716314315795898  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5720596313476562  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5720596313476562  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5721073150634766  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5784969329833984  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5791077613830566  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5791077613830566  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5791707038879395  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.588045597076416  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5883374214172363  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5883374214172363  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5883679389953613  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5928845405578613  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.593228816986084  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.593228816986084  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5932612419128418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5982871055603027  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5986027717590332  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5986027717590332  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5986313819885254  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6032662391662598  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.603506088256836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.603506088256836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6035270690917969  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6070728302001953  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([268, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.613502025604248  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.613502025604248  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6140131950378418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.705824375152588  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 268, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6865849494934082  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6870088577270508  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6874327659606934  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6869874000549316  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([2842, 40])
input nodes number: 21006
output nodes number: 2842
edges number: 22669
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6871657371520996  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6871662139892578  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04896688461303711  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

pseudo mini batch 18 input nodes size: 71400
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04498624801635742  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04498624801635742  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07903242111206055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07905387878417969  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045595645904541016  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04704427719116211  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04704427719116211  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04704427719116211  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([71400, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04704427719116211  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([826, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13155031204223633  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13155031204223633  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 826, 128]), torch.Size([1, 826, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1323380470275879  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1386399269104004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 826, 128])
m.shape torch.Size([1089, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13928461074829102  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13928461074829102  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.14032316207885742  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15590143203735352  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([1145, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15702009201049805  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15702009201049805  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1145, 128]), torch.Size([1, 1145, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1581120491027832  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1825571060180664  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1145, 128])
m.shape torch.Size([1083, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18407678604125977  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18407678604125977  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1083, 128]), torch.Size([1, 1083, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18510961532592773  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21588373184204102  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1083, 128])
m.shape torch.Size([1074, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2179279327392578  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2179279327392578  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1074, 128]), torch.Size([1, 1074, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21895217895507812  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25632190704345703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1074, 128])
m.shape torch.Size([977, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2586050033569336  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2586050033569336  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 977, 128]), torch.Size([1, 977, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2595367431640625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30049800872802734  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 977, 128])
m.shape torch.Size([929, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3031330108642578  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3031330108642578  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 929, 128]), torch.Size([1, 929, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3040189743041992  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34856557846069336  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 929, 128])
m.shape torch.Size([886, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3515024185180664  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3515024185180664  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 886, 128]), torch.Size([1, 886, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35234737396240234  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4020662307739258  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 886, 128])
m.shape torch.Size([870, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4053773880004883  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4053773880004883  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4062070846557617  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4599266052246094  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([12698, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5200605392456055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5200605392456055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 12698, 128]), torch.Size([1, 12698, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.532954216003418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3930749893188477  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 12698, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3148698806762695  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3354473114013672  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3560247421264648  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3352861404418945  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([21577, 256])
first layer input nodes number: 71400
first layer output nodes number: 21577
edges number: 170404
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3565587997436523  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.37713623046875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3822808265686035  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3822808265686035  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([423, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4064321517944336  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4064321517944336  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4072389602661133  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4140310287475586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([340, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4142813682556152  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4142813682556152  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4149298667907715  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4250121116638184  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([272, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4254722595214844  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4254722595214844  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4259910583496094  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4385299682617188  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([220, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4391164779663086  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4391164779663086  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4395360946655273  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.451704978942871  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([215, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.452674388885498  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.452674388885498  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4530844688415527  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4678473472595215  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([138, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4684381484985352  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4684381484985352  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4687013626098633  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4800195693969727  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4808030128479004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4808030128479004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.481062412261963  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.494032382965088  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([121, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4948334693908691  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4948334693908691  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4950642585754395  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5082192420959473  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5089950561523438  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5089950561523438  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5091915130615234  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5217647552490234  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5224356651306152  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5224356651306152  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5225882530212402  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5334219932556152  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5341496467590332  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5341496467590332  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.534294605255127  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5456013679504395  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5462555885314941  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5462555885314941  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5463757514953613  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5565896034240723  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5571417808532715  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5571417808532715  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5572352409362793  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.565833568572998  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.566352367401123  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.566352367401123  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5664324760437012  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5743632316589355  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.574756145477295  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.574756145477295  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5748133659362793  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.580878734588623  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5812807083129883  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5812807083129883  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.581334114074707  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5873689651489258  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5878324508666992  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5878324508666992  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5878896713256836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5947561264038086  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5951776504516602  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5951776504516602  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5952272415161133  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6015253067016602  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6019573211669922  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6019573211669922  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6020050048828125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6083946228027344  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6088900566101074  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6088900566101074  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6089415550231934  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6162028312683105  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.616560935974121  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.616560935974121  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6165971755981445  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6219606399536133  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6223444938659668  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6223444938659668  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6223807334899902  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.627997875213623  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6283116340637207  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6283116340637207  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.628340244293213  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6329751014709473  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.633284091949463  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.633284091949463  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6333107948303223  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6378235816955566  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([331, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.645763874053955  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.645763874053955  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.646395206451416  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7616510391235352  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 331, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7405333518981934  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.740957260131836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7413811683654785  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7409358024597168  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([2842, 40])
input nodes number: 21577
output nodes number: 2842
edges number: 23830
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7411184310913086  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7411189079284668  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04971933364868164  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

pseudo mini batch 19 input nodes size: 69760
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045595645904541016  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045595645904541016  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07885980606079102  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07888126373291016  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04481363296508789  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0462040901184082  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0462040901184082  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0462040901184082  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([69760, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0462040901184082  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([818, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1267232894897461  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1267232894897461  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 818, 128]), torch.Size([1, 818, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1275033950805664  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1337442398071289  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 818, 128])
m.shape torch.Size([1026, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13433265686035156  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13433265686035156  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1026, 128]), torch.Size([1, 1026, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13531112670898438  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.14998817443847656  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1026, 128])
m.shape torch.Size([1091, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15162944793701172  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15162944793701172  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15266990661621094  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1763629913330078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([1135, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1780076026916504  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1780076026916504  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1135, 128]), torch.Size([1, 1135, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17909002304077148  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21052789688110352  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1135, 128])
m.shape torch.Size([1023, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21242570877075195  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21242570877075195  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1023, 128]), torch.Size([1, 1023, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21340131759643555  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.24917030334472656  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1023, 128])
m.shape torch.Size([938, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25136613845825195  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25136613845825195  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 938, 128]), torch.Size([1, 938, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.252260684967041  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29130983352661133  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 938, 128])
m.shape torch.Size([930, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29396677017211914  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29396677017211914  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 930, 128]), torch.Size([1, 930, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29485368728637695  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.33968114852905273  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 930, 128])
m.shape torch.Size([906, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3426938056945801  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3426938056945801  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 906, 128]), torch.Size([1, 906, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34355783462524414  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39380693435668945  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 906, 128])
m.shape torch.Size([824, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3969111442565918  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3969111442565918  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39769697189331055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4487299919128418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([12112, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5069308280944824  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5069308280944824  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 12112, 128]), torch.Size([1, 12112, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5184817314147949  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3486666679382324  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 12112, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2742910385131836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2941303253173828  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.313969612121582  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2939748764038086  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([20803, 256])
first layer input nodes number: 69760
first layer output nodes number: 20803
edges number: 163720
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3144912719726562  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3343305587768555  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3398208618164062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3398208618164062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([407, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.362229347229004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.362229347229004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3630056381225586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3706855773925781  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([348, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3709664344787598  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3709664344787598  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3716301918029785  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3859734535217285  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([307, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3865270614624023  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3865270614624023  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3871126174926758  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.401163101196289  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([244, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.401808738708496  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.401808738708496  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4022741317749023  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4157705307006836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([213, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.416614055633545  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.416614055633545  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.417020320892334  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4316458702087402  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4323596954345703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4323596954345703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4326629638671875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4457035064697266  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([116, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4463324546813965  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4463324546813965  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4465537071228027  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4576163291931152  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4583592414855957  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4583592414855957  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.458570957183838  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4706387519836426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([97, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.471372127532959  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.471372127532959  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4715571403503418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4833979606628418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.484055519104004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.484055519104004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4842042922973633  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.494767189025879  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4954967498779297  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4954967498779297  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4956417083740234  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.506948471069336  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5075106620788574  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5075106620788574  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.507615566253662  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5165324211120605  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5173425674438477  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5173425674438477  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5174741744995117  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5295820236206055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5300006866455078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5300006866455078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.530069351196289  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5368671417236328  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5374960899353027  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5374960899353027  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.537583827972412  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5468840599060059  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5473322868347168  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5473322868347168  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5473933219909668  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5542902946472168  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5547828674316406  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5547828674316406  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5548439025878906  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5621681213378906  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5626397132873535  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5626397132873535  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.562695026397705  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5697197914123535  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5701308250427246  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5701308250427246  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.570176601409912  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.576310634613037  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5766725540161133  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5766725540161133  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5767107009887695  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5820894241333008  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5825753211975098  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5825753211975098  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.58262300491333  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5896801948547363  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5900583267211914  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5900583267211914  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5900945663452148  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5957117080688477  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.596003532409668  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.596003532409668  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5960302352905273  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.600356101989746  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.600527286529541  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.600527286529541  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6005425453186035  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.603121280670166  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([277, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6097698211669922  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6097698211669922  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6102981567382812  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7047700881958008  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 277, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6854228973388672  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6858468055725098  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6862707138061523  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6858253479003906  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([2842, 40])
input nodes number: 20803
output nodes number: 2842
edges number: 22775
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.686002254486084  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6860027313232422  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0487828254699707  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

pseudo mini batch 20 input nodes size: 70483
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04481363296508789  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04481363296508789  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07842254638671875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07844400405883789  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04515838623046875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04657268524169922  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04657268524169922  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04657268524169922  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([70483, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04657268524169922  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([811, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12842559814453125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12842559814453125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 811, 128]), torch.Size([1, 811, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12919902801513672  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13538646697998047  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 811, 128])
m.shape torch.Size([1075, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13605546951293945  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13605546951293945  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1075, 128]), torch.Size([1, 1075, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13708066940307617  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15245866775512695  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1075, 128])
m.shape torch.Size([1103, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15352392196655273  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15352392196655273  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15457582473754883  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17817115783691406  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([1116, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18034601211547852  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18034601211547852  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1116, 128]), torch.Size([1, 1116, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1814103126525879  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21264886856079102  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1116, 128])
m.shape torch.Size([1065, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21465587615966797  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21465587615966797  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1065, 128]), torch.Size([1, 1065, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21567153930664062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2526850700378418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1065, 128])
m.shape torch.Size([977, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2549724578857422  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2549724578857422  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 977, 128]), torch.Size([1, 977, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2559041976928711  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29686546325683594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 977, 128])
m.shape torch.Size([921, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29947376251220703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29947376251220703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 921, 128]), torch.Size([1, 921, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3003520965576172  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3450169563293457  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 921, 128])
m.shape torch.Size([870, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3478965759277344  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3478965759277344  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3487262725830078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39601993560791016  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([804, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39905548095703125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39905548095703125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 804, 128]), torch.Size([1, 804, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3998222351074219  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.44901084899902344  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 804, 128])
m.shape torch.Size([12401, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5077600479125977  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5077600479125977  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 12401, 128]), torch.Size([1, 12401, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5195865631103516  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.359269142150879  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 12401, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2836079597473145  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3037714958190918  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3239350318908691  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3036136627197266  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([21143, 256])
first layer input nodes number: 70483
first layer output nodes number: 21143
edges number: 166574
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3244624137878418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3446259498596191  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3496670722961426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3496670722961426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([410, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3724479675292969  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3724479675292969  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.37322998046875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3800067901611328  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([356, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.380300521850586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.380300521850586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3809795379638672  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.393442153930664  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([289, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3939361572265625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3939361572265625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3944873809814453  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4099822044372559  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([240, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4106292724609375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4106292724609375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4110870361328125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4243621826171875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([185, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4250226020812988  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4250226020812988  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4253754615783691  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4380784034729004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.438796043395996  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.438796043395996  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.439091682434082  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4518041610717773  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.452591896057129  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.452591896057129  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4528570175170898  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4661130905151367  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.466865062713623  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.466865062713623  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4670844078063965  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4795870780944824  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([99, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4803338050842285  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4803338050842285  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.480522632598877  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.492607593536377  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.493359088897705  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.493359088897705  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4935269355773926  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.505444049835205  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5060687065124512  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5060687065124512  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5061964988708496  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5161643028259277  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5169081687927246  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5169081687927246  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5170416831970215  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5283904075622559  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.528961181640625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.528961181640625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5290584564208984  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5380077362060547  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.538416862487793  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.538416862487793  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5384817123413086  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5449018478393555  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.545417308807373  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.545417308807373  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.54548978805542  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5531725883483887  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.553689956665039  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.553689956665039  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5537586212158203  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5615177154541016  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.561941146850586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.561941146850586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5619945526123047  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5684032440185547  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5690512657165527  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5690512657165527  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5691256523132324  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5785727500915527  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5789008140563965  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5789008140563965  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5789389610290527  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5840506553649902  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5845317840576172  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5845317840576172  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5845813751220703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.591573715209961  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5919933319091797  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5919933319091797  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5920352935791016  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.598245620727539  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5984997749328613  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5984997749328613  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.598524570465088  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.602367877960205  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6026654243469238  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6026654243469238  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6026921272277832  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.607017993927002  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6074433326721191  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6074433326721191  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6074795722961426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6136040687561035  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([289, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.620530128479004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.620530128479004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6210813522338867  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7350239753723145  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 289, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7152986526489258  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7157225608825684  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.716146469116211  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7157011032104492  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([2842, 40])
input nodes number: 21143
output nodes number: 2842
edges number: 23159
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7158803939819336  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7158808708190918  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04919147491455078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

pseudo mini batch 21 input nodes size: 70286
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04515838623046875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04515838623046875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0786733627319336  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07869482040405273  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045064449310302734  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046475887298583984  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046475887298583984  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046475887298583984  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([70286, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046475887298583984  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([795, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12815189361572266  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12815189361572266  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12891006469726562  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13497543334960938  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([1081, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1358504295349121  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1358504295349121  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1081, 128]), torch.Size([1, 1081, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13688135147094727  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1523451805114746  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1081, 128])
m.shape torch.Size([1218, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15357208251953125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15357208251953125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1218, 128]), torch.Size([1, 1218, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15473365783691406  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18129634857177734  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1218, 128])
m.shape torch.Size([1127, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18286514282226562  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18286514282226562  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1127, 128]), torch.Size([1, 1127, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18393993377685547  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21529388427734375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1127, 128])
m.shape torch.Size([1092, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2173600196838379  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2173600196838379  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21840143203735352  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25667810440063477  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([974, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.258944034576416  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.258944034576416  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 974, 128]), torch.Size([1, 974, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2598729133605957  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3009915351867676  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 974, 128])
m.shape torch.Size([954, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3037114143371582  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3037114143371582  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 954, 128]), torch.Size([1, 954, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30462121963500977  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3501114845275879  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 954, 128])
m.shape torch.Size([886, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35303640365600586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35303640365600586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 886, 128]), torch.Size([1, 886, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3538813591003418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4033036231994629  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 886, 128])
m.shape torch.Size([817, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4063873291015625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4063873291015625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 817, 128]), torch.Size([1, 817, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4071664810180664  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4596428871154785  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 817, 128])
m.shape torch.Size([12268, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5178470611572266  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5178470611572266  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 12268, 128]), torch.Size([1, 12268, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5295467376708984  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.361368179321289  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 12268, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.285970687866211  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3062000274658203  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3264293670654297  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3060417175292969  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([21212, 256])
first layer input nodes number: 70286
first layer output nodes number: 21212
edges number: 166222
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3269553184509277  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.347184658050537  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3523459434509277  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3523459434509277  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([432, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.375098705291748  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.375098705291748  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.375922679901123  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3835158348083496  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([369, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3838133811950684  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3838133811950684  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3845171928405762  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3971896171569824  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([302, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3977088928222656  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3977088928222656  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.398284912109375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4115495681762695  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([217, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4120960235595703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4120960235595703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4125099182128906  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4245128631591797  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([174, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4251422882080078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4251422882080078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4254741668701172  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4374217987060547  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([137, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4380459785461426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4380459785461426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.438307285308838  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4495434761047363  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4502739906311035  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4502739906311035  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4505181312561035  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4627251625061035  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([122, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4635415077209473  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4635415077209473  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4637742042541504  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4770379066467285  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([97, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4777607917785645  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4777607917785645  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4779458045959473  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4897866249084473  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.490501880645752  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.490501880645752  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4906620979309082  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.502037525177002  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5026764869689941  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5026764869689941  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5028061866760254  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.512922763824463  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5136079788208008  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5136079788208008  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5137319564819336  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5242700576782227  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5248332023620605  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5248332023620605  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5249285697937012  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5337023735046387  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5343413352966309  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5343413352966309  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5344386100769043  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5440688133239746  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5445680618286133  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5445680618286133  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5446405410766602  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.552323341369629  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5528101921081543  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5528101921081543  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.55287504196167  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5602030754089355  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5607590675354004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5607590675354004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5608277320861816  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5690674781799316  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5696563720703125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5696563720703125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5697250366210938  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5784454345703125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5787949562072754  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5787949562072754  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5788350105285645  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5842022895812988  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5845861434936523  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5845861434936523  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5846261978149414  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5902738571166992  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5908193588256836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5908193588256836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5908727645874023  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5987768173217773  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.599046230316162  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.599046230316162  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5990729331970215  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6032118797302246  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6035523414611816  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6035523414611816  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6035828590393066  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6085267066955566  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6087656021118164  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6087656021118164  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6087865829467773  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6123323440551758  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([291, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6202077865600586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6202077865600586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.620762825012207  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7212810516357422  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 291, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7020816802978516  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7025055885314941  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7029294967651367  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.702484130859375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([2842, 40])
input nodes number: 21212
output nodes number: 2842
edges number: 23109
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7026638984680176  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7026643753051758  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.049091339111328125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

pseudo mini batch 22 input nodes size: 71071
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045064449310302734  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045064449310302734  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07895374298095703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07897520065307617  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04543876647949219  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046901702880859375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046901702880859375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046901702880859375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([71071, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046901702880859375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([823, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13143014907836914  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13143014907836914  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13221502304077148  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13887643814086914  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([1039, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13947486877441406  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13947486877441406  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1039, 128]), torch.Size([1, 1039, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.14046573638916016  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15532875061035156  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1039, 128])
m.shape torch.Size([1145, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15647125244140625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15647125244140625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1145, 128]), torch.Size([1, 1145, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1575632095336914  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18158626556396484  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1145, 128])
m.shape torch.Size([1170, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1832718849182129  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1832718849182129  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1170, 128]), torch.Size([1, 1170, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1843876838684082  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21674585342407227  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1170, 128])
m.shape torch.Size([1136, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21889638900756836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21889638900756836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1136, 128]), torch.Size([1, 1136, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21997976303100586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25901174545288086  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1136, 128])
m.shape torch.Size([1032, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.26142263412475586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.26142263412475586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1032, 128]), torch.Size([1, 1032, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2624068260192871  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30481863021850586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1032, 128])
m.shape torch.Size([986, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3076176643371582  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3076176643371582  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 986, 128]), torch.Size([1, 986, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30855798721313477  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3569674491882324  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 986, 128])
m.shape torch.Size([897, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35991907119750977  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35991907119750977  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 897, 128]), torch.Size([1, 897, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.36077451705932617  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.41152000427246094  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 897, 128])
m.shape torch.Size([872, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.41483449935913086  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.41483449935913086  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 872, 128]), torch.Size([1, 872, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4156661033630371  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.47046804428100586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 872, 128])
m.shape torch.Size([12722, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5307154655456543  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5307154655456543  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 12722, 128]), torch.Size([1, 12722, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5428481101989746  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4047050476074219  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 12722, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3265976905822754  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3474087715148926  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3682198524475098  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3472461700439453  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([21822, 256])
first layer input nodes number: 71071
first layer output nodes number: 21822
edges number: 172034
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3687515258789062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3895626068115234  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3947653770446777  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3947653770446777  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([389, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4188838005065918  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4188838005065918  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4196257591247559  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.426626205444336  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([358, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4269437789916992  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4269437789916992  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.427626609802246  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4387636184692383  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([275, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4392151832580566  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4392151832580566  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.43973970413208  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4519658088684082  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([223, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4525609016418457  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4525609016418457  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.452986240386963  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4653210639953613  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([190, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4660215377807617  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4660215377807617  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.466383934020996  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4794301986694336  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.480189323425293  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.480189323425293  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4805002212524414  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4938688278198242  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([110, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4944539070129395  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4944539070129395  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4946637153625488  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5051541328430176  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5058951377868652  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5058951377868652  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5061049461364746  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.518064022064209  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([110, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5189108848571777  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5189108848571777  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.519120693206787  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.532548427581787  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.533116340637207  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.533116340637207  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.533249855041504  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.542729377746582  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([80, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.543508529663086  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.543508529663086  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.543661117553711  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.555562973022461  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5562944412231445  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5562944412231445  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5564279556274414  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5677766799926758  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5684223175048828  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5684223175048828  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5685310363769531  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5785331726074219  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([55, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5792193412780762  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5792193412780762  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5793242454528809  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.589709758758545  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.590407371520996  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.590407371520996  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5905065536499023  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6010198593139648  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6015396118164062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6015396118164062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6016101837158203  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6095848083496094  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.61008882522583  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.61008882522583  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.610151767730713  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6177048683166504  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([16, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.617950439453125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.617950439453125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.61798095703125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.621856689453125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6223711967468262  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6223711967468262  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6224265098571777  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.629838466644287  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6304645538330078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6304645538330078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6305294036865234  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6396732330322266  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6400041580200195  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6400041580200195  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6400384902954102  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6451196670532227  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6453566551208496  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6453566551208496  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6453795433044434  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6489272117614746  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6492695808410645  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6492695808410645  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6493000984191895  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6542439460754395  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6546211242675781  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6546211242675781  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.654653549194336  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6601333618164062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([318, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6677584648132324  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6677584648132324  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6683650016784668  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7769665718078613  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 318, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7558636665344238  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7562875747680664  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.756711483001709  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7562661170959473  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([2842, 40])
input nodes number: 21822
output nodes number: 2842
edges number: 24141
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7564501762390137  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7564506530761719  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04959535598754883  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

pseudo mini batch 23 input nodes size: 70325
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04543876647949219  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04543876647949219  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07897233963012695  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0789937973022461  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045083045959472656  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046484947204589844  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046484947204589844  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046484947204589844  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([70325, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046484947204589844  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([861, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12766408920288086  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12766408920288086  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 861, 128]), torch.Size([1, 861, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12848520278930664  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1350574493408203  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 861, 128])
m.shape torch.Size([1127, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13572168350219727  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13572168350219727  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1127, 128]), torch.Size([1, 1127, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1367964744567871  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15291833877563477  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1127, 128])
m.shape torch.Size([1120, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15398311614990234  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15398311614990234  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1120, 128]), torch.Size([1, 1120, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15505123138427734  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1787281036376953  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1120, 128])
m.shape torch.Size([1152, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1806354522705078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1806354522705078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1152, 128]), torch.Size([1, 1152, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1817340850830078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2135944366455078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1152, 128])
m.shape torch.Size([1095, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21565580368041992  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21565580368041992  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21670007705688477  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25502824783325195  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([1003, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25737571716308594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25737571716308594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1003, 128]), torch.Size([1, 1003, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2583322525024414  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3007345199584961  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1003, 128])
m.shape torch.Size([945, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30341053009033203  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30341053009033203  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 945, 128]), torch.Size([1, 945, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30431175231933594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34943628311157227  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 945, 128])
m.shape torch.Size([890, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35238075256347656  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35238075256347656  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3532295227050781  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40294504165649414  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([824, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40605688095092773  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40605688095092773  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4068427085876465  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.45944738388061523  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([12141, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5176482200622559  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5176482200622559  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 12141, 128]), torch.Size([1, 12141, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5292267799377441  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3603076934814453  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 12141, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2854647636413574  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3056426048278809  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3258204460144043  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3054847717285156  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([21158, 256])
first layer input nodes number: 70325
first layer output nodes number: 21158
edges number: 165137
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3263463973999023  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3465242385864258  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3517370223999023  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3517370223999023  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([420, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3742594718933105  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3742594718933105  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3750605583190918  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3826050758361816  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([367, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3829102516174316  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3829102516174316  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3836102485656738  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.397270679473877  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([277, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.397719383239746  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.397719383239746  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3982477188110352  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.411329746246338  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([255, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.412045955657959  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.412045955657959  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4125323295593262  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4266371726989746  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([191, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.427311897277832  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.427311897277832  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4276762008666992  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.440791130065918  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4415030479431152  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4415030479431152  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4417986869812012  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4545111656188965  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4552650451660156  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4552650451660156  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4555206298828125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4682998657226562  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.469010353088379  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.469010353088379  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4692182540893555  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4810686111450195  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4818906784057617  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4818906784057617  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4820947647094727  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4951562881469727  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4958906173706055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4958906173706055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4960565567016602  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.507838249206543  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5084214210510254  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5084214210510254  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5085415840148926  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5179142951965332  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5184311866760254  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5184311866760254  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.518526554107666  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5266327857971191  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5272350311279297  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5272350311279297  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.527334213256836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.536458969116211  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5369749069213867  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5369749069213867  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5370550155639648  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5449857711791992  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5454506874084473  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5454506874084473  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5455174446105957  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.55259370803833  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5529603958129883  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5529603958129883  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5530099868774414  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5586137771606445  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5591282844543457  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5591282844543457  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5591912269592285  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.566744327545166  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5673184394836426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5673184394836426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.567385196685791  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5758633613586426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.576432704925537  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.576432704925537  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.57649564743042  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5849299430847168  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.585263729095459  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.585263729095459  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5852999687194824  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.590409755706787  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5906744003295898  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5906744003295898  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5907011032104492  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5946531295776367  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5949783325195312  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5949783325195312  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5950088500976562  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5997390747070312  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6000556945800781  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6000556945800781  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6000843048095703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6047191619873047  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6050047874450684  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6050047874450684  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.605029582977295  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.609220027923584  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([294, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.61627197265625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.61627197265625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6168327331542969  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.717912197113037  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 294, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6984481811523438  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6988720893859863  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.699295997619629  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6988506317138672  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([2842, 40])
input nodes number: 21158
output nodes number: 2842
edges number: 22882
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6990299224853516  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6990303993225098  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0490880012512207  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

pseudo mini batch 24 input nodes size: 71373
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045083045959472656  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045083045959472656  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0791163444519043  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07913780212402344  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04558277130126953  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.047016143798828125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.047016143798828125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.047016143798828125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([71373, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.047016143798828125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([776, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1299896240234375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1299896240234375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 776, 128]), torch.Size([1, 776, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13072967529296875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1366591453552246  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 776, 128])
m.shape torch.Size([1064, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13730382919311523  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13730382919311523  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1064, 128]), torch.Size([1, 1064, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13831853866577148  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15353918075561523  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1064, 128])
m.shape torch.Size([1143, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15466690063476562  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15466690063476562  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1143, 128]), torch.Size([1, 1143, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15575695037841797  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17973804473876953  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1143, 128])
m.shape torch.Size([1111, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18131208419799805  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18131208419799805  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1111, 128]), torch.Size([1, 1111, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1823716163635254  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21349668502807617  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1111, 128])
m.shape torch.Size([1083, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21554899215698242  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21554899215698242  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1083, 128]), torch.Size([1, 1083, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2165818214416504  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2548856735229492  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1083, 128])
m.shape torch.Size([922, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2570071220397949  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2570071220397949  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 922, 128]), torch.Size([1, 922, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2578864097595215  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29633474349975586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 922, 128])
m.shape torch.Size([978, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29915952682495117  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29915952682495117  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 978, 128]), torch.Size([1, 978, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3000922203063965  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34760427474975586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 978, 128])
m.shape torch.Size([887, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3505215644836426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3505215644836426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 887, 128]), torch.Size([1, 887, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3513674736022949  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4009590148925781  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 887, 128])
m.shape torch.Size([797, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40395641326904297  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40395641326904297  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 797, 128]), torch.Size([1, 797, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40471649169921875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.45336151123046875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 797, 128])
m.shape torch.Size([12607, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5130963325500488  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5130963325500488  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 12607, 128]), torch.Size([1, 12607, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5251193046569824  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3792648315429688  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 12607, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3024959564208984  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3228740692138672  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.343252182006836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3227148056030273  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([21368, 256])
first layer input nodes number: 71373
first layer output nodes number: 21368
edges number: 168909
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3437862396240234  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3641643524169922  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3692588806152344  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3692588806152344  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([387, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3921761512756348  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3921761512756348  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3929142951965332  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.398880958557129  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([365, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3992137908935547  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3992137908935547  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3999099731445312  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4107775688171387  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 365, 256])
m.shape torch.Size([288, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4112601280212402  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4112601280212402  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4118094444274902  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4258475303649902  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([237, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4264841079711914  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4264841079711914  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.426936149597168  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4400453567504883  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([203, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4407949447631836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4407949447631836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4411821365356445  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4551210403442383  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([143, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4557523727416992  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4557523727416992  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4560251235961914  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4677534103393555  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([143, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4685792922973633  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4685792922973633  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4688520431518555  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4824895858764648  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4832606315612793  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4832606315612793  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4834856986999512  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.496314525604248  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.497006893157959  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.497006893157959  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4971842765808105  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5085368156433105  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5093035697937012  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5093035697937012  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5094733238220215  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5215258598327637  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5221920013427734  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5221920013427734  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5223274230957031  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5328903198242188  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.533480167388916  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.533480167388916  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5335888862609863  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.542829990386963  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5435004234313965  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5435004234313965  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5436110496520996  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.553788661956787  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5542716979980469  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5542716979980469  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5543479919433594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5619010925292969  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.562511920928955  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.562511920928955  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5625977516174316  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5716958045959473  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5721759796142578  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5721759796142578  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5722408294677734  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.579568862915039  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.580026626586914  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.580026626586914  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5800838470458984  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5869503021240234  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.587371826171875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.587371826171875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5874214172363281  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.593719482421875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5941882133483887  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5941882133483887  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5942397117614746  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6011404991149902  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6016149520874023  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6016149520874023  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6016645431518555  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.608656883239746  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6090965270996094  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6090965270996094  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.609140396118164  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6156330108642578  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6160554885864258  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6160554885864258  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6160955429077148  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6223039627075195  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6227703094482422  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6227703094482422  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.622812271118164  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6296100616455078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6298432350158691  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6298432350158691  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.62986421585083  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6334099769592285  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([285, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6402478218078613  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6402478218078613  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.640791416168213  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7461280822753906  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 285, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.726250171661377  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7266740798950195  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.727097988128662  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7266526222229004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([2842, 40])
input nodes number: 21368
output nodes number: 2842
edges number: 23323
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7268333435058594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7268338203430176  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.049666404724121094  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

pseudo mini batch 25 input nodes size: 70950
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04558277130126953  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04558277130126953  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07941436767578125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07943582534790039  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04538106918334961  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04680585861206055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04680585861206055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04680585861206055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([70950, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04680585861206055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([858, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12939071655273438  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12939071655273438  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 858, 128]), torch.Size([1, 858, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13020896911621094  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13703346252441406  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 858, 128])
m.shape torch.Size([1103, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13767623901367188  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13767623901367188  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13872814178466797  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15450668334960938  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([1200, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15656423568725586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15656423568725586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1200, 128]), torch.Size([1, 1200, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15770864486694336  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18288564682006836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1200, 128])
m.shape torch.Size([1090, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18439245223999023  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18439245223999023  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1090, 128]), torch.Size([1, 1090, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18543195724487305  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2161879539489746  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1090, 128])
m.shape torch.Size([1107, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2183074951171875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2183074951171875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1107, 128]), torch.Size([1, 1107, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21936321258544922  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2580599784851074  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1107, 128])
m.shape torch.Size([990, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2603645324707031  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2603645324707031  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 990, 128]), torch.Size([1, 990, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2613086700439453  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3034782409667969  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 990, 128])
m.shape torch.Size([870, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3059101104736328  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3059101104736328  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30673980712890625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3482246398925781  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([909, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35127735137939453  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35127735137939453  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3521442413330078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4027738571166992  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([795, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40575218200683594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40575218200683594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4065103530883789  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4557662010192871  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([12500, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5149917602539062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5149917602539062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 12500, 128]), torch.Size([1, 12500, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5269126892089844  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3742189407348633  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 12500, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2979493141174316  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3183789253234863  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.338808536529541  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3182191848754883  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([21422, 256])
first layer input nodes number: 70950
first layer output nodes number: 21422
edges number: 168016
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.339339256286621  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3597688674926758  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3648762702941895  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3648762702941895  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([447, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.387678623199463  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.387678623199463  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.38853120803833  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3953518867492676  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([356, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3956103324890137  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3956103324890137  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.396289348602295  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4074339866638184  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([321, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4080204963684082  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4080204963684082  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.408632755279541  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.423830509185791  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([221, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4243741035461426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4243741035461426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4247956275939941  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4370198249816895  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([181, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4376792907714844  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4376792907714844  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4380245208740234  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4504528045654297  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4511914253234863  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4511914253234863  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4514927864074707  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4644513130187988  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([106, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4650139808654785  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4650139808654785  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4652161598205566  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.475325107574463  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.476008415222168  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.476008415222168  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4762029647827148  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4872922897338867  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4880776405334473  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4880776405334473  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4882721900939941  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5007233619689941  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5013184547424316  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5013184547424316  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5014557838439941  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5112061500549316  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5118565559387207  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5118565559387207  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.511986255645752  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5221028327941895  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5227761268615723  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5227761268615723  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5228981971740723  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5332741737365723  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5337629318237305  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5337629318237305  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5338468551635742  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5415678024291992  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.541996955871582  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.541996955871582  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5420637130737305  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5486726760864258  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5493316650390625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5493316650390625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5494232177734375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5591278076171875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5594511032104492  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5594511032104492  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5594968795776367  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5646696090698242  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5651206970214844  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5651206970214844  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.565176010131836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5718135833740234  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5722532272338867  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5722532272338867  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5723047256469727  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5788450241088867  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.579385757446289  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.579385757446289  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5794448852539062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5873680114746094  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5878000259399414  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5878000259399414  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.587845802307129  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5943002700805664  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.594721794128418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.594721794128418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5947637557983398  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6009740829467773  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6013760566711426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6013760566711426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6014142036437988  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6073269844055176  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.607595443725586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.607595443725586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6076202392578125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6116371154785156  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6119709014892578  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6119709014892578  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.61199951171875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6168346405029297  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([312, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6243171691894531  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6243171691894531  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6249122619628906  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7418122291564941  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 312, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.722078800201416  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7225027084350586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7229266166687012  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7224812507629395  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([2842, 40])
input nodes number: 21422
output nodes number: 2842
edges number: 23146
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7226624488830566  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7226629257202148  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04944419860839844  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

pseudo mini batch 26 input nodes size: 69359
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04538106918334961  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04538106918334961  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07858419418334961  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07860565185546875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04614591598510742  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04614591598510742  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04614591598510742  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([69359, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04614591598510742  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([806, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12666606903076172  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12666606903076172  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12743473052978516  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13440942764282227  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([1061, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13503694534301758  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13503694534301758  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1061, 128]), torch.Size([1, 1061, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1360487937927246  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15122652053833008  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1061, 128])
m.shape torch.Size([1116, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15231704711914062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15231704711914062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1116, 128]), torch.Size([1, 1116, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15338134765625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17679595947265625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1116, 128])
m.shape torch.Size([1107, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17876625061035156  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17876625061035156  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1107, 128]), torch.Size([1, 1107, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17982196807861328  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2109661102294922  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1107, 128])
m.shape torch.Size([1041, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2129201889038086  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2129201889038086  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1041, 128]), torch.Size([1, 1041, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2139129638671875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2504401206970215  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1041, 128])
m.shape torch.Size([1008, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25282764434814453  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25282764434814453  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1008, 128]), torch.Size([1, 1008, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25378894805908203  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29543018341064453  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1008, 128])
m.shape torch.Size([909, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29798364639282227  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29798364639282227  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29885053634643555  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34335899353027344  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([890, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34632062911987305  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34632062911987305  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3471693992614746  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39719343185424805  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([767, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40006065368652344  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40006065368652344  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 767, 128]), torch.Size([1, 767, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40079212188720703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4485201835632324  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 767, 128])
m.shape torch.Size([12151, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5067481994628906  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5067481994628906  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 12151, 128]), torch.Size([1, 12151, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5189070701599121  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.349501132965088  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 12151, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2751264572143555  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2950162887573242  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.314906120300293  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.29486083984375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([20856, 256])
first layer input nodes number: 69359
first layer output nodes number: 20856
edges number: 163853
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.315424919128418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3353147506713867  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.340815544128418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.340815544128418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([422, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.363471508026123  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.363471508026123  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.36427640914917  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3723335266113281  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([381, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3726634979248047  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3726634979248047  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3733901977539062  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3871030807495117  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([256, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3874778747558594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3874778747558594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3879661560058594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3987083435058594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([253, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3994369506835938  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3994369506835938  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3999195098876953  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4139137268066406  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([188, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4145760536193848  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4145760536193848  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4149346351623535  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4278435707092285  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4285755157470703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4285755157470703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4288768768310547  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4418354034423828  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([122, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4425058364868164  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4425058364868164  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4427385330200195  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4543733596801758  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4551262855529785  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4551262855529785  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4553418159484863  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4676270484924316  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4682979583740234  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4682979583740234  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4684696197509766  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4794559478759766  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4801201820373535  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4801201820373535  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.480268955230713  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4908318519592285  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4915294647216797  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4915294647216797  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.491668701171875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5025291442871094  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5031747817993164  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5031747817993164  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5032930374145508  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5133447647094727  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5140228271484375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5140228271484375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5141353607177734  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5244884490966797  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5249977111816406  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5249977111816406  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5250778198242188  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5330085754394531  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5336174964904785  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5336174964904785  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.533703327178955  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5428013801574707  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5432662963867188  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5432662963867188  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5433292388916016  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5504417419433594  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5509824752807617  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5509824752807617  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5510492324829102  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5590600967407227  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5595459938049316  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5595459938049316  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.559603214263916  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5668702125549316  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5673165321350098  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5673165321350098  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.567366123199463  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5740113258361816  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5743904113769531  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5743904113769531  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5744304656982422  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.580078125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5805425643920898  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5805425643920898  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5805883407592773  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5873632431030273  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5878057479858398  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5878057479858398  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5878477096557617  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5943517684936523  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.594618320465088  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.594618320465088  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5946431159973145  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5986599922180176  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.599109172821045  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.599109172821045  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5991473197937012  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6055941581726074  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([276, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6122069358825684  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6122069358825684  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6127333641052246  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7080044746398926  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 276, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6884269714355469  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6888508796691895  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.689274787902832  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6888294219970703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([2842, 40])
input nodes number: 20856
output nodes number: 2842
edges number: 23021
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6890063285827637  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6890068054199219  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.048726558685302734  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

pseudo mini batch 27 input nodes size: 70708
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07846879959106445  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0784902572631836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04526567459106445  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04671812057495117  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04671812057495117  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04671812057495117  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([70708, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04671812057495117  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([876, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13124895095825195  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13124895095825195  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 876, 128]), torch.Size([1, 876, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13208436965942383  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13876771926879883  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 876, 128])
m.shape torch.Size([1051, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13935232162475586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13935232162475586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.14035463333129883  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15538930892944336  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([1080, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15643310546875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15643310546875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15746307373046875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18012237548828125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([1040, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18159103393554688  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18159103393554688  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1040, 128]), torch.Size([1, 1040, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18258285522460938  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21134567260742188  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1040, 128])
m.shape torch.Size([1013, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21326494216918945  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21326494216918945  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1013, 128]), torch.Size([1, 1013, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21423101425170898  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.24921941757202148  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1013, 128])
m.shape torch.Size([926, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2513856887817383  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2513856887817383  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 926, 128]), torch.Size([1, 926, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25226879119873047  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2909994125366211  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 926, 128])
m.shape torch.Size([912, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29360198974609375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29360198974609375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 912, 128]), torch.Size([1, 912, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29447174072265625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3391876220703125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 912, 128])
m.shape torch.Size([850, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3419952392578125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3419952392578125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 850, 128]), torch.Size([1, 850, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3428058624267578  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3890876770019531  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 850, 128])
m.shape torch.Size([773, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3919997215270996  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3919997215270996  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 773, 128]), torch.Size([1, 773, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39273691177368164  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.44144344329833984  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 773, 128])
m.shape torch.Size([12964, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5035748481750488  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5035748481750488  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 12964, 128]), torch.Size([1, 12964, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5159382820129395  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4118142127990723  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 12964, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3334379196166992  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3539276123046875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3744173049926758  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3537673950195312  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([21485, 256])
first layer input nodes number: 70708
first layer output nodes number: 21485
edges number: 170780
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.374946117401123  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3954358100891113  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4005584716796875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4005584716796875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([445, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4247283935546875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4247283935546875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.425577163696289  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4329643249511719  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([370, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4332513809204102  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4332513809204102  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4339570999145508  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4446678161621094  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([282, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4451284408569336  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4451284408569336  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4456663131713867  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4586338996887207  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([208, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4591646194458008  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4591646194458008  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4595613479614258  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4710664749145508  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([191, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4717860221862793  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4717860221862793  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4721503257751465  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4852652549743652  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([137, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4858732223510742  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4858732223510742  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4861345291137695  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.497370719909668  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4980545043945312  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4980545043945312  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4982852935791016  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5098247528076172  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5105323791503906  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5105323791503906  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5107364654541016  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.522369384765625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5230631828308105  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5230631828308105  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5232386589050293  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5344691276550293  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5350542068481445  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5350542068481445  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5351877212524414  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5446672439575195  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5452561378479004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5452561378479004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5453743934631348  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.554598331451416  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.555185317993164  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.555185317993164  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5552921295166016  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.564371109008789  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5650053024291992  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5650053024291992  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.565110206604004  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5747613906860352  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5752744674682617  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5752744674682617  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5753545761108398  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5832853317260742  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.58392333984375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.58392333984375  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5840129852294922  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.593515396118164  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.593947410583496  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.593947410583496  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5940065383911133  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6006879806518555  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6012468338012695  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6012468338012695  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6013154983520508  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6095552444458008  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6099882125854492  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6099882125854492  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6100397109985352  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6165800094604492  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6170291900634766  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6170291900634766  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6170787811279297  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6237239837646484  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6240453720092773  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6240453720092773  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.624079704284668  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.628920555114746  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6293272972106934  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6293272972106934  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6293673515319824  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6352953910827637  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6355929374694824  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6355929374694824  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6356215476989746  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6400561332702637  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.640373706817627  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.640373706817627  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6404023170471191  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6450371742248535  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6455998420715332  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6455998420715332  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6456475257873535  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6537060737609863  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([343, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.661923885345459  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.661923885345459  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6625781059265137  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7785730361938477  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 343, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7574472427368164  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.757871150970459  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7582950592041016  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7578496932983398  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([2842, 40])
input nodes number: 21485
output nodes number: 2842
edges number: 23972
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7580313682556152  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7580318450927734  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04938983917236328  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

pseudo mini batch 28 input nodes size: 71603
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04526567459106445  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04526567459106445  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07940864562988281  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07943010330200195  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04569244384765625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04716300964355469  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04716300964355469  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04716300964355469  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([71603, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04716300964355469  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([821, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13229084014892578  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13229084014892578  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1330738067626953  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13933753967285156  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([1034, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1403064727783203  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1403064727783203  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1034, 128]), torch.Size([1, 1034, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.14129257202148438  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1560840606689453  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1034, 128])
m.shape torch.Size([1106, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15717315673828125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15717315673828125  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1106, 128]), torch.Size([1, 1106, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15822792053222656  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1819782257080078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1106, 128])
m.shape torch.Size([1067, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1834859848022461  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1834859848022461  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1067, 128]), torch.Size([1, 1067, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18450355529785156  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21401309967041016  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1067, 128])
m.shape torch.Size([1096, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21611738204956055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21611738204956055  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1096, 128]), torch.Size([1, 1096, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2171626091003418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2559237480163574  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1096, 128])
m.shape torch.Size([1039, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2583737373352051  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2583737373352051  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 1039, 128]), torch.Size([1, 1039, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25936460494995117  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3024592399597168  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 1039, 128])
m.shape torch.Size([971, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3052048683166504  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3052048683166504  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 971, 128]), torch.Size([1, 971, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30613088607788086  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3524317741394043  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 971, 128])
m.shape torch.Size([881, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3553295135498047  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3553295135498047  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 881, 128]), torch.Size([1, 881, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3561697006225586  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40409278869628906  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 881, 128])
m.shape torch.Size([829, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4080805778503418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4080805778503418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 829, 128]), torch.Size([1, 829, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4088711738586426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4605832099914551  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 829, 128])
m.shape torch.Size([12978, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5226879119873047  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5226879119873047  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 12978, 128]), torch.Size([1, 12978, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.535064697265625  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4368133544921875  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 12978, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.357992172241211  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3788032531738281  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3996143341064453  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3786406517028809  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

torch.Size([21822, 256])
first layer input nodes number: 71603
first layer output nodes number: 21822
edges number: 173275
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4001498222351074  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4209609031677246  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.426163673400879  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.426163673400879  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

m.shape torch.Size([402, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4502935409545898  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4502935409545898  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4510602951049805  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4587993621826172  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([355, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4590988159179688  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4590988159179688  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4597759246826172  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4701862335205078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([313, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.470750331878662  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.470750331878662  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4713473320007324  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4848394393920898  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([205, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4853291511535645  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4853291511535645  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.485720157623291  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4970593452453613  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([203, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4978394508361816  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4978394508361816  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4982266426086426  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5121655464172363  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5129237174987793  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5129237174987793  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5132384300231934  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.526771068572998  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5274548530578613  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5274548530578613  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.527693271636963  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.539614200592041  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5402946472167969  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5402946472167969  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5404930114746094  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5517997741699219  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.552487850189209  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.552487850189209  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.552661418914795  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.563769817352295  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5643658638000488  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5643658638000488  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5645012855529785  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5741162300109863  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5747146606445312  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5747146606445312  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5748348236083984  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.584207534790039  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5848512649536133  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5848512649536133  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5849676132202148  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5948572158813477  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5953741073608398  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5953741073608398  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5954618453979492  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6035337448120117  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6039743423461914  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6039743423461914  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6040430068969727  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6108407974243164  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.611426830291748  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.611426830291748  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.611508846282959  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6202025413513184  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6205921173095703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6205921173095703  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.620645523071289  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6266803741455078  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6272096633911133  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6272096633911133  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.627274513244629  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.635056495666504  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6355605125427246  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6355605125427246  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6356196403503418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6431288719177246  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6435742378234863  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6435742378234863  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6436238288879395  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6502690315246582  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6508402824401855  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6508402824401855  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6508994102478027  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6592364311218262  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.659590721130371  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.659590721130371  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6596269607543945  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6649904251098633  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6653742790222168  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6653742790222168  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6654105186462402  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.671027660369873  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6713857650756836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6713857650756836  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6714181900024414  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.676671028137207  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6770472526550293  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6770472526550293  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.677079677581787  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6825594902038574  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([337, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.690640926361084  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.690640926361084  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6912837028503418  GigaBytes
Max Memory Allocated: 1.8129892349243164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.805748462677002  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 337, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7846274375915527  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7850513458251953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.785475254058838  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7850298881530762  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21822
output nodes number: 2842
edges number: 24023
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7852139472961426  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7852144241333008  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04986715316772461  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 29 input nodes size: 71691
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04569244384765625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04569244384765625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07987737655639648  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07989883422851562  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045734405517578125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04718208312988281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04718208312988281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04718208312988281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([71691, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04718208312988281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([871, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13171052932739258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13171052932739258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 871, 128]), torch.Size([1, 871, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13254117965698242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13918638229370117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 871, 128])
m.shape torch.Size([1088, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13980865478515625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13980865478515625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1088, 128]), torch.Size([1, 1088, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.14084625244140625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15641021728515625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1088, 128])
m.shape torch.Size([1092, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1574535369873047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1574535369873047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1584949493408203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18140602111816406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([1121, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18302345275878906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18302345275878906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18409252166748047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2154388427734375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([1076, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2174696922302246  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2174696922302246  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1076, 128]), torch.Size([1, 1076, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21849584579467773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2555556297302246  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1076, 128])
m.shape torch.Size([984, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2578577995300293  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2578577995300293  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 984, 128]), torch.Size([1, 984, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25879621505737305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2999110221862793  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 984, 128])
m.shape torch.Size([914, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.302492618560791  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.302492618560791  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 914, 128]), torch.Size([1, 914, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30336427688598633  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34769201278686523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 914, 128])
m.shape torch.Size([886, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35063600540161133  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35063600540161133  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 886, 128]), torch.Size([1, 886, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35148096084594727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40131425857543945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 886, 128])
m.shape torch.Size([806, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40435075759887695  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40435075759887695  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4051194190979004  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4543137550354004  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([12757, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5147595405578613  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5147595405578613  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12757, 128]), torch.Size([1, 12757, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5269255638122559  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3907899856567383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12757, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3125643730163574  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3331589698791504  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3537535667419434  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3329977989196777  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21595, 256])
first layer input nodes number: 71691
first layer output nodes number: 21595
edges number: 170401
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3542900085449219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3748846054077148  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3800334930419922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3800334930419922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([438, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.404195785522461  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.404195785522461  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4050312042236328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4117145538330078  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([370, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.412008285522461  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.412008285522461  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4127140045166016  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4235782623291016  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([264, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4239869117736816  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4239869117736816  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4244904518127441  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4359889030456543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([226, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4366064071655273  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4366064071655273  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.437037467956543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.449538230895996  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([188, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4502263069152832  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4502263069152832  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.450584888458252  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.463493824005127  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([147, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4641623497009277  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4641623497009277  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4644427299499512  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.476499080657959  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4772000312805176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4772000312805176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4774384498596191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4893593788146973  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([97, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4899864196777344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4899864196777344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4901714324951172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5007171630859375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5013599395751953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5013599395751953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5015220642089844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5118980407714844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5126533508300781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5126533508300781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5128192901611328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5246009826660156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5252265930175781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5252265930175781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5253543853759766  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5353221893310547  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5360774993896484  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5360774993896484  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5362129211425781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5477237701416016  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5482559204101562  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5482559204101562  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5483474731445312  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5567703247070312  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.557424545288086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.557424545288086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5575237274169922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.567342758178711  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5677404403686523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5677404403686523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5677995681762695  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5740671157836914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5744681358337402  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5744681358337402  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.574521541595459  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5805563926696777  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5810527801513672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5810527801513672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5811138153076172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5884380340576172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.588857650756836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.588857650756836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.588907241821289  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.595205307006836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.595710277557373  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.595710277557373  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5957655906677246  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.603177547454834  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6037650108337402  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6037650108337402  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6038260459899902  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6124320030212402  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6129264831542969  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6129264831542969  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.61297607421875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6203155517578125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6208195686340332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6208195686340332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6208672523498535  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.628258228302002  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6285881996154785  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6285881996154785  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6286187171936035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6335625648498535  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6340317726135254  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6340317726135254  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6340718269348145  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.640841007232666  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([311, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6482939720153809  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6482939720153809  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6488871574401855  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7570419311523438  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 311, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.735945701599121  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7363696098327637  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7367935180664062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7363481521606445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21595
output nodes number: 2842
edges number: 23782
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7365307807922363  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7365312576293945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04985761642456055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 30 input nodes size: 70397
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045734405517578125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045734405517578125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07930231094360352  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07932376861572266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04511737823486328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04653167724609375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04653167724609375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04653167724609375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([70397, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04653167724609375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([868, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1284337043762207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1284337043762207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 868, 128]), torch.Size([1, 868, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12926149368286133  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1368107795715332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 868, 128])
m.shape torch.Size([1094, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13744020462036133  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13744020462036133  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13848352432250977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15413331985473633  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([1133, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15523242950439453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15523242950439453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1133, 128]), torch.Size([1, 1133, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1563129425048828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18016624450683594  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1133, 128])
m.shape torch.Size([1108, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18173933029174805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18173933029174805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1108, 128]), torch.Size([1, 1108, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18279600143432617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21395063400268555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1108, 128])
m.shape torch.Size([1093, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21602821350097656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21602821350097656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1093, 128]), torch.Size([1, 1093, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2170705795288086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25549745559692383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1093, 128])
m.shape torch.Size([972, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25775718688964844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25775718688964844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 972, 128]), torch.Size([1, 972, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2586841583251953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29854393005371094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 972, 128])
m.shape torch.Size([895, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3010678291320801  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3010678291320801  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 895, 128]), torch.Size([1, 895, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30192136764526367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3462381362915039  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 895, 128])
m.shape torch.Size([856, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3490767478942871  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3490767478942871  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 856, 128]), torch.Size([1, 856, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34989309310913086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3964247703552246  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 856, 128])
m.shape torch.Size([821, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3995399475097656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3995399475097656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40032291412353516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4519186019897461  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([12393, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5106215476989746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5106215476989746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12393, 128]), torch.Size([1, 12393, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5224404335021973  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3615813255310059  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12393, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2859458923339844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3061952590942383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3264446258544922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3060369491577148  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21233, 256])
first layer input nodes number: 70397
first layer output nodes number: 21233
edges number: 166616
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3269710540771484  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3472204208374023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.352283000946045  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.352283000946045  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([422, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.375072956085205  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.375072956085205  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.375877857208252  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3827462196350098  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([377, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.383068561553955  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.383068561553955  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3837876319885254  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3958606719970703  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([311, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3963980674743652  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3963980674743652  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.39699125289917  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4139690399169922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([221, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4145221710205078  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4145221710205078  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4149436950683594  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4271678924560547  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([196, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4278993606567383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4278993606567383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4282732009887695  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4417314529418945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4424099922180176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4424099922180176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4426960945129395  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.45499849319458  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([116, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4556360244750977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4556360244750977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.455857276916504  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4669198989868164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4676399230957031  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4676399230957031  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4678459167480469  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4795875549316406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4802374839782715  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4802374839782715  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4804034233093262  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4910235404968262  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4916133880615234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4916133880615234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4917469024658203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5012264251708984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([51, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5016989707946777  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5016989707946777  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5017962455749512  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5093836784362793  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.510073184967041  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.510073184967041  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.510195255279541  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.520571231842041  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5212101936340332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5212101936340332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5213170051574707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5311436653137207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5317902565002441  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5317902565002441  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5318894386291504  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5417084693908691  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5421638488769531  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5421638488769531  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5422306060791016  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.549306869506836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([45, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5499658584594727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5499658584594727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5500516891479492  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5597505569458008  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5602145195007324  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5602145195007324  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5602736473083496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.567368984222412  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5678586959838867  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5678586959838867  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.567915916442871  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5751829147338867  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5756478309631348  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5756478309631348  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5756993293762207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5826001167297363  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5829973220825195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5829973220825195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5830392837524414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5889558792114258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5894598960876465  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5894598960876465  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5895094871520996  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.596848964691162  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5971627235412598  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5971627235412598  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5971932411193848  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6019234657287598  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6021957397460938  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6021957397460938  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6022205352783203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6062374114990234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6066865921020508  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6066865921020508  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.606724739074707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6131715774536133  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([296, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.620265007019043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.620265007019043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6208295822143555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7384381294250488  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 296, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7187085151672363  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.719132423400879  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7195563316345215  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7191109657287598  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21233
output nodes number: 2842
edges number: 23159
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7192907333374023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7192912101745605  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04915046691894531  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 31 input nodes size: 70662
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04511737823486328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04511737823486328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0788116455078125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07883310317993164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04524374008178711  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04665231704711914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04665231704711914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04665231704711914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([70662, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04665231704711914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([829, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1282196044921875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1282196044921875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 829, 128]), torch.Size([1, 829, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12901020050048828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13533496856689453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 829, 128])
m.shape torch.Size([1098, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1362471580505371  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1362471580505371  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13729429244995117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1530013084411621  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([1074, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15401411056518555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15401411056518555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1074, 128]), torch.Size([1, 1074, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15503835678100586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17779016494750977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1074, 128])
m.shape torch.Size([1115, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17940473556518555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17940473556518555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1115, 128]), torch.Size([1, 1115, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18046808242797852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21169614791870117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1115, 128])
m.shape torch.Size([1104, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21379661560058594  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21379661560058594  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21484947204589844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25333213806152344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([988, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2556324005126953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2556324005126953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 988, 128]), torch.Size([1, 988, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2565746307373047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2979888916015625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 988, 128])
m.shape torch.Size([872, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3004283905029297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3004283905029297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 872, 128]), torch.Size([1, 872, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30125999450683594  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34284019470214844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 872, 128])
m.shape torch.Size([829, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34558677673339844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34558677673339844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 829, 128]), torch.Size([1, 829, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3463773727416992  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3923912048339844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 829, 128])
m.shape torch.Size([787, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3953733444213867  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3953733444213867  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 787, 128]), torch.Size([1, 787, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39612388610839844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.44499826431274414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 787, 128])
m.shape torch.Size([12400, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5037508010864258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5037508010864258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12400, 128]), torch.Size([1, 12400, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5155763626098633  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3551912307739258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12400, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2797961235046387  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.299914836883545  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3200335502624512  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.299757480621338  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21096, 256])
first layer input nodes number: 70662
first layer output nodes number: 21096
edges number: 165974
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3205623626708984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3406810760498047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3457107543945312  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3457107543945312  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([425, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3683195114135742  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3683195114135742  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3691301345825195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3759698867797852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([380, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3762950897216797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3762950897216797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3770198822021484  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3892974853515625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([285, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3897571563720703  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3897571563720703  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3903007507324219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4062738418579102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([245, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4069442749023438  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4069442749023438  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4074115753173828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4209632873535156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([193, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4216575622558594  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4216575622558594  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4220256805419922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4352779388427734  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4359593391418457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4359593391418457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4362454414367676  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4485478401184082  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4492459297180176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4492459297180176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4494843482971191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4614052772521973  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([92, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.46199369430542  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.46199369430542  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4621691703796387  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4721713066101074  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.472879409790039  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.472879409790039  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4730548858642578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4842853546142578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.484957218170166  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.484957218170166  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4851078987121582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4958062171936035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4964394569396973  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4964394569396973  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4965672492980957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5065350532531738  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.507094383239746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.507094383239746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.507197380065918  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5159521102905273  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.516538143157959  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.516538143157959  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5166354179382324  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5255846977233887  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5261554718017578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5261554718017578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5262432098388672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5349292755126953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5355920791625977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5355920791625977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5356855392456055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5455923080444336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5460224151611328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5460224151611328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.54608154296875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5527629852294922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5533056259155273  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5533056259155273  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5533723831176758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5613832473754883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5617828369140625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5617828369140625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5618305206298828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5678863525390625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5683741569519043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5683741569519043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.568427562713623  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5755839347839355  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.57615327835083  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.57615327835083  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5762124061584473  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5845494270324707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5849642753601074  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5849642753601074  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5850062370300293  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5912165641784668  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.591470718383789  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.591470718383789  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5914955139160156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5953388214111328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5956363677978516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5956363677978516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.595663070678711  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5999889373779297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6002755165100098  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6002755165100098  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6003003120422363  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6044907569885254  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([294, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6115427017211914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6115427017211914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6121034622192383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7267427444458008  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 294, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7071952819824219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7076187133789062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7080421447753906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.707597255706787  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2839, 40])
input nodes number: 21096
output nodes number: 2839
edges number: 22966
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.707775592803955  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7077760696411133  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04926347732543945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04926347732543945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04926347732543945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.017651252448558807 |0.0020381733775138855 |0.11739516258239746 |8.95187258720398e-05 |0.07655113935470581 |0.0047931671142578125 |
----------------------------------------------------------pseudo_mini_loss sum 4.127479076385498
Total (block generation + training)time/epoch 14.080894947052002
Training time/epoch 6.984315395355225
Training time without block to device /epoch 6.91909384727478
Training time without total dataloading part /epoch 6.213939428329468
load block tensor time/epoch 0.5648400783538818
block to device time/epoch 0.06522154808044434
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2936575
Number of first layer input nodes during this epoch:  2256745
Number of first layer output nodes during this epoch:  679830
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04926300048828125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.018464088439941406
number of batches is  32
batch size is  2842
random selection method spend 0.0058138370513916016
time for parepare:  0.021186113357543945
local_output_nid generation:  0.0013136863708496094
local_in_edges_tensor generation:  0.0039637088775634766
mini_batch_src_global generation:  0.0014357566833496094
r_  generation:  0.00739598274230957
local_output_nid generation:  0.0014317035675048828
local_in_edges_tensor generation:  0.0010166168212890625
mini_batch_src_global generation:  0.0014147758483886719
r_  generation:  0.007337093353271484
local_output_nid generation:  0.0014693737030029297
local_in_edges_tensor generation:  0.00090789794921875
mini_batch_src_global generation:  0.0009343624114990234
r_  generation:  0.00681614875793457
local_output_nid generation:  0.0014591217041015625
local_in_edges_tensor generation:  0.0008165836334228516
mini_batch_src_global generation:  0.0008478164672851562
r_  generation:  0.00679779052734375
local_output_nid generation:  0.001432180404663086
local_in_edges_tensor generation:  0.0007810592651367188
mini_batch_src_global generation:  0.0007565021514892578
r_  generation:  0.0066335201263427734
local_output_nid generation:  0.0014014244079589844
local_in_edges_tensor generation:  0.0007975101470947266
mini_batch_src_global generation:  0.0008077621459960938
r_  generation:  0.007071971893310547
local_output_nid generation:  0.0013995170593261719
local_in_edges_tensor generation:  0.0007615089416503906
mini_batch_src_global generation:  0.000762939453125
r_  generation:  0.007227897644042969
local_output_nid generation:  0.0013995170593261719
local_in_edges_tensor generation:  0.0007829666137695312
mini_batch_src_global generation:  0.0007669925689697266
r_  generation:  0.007241249084472656
local_output_nid generation:  0.001382589340209961
local_in_edges_tensor generation:  0.0007555484771728516
mini_batch_src_global generation:  0.0007576942443847656
r_  generation:  0.007287740707397461
local_output_nid generation:  0.0013895034790039062
local_in_edges_tensor generation:  0.0007681846618652344
mini_batch_src_global generation:  0.0007510185241699219
r_  generation:  0.007125377655029297
local_output_nid generation:  0.0013871192932128906
local_in_edges_tensor generation:  0.0007500648498535156
mini_batch_src_global generation:  0.0008146762847900391
r_  generation:  0.007171154022216797
local_output_nid generation:  0.0013704299926757812
local_in_edges_tensor generation:  0.0007343292236328125
mini_batch_src_global generation:  0.0007369518280029297
r_  generation:  0.007262706756591797
local_output_nid generation:  0.0013704299926757812
local_in_edges_tensor generation:  0.0007412433624267578
mini_batch_src_global generation:  0.0008897781372070312
r_  generation:  0.0073091983795166016
local_output_nid generation:  0.00136566162109375
local_in_edges_tensor generation:  0.0007550716400146484
mini_batch_src_global generation:  0.0007991790771484375
r_  generation:  0.0073947906494140625
local_output_nid generation:  0.0013725757598876953
local_in_edges_tensor generation:  0.0007464885711669922
mini_batch_src_global generation:  0.0007812976837158203
r_  generation:  0.007325887680053711
local_output_nid generation:  0.0013835430145263672
local_in_edges_tensor generation:  0.0008223056793212891
mini_batch_src_global generation:  0.0007841587066650391
r_  generation:  0.00708460807800293
local_output_nid generation:  0.0013954639434814453
local_in_edges_tensor generation:  0.0007371902465820312
mini_batch_src_global generation:  0.0007710456848144531
r_  generation:  0.007121562957763672
local_output_nid generation:  0.0013737678527832031
local_in_edges_tensor generation:  0.0008151531219482422
mini_batch_src_global generation:  0.0008022785186767578
r_  generation:  0.007307291030883789
local_output_nid generation:  0.0013937950134277344
local_in_edges_tensor generation:  0.0009772777557373047
mini_batch_src_global generation:  0.000820159912109375
r_  generation:  0.007504940032958984
local_output_nid generation:  0.0013642311096191406
local_in_edges_tensor generation:  0.0008029937744140625
mini_batch_src_global generation:  0.0008487701416015625
r_  generation:  0.007288932800292969
local_output_nid generation:  0.0013730525970458984
local_in_edges_tensor generation:  0.0008223056793212891
mini_batch_src_global generation:  0.0007853507995605469
r_  generation:  0.007232189178466797
local_output_nid generation:  0.0013675689697265625
local_in_edges_tensor generation:  0.000736236572265625
mini_batch_src_global generation:  0.0007994174957275391
r_  generation:  0.007396221160888672
local_output_nid generation:  0.0013740062713623047
local_in_edges_tensor generation:  0.0007860660552978516
mini_batch_src_global generation:  0.0008740425109863281
r_  generation:  0.007607460021972656
local_output_nid generation:  0.0014040470123291016
local_in_edges_tensor generation:  0.0008029937744140625
mini_batch_src_global generation:  0.0008141994476318359
r_  generation:  0.007399559020996094
local_output_nid generation:  0.0013990402221679688
local_in_edges_tensor generation:  0.0007894039154052734
mini_batch_src_global generation:  0.0007939338684082031
r_  generation:  0.007441043853759766
local_output_nid generation:  0.0014121532440185547
local_in_edges_tensor generation:  0.0007250308990478516
mini_batch_src_global generation:  0.0007729530334472656
r_  generation:  0.0070874691009521484
local_output_nid generation:  0.0013921260833740234
local_in_edges_tensor generation:  0.0007262229919433594
mini_batch_src_global generation:  0.0007910728454589844
r_  generation:  0.0073549747467041016
local_output_nid generation:  0.0013799667358398438
local_in_edges_tensor generation:  0.0007269382476806641
mini_batch_src_global generation:  0.0008008480072021484
r_  generation:  0.007301807403564453
local_output_nid generation:  0.0013942718505859375
local_in_edges_tensor generation:  0.0007393360137939453
mini_batch_src_global generation:  0.000904083251953125
r_  generation:  0.0074193477630615234
local_output_nid generation:  0.0014026165008544922
local_in_edges_tensor generation:  0.00072479248046875
mini_batch_src_global generation:  0.0007932186126708984
r_  generation:  0.007337093353271484
local_output_nid generation:  0.0013895034790039062
local_in_edges_tensor generation:  0.0007157325744628906
mini_batch_src_global generation:  0.0008072853088378906
r_  generation:  0.0073964595794677734
local_output_nid generation:  0.0013959407806396484
local_in_edges_tensor generation:  0.0008001327514648438
mini_batch_src_global generation:  0.0007853507995605469
r_  generation:  0.007242679595947266
----------------------check_connections_block total spend ----------------------------- 0.4289429187774658
generate_one_block  0.01761627197265625
generate_one_block  0.012729167938232422
generate_one_block  0.011895418167114258
generate_one_block  0.012030363082885742
generate_one_block  0.014931201934814453
generate_one_block  0.013007879257202148
generate_one_block  0.012359619140625
generate_one_block  0.012480974197387695
generate_one_block  0.012509822845458984
generate_one_block  0.012000322341918945
generate_one_block  0.012023448944091797
generate_one_block  0.01194453239440918
generate_one_block  0.012022018432617188
generate_one_block  0.016090869903564453
generate_one_block  0.013001680374145508
generate_one_block  0.011927127838134766
generate_one_block  0.011816978454589844
generate_one_block  0.012351512908935547
generate_one_block  0.012545108795166016
generate_one_block  0.012154102325439453
generate_one_block  0.011852025985717773
generate_one_block  0.012290239334106445
generate_one_block  0.012697696685791016
generate_one_block  0.012038946151733398
generate_one_block  0.012029886245727539
generate_one_block  0.011619329452514648
generate_one_block  0.01228475570678711
generate_one_block  0.012094497680664062
generate_one_block  0.012282609939575195
generate_one_block  0.012163400650024414
generate_one_block  0.01210641860961914
generate_one_block  0.011970281600952148
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020868301391601562
gen group dst list time:  0.019548892974853516
time for parepare:  0.01877117156982422
local_output_nid generation:  0.0045778751373291016
local_in_edges_tensor generation:  0.011276006698608398
mini_batch_src_global generation:  0.0053179264068603516
r_  generation:  0.05674386024475098
local_output_nid generation:  0.007092952728271484
local_in_edges_tensor generation:  0.006689548492431641
mini_batch_src_global generation:  0.006958723068237305
r_  generation:  0.062196969985961914
local_output_nid generation:  0.0069124698638916016
local_in_edges_tensor generation:  0.005688190460205078
mini_batch_src_global generation:  0.005350351333618164
r_  generation:  0.06016230583190918
local_output_nid generation:  0.007196664810180664
local_in_edges_tensor generation:  0.006640434265136719
mini_batch_src_global generation:  0.006287336349487305
r_  generation:  0.06245613098144531
local_output_nid generation:  0.006909847259521484
local_in_edges_tensor generation:  0.005479335784912109
mini_batch_src_global generation:  0.010933876037597656
r_  generation:  0.06240987777709961
local_output_nid generation:  0.008198261260986328
local_in_edges_tensor generation:  0.005770444869995117
mini_batch_src_global generation:  0.006714582443237305
r_  generation:  0.06349396705627441
local_output_nid generation:  0.00732874870300293
local_in_edges_tensor generation:  0.0055789947509765625
mini_batch_src_global generation:  0.006777763366699219
r_  generation:  0.06386160850524902
local_output_nid generation:  0.007401466369628906
local_in_edges_tensor generation:  0.006109476089477539
mini_batch_src_global generation:  0.007367134094238281
r_  generation:  0.06493544578552246
local_output_nid generation:  0.007254123687744141
local_in_edges_tensor generation:  0.006634950637817383
mini_batch_src_global generation:  0.007197141647338867
r_  generation:  0.0665886402130127
local_output_nid generation:  0.007252931594848633
local_in_edges_tensor generation:  0.005591154098510742
mini_batch_src_global generation:  0.006989955902099609
r_  generation:  0.0628666877746582
local_output_nid generation:  0.007319211959838867
local_in_edges_tensor generation:  0.005570650100708008
mini_batch_src_global generation:  0.006976604461669922
r_  generation:  0.0657343864440918
local_output_nid generation:  0.007063388824462891
local_in_edges_tensor generation:  0.0054607391357421875
mini_batch_src_global generation:  0.006943464279174805
r_  generation:  0.06409454345703125
local_output_nid generation:  0.007179975509643555
local_in_edges_tensor generation:  0.005558967590332031
mini_batch_src_global generation:  0.0067882537841796875
r_  generation:  0.06520867347717285
local_output_nid generation:  0.007176876068115234
local_in_edges_tensor generation:  0.005835294723510742
mini_batch_src_global generation:  0.007053375244140625
r_  generation:  0.06479740142822266
local_output_nid generation:  0.006966590881347656
local_in_edges_tensor generation:  0.005815982818603516
mini_batch_src_global generation:  0.007193088531494141
r_  generation:  0.06596875190734863
local_output_nid generation:  0.006776571273803711
local_in_edges_tensor generation:  0.005472898483276367
mini_batch_src_global generation:  0.006947755813598633
r_  generation:  0.06244802474975586
local_output_nid generation:  0.006779670715332031
local_in_edges_tensor generation:  0.005480766296386719
mini_batch_src_global generation:  0.006913661956787109
r_  generation:  0.06333494186401367
local_output_nid generation:  0.007172584533691406
local_in_edges_tensor generation:  0.005602836608886719
mini_batch_src_global generation:  0.00699615478515625
r_  generation:  0.06506061553955078
local_output_nid generation:  0.0070705413818359375
local_in_edges_tensor generation:  0.028309345245361328
mini_batch_src_global generation:  0.00713038444519043
r_  generation:  0.06661224365234375
local_output_nid generation:  0.006747007369995117
local_in_edges_tensor generation:  0.0055620670318603516
mini_batch_src_global generation:  0.0071980953216552734
r_  generation:  0.0644834041595459
local_output_nid generation:  0.006699085235595703
local_in_edges_tensor generation:  0.0055806636810302734
mini_batch_src_global generation:  0.0071277618408203125
r_  generation:  0.06421375274658203
local_output_nid generation:  0.006917238235473633
local_in_edges_tensor generation:  0.005522489547729492
mini_batch_src_global generation:  0.0071599483489990234
r_  generation:  0.06572079658508301
local_output_nid generation:  0.006852388381958008
local_in_edges_tensor generation:  0.00616455078125
mini_batch_src_global generation:  0.007614612579345703
r_  generation:  0.06735658645629883
local_output_nid generation:  0.006747007369995117
local_in_edges_tensor generation:  0.005707979202270508
mini_batch_src_global generation:  0.0072286128997802734
r_  generation:  0.06419658660888672
local_output_nid generation:  0.006738424301147461
local_in_edges_tensor generation:  0.005601406097412109
mini_batch_src_global generation:  0.007030963897705078
r_  generation:  0.0651848316192627
local_output_nid generation:  0.0066471099853515625
local_in_edges_tensor generation:  0.005766868591308594
mini_batch_src_global generation:  0.0069522857666015625
r_  generation:  0.06284022331237793
local_output_nid generation:  0.006710529327392578
local_in_edges_tensor generation:  0.005971193313598633
mini_batch_src_global generation:  0.007090091705322266
r_  generation:  0.06548595428466797
local_output_nid generation:  0.006707429885864258
local_in_edges_tensor generation:  0.005369424819946289
mini_batch_src_global generation:  0.0071070194244384766
r_  generation:  0.06467247009277344
local_output_nid generation:  0.006831169128417969
local_in_edges_tensor generation:  0.007924318313598633
mini_batch_src_global generation:  0.007180452346801758
r_  generation:  0.0658259391784668
local_output_nid generation:  0.006838083267211914
local_in_edges_tensor generation:  0.006098508834838867
mini_batch_src_global generation:  0.007180213928222656
r_  generation:  0.06627893447875977
local_output_nid generation:  0.006764650344848633
local_in_edges_tensor generation:  0.005698204040527344
mini_batch_src_global generation:  0.007363080978393555
r_  generation:  0.0656592845916748
local_output_nid generation:  0.006700754165649414
local_in_edges_tensor generation:  0.005476951599121094
mini_batch_src_global generation:  0.0072689056396484375
r_  generation:  0.06432223320007324
----------------------check_connections_block total spend ----------------------------- 3.2216103076934814
generate_one_block  0.08535909652709961
generate_one_block  0.08527898788452148
generate_one_block  0.08173847198486328
generate_one_block  0.08597970008850098
generate_one_block  0.07948446273803711
generate_one_block  0.086090087890625
generate_one_block  0.08341026306152344
generate_one_block  0.08514046669006348
generate_one_block  0.08598995208740234
generate_one_block  0.08183765411376953
generate_one_block  0.0828089714050293
generate_one_block  0.08286714553833008
generate_one_block  0.08435344696044922
generate_one_block  0.08430671691894531
generate_one_block  0.08785796165466309
generate_one_block  0.08530092239379883
generate_one_block  0.08190250396728516
generate_one_block  0.08525490760803223
generate_one_block  0.08619236946105957
generate_one_block  0.10303354263305664
generate_one_block  0.08301877975463867
generate_one_block  0.08577299118041992
generate_one_block  0.08578205108642578
generate_one_block  0.08439397811889648
generate_one_block  0.0850226879119873
generate_one_block  0.08212089538574219
generate_one_block  0.08557248115539551
generate_one_block  0.08281159400939941
generate_one_block  0.08548378944396973
generate_one_block  0.0859525203704834
generate_one_block  0.08626723289489746
generate_one_block  0.0829157829284668
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04926300048828125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

connection checking time:  3.2216103076934814
block generation total time  2.7193024158477783
average batch blocks generation time:  0.08497820049524307
block dataloader generation time/epoch 7.061542749404907
pseudo mini batch 0 input nodes size: 70283
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0452423095703125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0452423095703125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07875585556030273  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07877731323242188  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045061588287353516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0464625358581543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0464625358581543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0464625358581543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([70283, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0464625358581543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([890, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12760210037231445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12760210037231445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12845087051391602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13524103164672852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([1038, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13645648956298828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13645648956298828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1038, 128]), torch.Size([1, 1038, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13744640350341797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15229511260986328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1038, 128])
m.shape torch.Size([1078, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15334224700927734  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15334224700927734  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1078, 128]), torch.Size([1, 1078, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15437030792236328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17764663696289062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1078, 128])
m.shape torch.Size([1125, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18021488189697266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18021488189697266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1125, 128]), torch.Size([1, 1125, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1812877655029297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21262073516845703  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1125, 128])
m.shape torch.Size([1059, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21460914611816406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21460914611816406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1059, 128]), torch.Size([1, 1059, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21561908721923828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25244665145874023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1059, 128])
m.shape torch.Size([992, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2547798156738281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2547798156738281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 992, 128]), torch.Size([1, 992, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2557258605957031  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2970161437988281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 992, 128])
m.shape torch.Size([941, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2996840476989746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2996840476989746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 941, 128]), torch.Size([1, 941, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3005814552307129  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34559154510498047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 941, 128])
m.shape torch.Size([862, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3484311103820801  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3484311103820801  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 862, 128]), torch.Size([1, 862, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34925317764282227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39611101150512695  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 862, 128])
m.shape torch.Size([807, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39916324615478516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39916324615478516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.399932861328125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4492321014404297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([12234, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5074410438537598  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5074410438537598  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12234, 128]), torch.Size([1, 12234, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5191082954406738  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3505730628967285  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12234, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2756729125976562  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.295724868774414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3157768249511719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2955679893493652  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21026, 256])
first layer input nodes number: 70283
first layer output nodes number: 21026
edges number: 165033
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.31630277633667  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3363547325134277  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3413829803466797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3413829803466797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([442, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.363863468170166  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.363863468170166  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 442, 256]), torch.Size([1, 442, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3647065162658691  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.372483730316162  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 442, 256])
m.shape torch.Size([334, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3727045059204102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3727045059204102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3733415603637695  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3846697807312012  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([297, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3852076530456543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3852076530456543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3857741355895996  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.401735782623291  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([215, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4022793769836426  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4022793769836426  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4026894569396973  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4145817756652832  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([191, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4152946472167969  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4152946472167969  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.415658950805664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4287738800048828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([167, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4295549392700195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4295549392700195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4298734664916992  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4435701370239258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([149, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4444794654846191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4444794654846191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4447636604309082  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4589734077453613  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4596924781799316  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4596924781799316  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4599061012268066  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4720826148986816  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4727373123168945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4727373123168945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.472905158996582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.483647346496582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4843902587890625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4843902587890625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4845542907714844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4962005615234375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4969115257263184  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4969115257263184  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4970545768737793  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5082125663757324  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5088562965393066  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5088562965393066  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.508974552154541  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.519026279449463  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5196547508239746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5196547508239746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5197596549987793  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5294108390808105  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.529923915863037  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.529923915863037  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5300040245056152  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5379347801208496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5384860038757324  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5384860038757324  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5385642051696777  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5468535423278809  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5473837852478027  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5473837852478027  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5474543571472168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5554289817810059  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5559005737304688  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5559005737304688  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.555959701538086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5630550384521484  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5634584426879883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5634584426879883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5635061264038086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5695619583129883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.569958209991455  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.569958209991455  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5700020790100098  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.575880527496338  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5763969421386719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5763969421386719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5764503479003906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5839805603027344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5844988822937012  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5844988822937012  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.584550380706787  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5921721458435059  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5924005508422852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5924005508422852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.592423439025879  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5959711074829102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5963797569274902  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5963797569274902  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5964159965515137  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6022868156433105  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6026148796081543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6026148796081543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6026434898376465  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6074786186218262  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([269, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6139283180236816  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6139283180236816  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6144413948059082  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7063088417053223  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 269, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6869316101074219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6873555183410645  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.687779426574707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6873340606689453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21026
output nodes number: 2842
edges number: 22815
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6875128746032715  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.687513828277588  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04906320571899414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 1 input nodes size: 70960
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045063018798828125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045063018798828125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07889938354492188  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07892084121704102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04538583755493164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04683065414428711  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04683065414428711  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04683065414428711  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([70960, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04683065414428711  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([782, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1313157081604004  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1313157081604004  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 782, 128]), torch.Size([1, 782, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13206148147583008  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13802766799926758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 782, 128])
m.shape torch.Size([1098, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1387019157409668  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1387019157409668  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13974905014038086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1554560661315918  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([1071, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1564645767211914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1564645767211914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1071, 128]), torch.Size([1, 1071, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1574859619140625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17995643615722656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1071, 128])
m.shape torch.Size([1144, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18162775039672852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18162775039672852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1144, 128]), torch.Size([1, 1144, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18271875381469727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21439027786254883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1144, 128])
m.shape torch.Size([1090, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21644353866577148  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21644353866577148  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1090, 128]), torch.Size([1, 1090, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2174830436706543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2557253837585449  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1090, 128])
m.shape torch.Size([965, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2579665184020996  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2579665184020996  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 965, 128]), torch.Size([1, 965, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25888681411743164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29848337173461914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 965, 128])
m.shape torch.Size([940, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3011608123779297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3011608123779297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 940, 128]), torch.Size([1, 940, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30205726623535156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34699440002441406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 940, 128])
m.shape torch.Size([900, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3499794006347656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3499794006347656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 900, 128]), torch.Size([1, 900, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35083770751953125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4006767272949219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 900, 128])
m.shape torch.Size([849, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4043292999267578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4043292999267578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 849, 128]), torch.Size([1, 849, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4051389694213867  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.45719385147094727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 849, 128])
m.shape torch.Size([12677, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.517237663269043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.517237663269043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12677, 128]), torch.Size([1, 12677, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.529327392578125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3882761001586914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12677, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.310049057006836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3305683135986328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3510875701904297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3304076194763184  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21516, 256])
first layer input nodes number: 70960
first layer output nodes number: 21516
edges number: 170198
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3516182899475098  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3721375465393066  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3772673606872559  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3772673606872559  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([388, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4013824462890625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4013824462890625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4021224975585938  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.408736228942871  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([371, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4090795516967773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4090795516967773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4097871780395508  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.420628547668457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([283, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.421091079711914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.421091079711914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.421630859375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4344854354858398  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([238, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4351305961608887  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4351305961608887  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.435584545135498  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.44874906539917  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([198, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4494738578796387  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4494738578796387  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4498515129089355  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.463447093963623  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([142, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4640774726867676  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4640774726867676  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.464348316192627  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.47599458694458  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([150, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4770784378051758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4770784378051758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4773645401000977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4916696548461914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4922881126403809  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4922881126403809  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4924769401550293  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5032401084899902  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5040717124938965  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5040717124938965  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5042757987976074  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5173373222351074  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.517937183380127  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.517937183380127  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5180764198303223  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5279622077941895  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5286540985107422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5286540985107422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5287914276123047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5395030975341797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5401153564453125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5401153564453125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5402278900146484  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5497932434082031  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.550386905670166  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.550386905670166  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5504860877990723  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5596108436584473  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5601129531860352  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5601129531860352  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5601911544799805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5679330825805664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.568413257598877  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.568413257598877  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5684819221496582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5757603645324707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5763721466064453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5763721466064453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5764522552490234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5855045318603516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5860366821289062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5860366821289062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5861034393310547  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5941143035888672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5945138931274414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5945138931274414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5945615768432617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6006174087524414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6009774208068848  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6009774208068848  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6010174751281738  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6063847541809082  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6068072319030762  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6068072319030762  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6068511009216309  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6130366325378418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6135196685791016  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6135196685791016  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6135673522949219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6206245422363281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6210451126098633  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6210451126098633  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6210851669311523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.627293586730957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6276273727416992  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6276273727416992  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6276578903198242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6326017379760742  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6330251693725586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6330251693725586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.633061408996582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.639185905456543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([306, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6465206146240234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6465206146240234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.647104263305664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7563304901123047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 306, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7352375984191895  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.735661506652832  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7360854148864746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.735640048980713  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21516
output nodes number: 2842
edges number: 23635
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7358222007751465  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7358226776123047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.049495697021484375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 2 input nodes size: 69501
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04538583755493164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04538583755493164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07858896255493164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07861042022705078  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046132564544677734  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046132564544677734  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046132564544677734  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([69501, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046132564544677734  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([809, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1266326904296875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1266326904296875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 809, 128]), torch.Size([1, 809, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12740421295166016  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1335763931274414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 809, 128])
m.shape torch.Size([1067, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13420820236206055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13420820236206055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1067, 128]), torch.Size([1, 1067, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13522577285766602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15048933029174805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1067, 128])
m.shape torch.Size([1087, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15165424346923828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15165424346923828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1087, 128]), torch.Size([1, 1087, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15269088745117188  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17636871337890625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1087, 128])
m.shape torch.Size([1136, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17801713943481445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17801713943481445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1136, 128]), torch.Size([1, 1136, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17910051345825195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21054887771606445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1136, 128])
m.shape torch.Size([1094, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2126154899597168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2126154899597168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21365880966186523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2519698143005371  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([975, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25423765182495117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25423765182495117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 975, 128]), torch.Size([1, 975, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25516748428344727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2962212562561035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 975, 128])
m.shape torch.Size([890, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29872703552246094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29872703552246094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2995758056640625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34383106231689453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([860, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34668731689453125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34668731689453125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3475074768066406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.394256591796875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 860, 128])
m.shape torch.Size([748, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39705657958984375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39705657958984375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 748, 128]), torch.Size([1, 748, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3977699279785156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4440441131591797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 748, 128])
m.shape torch.Size([12063, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5012083053588867  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5012083053588867  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12063, 128]), torch.Size([1, 12063, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5127124786376953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3423833847045898  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12063, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2679986953735352  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2877674102783203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3075361251831055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2876129150390625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([20729, 256])
first layer input nodes number: 69501
first layer output nodes number: 20729
edges number: 162540
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3080558776855469  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.327824592590332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3330888748168945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3330888748168945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([432, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3553733825683594  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3553733825683594  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3561973571777344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3642587661743164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([352, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3645234107971191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3645234107971191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3651947975158691  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3799266815185547  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([320, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3805136680603027  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3805136680603027  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3811240196228027  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3953862190246582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([238, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.39599609375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.39599609375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3964500427246094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4096145629882812  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([194, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4103202819824219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4103202819824219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4106903076171875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.42401123046875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([160, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4247488975524902  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4247488975524902  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4250540733337402  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4381766319274902  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4388718605041504  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4388718605041504  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4391121864318848  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4511284828186035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4519004821777344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4519004821777344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4521217346191406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4647331237792969  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([72, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4652457237243652  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4652457237243652  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4653830528259277  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4741721153259277  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4748244285583496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4748244285583496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4749674797058105  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.485124111175537  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.485814094543457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.485814094543457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4859514236450195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4966630935668945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.497298240661621  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.497298240661621  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4974145889282227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5073041915893555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5078210830688477  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5078210830688477  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.507908821105957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5159807205200195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5165157318115234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5165157318115234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5165977478027344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5247173309326172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5253543853759766  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5253543853759766  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5254440307617188  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5349464416503906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5354247093200684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5354247093200684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.535489559173584  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5428175926208496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5431938171386719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5431938171386719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5432415008544922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5489635467529297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5494589805603027  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5494589805603027  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.549516201019287  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5567831993103027  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5572843551635742  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5572843551635742  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5573396682739258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5647516250610352  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5652241706848145  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5652241706848145  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5652737617492676  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5722661018371582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.572524070739746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.572524070739746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5725507736206055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.576502799987793  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5769758224487305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5769758224487305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5770196914672852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5838193893432617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.584151268005371  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.584151268005371  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.584181785583496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.589125633239746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5894794464111328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5894794464111328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5895099639892578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5946674346923828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([275, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6012601852416992  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6012601852416992  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6017847061157227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6964349746704102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 275, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.677236557006836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6776604652404785  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.678084373474121  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6776390075683594  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 20729
output nodes number: 2842
edges number: 22622
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6778149604797363  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6778154373168945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04869508743286133  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 3 input nodes size: 71401
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07879924774169922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07882070541381836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04559612274169922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04702568054199219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04702568054199219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04702568054199219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([71401, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04702568054199219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([816, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12987041473388672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12987041473388672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13064861297607422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13695192337036133  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([1030, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13754510879516602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13754510879516602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1030, 128]), torch.Size([1, 1030, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13852739334106445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15326166152954102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1030, 128])
m.shape torch.Size([1068, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1542983055114746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1542983055114746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1068, 128]), torch.Size([1, 1068, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15531682968139648  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17780828475952148  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1068, 128])
m.shape torch.Size([1089, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17937612533569336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17937612533569336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18041467666625977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21136999130249023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([1110, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21349716186523438  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21349716186523438  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2145557403564453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25320911407470703  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([977, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2554750442504883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2554750442504883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 977, 128]), torch.Size([1, 977, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2564067840576172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29736804962158203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 977, 128])
m.shape torch.Size([894, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29988622665405273  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29988622665405273  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 894, 128]), torch.Size([1, 894, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3007388114929199  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34414243698120117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 894, 128])
m.shape torch.Size([879, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34706926345825195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34706926345825195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 879, 128]), torch.Size([1, 879, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34790754318237305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3956894874572754  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 879, 128])
m.shape torch.Size([813, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3987593650817871  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3987593650817871  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 813, 128]), torch.Size([1, 813, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3995347023010254  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4501032829284668  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 813, 128])
m.shape torch.Size([12615, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5098686218261719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5098686218261719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12615, 128]), torch.Size([1, 12615, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5218992233276367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3765578269958496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12615, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2998933792114258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3201980590820312  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3405027389526367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3200392723083496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21291, 256])
first layer input nodes number: 71401
first layer output nodes number: 21291
edges number: 168605
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3410367965698242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3613414764404297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3664178848266602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3664178848266602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([417, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3891606330871582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3891606330871582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 417, 256]), torch.Size([1, 417, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.389955997467041  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3979582786560059  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 417, 256])
m.shape torch.Size([367, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.398266315460205  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.398266315460205  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3989663124084473  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4099783897399902  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([316, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4105396270751953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4105396270751953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.411142349243164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4255180358886719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([224, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4260778427124023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4260778427124023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4265050888061523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4388952255249023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([191, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4395995140075684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4395995140075684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4399638175964355  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4530787467956543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4538135528564453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4538135528564453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4541168212890625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4671573638916016  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4678874015808105  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4678874015808105  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.468137264251709  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4806303977966309  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.481266975402832  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.481266975402832  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4814558029174805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4922189712524414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4928598403930664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4928598403930664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4930219650268555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5033979415893555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([95, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.50423002243042  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.50423002243042  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.504411220550537  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5172762870788574  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5178413391113281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5178413391113281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5179595947265625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5271835327148438  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5278511047363281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5278511047363281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5279712677001953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5381851196289062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5386123657226562  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5386123657226562  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.538686752319336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5455303192138672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5460448265075684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5460448265075684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5461230278015137  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5538649559020996  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5543885231018066  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5543885231018066  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5544629096984863  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5623478889465332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5627107620239258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5627107620239258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.562760353088379  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.568364143371582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5687642097473145  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5687642097473145  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5688138008117676  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5747647285461426  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5751900672912598  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5751900672912598  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.575239658355713  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5815377235412598  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.582115650177002  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.582115650177002  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5821785926818848  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5906128883361816  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5910816192626953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5910816192626953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5911312103271484  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.598123550415039  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5985832214355469  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5985832214355469  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5986289978027344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6054039001464844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.605888843536377  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.605888843536377  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6059346199035645  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.613029956817627  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6133170127868652  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6133170127868652  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6133437156677246  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6176695823669434  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6181178092956543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6181178092956543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6181559562683105  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6246027946472168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([295, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6316723823547363  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6316723823547363  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.632235050201416  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7406845092773438  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 295, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7209982872009277  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7214221954345703  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.721846103668213  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7214007377624512  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21291
output nodes number: 2842
edges number: 23114
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.721580982208252  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7215814590454102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04966926574707031  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 4 input nodes size: 69286
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04559612274169922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04559612274169922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07879924774169922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07882070541381836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04611921310424805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04611921310424805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04611921310424805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([69286, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04611921310424805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([867, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12527990341186523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12527990341186523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 867, 128]), torch.Size([1, 867, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12610673904418945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1327214241027832  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 867, 128])
m.shape torch.Size([1131, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1336669921875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1336669921875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1131, 128]), torch.Size([1, 1131, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13474559783935547  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1509246826171875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1131, 128])
m.shape torch.Size([1176, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1520676612854004  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1520676612854004  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1176, 128]), torch.Size([1, 1176, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15318918228149414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17786264419555664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1176, 128])
m.shape torch.Size([1156, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17950677871704102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17950677871704102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1156, 128]), torch.Size([1, 1156, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18060922622680664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21258020401000977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1156, 128])
m.shape torch.Size([1131, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21472549438476562  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21472549438476562  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1131, 128]), torch.Size([1, 1131, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2158041000366211  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25475025177001953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1131, 128])
m.shape torch.Size([959, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2569546699523926  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2569546699523926  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 959, 128]), torch.Size([1, 959, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25786924362182617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2977004051208496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 959, 128])
m.shape torch.Size([920, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30031394958496094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30031394958496094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 920, 128]), torch.Size([1, 920, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3011913299560547  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3456459045410156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 920, 128])
m.shape torch.Size([846, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3484344482421875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3484344482421875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 846, 128]), torch.Size([1, 846, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3492412567138672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39541053771972656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 846, 128])
m.shape torch.Size([758, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39826011657714844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39826011657714844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 758, 128]), torch.Size([1, 758, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3989830017089844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.44662952423095703  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 758, 128])
m.shape torch.Size([11827, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5026636123657227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5026636123657227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 11827, 128]), torch.Size([1, 11827, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5139427185058594  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3411378860473633  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 11827, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2682428359985352  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2880516052246094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3078603744506836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2878966331481934  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([20771, 256])
first layer input nodes number: 69286
first layer output nodes number: 20771
edges number: 160990
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3083786964416504  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3281874656677246  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3337693214416504  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3337693214416504  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([442, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3557696342468262  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3557696342468262  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 442, 256]), torch.Size([1, 442, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3566126823425293  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3652639389038086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 442, 256])
m.shape torch.Size([368, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3655500411987305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3655500411987305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3662519454956055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3767805099487305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([290, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3772659301757812  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3772659301757812  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3778190612792969  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3910307884216309  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3916077613830566  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3916077613830566  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.392031192779541  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.404310703277588  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([229, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4051995277404785  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4051995277404785  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4056363105773926  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4213604927062988  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4220247268676758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4220247268676758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.422316551208496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4348649978637695  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([112, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4354729652404785  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4354729652404785  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4356865882873535  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4463677406311035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4471220970153809  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4471220970153809  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4473357200622559  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4595122337341309  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4602103233337402  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4602103233337402  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4603877067565918  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4717402458190918  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4724879264831543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4724879264831543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.472653865814209  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4844355583190918  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4849658012390137  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4849658012390137  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4850764274597168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4937052726745605  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.49434232711792  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.49434232711792  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4944567680358887  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5041842460632324  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5048894882202148  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5048894882202148  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5050058364868164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5157098770141602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5163383483886719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5163383483886719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5164356231689453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5260658264160156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5265798568725586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5265798568725586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5266542434692383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5345392227172852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5350556373596191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5350556373596191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5351243019104004  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5428833961486816  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5434536933898926  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5434536933898926  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5435242652893066  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5519928932189941  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5522866249084473  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5522866249084473  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5523228645324707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5569252967834473  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5574736595153809  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5574736595153809  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.557532787322998  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5654559135437012  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5656957626342773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5656957626342773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5657224655151367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5694875717163086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5698175430297852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5698175430297852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.569849967956543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5746488571166992  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5748019218444824  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5748019218444824  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.574817180633545  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5771822929382324  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5774846076965332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5774846076965332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5775113105773926  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5818371772766113  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.582170009613037  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.582170009613037  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5821986198425293  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.587033748626709  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([274, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5936036109924316  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5936036109924316  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5941262245178223  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.688610553741455  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 274, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6697049140930176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6701288223266602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6705527305603027  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.670107364654541  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 20771
output nodes number: 2842
edges number: 22317
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6702837944030762  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6702842712402344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.048666954040527344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 5 input nodes size: 70311
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07827949523925781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07830095291137695  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04507637023925781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04650592803955078  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04650592803955078  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04650592803955078  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([70311, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04650592803955078  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([786, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12924861907958984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12924861907958984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 786, 128]), torch.Size([1, 786, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12999820709228516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1362171173095703  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 786, 128])
m.shape torch.Size([1029, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1368236541748047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1368236541748047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1029, 128]), torch.Size([1, 1029, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13780498504638672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1525249481201172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1029, 128])
m.shape torch.Size([1076, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15357351303100586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15357351303100586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1076, 128]), torch.Size([1, 1076, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15459966659545898  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17735910415649414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1076, 128])
m.shape torch.Size([1098, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1789402961730957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1789402961730957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17998743057250977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21103715896606445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([1115, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21317195892333984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21317195892333984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1115, 128]), torch.Size([1, 1115, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2142353057861328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25290679931640625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1115, 128])
m.shape torch.Size([975, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25516462326049805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25516462326049805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 975, 128]), torch.Size([1, 975, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25609445571899414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29723548889160156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 975, 128])
m.shape torch.Size([963, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2999849319458008  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2999849319458008  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 963, 128]), torch.Size([1, 963, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3009033203125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34682273864746094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 963, 128])
m.shape torch.Size([926, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3498959541320801  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3498959541320801  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 926, 128]), torch.Size([1, 926, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35077905654907227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40121889114379883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 926, 128])
m.shape torch.Size([816, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40441274642944336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40441274642944336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40519094467163086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.45677852630615234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([12504, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5160131454467773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5160131454467773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12504, 128]), torch.Size([1, 12504, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5279378890991211  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3746824264526367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12504, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2981553077697754  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3184571266174316  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.338758945465088  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.31829833984375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21288, 256])
first layer input nodes number: 70311
first layer output nodes number: 21288
edges number: 168422
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.339284896850586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3595867156982422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3646621704101562  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3646621704101562  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([433, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3877019882202148  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3877019882202148  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3885278701782227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3951349258422852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([376, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3954448699951172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3954448699951172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3961620330810547  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4074459075927734  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([278, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4078893661499023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4078893661499023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4084196090698242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4227538108825684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([224, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4233498573303223  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4233498573303223  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4237771034240723  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4361672401428223  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([190, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4368667602539062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4368667602539062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4372291564941406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4502754211425781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([140, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.450901985168457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.450901985168457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4511690139770508  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.462651252746582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([114, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.463284969329834  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.463284969329834  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4635024070739746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4743742942810059  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4751577377319336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4751577377319336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4753789901733398  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.487990379333496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4887104034423828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4887104034423828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4888935089111328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5006122589111328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.501357078552246  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.501357078552246  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5015230178833008  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5133047103881836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5138349533081055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5138349533081055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5139455795288086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5225744247436523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.523176670074463  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.523176670074463  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5232853889465332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5325264930725098  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5331597328186035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5331597328186035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5332646369934082  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5429158210754395  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([55, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5436038970947266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5436038970947266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5437088012695312  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5540943145751953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5547199249267578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5547199249267578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5548095703125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5643119812011719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5647592544555664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5647592544555664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5648202896118164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5717172622680664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5720629692077637  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5720629692077637  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5721068382263184  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5773711204528809  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5777993202209473  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5777993202209473  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5778489112854004  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5841469764709473  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5845060348510742  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5845060348510742  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5845460891723633  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5899133682250977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5905470848083496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5905470848083496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5906119346618652  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5997557640075684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6003289222717285  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6003289222717285  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.600386142730713  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6088547706604004  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6091856956481934  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6091856956481934  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6092181205749512  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.614243984222412  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6145596504211426  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6145596504211426  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6145882606506348  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6192231178283691  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6196012496948242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6196012496948242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.619633674621582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6251134872436523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([301, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6323299407958984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6323299407958984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.632904052734375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7461109161376953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 301, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7261390686035156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7265629768371582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7269868850708008  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.726541519165039  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21288
output nodes number: 2842
edges number: 23409
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7267217636108398  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.726722240447998  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.049143314361572266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 6 input nodes size: 70687
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04507637023925781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04507637023925781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07878255844116211  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07880401611328125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04525566101074219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046675682067871094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046675682067871094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046675682067871094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([70687, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046675682067871094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([837, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12879705429077148  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12879705429077148  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 837, 128]), torch.Size([1, 837, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12959527969360352  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13673877716064453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 837, 128])
m.shape torch.Size([1080, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13736963272094727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13736963272094727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13839960098266602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15384912490844727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([1134, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15495634078979492  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15495634078979492  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1134, 128]), torch.Size([1, 1134, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1560378074645996  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17989492416381836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1134, 128])
m.shape torch.Size([1104, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18145990371704102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18145990371704102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18251276016235352  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21362543106079102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([1097, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2157144546508789  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2157144546508789  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1097, 128]), torch.Size([1, 1097, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21676063537597656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.255246639251709  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1097, 128])
m.shape torch.Size([970, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25749874114990234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25749874114990234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 970, 128]), torch.Size([1, 970, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2584238052368164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2982015609741211  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 970, 128])
m.shape torch.Size([879, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3006730079650879  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3006730079650879  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 879, 128]), torch.Size([1, 879, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.301511287689209  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34342527389526367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 879, 128])
m.shape torch.Size([902, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3464469909667969  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3464469909667969  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 902, 128]), torch.Size([1, 902, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3473072052001953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39768409729003906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 902, 128])
m.shape torch.Size([774, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4005756378173828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4005756378173828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 774, 128]), torch.Size([1, 774, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40131378173828125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4488945007324219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 774, 128])
m.shape torch.Size([12464, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5079584121704102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5079584121704102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12464, 128]), torch.Size([1, 12464, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5198450088500977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3637933731079102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12464, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2878975868225098  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.308154582977295  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.32841157913208  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3079962730407715  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21241, 256])
first layer input nodes number: 70687
first layer output nodes number: 21241
edges number: 167095
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3289403915405273  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3491973876953125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.354261875152588  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.354261875152588  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([434, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3772244453430176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3772244453430176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3780522346496582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3848118782043457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([355, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3850808143615723  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3850808143615723  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3857579231262207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3973469734191895  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([274, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3977985382080078  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3977985382080078  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3983211517333984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.412363052368164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([237, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.413012981414795  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.413012981414795  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4134650230407715  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4265742301940918  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.427304744720459  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.427304744720459  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4276843070983887  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4413485527038574  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4420528411865234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4420528411865234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4423484802246094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4550609588623047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.455700397491455  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.455700397491455  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4559235572814941  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4670815467834473  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4678082466125488  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4678082466125488  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4680161476135254  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4798665046691895  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4805498123168945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4805498123168945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4807233810424805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4918317794799805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4926104545593262  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4926104545593262  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4927821159362793  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5049700736999512  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5055718421936035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5055718421936035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5056958198547363  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5153660774230957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5160541534423828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5160541534423828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5161781311035156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5267162322998047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5273914337158203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5273914337158203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5275039672851562  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5378570556640625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5382990837097168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5382990837097168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5383696556091309  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.545356273651123  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5458111763000488  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5458111763000488  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5458760261535645  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5527501106262207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5531177520751953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5531177520751953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5531673431396484  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5587711334228516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5593185424804688  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5593185424804688  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5593852996826172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5673961639404297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.567899227142334  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.567899227142334  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5679583549499512  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.575467586517334  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5760407447814941  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5760407447814941  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.576103687286377  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5845379829406738  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5850257873535156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5850257873535156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5850772857666016  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5923385620117188  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5926761627197266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5926761627197266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5927104949951172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5977916717529297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5982189178466797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5982189178466797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5982589721679688  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6044673919677734  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6047348976135254  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6047348976135254  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.604759693145752  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.608776569366455  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6091103553771973  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6091103553771973  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6091389656066895  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6139740943908691  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([302, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6212162971496582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6212162971496582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6217923164367676  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.739180088043213  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 302, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.719285488128662  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7197093963623047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7201333045959473  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7196879386901855  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21241
output nodes number: 2842
edges number: 23324
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7198677062988281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7198681831359863  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04930448532104492  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 7 input nodes size: 71335
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04525566101074219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04525566101074219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07927083969116211  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07929229736328125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04556465148925781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0470123291015625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0470123291015625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0470123291015625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([71335, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0470123291015625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([803, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13150787353515625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13150787353515625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 803, 128]), torch.Size([1, 803, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13227367401123047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13840007781982422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 803, 128])
m.shape torch.Size([1071, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1390385627746582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1390385627746582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1071, 128]), torch.Size([1, 1071, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1400599479675293  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1553807258605957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1071, 128])
m.shape torch.Size([1090, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15652847290039062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15652847290039062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1090, 128]), torch.Size([1, 1090, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15756797790527344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1812572479248047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1090, 128])
m.shape torch.Size([1137, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1829061508178711  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1829061508178711  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1137, 128]), torch.Size([1, 1137, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.183990478515625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21544933319091797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1137, 128])
m.shape torch.Size([1114, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21756315231323242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21756315231323242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1114, 128]), torch.Size([1, 1114, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21862554550170898  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2572798728942871  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1114, 128])
m.shape torch.Size([1054, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2597641944885254  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2597641944885254  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1054, 128]), torch.Size([1, 1054, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2607693672180176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30408143997192383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1054, 128])
m.shape torch.Size([874, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30649614334106445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30649614334106445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3073296546936035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34940195083618164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 874, 128])
m.shape torch.Size([849, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35222387313842773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35222387313842773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 849, 128]), torch.Size([1, 849, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35303354263305664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39928388595581055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 849, 128])
m.shape torch.Size([821, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.402402400970459  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.402402400970459  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4031853675842285  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.454775333404541  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([12751, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5151853561401367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5151853561401367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12751, 128]), torch.Size([1, 12751, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5273456573486328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3909850120544434  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12751, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3127470016479492  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3333120346069336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.353877067565918  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3331513404846191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21564, 256])
first layer input nodes number: 71335
first layer output nodes number: 21564
edges number: 170466
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3544106483459473  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3749756813049316  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3807806968688965  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3807806968688965  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([412, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4049172401428223  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4049172401428223  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.405703067779541  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.412116527557373  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([370, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4124350547790527  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4124350547790527  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4131407737731934  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4240484237670898  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([266, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4244627952575684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4244627952575684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4249701499938965  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4366297721862793  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4372296333312988  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4372296333312988  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4376530647277832  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.44993257522583  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4507989883422852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4507989883422852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4511957168579102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4654779434204102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([160, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4662022590637207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4662022590637207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4665074348449707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4796299934387207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.480318546295166  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.480318546295166  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4805569648742676  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4924778938293457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4932432174682617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4932432174682617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4934625625610352  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.505965232849121  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.506582260131836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.506582260131836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5067424774169922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5169963836669922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.517599105834961  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.517599105834961  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5177345275878906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5273494720458984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5279269218444824  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5279269218444824  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.528043270111084  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5371184349060059  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5376715660095215  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5376715660095215  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5377726554870605  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5463652610778809  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5469269752502441  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5469269752502441  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.547020435333252  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5556187629699707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5562448501586914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5562448501586914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.556340217590332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.565781593322754  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([61, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5666136741638184  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5666136741638184  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.56673002243042  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5790629386901855  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.579681396484375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.579681396484375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5797653198242188  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5892486572265625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5897626876831055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5897626876831055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.589827537536621  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.597609519958496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5980792045593262  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5980792045593262  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5981345176696777  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6051592826843262  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.605588436126709  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.605588436126709  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6056361198425293  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6120257377624512  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6124634742736816  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6124634742736816  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6125092506408691  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6189637184143066  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6194658279418945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6194658279418945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6195154190063477  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6268548965454102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6272320747375488  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6272320747375488  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6272683143615723  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.632885456085205  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6331992149353027  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6331992149353027  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.633227825164795  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6378626823425293  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6380791664123535  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6380791664123535  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6380982398986816  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6413216590881348  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([309, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6487369537353516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6487369537353516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6493263244628906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.756058692932129  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 309, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7349653244018555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.735389232635498  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7358131408691406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.735367774963379  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21564
output nodes number: 2842
edges number: 23691
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7355499267578125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7355504035949707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04968404769897461  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 8 input nodes size: 71596
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04556465148925781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04556465148925781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07970428466796875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07972574234008789  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04568910598754883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04714632034301758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04714632034301758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04714632034301758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([71596, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04714632034301758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([801, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13165712356567383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13165712356567383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 801, 128]), torch.Size([1, 801, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13242101669311523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13853216171264648  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 801, 128])
m.shape torch.Size([1062, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13916301727294922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13916301727294922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.14017581939697266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15536785125732422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([1137, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15664291381835938  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15664291381835938  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1137, 128]), torch.Size([1, 1137, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15772724151611328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1815958023071289  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1137, 128])
m.shape torch.Size([1172, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1832890510559082  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1832890510559082  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1172, 128]), torch.Size([1, 1172, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18440675735473633  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21682024002075195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1172, 128])
m.shape torch.Size([1089, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2188577651977539  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2188577651977539  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2198963165283203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2581214904785156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([1019, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.26051759719848633  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.26051759719848633  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1019, 128]), torch.Size([1, 1019, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2614893913269043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30390501022338867  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1019, 128])
m.shape torch.Size([933, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3065333366394043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3065333366394043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 933, 128]), torch.Size([1, 933, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30742311477661133  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3519120216369629  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 933, 128])
m.shape torch.Size([869, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3547821044921875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3547821044921875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 869, 128]), torch.Size([1, 869, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.35561084747314453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40337181091308594  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 869, 128])
m.shape torch.Size([841, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4065666198730469  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4065666198730469  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 841, 128]), torch.Size([1, 841, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40736865997314453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.45902538299560547  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 841, 128])
m.shape torch.Size([12813, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.519721508026123  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.519721508026123  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12813, 128]), torch.Size([1, 12813, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5328364372253418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.42612886428833  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12813, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3479399681091309  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.368669033050537  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3893980979919434  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.368506908416748  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21736, 256])
first layer input nodes number: 71596
first layer output nodes number: 21736
edges number: 171765
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3899335861206055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4106626510620117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4158449172973633  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4158449172973633  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([390, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.439962387084961  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.439962387084961  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4407062530517578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4468097686767578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([342, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4470953941345215  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4470953941345215  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4477477073669434  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4579582214355469  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([280, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.458439826965332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.458439826965332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4589738845825195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4721922874450684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([272, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.472970962524414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.472970962524414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.473489761352539  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.49090576171875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([179, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.491506576538086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.491506576538086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4918479919433594  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5041389465332031  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([140, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5047760009765625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5047760009765625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5050430297851562  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5165252685546875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([140, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.517333984375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.517333984375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5176010131835938  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5309524536132812  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.531726360321045  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.531726360321045  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5319514274597168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5447802543640137  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5455503463745117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5455503463745117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5457448959350586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5581960678100586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([99, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5590505599975586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5590505599975586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.559239387512207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.572646141052246  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5731544494628906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5731544494628906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.573263168334961  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5817432403564453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5823698043823242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5823698043823242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5824823379516602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5920476913452148  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5927162170410156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5927162170410156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5928268432617188  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6030044555664062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6035819053649902  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6035819053649902  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6036715507507324  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.612546443939209  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6131362915039062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6131362915039062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.61322021484375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6221160888671875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6224894523620605  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6224894523620605  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6225409507751465  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6283602714538574  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6289067268371582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6289067268371582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6289734840393066  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6369843482971191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6373143196105957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6373143196105957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6373543739318848  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6424412727355957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6427135467529297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6427135467529297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6427440643310547  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6468334197998047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.647395133972168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.647395133972168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6474523544311523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6555204391479492  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6559762954711914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6559762954711914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.656022071838379  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.662796974182129  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6630282402038574  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6630282402038574  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6630511283874512  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6665987968444824  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6670074462890625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6670074462890625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.667043685913086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6729145050048828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6732196807861328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6732196807861328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6732463836669922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6777591705322266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([317, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6853628158569336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6853628158569336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6859674453735352  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7934885025024414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 317, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7725553512573242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7729792594909668  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7734031677246094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7729578018188477  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21736
output nodes number: 2842
edges number: 23751
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7731413841247559  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.773141860961914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04983329772949219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 9 input nodes size: 70396
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04568910598754883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04568910598754883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07925653457641602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07927799224853516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04511690139770508  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046514034271240234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046514034271240234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046514034271240234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([70396, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046514034271240234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([827, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12737703323364258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12737703323364258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12816572189331055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13489866256713867  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([1084, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13553810119628906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13553810119628906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1084, 128]), torch.Size([1, 1084, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13657188415527344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15207862854003906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1084, 128])
m.shape torch.Size([1156, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1532154083251953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1532154083251953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1156, 128]), torch.Size([1, 1156, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15431785583496094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1792278289794922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1156, 128])
m.shape torch.Size([1095, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18076515197753906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18076515197753906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1818094253540039  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2128276824951172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([1023, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21474456787109375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21474456787109375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1023, 128]), torch.Size([1, 1023, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21572017669677734  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25179433822631836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1023, 128])
m.shape torch.Size([975, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25409603118896484  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25409603118896484  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 975, 128]), torch.Size([1, 975, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25502586364746094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2959756851196289  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 975, 128])
m.shape torch.Size([905, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29853153228759766  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29853153228759766  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2993946075439453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.344113826751709  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 905, 128])
m.shape torch.Size([836, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34687137603759766  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34687137603759766  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 836, 128]), torch.Size([1, 836, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3476686477661133  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3939065933227539  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 836, 128])
m.shape torch.Size([803, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3969540596008301  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3969540596008301  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 803, 128]), torch.Size([1, 803, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3977198600769043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4473743438720703  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 803, 128])
m.shape torch.Size([12247, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5055851936340332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5055851936340332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12247, 128]), torch.Size([1, 12247, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5172648429870605  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3488659858703613  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12247, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.274165153503418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2941455841064453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3141260147094727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2939891815185547  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([20951, 256])
first layer input nodes number: 70396
first layer output nodes number: 20951
edges number: 164528
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.314652442932129  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3346328735351562  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3396787643432617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3396787643432617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([447, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.362199306488037  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.362199306488037  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3630518913269043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3707923889160156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([354, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.371047019958496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.371047019958496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3717222213745117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3847894668579102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([291, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3852910995483398  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3852910995483398  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3858461380004883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.399705410003662  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([237, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.400339126586914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.400339126586914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4007911682128906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.413900375366211  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([174, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.414510726928711  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.414510726928711  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4148426055908203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4267902374267578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([171, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4276108741760254  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4276108741760254  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4279370307922363  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4419617652893066  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4427342414855957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4427342414855957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4429993629455566  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4562554359436035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4569072723388672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4569072723388672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.457101821899414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.468191146850586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4689593315124512  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4689593315124512  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4691500663757324  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4813570976257324  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4819731712341309  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4819731712341309  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.482114315032959  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4921355247497559  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4927525520324707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4927525520324707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4928765296936035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.502546787261963  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5031886100769043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5031886100769043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5033049583435059  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5131945610046387  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5136990547180176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5136990547180176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5137848854064941  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.521681308746338  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.522230625152588  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.522230625152588  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5223145484924316  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.530622959136963  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([27, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.530970573425293  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.530970573425293  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.531022071838379  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5364809036254883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5369629859924316  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5369629859924316  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5370259284973145  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5441384315490723  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5446953773498535  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5446953773498535  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5447640419006348  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5530037879943848  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.553523063659668  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.553523063659668  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.553584098815918  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.561335563659668  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5617618560791016  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5617618560791016  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5618095397949219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5681991577148438  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5687332153320312  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5687332153320312  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5687885284423828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5765876770019531  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5769033432006836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5769033432006836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5769357681274414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5817346572875977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.582099437713623  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.582099437713623  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5821337699890137  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5874552726745605  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5877699851989746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5877699851989746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5877985954284668  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5924334526062012  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5929036140441895  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5929036140441895  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5929436683654785  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.59971284866333  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([285, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6065411567687988  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6065411567687988  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6070847511291504  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7046666145324707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 285, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6852388381958008  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6856627464294434  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.686086654663086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6856412887573242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 20951
output nodes number: 2842
edges number: 22852
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.685819149017334  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6858196258544922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.049108028411865234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 10 input nodes size: 70543
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04511690139770508  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04511690139770508  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07875442504882812  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07877588272094727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04518699645996094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046608924865722656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046608924865722656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046608924865722656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([70543, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.046608924865722656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([828, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12893247604370117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12893247604370117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 828, 128]), torch.Size([1, 828, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12972211837768555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13661479949951172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 828, 128])
m.shape torch.Size([1155, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13732147216796875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13732147216796875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1155, 128]), torch.Size([1, 1155, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13842296600341797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15494537353515625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1155, 128])
m.shape torch.Size([1142, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1564478874206543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1564478874206543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1142, 128]), torch.Size([1, 1142, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15753698348999023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18149709701538086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1142, 128])
m.shape torch.Size([1061, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1830582618713379  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1830582618713379  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1061, 128]), torch.Size([1, 1061, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18407011032104492  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21341371536254883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1061, 128])
m.shape torch.Size([1070, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21545886993408203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21545886993408203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1070, 128]), torch.Size([1, 1070, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21647930145263672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.253936767578125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1070, 128])
m.shape torch.Size([987, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25625038146972656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25625038146972656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 987, 128]), torch.Size([1, 987, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25719165802001953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2983722686767578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 987, 128])
m.shape torch.Size([917, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3009624481201172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3009624481201172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 917, 128]), torch.Size([1, 917, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3018369674682617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3463168144226074  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 917, 128])
m.shape torch.Size([911, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34935474395751953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34935474395751953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 911, 128]), torch.Size([1, 911, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3502235412597656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4005460739135742  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 911, 128])
m.shape torch.Size([834, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40369081497192383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40369081497192383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 834, 128]), torch.Size([1, 834, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40448617935180664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4568819999694824  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 834, 128])
m.shape torch.Size([12422, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5157170295715332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5157170295715332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12422, 128]), torch.Size([1, 12422, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5275635719299316  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3688387870788574  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12422, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2928028106689453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3131418228149414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3334808349609375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3129825592041016  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21327, 256])
first layer input nodes number: 70543
first layer output nodes number: 21327
edges number: 167513
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3340086936950684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3543477058410645  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3594326972961426  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3594326972961426  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([404, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3823156356811523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3823156356811523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3830862045288086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3897199630737305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([388, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3900809288024902  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3900809288024902  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3908209800720215  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.403226375579834  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([293, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4037013053894043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4037013053894043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4042601585388184  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.419449806213379  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([223, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.420027732849121  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.420027732849121  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4204530715942383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4327878952026367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([198, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4335269927978516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4335269927978516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4339046478271484  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.447500228881836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4481825828552246  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4481825828552246  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4484705924987793  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4608550071716309  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4615521430969238  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4615521430969238  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4617905616760254  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4737114906311035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4744768142700195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4744768142700195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.474696159362793  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.487198829650879  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([108, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4880237579345703  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4880237579345703  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.488229751586914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.501413345336914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5020604133605957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5020604133605957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.502209186553955  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5127720832824707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5133109092712402  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5133109092712402  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5134215354919434  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.522050380706787  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5225720405578613  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5225720405578613  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.522667407989502  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.530773639678955  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5313758850097656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5313758850097656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5314750671386719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5405998229980469  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5410213470458984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5410213470458984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5410881042480469  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5476970672607422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.548269271850586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.548269271850586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.548349380493164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5568408966064453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.55735445022583  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.55735445022583  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5574231147766113  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5651822090148926  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.565605640411377  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.565605640411377  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5656590461730957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5720677375793457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5725946426391602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5725946426391602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5726556777954102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5804071426391602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5807604789733887  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5807604789733887  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5808005332946777  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.586167812347412  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.58659029006958  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.58659029006958  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5866341590881348  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5928196907043457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5933427810668945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5933427810668945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5933942794799805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6010160446166992  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6012444496154785  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6012444496154785  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6012673377990723  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6048150062561035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6051573753356934  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6051573753356934  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6051878929138184  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6101317405700684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.610508918762207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.610508918762207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6105413436889648  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6160211563110352  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([310, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6234540939331055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6234540939331055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6240453720092773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7446727752685547  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 310, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.724820613861084  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7252445220947266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7256684303283691  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7252230644226074  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21327
output nodes number: 2842
edges number: 23272
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7254037857055664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7254042625427246  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.0492405891418457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 11 input nodes size: 70423
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04518699645996094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04518699645996094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07876729965209961  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07878875732421875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04512977600097656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04654121398925781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04654121398925781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04654121398925781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([70423, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04654121398925781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([748, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1281890869140625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1281890869140625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 748, 128]), torch.Size([1, 748, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12890243530273438  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13460922241210938  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 748, 128])
m.shape torch.Size([1060, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13559913635253906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13559913635253906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1060, 128]), torch.Size([1, 1060, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1366100311279297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15177345275878906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1060, 128])
m.shape torch.Size([1186, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15296459197998047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15296459197998047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1186, 128]), torch.Size([1, 1186, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15409564971923828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1795673370361328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1186, 128])
m.shape torch.Size([1142, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18118000030517578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18118000030517578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1142, 128]), torch.Size([1, 1142, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18226909637451172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2138528823852539  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1142, 128])
m.shape torch.Size([1063, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21584272384643555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21584272384643555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1063, 128]), torch.Size([1, 1063, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2168564796447754  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25345325469970703  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1063, 128])
m.shape torch.Size([1011, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25583887100219727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25583887100219727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1011, 128]), torch.Size([1, 1011, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.256803035736084  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2985100746154785  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1011, 128])
m.shape torch.Size([909, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30106210708618164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30106210708618164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3019289970397949  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3462371826171875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([887, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34918737411499023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34918737411499023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 887, 128]), torch.Size([1, 887, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3500332832336426  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3999667167663574  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 887, 128])
m.shape torch.Size([878, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40331172943115234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40331172943115234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 878, 128]), torch.Size([1, 878, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40414905548095703  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4583091735839844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 878, 128])
m.shape torch.Size([12248, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.516484260559082  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.516484260559082  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12248, 128]), torch.Size([1, 12248, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5281648635864258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.359776496887207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12248, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2843551635742188  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3045082092285156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3246612548828125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3043503761291504  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21132, 256])
first layer input nodes number: 70423
first layer output nodes number: 21132
edges number: 166216
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.325188159942627  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3453412055969238  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.350578784942627  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.350578784942627  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([396, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3732857704162598  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3732857704162598  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3740410804748535  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3815827369689941  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([373, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3819222450256348  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3819222450256348  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3826336860656738  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3950791358947754  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([298, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.395582675933838  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.395582675933838  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.396151065826416  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4102730751037598  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([235, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4108924865722656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4108924865722656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4113407135009766  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4243392944335938  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([174, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4249515533447266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4249515533447266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.425283432006836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4372310638427734  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4379363059997559  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4379363059997559  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4382243156433105  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.450608730316162  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4513864517211914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4513864517211914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4516477584838867  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4647130966186523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([130, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.465604305267334  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.465604305267334  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4658522605895996  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4799857139587402  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([97, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.480700969696045  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.480700969696045  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4808859825134277  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4927268028259277  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4934802055358887  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4934802055358887  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4936480522155762  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5055651664733887  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5061264038085938  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5061264038085938  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5062427520751953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5153179168701172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.515986442565918  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.515986442565918  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5161066055297852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.526320457458496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5268726348876953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5268726348876953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5269660949707031  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5355644226074219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5362043380737305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5362043380737305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.536301612854004  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5459318161010742  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.546316146850586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.546316146850586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5463733673095703  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.552438735961914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5529332160949707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5529332160949707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5529980659484863  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.560326099395752  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5606861114501953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5606861114501953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5607318878173828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5662250518798828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5668253898620605  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5668253898620605  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5668940544128418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5756144523620605  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.576329231262207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.576329231262207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5764074325561523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5868864059448242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5874052047729492  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5874052047729492  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5874605178833008  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.595259666442871  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5958375930786133  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5958375930786133  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5958948135375977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6043634414672852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6047577857971191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6047577857971191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6047959327697754  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6107087135314941  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6109552383422852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6109552383422852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.610978126525879  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6146860122680664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6150436401367188  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6150436401367188  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6150741577148438  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6202316284179688  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([267, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6266322135925293  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6266322135925293  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6271414756774902  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7201318740844727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 267, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7004880905151367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7009119987487793  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7013359069824219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7008905410766602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21132
output nodes number: 2842
edges number: 23096
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7010698318481445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7010703086853027  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04915666580200195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 12 input nodes size: 70712
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04512977600097656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04512977600097656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07884788513183594  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07886934280395508  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045267581939697266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04668283462524414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04668283462524414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04668283462524414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([70712, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04668283462524414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([834, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12856006622314453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12856006622314453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 834, 128]), torch.Size([1, 834, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12935543060302734  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13571834564208984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 834, 128])
m.shape torch.Size([1062, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13633346557617188  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13633346557617188  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1373462677001953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15253829956054688  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([1113, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1536240577697754  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1536240577697754  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1113, 128]), torch.Size([1, 1113, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15468549728393555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17846250534057617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1113, 128])
m.shape torch.Size([1046, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17992687225341797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17992687225341797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1046, 128]), torch.Size([1, 1046, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1809244155883789  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2098531723022461  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1046, 128])
m.shape torch.Size([1068, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2119007110595703  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2119007110595703  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1068, 128]), torch.Size([1, 1068, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2129192352294922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2504425048828125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1068, 128])
m.shape torch.Size([969, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25270557403564453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25270557403564453  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 969, 128]), torch.Size([1, 969, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2536296844482422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2933664321899414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 969, 128])
m.shape torch.Size([900, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29590845108032227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29590845108032227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 900, 128]), torch.Size([1, 900, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2967667579650879  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34114503860473633  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 900, 128])
m.shape torch.Size([843, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3439316749572754  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3439316749572754  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 843, 128]), torch.Size([1, 843, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34473562240600586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39079713821411133  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 843, 128])
m.shape torch.Size([838, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39399147033691406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39399147033691406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 838, 128]), torch.Size([1, 838, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3947906494140625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4466400146484375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 838, 128])
m.shape torch.Size([12438, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.505549430847168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.505549430847168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12438, 128]), torch.Size([1, 12438, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5174112319946289  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3595991134643555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12438, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2838902473449707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.304023265838623  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3241562843322754  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.303865909576416  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21111, 256])
first layer input nodes number: 70712
first layer output nodes number: 21111
edges number: 166601
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3246850967407227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.344818115234375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3498516082763672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3498516082763672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([431, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.372704029083252  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.372704029083252  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3735260963439941  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.380171298980713  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 431, 256])
m.shape torch.Size([361, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3804545402526855  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3804545402526855  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3811430931091309  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.392648696899414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([285, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3931264877319336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3931264877319336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3936700820922852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4094982147216797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([211, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4100379943847656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4100379943847656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.410440444946289  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4221115112304688  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([210, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4229674339294434  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4229674339294434  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.423367977142334  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4377875328063965  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4385218620300293  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4385218620300293  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.438830852508545  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4521174430847168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4528512954711914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4528512954711914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4531030654907227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4656915664672852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4663810729980469  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4663810729980469  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.466583251953125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4781074523925781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4786901473999023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4786901473999023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4788408279418945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4884843826293945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4892067909240723  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4892067909240723  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4893651008605957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5006051063537598  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5012450218200684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5012450218200684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5013747215270996  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.511491298675537  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5122342109680176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5122342109680176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5123677253723145  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5237164497375488  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5243744850158691  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5243744850158691  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5244851112365723  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5346627235412598  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5351190567016602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5351190567016602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.535191535949707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5423669815063477  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([21, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5426335334777832  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5426335334777832  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5426735877990723  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.546919345855713  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5475454330444336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5475454330444336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5476255416870117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5566778182983398  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5572099685668945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5572099685668945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.557276725769043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5652875900268555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5657906532287598  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5657906532287598  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.565849781036377  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5733590126037598  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5737862586975098  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5737862586975098  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.57383394241333  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.580223560333252  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5806803703308105  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5806803703308105  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5807280540466309  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.587451457977295  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5878920555114746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5878920555114746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5879359245300293  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.594428539276123  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.59478759765625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.59478759765625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5948219299316406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6001434326171875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.600480079650879  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.600480079650879  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.600510597229004  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.605454444885254  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6057162284851074  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6057162284851074  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6057391166687012  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.609607219696045  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([300, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.616804599761963  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.616804599761963  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6173768043518066  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7323217391967773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 300, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7125353813171387  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7129592895507812  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7133831977844238  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.712937831878662  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21111
output nodes number: 2842
edges number: 23211
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7131166458129883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7131171226501465  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04930305480957031  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 13 input nodes size: 70248
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045267581939697266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045267581939697266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07876443862915039  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07878589630126953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045046329498291016  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04647493362426758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04647493362426758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04647493362426758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([70248, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04647493362426758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([813, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12911605834960938  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12911605834960938  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 813, 128]), torch.Size([1, 813, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.12989139556884766  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13637542724609375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 813, 128])
m.shape torch.Size([1059, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13699769973754883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13699769973754883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1059, 128]), torch.Size([1, 1059, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13800764083862305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15315675735473633  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1059, 128])
m.shape torch.Size([1178, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15433692932128906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15433692932128906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1178, 128]), torch.Size([1, 1178, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15546035766601562  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18017578125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1178, 128])
m.shape torch.Size([1024, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18156719207763672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18156719207763672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1024, 128]), torch.Size([1, 1024, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18254375457763672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21086406707763672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1024, 128])
m.shape torch.Size([1043, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21286249160766602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21286249160766602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1043, 128]), torch.Size([1, 1043, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21385717391967773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2496657371520996  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1043, 128])
m.shape torch.Size([1010, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2520580291748047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2520580291748047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1010, 128]), torch.Size([1, 1010, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.253021240234375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2947063446044922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1010, 128])
m.shape torch.Size([915, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29727888107299805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29727888107299805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 915, 128]), torch.Size([1, 915, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29815149307250977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3423423767089844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 915, 128])
m.shape torch.Size([829, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34506845474243164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34506845474243164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 829, 128]), torch.Size([1, 829, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3458590507507324  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39163827896118164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 829, 128])
m.shape torch.Size([783, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39460325241088867  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39460325241088867  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 783, 128]), torch.Size([1, 783, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39534997940063477  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.44420528411865234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 783, 128])
m.shape torch.Size([12627, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5040421485900879  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5040421485900879  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12627, 128]), torch.Size([1, 12627, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5160841941833496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3710694313049316  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12627, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2945928573608398  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3148880004882812  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3351831436157227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3147292137145996  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21281, 256])
first layer input nodes number: 70248
first layer output nodes number: 21281
edges number: 168190
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3357086181640625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.356003761291504  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3610777854919434  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3610777854919434  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([405, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.384225845336914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.384225845336914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3849983215332031  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3929944038391113  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([361, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3933024406433105  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3933024406433105  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3939909934997559  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4048657417297363  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([312, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.405421257019043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.405421257019043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4060163497924805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4201555252075195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([211, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4206695556640625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4206695556640625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.421072006225586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4327430725097656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([193, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4334697723388672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4334697723388672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.433837890625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4470901489257812  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([156, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4478058815002441  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4478058815002441  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.448103427886963  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4608979225158691  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4616508483886719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4616508483886719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4619064331054688  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4746856689453125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.475388526916504  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.475388526916504  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4755945205688477  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4873361587524414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.48799467086792  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.48799467086792  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4881625175476074  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4989047050476074  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4995036125183105  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4995036125183105  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4996390342712402  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.509253978729248  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5099902153015137  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5099902153015137  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5101351737976074  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.52144193649292  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5220961570739746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5220961570739746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5222163200378418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5324301719665527  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5330076217651367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5330076217651367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5331048965454102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5420541763305664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5426249504089355  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5426249504089355  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.542712688446045  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.551398754119873  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5519895553588867  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5519895553588867  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5520734786987305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.560969352722168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5613737106323242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5613737106323242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5614290237426758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5676794052124023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5682077407836914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5682077407836914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.568272590637207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.576054573059082  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5765066146850586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5765066146850586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5765600204467773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5833425521850586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5838637351989746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5838637351989746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.583920955657959  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5915884971618652  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5920405387878418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5920405387878418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.592088222503662  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5988116264343262  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5991110801696777  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5991110801696777  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5991415977478027  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6036581993103027  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6040449142456055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6040449142456055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.604081153869629  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6096982955932617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6100339889526367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6100339889526367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6100645065307617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6150083541870117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.615293025970459  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.615293025970459  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6153178215026855  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6195082664489746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([313, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6270170211791992  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6270170211791992  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6276140213012695  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7403392791748047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 313, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.720221996307373  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7206459045410156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7210698127746582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7206244468688965  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21281
output nodes number: 2842
edges number: 23546
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7208046913146973  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7208051681518555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04911184310913086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 14 input nodes size: 71287
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045046329498291016  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.045046329498291016  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07903861999511719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07906007766723633  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04554176330566406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04697990417480469  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04697990417480469  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04697990417480469  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([71287, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04697990417480469  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([847, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13021421432495117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13021421432495117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 847, 128]), torch.Size([1, 847, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13102197647094727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13748407363891602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 847, 128])
m.shape torch.Size([1107, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13835477828979492  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13835477828979492  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1107, 128]), torch.Size([1, 1107, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13941049575805664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15524625778198242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1107, 128])
m.shape torch.Size([1171, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15673446655273438  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15673446655273438  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1171, 128]), torch.Size([1, 1171, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1578512191772461  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1824197769165039  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1171, 128])
m.shape torch.Size([1091, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18394231796264648  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.18394231796264648  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1849827766418457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2158064842224121  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([1117, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21794939041137695  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21794939041137695  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21901464462280273  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.25779247283935547  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([996, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.26010942459106445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.26010942459106445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 996, 128]), torch.Size([1, 996, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2610592842102051  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.30322885513305664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 996, 128])
m.shape torch.Size([959, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3059549331665039  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3059549331665039  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 959, 128]), torch.Size([1, 959, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3068695068359375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3525981903076172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 959, 128])
m.shape torch.Size([865, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.355440616607666  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.355440616607666  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 865, 128]), torch.Size([1, 865, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3562655448913574  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4036068916320801  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 865, 128])
m.shape torch.Size([823, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4067263603210449  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4067263603210449  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40751123428344727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.45913171768188477  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([12582, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5187349319458008  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5187349319458008  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12582, 128]), torch.Size([1, 12582, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5307340621948242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3832755088806152  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12582, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3063898086547852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.326949119567871  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.347508430480957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3267884254455566  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21558, 256])
first layer input nodes number: 71287
first layer output nodes number: 21558
edges number: 169359
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3480415344238281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.368600845336914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3737406730651855  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3737406730651855  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([411, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3967938423156738  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3967938423156738  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3975777626037598  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4047856330871582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([376, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4051165580749512  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4051165580749512  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4058337211608887  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4171333312988281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([289, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4176082611083984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4176082611083984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4181594848632812  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4322724342346191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([234, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.432896614074707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.432896614074707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4333429336547852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4462862014770508  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([211, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4471535682678223  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4471535682678223  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4475560188293457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4620442390441895  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([140, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4626507759094238  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4626507759094238  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4629178047180176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4744000434875488  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([109, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4749999046325684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4749999046325684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.475207805633545  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.485602855682373  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4863524436950684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4863524436950684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4865641593933105  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4986319541931152  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([97, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4993653297424316  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4993653297424316  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4995503425598145  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5113911628723145  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.51198148727417  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.51198148727417  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5121169090270996  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5217318534851074  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5223517417907715  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5223517417907715  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5224757194519043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5321459770202637  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5328340530395508  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5328340530395508  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5329580307006836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5434961318969727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5440592765808105  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5440592765808105  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5441546440124512  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5529284477233887  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5534191131591797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5534191131591797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5534954071044922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5610485076904297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5616884231567383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5616884231567383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5617780685424805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5712804794311523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.57175874710083  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.57175874710083  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5718235969543457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5791516304016113  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5795607566833496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5795607566833496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5796122550964355  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.585792064666748  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5863375663757324  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5863375663757324  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5864005088806152  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5943942070007324  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5948195457458496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5948195457458496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.59486722946167  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6012568473815918  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6016368865966797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6016368865966797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6016769409179688  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6073246002197266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6078095436096191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6078095436096191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6078572273254395  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6149144172668457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6153769493103027  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6153769493103027  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6154208183288574  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.622220516204834  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6224641799926758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6224641799926758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6224870681762695  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.626194953918457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.62648344039917  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.62648344039917  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6265082359313965  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6306986808776855  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([313, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6382074356079102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6382074356079102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6388044357299805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7525248527526855  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 313, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7325081825256348  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7329320907592773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.73335599899292  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7329106330871582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21558
output nodes number: 2842
edges number: 23441
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.7330927848815918  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.73309326171875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04963970184326172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 15 input nodes size: 69842
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04554176330566406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04554176330566406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07884502410888672  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.07886648178100586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04485273361206055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04623556137084961  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04623556137084961  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04623556137084961  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([69842, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.04623556137084961  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([832, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1267547607421875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1267547607421875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 832, 128]), torch.Size([1, 832, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1275482177734375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1338958740234375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 832, 128])
m.shape torch.Size([1078, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13452720642089844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13452720642089844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1078, 128]), torch.Size([1, 1078, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.13555526733398438  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15097618103027344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1078, 128])
m.shape torch.Size([1095, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15202856063842773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15202856063842773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.15307283401489258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17604684829711914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([1094, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1776113510131836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.1776113510131836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.17865467071533203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.20966053009033203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([1027, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21158742904663086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21158742904663086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1027, 128]), torch.Size([1, 1027, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.21256685256958008  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.24859905242919922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1027, 128])
m.shape torch.Size([1040, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2510848045349121  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2510848045349121  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1040, 128]), torch.Size([1, 1040, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2520766258239746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.2954859733581543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1040, 128])
m.shape torch.Size([938, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29812097549438477  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29812097549438477  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 938, 128]), torch.Size([1, 938, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.29901552200317383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.3438553810119629  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 938, 128])
m.shape torch.Size([899, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34683752059936523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34683752059936523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 899, 128]), torch.Size([1, 899, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.34769487380981445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.39745664596557617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 899, 128])
m.shape torch.Size([828, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40058135986328125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.40058135986328125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 828, 128]), torch.Size([1, 828, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.4013710021972656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.45363807678222656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 828, 128])
m.shape torch.Size([11960, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5102729797363281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5102729797363281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 11960, 128]), torch.Size([1, 11960, 128])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 0.5216789245605469  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3502693176269531  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 11960, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2759594917297363  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2957873344421387  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.315615177154541  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.2956323623657227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([20791, 256])
first layer input nodes number: 69842
first layer output nodes number: 20791
edges number: 162834
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3161377906799316  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.335965633392334  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3409323692321777  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3409323692321777  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([416, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3632211685180664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3632211685180664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3640146255493164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.372288703918457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([351, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3725666999816895  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3725666999816895  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3732361793518066  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3835701942443848  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([296, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3840889930725098  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3840889930725098  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3846535682678223  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3981308937072754  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([229, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3987293243408203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3987293243408203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.3991661071777344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4118328094482422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([201, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4125804901123047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4125804901123047  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4129638671875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4267654418945312  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([161, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4275026321411133  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4275026321411133  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.427809715270996  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.441014289855957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4416751861572266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4416751861572266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4419059753417969  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4534454345703125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([127, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4543066024780273  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4543066024780273  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4545488357543945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4683561325073242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([115, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4693264961242676  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4693264961242676  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.469545841217041  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.483583927154541  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4842047691345215  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4842047691345215  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4843497276306152  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4946417808532715  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4951720237731934  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4951720237731934  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.4952807426452637  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.503760814666748  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5044445991516113  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5044445991516113  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5045666694641113  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5149426460266113  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([65, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5156941413879395  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5156941413879395  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5158181190490723  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.527224063873291  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5278081893920898  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5278081893920898  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5278997421264648  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5369634628295898  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5374369621276855  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5374369621276855  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5375056266784668  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5447840690612793  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5453033447265625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5453033447265625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5453720092773438  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.553131103515625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5537505149841309  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5537505149841309  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5538268089294434  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5629820823669434  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5636014938354492  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5636014938354492  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.563673973083496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5728788375854492  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5731897354125977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5731897354125977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.573225975036621  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5780820846557617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5785255432128906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5785255432128906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5785713195800781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5850257873535156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5855278968811035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5855278968811035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5855774879455566  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5929169654846191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5932307243347168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5932307243347168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5932612419128418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5979914665222168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5982637405395508  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5982637405395508  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.5982885360717773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6023054122924805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6025700569152832  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6025700569152832  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.602592945098877  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6064610481262207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([255, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.612576961517334  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.612576961517334  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 3.9295654296875 GB
    Memory Allocated: 1.6130633354187012  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9354248046875 GB
    Memory Allocated: 1.6986651420593262  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 255, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9354248046875 GB
    Memory Allocated: 1.6796083450317383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9354248046875 GB
    Memory Allocated: 1.6800322532653809  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6804561614990234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6800107955932617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 20791
output nodes number: 2842
edges number: 22644
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6801872253417969  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.680187702178955  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04880571365356445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 16 input nodes size: 69787
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04485273361206055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04485273361206055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07812976837158203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07815122604370117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.044826507568359375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.046217918395996094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.046217918395996094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.046217918395996094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([69787, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.046217918395996094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([834, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.12680578231811523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.12680578231811523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 834, 128]), torch.Size([1, 834, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.12760114669799805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13463401794433594  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 834, 128])
m.shape torch.Size([1031, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13521957397460938  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13521957397460938  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1031, 128]), torch.Size([1, 1031, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13620281219482422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15095138549804688  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1031, 128])
m.shape torch.Size([1117, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15205764770507812  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15205764770507812  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1531229019165039  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1765584945678711  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([1142, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1785130500793457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1785130500793457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1142, 128]), torch.Size([1, 1142, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.17960214614868164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21118593215942383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1142, 128])
m.shape torch.Size([1123, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2133188247680664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2133188247680664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1123, 128]), torch.Size([1, 1123, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21438980102539062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25319862365722656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1123, 128])
m.shape torch.Size([961, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25541257858276367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25541257858276367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 961, 128]), torch.Size([1, 961, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2563290596008301  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.29601049423217773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 961, 128])
m.shape torch.Size([910, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.29858970642089844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.29858970642089844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 910, 128]), torch.Size([1, 910, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2994575500488281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3439664840698242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 910, 128])
m.shape torch.Size([907, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.34699249267578125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.34699249267578125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 907, 128]), torch.Size([1, 907, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3478574752807617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3981475830078125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 907, 128])
m.shape torch.Size([807, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40117835998535156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40117835998535156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4019479751586914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4522590637207031  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([12087, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5104680061340332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5104680061340332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12087, 128]), torch.Size([1, 12087, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5219950675964355  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3519177436828613  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12087, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.2775506973266602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.2975006103515625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3174505233764648  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.29734468460083  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([20919, 256])
first layer input nodes number: 69787
first layer output nodes number: 20919
edges number: 163955
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3179726600646973  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3379225730895996  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3432893753051758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3432893753051758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([435, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3656678199768066  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3656678199768066  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.36649751663208  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3744120597839355  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 435, 256])
m.shape torch.Size([359, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.374687671661377  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.374687671661377  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3753724098205566  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3900599479675293  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([303, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3905916213989258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3905916213989258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.391169548034668  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4048023223876953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([224, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.405374526977539  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.405374526977539  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.405801773071289  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.418191909790039  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([189, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.418886661529541  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.418886661529541  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4192471504211426  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4322247505187988  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([144, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.432875156402588  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.432875156402588  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.433149814605713  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.444960117340088  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.44575834274292  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.44575834274292  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4460234642028809  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4592795372009277  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([100, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.459916114807129  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.459916114807129  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4601068496704102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4709787368774414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4718093872070312  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4718093872070312  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4720134735107422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4850749969482422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4858283996582031  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4858283996582031  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4859981536865234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4980506896972656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.498769760131836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.498769760131836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4989147186279297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5102214813232422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5108413696289062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5108413696289062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.510955810546875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5206832885742188  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.521188735961914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.521188735961914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5212745666503906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5291709899902344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.529747486114502  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.529747486114502  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5298352241516113  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5385212898254395  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.539011001586914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.539011001586914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5390815734863281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5465621948242188  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5470499992370605  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5470499992370605  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5471148490905762  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5544428825378418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5550317764282227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5550317764282227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5551042556762695  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5638017654418945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.564180850982666  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.564180850982666  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5642266273498535  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.570040225982666  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5704193115234375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5704193115234375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5704612731933594  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5760841369628906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5766210556030273  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5766210556030273  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.576676368713379  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5844755172729492  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5848112106323242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5848112106323242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5848455429077148  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5899267196655273  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5903115272521973  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5903115272521973  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5903477668762207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5959649085998535  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5963892936706543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5963892936706543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5964274406433105  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.602607250213623  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6030035018920898  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6030035018920898  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6030378341674805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.608839988708496  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([267, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6152386665344238  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6152386665344238  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6157479286193848  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7076387405395508  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 267, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6883578300476074  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.68878173828125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6892056465148926  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6887602806091309  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 20919
output nodes number: 2842
edges number: 22716
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6889376640319824  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6889381408691406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.048799991607666016  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 17 input nodes size: 71429
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.044826507568359375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.044826507568359375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07888650894165039  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07890796661376953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045609474182128906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04704761505126953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04704761505126953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04704761505126953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([71429, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04704761505126953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([864, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13022565841674805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13022565841674805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 864, 128]), torch.Size([1, 864, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13104963302612305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13764142990112305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 864, 128])
m.shape torch.Size([1082, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1385669708251953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1385669708251953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1082, 128]), torch.Size([1, 1082, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13959884643554688  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1550769805908203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1082, 128])
m.shape torch.Size([1164, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15676593780517578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15676593780517578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1164, 128]), torch.Size([1, 1164, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15787601470947266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1822977066040039  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1164, 128])
m.shape torch.Size([1127, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18389225006103516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18389225006103516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1127, 128]), torch.Size([1, 1127, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.184967041015625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21625041961669922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1127, 128])
m.shape torch.Size([1083, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21829509735107422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21829509735107422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1083, 128]), torch.Size([1, 1083, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2193279266357422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25745439529418945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1083, 128])
m.shape torch.Size([1029, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25988197326660156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25988197326660156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1029, 128]), torch.Size([1, 1029, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2608633041381836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3036375045776367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1029, 128])
m.shape torch.Size([935, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.30626773834228516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.30626773834228516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 935, 128]), torch.Size([1, 935, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.307159423828125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.35182762145996094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 935, 128])
m.shape torch.Size([885, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.35475778579711914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.35475778579711914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 885, 128]), torch.Size([1, 885, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.35560178756713867  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40515565872192383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 885, 128])
m.shape torch.Size([775, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40805959701538086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40805959701538086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 775, 128]), torch.Size([1, 775, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4087986946105957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.45673036575317383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 775, 128])
m.shape torch.Size([12601, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5164470672607422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5164470672607422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12601, 128]), torch.Size([1, 12601, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5284643173217773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.382188320159912  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12601, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3053507804870605  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3258976936340332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3464446067810059  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3257369995117188  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21545, 256])
first layer input nodes number: 71429
first layer output nodes number: 21545
edges number: 169227
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3469791412353516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3675260543823242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3726630210876465  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3726630210876465  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([429, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3968148231506348  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3968148231506348  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3976330757141113  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.404956340789795  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([369, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.405256748199463  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.405256748199463  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4059605598449707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.417025089263916  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([279, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.417478084564209  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.417478084564209  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4180102348327637  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4320068359375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([240, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4326634407043457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4326634407043457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4331212043762207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4463963508605957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([189, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4470758438110352  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4470758438110352  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4474363327026367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.460413932800293  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([147, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4610815048217773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4610815048217773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4613618850708008  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4734182357788086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([122, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4740991592407227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4740991592407227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4743318557739258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.485966682434082  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([90, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4865427017211914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4865427017211914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4867143630981445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4964990615844727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4971399307250977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4971399307250977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.497300148010254  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.507554054260254  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5081567764282227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5081567764282227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5082921981811523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5179071426391602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([83, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5187172889709473  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5187172889709473  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5188755989074707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5312237739562988  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5318598747253418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5318598747253418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5319781303405762  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.542029857635498  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5425958633422852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5425958633422852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5426912307739258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5514650344848633  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5520501136779785  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5520501136779785  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5521397590637207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5610146522521973  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5615034103393555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5615034103393555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5615739822387695  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5690546035766602  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.569572925567627  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.569572925567627  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5696415901184082  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5774006843566895  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5779223442077637  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5779223442077637  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5779871940612793  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5857691764831543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.586273193359375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.586273193359375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5863323211669922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.593841552734375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.59434175491333  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.59434175491333  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5943970680236816  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.601809024810791  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6023964881896973  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6023964881896973  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6024575233459473  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6110634803771973  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6114568710327148  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6114568710327148  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.611496925354004  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6174249649047852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.617785930633545  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.617785930633545  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6178202629089355  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6231417655944824  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6234784126281738  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6234784126281738  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6235089302062988  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6284527778625488  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.628760814666748  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.628760814666748  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6287875175476074  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6333003044128418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([312, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6407837867736816  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6407837867736816  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6413788795471191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.753675937652588  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 312, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7325797080993652  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7330036163330078  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7334275245666504  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7329821586608887  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21545
output nodes number: 2842
edges number: 23595
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7331643104553223  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7331647872924805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04970979690551758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 18 input nodes size: 71939
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045609474182128906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045609474182128906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07991266250610352  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07993412017822266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0458526611328125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0473175048828125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0473175048828125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0473175048828125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([71939, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0473175048828125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([798, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13207292556762695  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13207292556762695  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 798, 128]), torch.Size([1, 798, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13283395767211914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1391153335571289  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 798, 128])
m.shape torch.Size([1108, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13979148864746094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13979148864746094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1108, 128]), torch.Size([1, 1108, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.14084815979003906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15669822692871094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1108, 128])
m.shape torch.Size([1126, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15778064727783203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15778064727783203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1126, 128]), torch.Size([1, 1126, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15885448455810547  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18268108367919922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1126, 128])
m.shape torch.Size([1109, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18425941467285156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18425941467285156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1109, 128]), torch.Size([1, 1109, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1853170394897461  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21648216247558594  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1109, 128])
m.shape torch.Size([1101, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21857833862304688  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21857833862304688  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21962833404541016  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2581048011779785  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1101, 128])
m.shape torch.Size([978, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2603778839111328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2603778839111328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 978, 128]), torch.Size([1, 978, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2613105773925781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3022937774658203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 978, 128])
m.shape torch.Size([925, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3049149513244629  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3049149513244629  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 925, 128]), torch.Size([1, 925, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.30579710006713867  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3503913879394531  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 925, 128])
m.shape torch.Size([888, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.35333776473999023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.35333776473999023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 888, 128]), torch.Size([1, 888, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.354184627532959  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40404462814331055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 888, 128])
m.shape torch.Size([839, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40722179412841797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40722179412841797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4080219268798828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.46076059341430664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([12920, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5228605270385742  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5228605270385742  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12920, 128]), torch.Size([1, 12920, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.535181999206543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4301939010620117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12920, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3517417907714844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3725242614746094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3933067321777344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.372361660003662  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21792, 256])
first layer input nodes number: 71939
first layer output nodes number: 21792
edges number: 172531
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3938450813293457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4146275520324707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4202370643615723  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4202370643615723  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([394, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.444359302520752  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.444359302520752  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.44511079788208  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.452019214630127  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 394, 256])
m.shape torch.Size([359, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.452333927154541  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.452333927154541  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4530186653137207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.463697910308838  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([282, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4641690254211426  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4641690254211426  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4647068977355957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4779601097106934  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4785833358764648  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4785833358764648  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4790258407592773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4918584823608398  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([211, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.49269437789917  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.49269437789917  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4930968284606934  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.507585048675537  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.508260726928711  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.508260726928711  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5085506439208984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.521017074584961  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.521733283996582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.521733283996582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.521977424621582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.534184455871582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5347929000854492  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5347929000854492  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5349740982055664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.545302391052246  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5460944175720215  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5460944175720215  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5462889671325684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5587401390075684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5593833923339844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5593833923339844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.559530258178711  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5699577331542969  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5705718994140625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5705718994140625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5706958770751953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5803661346435547  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([45, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5808234214782715  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5808234214782715  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.580909252166748  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5882048606872559  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5887870788574219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5887870788574219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5888824462890625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.59765625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5981740951538086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5981740951538086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5982542037963867  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.606184959411621  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6065921783447266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6065921783447266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6066513061523438  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6129188537597656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6135659217834473  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6135659217834473  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.613649845123291  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6231331825256348  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6237611770629883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6237611770629883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6238393783569336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.633223533630371  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([43, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6339287757873535  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6339287757873535  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6340107917785645  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6444268226623535  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6449522972106934  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6449522972106934  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6450114250183105  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6529345512390137  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6534628868103027  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6534628868103027  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6535181999206543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6613173484802246  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6618952751159668  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6618952751159668  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6619524955749512  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6704211235046387  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6706676483154297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6706676483154297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6706924438476562  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6745357513427734  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6748552322387695  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6748552322387695  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6748838424682617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.679518699645996  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6798505783081055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6798505783081055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6798791885375977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6847143173217773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([316, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6922931671142578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6922931671142578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6928958892822266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.8009319305419922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 316, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7798309326171875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.78025484085083  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7806787490844727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.780233383178711  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21792
output nodes number: 2842
edges number: 24020
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7804174423217773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7804179191589355  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0500187873840332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 19 input nodes size: 70987
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0458526611328125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0458526611328125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07970190048217773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07972335815429688  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045398712158203125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04682159423828125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04682159423828125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04682159423828125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([70987, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04682159423828125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([831, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.12915277481079102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.12915277481079102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 831, 128]), torch.Size([1, 831, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1299452781677246  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13684606552124023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 831, 128])
m.shape torch.Size([1054, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13745498657226562  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13745498657226562  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1054, 128]), torch.Size([1, 1054, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1384601593017578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15353775024414062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1054, 128])
m.shape torch.Size([1153, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15468454360961914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15468454360961914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1153, 128]), torch.Size([1, 1153, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15578413009643555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.17997503280639648  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1153, 128])
m.shape torch.Size([1081, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1814870834350586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1814870834350586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1081, 128]), torch.Size([1, 1081, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18251800537109375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21325206756591797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1081, 128])
m.shape torch.Size([1126, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21542119979858398  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21542119979858398  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1126, 128]), torch.Size([1, 1126, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21649503707885742  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2554497718811035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1126, 128])
m.shape torch.Size([990, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25774526596069336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25774526596069336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 990, 128]), torch.Size([1, 990, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25868940353393555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3007998466491699  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 990, 128])
m.shape torch.Size([944, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3034787178039551  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3034787178039551  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 944, 128]), torch.Size([1, 944, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3043789863586426  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3493924140930176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 944, 128])
m.shape torch.Size([883, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3523106575012207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3523106575012207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 883, 128]), torch.Size([1, 883, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3531527519226074  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40169191360473633  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 883, 128])
m.shape torch.Size([772, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4045839309692383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4045839309692383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 772, 128]), torch.Size([1, 772, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4053201675415039  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.45305395126342773  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 772, 128])
m.shape torch.Size([12462, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5121092796325684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5121092796325684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12462, 128]), torch.Size([1, 12462, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.523993968963623  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3687820434570312  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12462, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.2927050590515137  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3130145072937012  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3333239555358887  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3128557205200195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21296, 256])
first layer input nodes number: 70987
first layer output nodes number: 21296
edges number: 167532
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.333855152130127  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3541646003723145  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3592419624328613  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3592419624328613  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([420, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3821773529052734  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3821773529052734  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3829784393310547  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.389444351196289  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([373, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.389760971069336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.389760971069336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.390472412109375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.402334213256836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([286, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4028034210205078  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4028034210205078  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4033489227294922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4193601608276367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([225, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4199528694152832  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4199528694152832  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.420382022857666  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4328274726867676  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([172, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4334397315979004  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4334397315979004  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4337677955627441  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4455780982971191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([134, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4461870193481445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4461870193481445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4464426040649414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.457432746887207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([138, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4582338333129883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4582338333129883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4584970474243164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4716577529907227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([100, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4722952842712402  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4722952842712402  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4724860191345215  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4833579063415527  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4840326309204102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4840326309204102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4842023849487305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4950666427612305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([103, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.495995044708252  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.495995044708252  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4961915016174316  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5101399421691895  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([82, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.510909080505371  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.510909080505371  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5110654830932617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5232648849487305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5240521430969238  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5240521430969238  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5241951942443848  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5363545417785645  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5369830131530762  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5369830131530762  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5370898246765137  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5469164848327637  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5474419593811035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5474419593811035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5475239753723145  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5556435585021973  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5561795234680176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5561795234680176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.55625581741333  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.564342975616455  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5648431777954102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5648431777954102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5649099349975586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.572453498840332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5728449821472168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5728449821472168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.57289457321167  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.578845500946045  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5793228149414062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5793228149414062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5793781280517578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5864028930664062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5869779586791992  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5869779586791992  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.587040901184082  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.595475196838379  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5959243774414062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5959243774414062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5959720611572266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6026954650878906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6031765937805176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6031765937805176  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.603224277496338  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6102814674377441  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6106386184692383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6106386184692383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.610672950744629  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6159944534301758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6164417266845703  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6164417266845703  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6164817810058594  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6229705810546875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6232504844665527  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6232504844665527  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6232752799987793  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6274657249450684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([281, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6342053413391113  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6342053413391113  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6347413063049316  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7418837547302246  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 281, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7220230102539062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7224469184875488  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7228708267211914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7224254608154297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21296
output nodes number: 2842
edges number: 23309
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7226057052612305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7226061820983887  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.049457550048828125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 20 input nodes size: 70282
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045398712158203125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045398712158203125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07891178131103516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0789332389831543  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04506254196166992  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04647111892700195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04647111892700195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04647111892700195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([70282, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04647111892700195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([831, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.12803363800048828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.12803363800048828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 831, 128]), torch.Size([1, 831, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.12882614135742188  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13516616821289062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 831, 128])
m.shape torch.Size([1027, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13608074188232422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13608074188232422  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1027, 128]), torch.Size([1, 1027, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13706016540527344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15175151824951172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1027, 128])
m.shape torch.Size([1147, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15290260314941406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15290260314941406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1147, 128]), torch.Size([1, 1147, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15399646759033203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.17884111404418945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1147, 128])
m.shape torch.Size([1099, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1803903579711914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1803903579711914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1099, 128]), torch.Size([1, 1099, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18143844604492188  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21249866485595703  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1099, 128])
m.shape torch.Size([1102, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21460199356079102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21460199356079102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1102, 128]), torch.Size([1, 1102, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2156529426574707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2542128562927246  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1102, 128])
m.shape torch.Size([1000, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2565484046936035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2565484046936035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1000, 128]), torch.Size([1, 1000, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25750207901000977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2990899085998535  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1000, 128])
m.shape torch.Size([898, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.30161046981811523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.30161046981811523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 898, 128]), torch.Size([1, 898, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.30246686935424805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.34690141677856445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 898, 128])
m.shape torch.Size([867, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3497805595397949  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3497805595397949  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 867, 128]), torch.Size([1, 867, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.35060739517211914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3977370262145996  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 867, 128])
m.shape torch.Size([795, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40073537826538086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40073537826538086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40149354934692383  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4501485824584961  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([12335, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5085873603820801  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5085873603820801  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12335, 128]), torch.Size([1, 12335, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5203509330749512  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3555645942687988  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12335, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.2802085876464844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3003320693969727  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.320455551147461  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3001747131347656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21101, 256])
first layer input nodes number: 70282
first layer output nodes number: 21101
edges number: 165959
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.320981502532959  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3411049842834473  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3461360931396484  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3461360931396484  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([425, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3687143325805664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3687143325805664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3695249557495117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3767366409301758  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([379, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3770599365234375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3770599365234375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3777828216552734  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.390523910522461  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([285, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3909845352172852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3909845352172852  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3915281295776367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4087820053100586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4094023704528809  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4094023704528809  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4098448753356934  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4226775169372559  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([223, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.424328327178955  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.424328327178955  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4247536659240723  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.440065860748291  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4406952857971191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4406952857971191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4409737586975098  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4529480934143066  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([91, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4534211158752441  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4534211158752441  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.45359468460083  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.462273120880127  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4629859924316406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4629859924316406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4631843566894531  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4744911193847656  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4753179550170898  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4753179550170898  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4755220413208008  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4885835647583008  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4891643524169922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4891643524169922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4892997741699219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4989147186279297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4995131492614746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4995131492614746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4996333122253418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5090060234069824  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.509626865386963  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.509626865386963  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5097393989562988  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5193047523498535  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5199484825134277  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5199484825134277  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5200552940368652  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5298819541931152  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.530609130859375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.530609130859375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5307197570800781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5416717529296875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.542337417602539  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.542337417602539  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5424327850341797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.552541732788086  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5531249046325684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5531249046325684  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5532031059265137  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.562039852142334  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5624909400939941  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5624909400939941  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5625481605529785  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5694146156311035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5696978569030762  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5696978569030762  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5697321891784668  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5740923881530762  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5745139122009277  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5745139122009277  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5745596885681152  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5806937217712402  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5812091827392578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5812091827392578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5812625885009766  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5887928009033203  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.58906888961792  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.58906888961792  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.589097499847412  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5933318138122559  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.593719482421875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.593719482421875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5937557220458984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5993728637695312  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5996646881103516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5996646881103516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.599691390991211  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6040172576904297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6043729782104492  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6043729782104492  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6044034957885742  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6095609664916992  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([288, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6164660453796387  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6164660453796387  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6170153617858887  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.732046127319336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 288, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7128791809082031  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7133030891418457  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7137269973754883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7132816314697266  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21101
output nodes number: 2842
edges number: 22935
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7134604454040527  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.713460922241211  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04907989501953125  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 21 input nodes size: 70872
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04506254196166992  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04506254196166992  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0788569450378418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07887840270996094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045343875885009766  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.046788692474365234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.046788692474365234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.046788692474365234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([70872, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.046788692474365234  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([797, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13127851486206055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13127851486206055  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 797, 128]), torch.Size([1, 797, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13203859329223633  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13811922073364258  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 797, 128])
m.shape torch.Size([1080, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13876914978027344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13876914978027344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1397991180419922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15524864196777344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([1156, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1563873291015625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1563873291015625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1156, 128]), torch.Size([1, 1156, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15748977661132812  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18198204040527344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1156, 128])
m.shape torch.Size([1068, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18346786499023438  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18346786499023438  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1068, 128]), torch.Size([1, 1068, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18448638916015625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21402359008789062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1068, 128])
m.shape torch.Size([1084, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21609878540039062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21609878540039062  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1084, 128]), torch.Size([1, 1084, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.217132568359375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2558307647705078  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1084, 128])
m.shape torch.Size([1034, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2582721710205078  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2582721710205078  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1034, 128]), torch.Size([1, 1034, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2592582702636719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3021697998046875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1034, 128])
m.shape torch.Size([919, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.30474424362182617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.30474424362182617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 919, 128]), torch.Size([1, 919, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3056206703186035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.34972047805786133  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 919, 128])
m.shape torch.Size([858, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3525552749633789  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3525552749633789  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 858, 128]), torch.Size([1, 858, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.35337352752685547  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40096187591552734  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 858, 128])
m.shape torch.Size([815, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.404050350189209  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.404050350189209  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 815, 128]), torch.Size([1, 815, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4048275947570801  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4563617706298828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 815, 128])
m.shape torch.Size([12715, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5166029930114746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5166029930114746  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12715, 128]), torch.Size([1, 12715, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5287289619445801  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3902201652526855  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12715, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.311981201171875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.332509994506836  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3530387878417969  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3323493003845215  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21526, 256])
first layer input nodes number: 70872
first layer output nodes number: 21526
edges number: 170103
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3535690307617188  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3740978240966797  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.379948616027832  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.379948616027832  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([422, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4040946960449219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4040946960449219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4048995971679688  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4115991592407227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([382, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.411931037902832  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.411931037902832  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4126596450805664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.423661231994629  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([286, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4241218566894531  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4241218566894531  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4246673583984375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4370975494384766  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.437678337097168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.437678337097168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4381017684936523  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4503812789916992  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([171, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4509916305541992  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4509916305541992  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4513177871704102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.463059425354004  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.463773250579834  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.463773250579834  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4640631675720215  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.476529598236084  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([111, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4771318435668945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4771318435668945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4773435592651367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.487929344177246  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4886231422424316  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4886231422424316  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4888215065002441  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5001282691955566  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([97, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.500868320465088  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.500868320465088  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5010533332824707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5128941535949707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5136570930480957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5136570930480957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.513826847076416  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5258793830871582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5264501571655273  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5264501571655273  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5265684127807617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.535792350769043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5364713668823242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5364713668823242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5365934371948242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5469694137573242  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5475459098815918  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5475459098815918  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5476431846618652  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5565924644470215  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5572304725646973  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5572304725646973  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5573277473449707  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.566957950592041  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5675148963928223  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5675148963928223  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5675950050354004  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5760865211486816  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.576554298400879  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.576554298400879  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5766172409057617  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5837297439575195  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5843682289123535  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5843682289123535  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5844464302062988  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5938305854797363  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.594172477722168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.594172477722168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5942144393920898  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.599543571472168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.599942684173584  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.599942684173584  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5999865531921387  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6058650016784668  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6061506271362305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6061506271362305  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6061811447143555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6104841232299805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6109333038330078  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6109333038330078  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6109771728515625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6174697875976562  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.617807388305664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.617807388305664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6178398132324219  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6228656768798828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.623335838317871  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.623335838317871  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.623377799987793  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6301755905151367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.630547046661377  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.630547046661377  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6305794715881348  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.636059284210205  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([322, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.64378023147583  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.64378023147583  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6443943977355957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7542757987976074  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 322, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7331700325012207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7335939407348633  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7340178489685059  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7335724830627441  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([2842, 40])
input nodes number: 21526
output nodes number: 2842
edges number: 23727
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7337546348571777  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.733755111694336  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0494542121887207  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

pseudo mini batch 22 input nodes size: 71482
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045343875885009766  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045343875885009766  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07942914962768555  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07945060729980469  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04563474655151367  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.047106266021728516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.047106266021728516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.047106266021728516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([71482, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.047106266021728516  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([784, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13222980499267578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13222980499267578  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 784, 128]), torch.Size([1, 784, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13297748565673828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13895893096923828  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 784, 128])
m.shape torch.Size([1050, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13993120193481445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13993120193481445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1050, 128]), torch.Size([1, 1050, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.14093255996704102  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15595293045043945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1050, 128])
m.shape torch.Size([1053, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15695858001708984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15695858001708984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1053, 128]), torch.Size([1, 1053, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15796279907226562  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1800556182861328  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1053, 128])
m.shape torch.Size([1117, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18168401718139648  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18168401718139648  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18274927139282227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21399831771850586  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([1079, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21603822708129883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21603822708129883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 1079, 128]), torch.Size([1, 1079, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21706724166870117  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2543163299560547  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 1079, 128])
m.shape torch.Size([975, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2565913200378418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2565913200378418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 975, 128]), torch.Size([1, 975, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2575211524963379  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.29843854904174805  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 975, 128])
m.shape torch.Size([989, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.30127477645874023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.30127477645874023  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 989, 128]), torch.Size([1, 989, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.302217960357666  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.35004472732543945  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 989, 128])
m.shape torch.Size([932, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.35312843322753906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.35312843322753906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3540172576904297  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4046802520751953  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([810, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4077119827270508  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4077119827270508  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 810, 128]), torch.Size([1, 810, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40848445892333984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.45871543884277344  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 810, 128])
m.shape torch.Size([12988, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5208292007446289  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5208292007446289  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 12988, 128]), torch.Size([1, 12988, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5341806411743164  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4360055923461914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 12988, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.357144832611084  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.377912998199463  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3986811637878418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3777503967285156  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

torch.Size([21777, 256])
first layer input nodes number: 71482
first layer output nodes number: 21777
edges number: 173305
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3992156982421875  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4199838638305664  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4251761436462402  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4251761436462402  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

m.shape torch.Size([393, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4492993354797363  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4492993354797363  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4500489234924316  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4568071365356445  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([381, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4571647644042969  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4571647644042969  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4578914642333984  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4688081741333008  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([275, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4692378044128418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4692378044128418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4697623252868652  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.482818603515625  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([216, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4833869934082031  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4833869934082031  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4837989807128906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4957466125488281  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([203, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.496516227722168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.496516227722168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.496903419494629  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5108423233032227  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([140, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5114564895629883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5114564895629883  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.511723518371582  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5232057571411133  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5239067077636719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5239067077636719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5241432189941406  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5359687805175781  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5367732048034668  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5367732048034668  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5370020866394043  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5500483512878418  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5506434440612793  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5506434440612793  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.55079984664917  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.56080961227417  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5616540908813477  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5616540908813477  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5618371963500977  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5748376846313477  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5755181312561035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5755181312561035  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5756573677062988  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5865178108215332  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5870018005371094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5870018005371094  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5870933532714844  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5948753356933594  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.595491886138916  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.595491886138916  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.595592975616455  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6048932075500488  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6054348945617676  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6054348945617676  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6055188179016113  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6138272285461426  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6143908500671387  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6143908500671387  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6144709587097168  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.622962474822998  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.623368740081787  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.623368740081787  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6234240531921387  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6296744346618652  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6301860809326172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6301860809326172  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6302490234375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6378021240234375  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6382207870483398  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6382207870483398  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.638270378112793  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6445684432983398  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6450004577636719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6450004577636719  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6450481414794922  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.651437759399414  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.651933193206787  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.651933193206787  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.651984691619873  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6592459678649902  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6597046852111816  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6597046852111816  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6597504615783691  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6665253639221191  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6669044494628906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6669044494628906  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.666940689086914  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6725578308105469  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.672959804534912  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.672959804534912  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6729960441589355  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6788668632507324  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.679333209991455  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.679333209991455  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6793732643127441  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6861424446105957  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([329, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.694282054901123  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.694282054901123  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6949095726013184  GigaBytes
Max Memory Allocated: 1.8137831687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.808457851409912  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 329, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7873435020446777  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7877674102783203  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.788191318511963  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7877459526062012  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([2842, 40])
input nodes number: 21777
output nodes number: 2842
edges number: 24135
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7879300117492676  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7879304885864258  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.049811363220214844  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

pseudo mini batch 23 input nodes size: 71208
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04563474655151367  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04563474655151367  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0795893669128418  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07961082458496094  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045504093170166016  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04692792892456055  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04692792892456055  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04692792892456055  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([71208, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04692792892456055  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

m.shape torch.Size([831, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1294541358947754  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1294541358947754  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 831, 128]), torch.Size([1, 831, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13024663925170898  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1369614601135254  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 831, 128])
m.shape torch.Size([1204, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13771343231201172  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13771343231201172  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1204, 128]), torch.Size([1, 1204, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13886165618896484  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15608501434326172  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1204, 128])
m.shape torch.Size([1150, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15715599060058594  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15715599060058594  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1150, 128]), torch.Size([1, 1150, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15825271606445312  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18271923065185547  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1150, 128])
m.shape torch.Size([1166, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18439483642578125  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18439483642578125  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1166, 128]), torch.Size([1, 1166, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18550682067871094  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21775436401367188  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1166, 128])
m.shape torch.Size([1035, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2196660041809082  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2196660041809082  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1035, 128]), torch.Size([1, 1035, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.22065305709838867  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25618696212768555  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1035, 128])
m.shape torch.Size([988, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25852012634277344  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25852012634277344  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 988, 128]), torch.Size([1, 988, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2594623565673828  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.30066490173339844  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 988, 128])
m.shape torch.Size([939, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3033280372619629  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3033280372619629  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 939, 128]), torch.Size([1, 939, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.30422353744506836  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3489985466003418  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 939, 128])
m.shape torch.Size([909, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3520183563232422  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3520183563232422  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.35288524627685547  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40283823013305664  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([849, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40633201599121094  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40633201599121094  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 849, 128]), torch.Size([1, 849, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40714168548583984  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.45916080474853516  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 849, 128])
m.shape torch.Size([12398, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5178742408752441  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5178742408752441  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 12398, 128]), torch.Size([1, 12398, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5296978950500488  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3691773414611816  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 12398, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.2930245399475098  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3134989738464355  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3339734077453613  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3133387565612793  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([21469, 256])
first layer input nodes number: 71208
first layer output nodes number: 21469
edges number: 167922
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3345060348510742  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.35498046875  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3600993156433105  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3600993156433105  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

m.shape torch.Size([390, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3827667236328125  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3827667236328125  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3835105895996094  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3900866508483887  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([400, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3904838562011719  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3904838562011719  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3912467956542969  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4039955139160156  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([295, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4044647216796875  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4044647216796875  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4050273895263672  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.421797752380371  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([237, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4224276542663574  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4224276542663574  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.422879695892334  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4359889030456543  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([173, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4365944862365723  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4365944862365723  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4369244575500488  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.448803424835205  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([174, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4503898620605469  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4503898620605469  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4507217407226562  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4649925231933594  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4656410217285156  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4656410217285156  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.465871810913086  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4774112701416016  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4781956672668457  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4781956672668457  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4784188270568848  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4911389350891113  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([97, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4918665885925293  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4918665885925293  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.492051601409912  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.503892421722412  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([65, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.504425048828125  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.504425048828125  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5045490264892578  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5133514404296875  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([80, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5141353607177734  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5141353607177734  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5142879486083984  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5261898040771484  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5266904830932617  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5266904830932617  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5267858505249023  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5348920822143555  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5354442596435547  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5354442596435547  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5355358123779297  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5439586639404297  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5443434715270996  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5443434715270996  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5444045066833496  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5504469871520996  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([55, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5512094497680664  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5512094497680664  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.551314353942871  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.562434196472168  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5629663467407227  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5629663467407227  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5630388259887695  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5712289810180664  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.571699619293213  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.571699619293213  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.57175874710083  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5788540840148926  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5793781280517578  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5793781280517578  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5794391632080078  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5871906280517578  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5876169204711914  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5876169204711914  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5876646041870117  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5940542221069336  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5944533348083496  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5944533348083496  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5944952964782715  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6004118919372559  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6008553504943848  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6008553504943848  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6008992195129395  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6073918342590332  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6076874732971191  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6076874732971191  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6077160835266113  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6121506690979004  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6123576164245605  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6123576164245605  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6123766899108887  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.615466594696045  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.615987777709961  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.615987777709961  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6160316467285156  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6234455108642578  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([289, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6303677558898926  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6303677558898926  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6309189796447754  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7447757720947266  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 289, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.725144863128662  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7255687713623047  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7259926795959473  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7255473136901855  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([2842, 40])
input nodes number: 21469
output nodes number: 2842
edges number: 23061
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.725728988647461  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7257294654846191  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04956817626953125  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

pseudo mini batch 24 input nodes size: 70408
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045504093170166016  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045504093170166016  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07907724380493164  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07909870147705078  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045122623443603516  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0465540885925293  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0465540885925293  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0465540885925293  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([70408, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0465540885925293  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

m.shape torch.Size([824, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.12942934036254883  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.12942934036254883  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13021516799926758  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13654136657714844  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([1082, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13718032836914062  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13718032836914062  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1082, 128]), torch.Size([1, 1082, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1382122039794922  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15369033813476562  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1082, 128])
m.shape torch.Size([1130, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15479087829589844  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15479087829589844  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1130, 128]), torch.Size([1, 1130, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1558685302734375  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.17971038818359375  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1130, 128])
m.shape torch.Size([1176, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18141460418701172  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18141460418701172  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1176, 128]), torch.Size([1, 1176, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18253612518310547  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21506023406982422  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1176, 128])
m.shape torch.Size([1041, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2169814109802246  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2169814109802246  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1041, 128]), torch.Size([1, 1041, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21797418594360352  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25371408462524414  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1041, 128])
m.shape torch.Size([988, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2560443878173828  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2560443878173828  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 988, 128]), torch.Size([1, 988, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2569866180419922  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2981891632080078  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 988, 128])
m.shape torch.Size([870, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.30062198638916016  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.30062198638916016  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3014516830444336  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3439345359802246  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([928, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3470597267150879  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3470597267150879  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 928, 128]), torch.Size([1, 928, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3479447364807129  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.39884424209594727  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 928, 128])
m.shape torch.Size([836, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4019894599914551  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4019894599914551  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 836, 128]), torch.Size([1, 836, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4027867317199707  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4549698829650879  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 836, 128])
m.shape torch.Size([12540, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.514366626739502  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.514366626739502  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 12540, 128]), torch.Size([1, 12540, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5263257026672363  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.375420093536377  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 12540, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.2988262176513672  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.319249153137207  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3396720886230469  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.319089412689209  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([21415, 256])
first layer input nodes number: 70408
first layer output nodes number: 21415
edges number: 168653
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3401989936828613  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3606219291687012  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3665995597839355  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3665995597839355  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

m.shape torch.Size([400, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.389575481414795  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.389575481414795  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.39033842086792  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3966364860534668  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([379, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3969836235046387  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3969836235046387  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3977065086364746  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.40871000289917  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([290, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4091849327087402  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4091849327087402  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4097380638122559  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.424318790435791  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([245, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4249844551086426  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4249844551086426  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4254517555236816  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4390034675598145  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([170, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.439587116241455  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.439587116241455  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4399113655090332  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4515843391418457  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4523334503173828  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4523334503173828  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4526348114013672  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4655933380126953  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([113, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.466203212738037  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.466203212738037  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.466418743133545  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4771952629089355  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([105, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4778952598571777  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4778952598571777  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.478095531463623  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4895110130310059  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4902243614196777  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4902243614196777  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.490403652191162  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.501878261566162  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([106, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.502899169921875  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.502899169921875  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5031013488769531  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5174560546875  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5181479454040527  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5181479454040527  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5182909965515137  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5294489860534668  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5300350189208984  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5300350189208984  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5301437377929688  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5393848419189453  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5399928092956543  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5399928092956543  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5400938987731934  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.549394130706787  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5499091148376465  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5499091148376465  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5499892234802246  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.557919979095459  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5583701133728027  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5583701133728027  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5584349632263184  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5653090476989746  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5658459663391113  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5658459663391113  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5659165382385254  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5738911628723145  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5742974281311035  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5742974281311035  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5743489265441895  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.580528736114502  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5811433792114258  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5811433792114258  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5812139511108398  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5901765823364258  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.590616226196289  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.590616226196289  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5906658172607422  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.597311019897461  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5977287292480469  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5977287292480469  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5977725982666016  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6039581298828125  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6044206619262695  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6044206619262695  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.604466438293457  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.611241340637207  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6115570068359375  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6115570068359375  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6115875244140625  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6163177490234375  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6168551445007324  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6168551445007324  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6169028282165527  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6246275901794434  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6249961853027344  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6249961853027344  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6250286102294922  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6305084228515625  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([289, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6374363899230957  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6374363899230957  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6379876136779785  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7476496696472168  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 289, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7277216911315918  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7281455993652344  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.728569507598877  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7281241416931152  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([2842, 40])
input nodes number: 21415
output nodes number: 2842
edges number: 23374
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7283053398132324  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7283058166503906  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04919719696044922  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

pseudo mini batch 25 input nodes size: 69507
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045122623443603516  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045122623443603516  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07832574844360352  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07834720611572266  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04613637924194336  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04613637924194336  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04613637924194336  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([69507, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04613637924194336  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

m.shape torch.Size([861, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.12667083740234375  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.12667083740234375  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 861, 128]), torch.Size([1, 861, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.12749195098876953  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13406085968017578  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 861, 128])
m.shape torch.Size([1100, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13469934463500977  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13469934463500977  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1100, 128]), torch.Size([1, 1100, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13574838638305664  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1524510383605957  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1100, 128])
m.shape torch.Size([1096, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15349435806274414  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15349435806274414  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1096, 128]), torch.Size([1, 1096, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1545395851135254  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1775345802307129  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1096, 128])
m.shape torch.Size([1045, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.17900514602661133  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.17900514602661133  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1045, 128]), torch.Size([1, 1045, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18000173568725586  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.20890283584594727  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1045, 128])
m.shape torch.Size([1061, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21093416213989258  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21093416213989258  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1061, 128]), torch.Size([1, 1061, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2119460105895996  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.24933719635009766  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1061, 128])
m.shape torch.Size([935, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25150632858276367  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25150632858276367  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 935, 128]), torch.Size([1, 935, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2523980140686035  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.29082536697387695  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 935, 128])
m.shape torch.Size([905, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.29340028762817383  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.29340028762817383  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2942633628845215  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3388214111328125  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 905, 128])
m.shape torch.Size([802, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3414492607116699  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3414492607116699  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.34221410751342773  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.386563777923584  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([767, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.38947296142578125  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.38947296142578125  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 767, 128]), torch.Size([1, 767, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.39020442962646484  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4375638961791992  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 767, 128])
m.shape torch.Size([12209, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4957919120788574  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4957919120788574  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 12209, 128]), torch.Size([1, 12209, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5074353218078613  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3386378288269043  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 12209, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.264204978942871  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.2840232849121094  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3038415908813477  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.2838683128356934  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([20781, 256])
first layer input nodes number: 69507
first layer output nodes number: 20781
edges number: 163188
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3043618202209473  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3241801261901855  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3297524452209473  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3297524452209473  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

m.shape torch.Size([446, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.351877212524414  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.351877212524414  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3527278900146484  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3605985641479492  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([385, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3609137535095215  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3609137535095215  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3616480827331543  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.375650405883789  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([292, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3761253356933594  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3761253356933594  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3766822814941406  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3907194137573242  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([242, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.391371726989746  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.391371726989746  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3918333053588867  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4052190780639648  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4058728218078613  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4058728218078613  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4062237739562988  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4188580513000488  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([148, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4195361137390137  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4195361137390137  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.41981840133667  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4319567680358887  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4326767921447754  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4326767921447754  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4329209327697754  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4451279640197754  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4457674026489258  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4457674026489258  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4459562301635742  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4567193984985352  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4573431015014648  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4573431015014648  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4575014114379883  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4676332473754883  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4683232307434082  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4683232307434082  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4684758186340332  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4793095588684082  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4800262451171875  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4800262451171875  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4801692962646484  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4913272857666016  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.492074966430664  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.492074966430664  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4922103881835938  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5037212371826172  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.504178524017334  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.504178524017334  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.504258632659912  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5116286277770996  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5122079849243164  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5122079849243164  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5122957229614258  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.520981788635254  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5215868949890137  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5215868949890137  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5216727256774902  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5307707786560059  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5311741828918457  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5311741828918457  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5312294960021973  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5374798774719238  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5379753112792969  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5379753112792969  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5380363464355469  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5453605651855469  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5457453727722168  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5457453727722168  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5457911491394043  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5516047477722168  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5520567893981934  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5520567893981934  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5521063804626465  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5587515830993652  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5591497421264648  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5591497421264648  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5591917037963867  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.565108299255371  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.56535005569458  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.56535005569458  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5653748512268066  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.569044589996338  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.569413185119629  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.569413185119629  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5694475173950195  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5747690200805664  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5751280784606934  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5751280784606934  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5751605033874512  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5804133415222168  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5807204246520996  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5807204246520996  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.580747127532959  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5852599143981934  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([281, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.59199857711792  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.59199857711792  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5925345420837402  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6890230178833008  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 281, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6699910163879395  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.670414924621582  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6708388328552246  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.670393466949463  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([2842, 40])
input nodes number: 20781
output nodes number: 2842
edges number: 22440
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.670569896697998  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6705703735351562  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04870414733886719  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

pseudo mini batch 26 input nodes size: 70841
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07853221893310547  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07855367660522461  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04532909393310547  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04675865173339844  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04675865173339844  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04675865173339844  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([70841, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04675865173339844  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

m.shape torch.Size([875, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1294560432434082  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1294560432434082  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 875, 128]), torch.Size([1, 875, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13029050827026367  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13710451126098633  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 875, 128])
m.shape torch.Size([1025, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.137664794921875  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.137664794921875  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1025, 128]), torch.Size([1, 1025, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1386423110961914  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1533050537109375  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1025, 128])
m.shape torch.Size([1077, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1543569564819336  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1543569564819336  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1077, 128]), torch.Size([1, 1077, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15538406372070312  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1779804229736328  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1077, 128])
m.shape torch.Size([1139, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.17963933944702148  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.17963933944702148  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1139, 128]), torch.Size([1, 1139, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1807255744934082  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21222639083862305  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1139, 128])
m.shape torch.Size([1107, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21432256698608398  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21432256698608398  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1107, 128]), torch.Size([1, 1107, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2153782844543457  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2539525032043457  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1107, 128])
m.shape torch.Size([993, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25626564025878906  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25626564025878906  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 993, 128]), torch.Size([1, 993, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25721263885498047  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.29946184158325195  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 993, 128])
m.shape torch.Size([914, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.30203914642333984  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.30203914642333984  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 914, 128]), torch.Size([1, 914, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.30291080474853516  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.34740114212036133  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 914, 128])
m.shape torch.Size([874, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3502993583679199  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3502993583679199  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.351132869720459  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.39864301681518555  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 874, 128])
m.shape torch.Size([813, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4017152786254883  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4017152786254883  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 813, 128]), torch.Size([1, 813, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40249061584472656  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.45395851135253906  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 813, 128])
m.shape torch.Size([12533, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5133328437805176  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5133328437805176  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 12533, 128]), torch.Size([1, 12533, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5252852439880371  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3748149871826172  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 12533, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.298391342163086  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3187522888183594  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3391132354736328  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3185930252075195  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([21350, 256])
first layer input nodes number: 70841
first layer output nodes number: 21350
edges number: 168242
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3396430015563965  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.36000394821167  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3650941848754883  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3650941848754883  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

m.shape torch.Size([432, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3881754875183105  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3881754875183105  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3889994621276855  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3955912590026855  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([349, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3958501815795898  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3958501815795898  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3965158462524414  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4072155952453613  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([279, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4076876640319824  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4076876640319824  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.408219814300537  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4226231575012207  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([226, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4232263565063477  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4232263565063477  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4236574172973633  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4361581802368164  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([200, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.436903953552246  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.436903953552246  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4372854232788086  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4510183334350586  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4517216682434082  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4517216682434082  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4520173072814941  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4647297859191895  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4654903411865234  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4654903411865234  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4657478332519531  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4786224365234375  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([101, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4792704582214355  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4792704582214355  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4794631004333496  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4904437065124512  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4910569190979004  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4910569190979004  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.491213321685791  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.501223087310791  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5019621849060059  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5019621849060059  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.502124309539795  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5136351585388184  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5143580436706543  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5143580436706543  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.514503002166748  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5258097648620605  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5265564918518066  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5265564918518066  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5266919136047363  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5382027626037598  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5388097763061523  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5388097763061523  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5389127731323242  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5483884811401367  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5489697456359863  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5489697456359863  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5490593910217285  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.557934284210205  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5583796501159668  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5583796501159668  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5584444999694824  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5653185844421387  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.565762996673584  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.565762996673584  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5658221244812012  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5725035667419434  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5729970932006836  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5729970932006836  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5730581283569336  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5803823471069336  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5808019638061523  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5808019638061523  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5808515548706055  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5871496200561523  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5875635147094727  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5875635147094727  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5876092910766602  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5937433242797852  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5940666198730469  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5940666198730469  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5941009521484375  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5989418029785156  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5994296073913574  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5994296073913574  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5994772911071777  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.606534481048584  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6068916320800781  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6068916320800781  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6069259643554688  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6122474670410156  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.612584114074707  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.612584114074707  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.612614631652832  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.617558479309082  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.617889404296875  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.617889404296875  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6179180145263672  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6227531433105469  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([311, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6302118301391602  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6302118301391602  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6308050155639648  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7477126121520996  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 311, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7276897430419922  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7281136512756348  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7285375595092773  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7280921936035156  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([2842, 40])
input nodes number: 21350
output nodes number: 2842
edges number: 23448
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7282729148864746  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7282733917236328  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04940176010131836  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

pseudo mini batch 27 input nodes size: 70140
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04532909393310547  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04532909393310547  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07877445220947266  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0787959098815918  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04499483108520508  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04639577865600586  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04639577865600586  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04639577865600586  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([70140, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04639577865600586  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

m.shape torch.Size([847, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.12744903564453125  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.12744903564453125  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 847, 128]), torch.Size([1, 847, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.12825679779052734  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13489151000976562  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 847, 128])
m.shape torch.Size([1057, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13549566268920898  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13549566268920898  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1057, 128]), torch.Size([1, 1057, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1365036964416504  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15162420272827148  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1057, 128])
m.shape torch.Size([1156, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15277385711669922  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15277385711669922  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1156, 128]), torch.Size([1, 1156, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15387630462646484  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.17908287048339844  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1156, 128])
m.shape torch.Size([1092, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18061447143554688  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18061447143554688  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1816558837890625  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21264266967773438  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([1138, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21483516693115234  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21483516693115234  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21592044830322266  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2549905776977539  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([1007, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25732898712158203  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25732898712158203  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1007, 128]), torch.Size([1, 1007, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2582893371582031  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3004941940307617  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1007, 128])
m.shape torch.Size([888, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3029780387878418  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3029780387878418  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 888, 128]), torch.Size([1, 888, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.30382490158081055  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.34813642501831055  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 888, 128])
m.shape torch.Size([914, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3511996269226074  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3511996269226074  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 914, 128]), torch.Size([1, 914, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.35207128524780273  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40256452560424805  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 914, 128])
m.shape torch.Size([813, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40561771392822266  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40561771392822266  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 813, 128]), torch.Size([1, 813, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40639305114746094  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.45879125595092773  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 813, 128])
m.shape torch.Size([12152, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5169973373413086  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5169973373413086  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 12152, 128]), torch.Size([1, 12152, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5285863876342773  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3591909408569336  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 12152, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.2844138145446777  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.304502010345459  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3245902061462402  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.304344654083252  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([21064, 256])
first layer input nodes number: 70140
first layer output nodes number: 21064
edges number: 164894
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3251147270202637  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.345202922821045  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3502631187438965  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3502631187438965  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

m.shape torch.Size([423, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3728618621826172  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3728618621826172  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3736686706542969  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3817253112792969  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([339, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3819737434387207  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3819737434387207  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3826203346252441  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.395988941192627  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([305, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.39654541015625  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.39654541015625  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3971271514892578  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4114665985107422  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([215, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4120025634765625  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4120025634765625  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4124126434326172  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4243049621582031  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4250998497009277  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4250998497009277  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4254965782165527  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4397788047790527  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4405322074890137  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4405322074890137  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4408469200134277  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4543795585632324  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.45515775680542  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.45515775680542  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4554228782653809  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4686789512634277  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4694461822509766  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4694461822509766  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4696693420410156  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4823894500732422  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.483039379119873  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.483039379119873  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4832072257995605  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4939494132995605  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4946250915527344  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4946250915527344  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4947757720947266  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5054740905761719  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5062131881713867  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5062131881713867  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5063600540161133  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5178155899047852  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.518388271331787  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.518388271331787  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5184950828552246  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.527574062347412  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.528120517730713  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.528120517730713  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.528212070465088  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.536634922027588  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5372486114501953  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5372486114501953  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5373420715332031  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5465946197509766  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.547095775604248  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.547095775604248  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.547168254852295  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5548510551452637  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5553994178771973  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5553994178771973  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5554718971252441  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.563662052154541  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5640344619750977  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5640344619750977  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.564082145690918  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5698041915893555  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5703339576721191  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5703339576721191  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5703949928283691  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5781464576721191  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.578718662261963  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.578718662261963  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5787816047668457  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5872159004211426  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5876073837280273  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5876073837280273  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5876493453979492  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5935659408569336  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5939083099365234  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5939083099365234  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.593942642211914  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5990238189697266  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5993027687072754  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5993027687072754  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5993294715881348  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.603468418121338  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6038312911987305  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6038312911987305  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6038637161254883  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.609116554260254  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.60951566696167  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.60951566696167  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6095499992370605  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6153521537780762  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([279, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6220388412475586  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6220388412475586  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6225709915161133  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7198352813720703  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 279, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7003130912780762  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7007369995117188  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7011609077453613  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7007155418395996  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([2842, 40])
input nodes number: 21064
output nodes number: 2842
edges number: 22956
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7008943557739258  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.700894832611084  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0489954948425293  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

pseudo mini batch 28 input nodes size: 71109
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04499483108520508  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04499483108520508  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0789022445678711  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07892370223999023  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045456886291503906  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04689979553222656  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04689979553222656  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04689979553222656  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([71109, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04689979553222656  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

m.shape torch.Size([836, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1303691864013672  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1303691864013672  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 836, 128]), torch.Size([1, 836, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1311664581298828  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1375446319580078  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 836, 128])
m.shape torch.Size([1081, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1381826400756836  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1381826400756836  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1081, 128]), torch.Size([1, 1081, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13921356201171875  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1546773910522461  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1081, 128])
m.shape torch.Size([1140, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1565384864807129  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1565384864807129  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1140, 128]), torch.Size([1, 1140, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15762567520141602  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18154382705688477  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1140, 128])
m.shape torch.Size([1069, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1831364631652832  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1831364631652832  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18415594100952148  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21372079849243164  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([1038, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21568584442138672  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21568584442138672  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1038, 128]), torch.Size([1, 1038, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2166757583618164  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25231266021728516  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1038, 128])
m.shape torch.Size([975, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2546072006225586  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2546072006225586  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 975, 128]), torch.Size([1, 975, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2555370330810547  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.29645442962646484  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 975, 128])
m.shape torch.Size([922, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.29906702041625977  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.29906702041625977  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 922, 128]), torch.Size([1, 922, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.29994630813598633  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.34452199935913086  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 922, 128])
m.shape torch.Size([911, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.34755754470825195  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.34755754470825195  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 911, 128]), torch.Size([1, 911, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.34842634201049805  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.39872026443481445  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 911, 128])
m.shape torch.Size([848, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40192508697509766  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40192508697509766  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40273380279541016  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.45520973205566406  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([12675, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5152444839477539  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5152444839477539  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 12675, 128]), torch.Size([1, 12675, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5273323059082031  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3860783576965332  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 12675, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.30888032913208  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3293795585632324  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3498787879943848  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3292193412780762  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([21495, 256])
first layer input nodes number: 71109
first layer output nodes number: 21495
edges number: 169858
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3504109382629395  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3709101676940918  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.376035213470459  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.376035213470459  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

m.shape torch.Size([431, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4001898765563965  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4001898765563965  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4010119438171387  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4081006050109863  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 431, 256])
m.shape torch.Size([357, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4083762168884277  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4083762168884277  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4090571403503418  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.419497013092041  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([278, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4199585914611816  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4199585914611816  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4204888343811035  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.433544635772705  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([230, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.434164047241211  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.434164047241211  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4346027374267578  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4473247528076172  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([193, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.448033332824707  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.448033332824707  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4484014511108398  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.461653709411621  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4623808860778809  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4623808860778809  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4626822471618652  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4756407737731934  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([112, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4762439727783203  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4762439727783203  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4764575958251953  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4871387481689453  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4878625869750977  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4878625869750977  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4880685806274414  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4998102188110352  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5005121231079102  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5005121231079102  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5006895065307617  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5120420455932617  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5126361846923828  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5126361846923828  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5127716064453125  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5223865509033203  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([83, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5231966972351074  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5231966972351074  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5233550071716309  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.535703182220459  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([47, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5361661911010742  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5361661911010742  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5362558364868164  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5438756942749023  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5444684028625488  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5444684028625488  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5445656776428223  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5535149574279785  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5540857315063477  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5540857315063477  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.554173469543457  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5628595352172852  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5633492469787598  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5633492469787598  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5634198188781738  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5709004402160645  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5714497566223145  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5714497566223145  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5715222358703613  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5797123908996582  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.580411434173584  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.580411434173584  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5804972648620605  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.590796947479248  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.591273307800293  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.591273307800293  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5913305282592773  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.598597526550293  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5990257263183594  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5990257263183594  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5990734100341797  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6054630279541016  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6058621406555176  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6058621406555176  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6059041023254395  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6118206977844238  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6122236251831055  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6122236251831055  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6122636795043945  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6181917190551758  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6186580657958984  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6186580657958984  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6187019348144531  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6255016326904297  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6258115768432617  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6258115768432617  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.625840187072754  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6304750442504883  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.631014347076416  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.631014347076416  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6310601234436035  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.638796329498291  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([304, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.646078109741211  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.646078109741211  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.646657943725586  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7554855346679688  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 304, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7346267700195312  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7350506782531738  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7354745864868164  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7350292205810547  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([2842, 40])
input nodes number: 21495
output nodes number: 2842
edges number: 23642
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.73521089553833  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7352113723754883  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04956245422363281  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

pseudo mini batch 29 input nodes size: 71509
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045456886291503906  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045456886291503906  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07955503463745117  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07957649230957031  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045647621154785156  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04708385467529297  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04708385467529297  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04708385467529297  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([71509, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04708385467529297  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

m.shape torch.Size([841, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13016223907470703  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13016223907470703  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 841, 128]), torch.Size([1, 841, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1309642791748047  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13738059997558594  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 841, 128])
m.shape torch.Size([1074, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13840103149414062  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13840103149414062  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1074, 128]), torch.Size([1, 1074, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13942527770996094  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15478897094726562  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1074, 128])
m.shape torch.Size([1125, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15670490264892578  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15670490264892578  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1125, 128]), torch.Size([1, 1125, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1577777862548828  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18160057067871094  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1125, 128])
m.shape torch.Size([1094, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1831507682800293  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1831507682800293  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18419408798217773  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21520185470581055  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([1117, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21734333038330078  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21734333038330078  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21840858459472656  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2571144104003906  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([1006, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2594599723815918  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2594599723815918  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1006, 128]), torch.Size([1, 1006, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2604193687438965  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.30289554595947266  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1006, 128])
m.shape torch.Size([964, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.305633544921875  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.305633544921875  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 964, 128]), torch.Size([1, 964, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3065528869628906  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3525199890136719  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 964, 128])
m.shape torch.Size([890, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3554553985595703  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3554553985595703  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3563041687011719  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40569496154785156  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([798, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40952396392822266  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.40952396392822266  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 798, 128]), torch.Size([1, 798, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.41028499603271484  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.45899105072021484  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 798, 128])
m.shape torch.Size([12564, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5185203552246094  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5185203552246094  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 12564, 128]), torch.Size([1, 12564, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5305023193359375  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3817534446716309  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 12564, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3049845695495605  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.325462818145752  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3459410667419434  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3253026008605957  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([21473, 256])
first layer input nodes number: 71509
first layer output nodes number: 21473
edges number: 169051
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3464760780334473  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3669543266296387  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3720741271972656  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3720741271972656  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

m.shape torch.Size([419, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3962178230285645  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3962178230285645  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.397017002105713  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4034104347229004  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([358, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4036993980407715  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4036993980407715  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4043822288513184  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4149909019470215  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([273, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4154367446899414  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4154367446899414  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4159574508666992  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4301462173461914  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([229, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4307665824890137  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4307665824890137  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4312033653259277  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4438700675964355  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([217, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4450864791870117  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4450864791870117  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.445500373840332  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4604005813598633  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4611105918884277  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4611105918884277  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.461413860321045  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.474454402923584  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4752044677734375  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4752044677734375  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4754600524902344  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4882392883300781  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4889497756958008  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4889497756958008  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4891576766967773  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5010080337524414  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([80, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.501596450805664  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.501596450805664  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.501749038696289  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.511514663696289  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.512073040008545  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.512073040008545  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5121989250183105  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.52113676071167  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5217399597167969  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5217399597167969  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.521860122680664  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5312328338623047  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5318074226379395  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5318074226379395  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5319123268127441  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5408291816711426  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5414390563964844  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5414390563964844  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5415401458740234  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5508403778076172  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5513148307800293  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5513148307800293  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.551389217376709  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.558753490447998  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5594086647033691  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5594086647033691  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5595002174377441  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5692048072814941  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5696511268615723  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5696511268615723  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5697121620178223  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5766091346740723  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.57706880569458  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.57706880569458  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5771260261535645  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5839924812316895  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.584742546081543  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.584742546081543  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5848283767700195  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.595728874206543  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5960698127746582  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5960698127746582  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5961098670959473  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6014771461486816  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6020722389221191  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6020722389221191  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6021332740783691  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6107392311096191  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6111531257629395  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6111531257629395  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6111950874328613  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6174054145812988  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6177020072937012  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6177020072937012  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6177306175231934  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6221652030944824  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.622549057006836  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.622549057006836  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6225833892822266  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6281452178955078  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6287050247192383  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6287050247192383  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6287527084350586  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6368112564086914  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([300, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.643996238708496  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.643996238708496  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6445684432983398  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.756667137145996  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 300, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7355809211730957  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7360048294067383  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7364287376403809  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7359833717346191  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([2842, 40])
input nodes number: 21473
output nodes number: 2842
edges number: 23584
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7361650466918945  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7361655235290527  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.049742698669433594  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

pseudo mini batch 30 input nodes size: 71080
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045647621154785156  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045647621154785156  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07954120635986328  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07956266403198242  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045443058013916016  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04687929153442383  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04687929153442383  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04687929153442383  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([71080, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04687929153442383  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

m.shape torch.Size([837, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1300654411315918  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1300654411315918  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 837, 128]), torch.Size([1, 837, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13086366653442383  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13724946975708008  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 837, 128])
m.shape torch.Size([1016, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1378192901611328  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1378192901611328  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1016, 128]), torch.Size([1, 1016, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13878822326660156  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1533222198486328  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1016, 128])
m.shape torch.Size([1154, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15448856353759766  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15448856353759766  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1154, 128]), torch.Size([1, 1154, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15558910369873047  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.17980098724365234  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1154, 128])
m.shape torch.Size([1103, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18135452270507812  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18135452270507812  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18240642547607422  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2134113311767578  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([1051, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2153911590576172  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2153911590576172  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21639347076416016  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25296926498413086  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([971, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2552461624145508  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2552461624145508  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 971, 128]), torch.Size([1, 971, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25617218017578125  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.29606151580810547  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 971, 128])
m.shape torch.Size([839, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2983989715576172  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2983989715576172  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.29919910430908203  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.33975839614868164  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([838, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.34255504608154297  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.34255504608154297  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 838, 128]), torch.Size([1, 838, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3433542251586914  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.38960742950439453  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 838, 128])
m.shape torch.Size([803, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3926539421081543  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3926539421081543  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 803, 128]), torch.Size([1, 803, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3934197425842285  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.44299983978271484  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 803, 128])
m.shape torch.Size([12765, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5034852027893066  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5034852027893066  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 12765, 128]), torch.Size([1, 12765, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5156588554382324  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3803410530090332  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 12765, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3042984008789062  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3246850967407227  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.345071792602539  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3245253562927246  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([21377, 256])
first layer input nodes number: 71080
first layer output nodes number: 21377
edges number: 169278
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3456034660339355  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.365990161895752  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3710870742797852  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3710870742797852  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

m.shape torch.Size([440, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3941383361816406  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3941383361816406  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3949775695800781  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4022736549377441  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([354, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4025349617004395  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4025349617004395  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.403210163116455  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4140229225158691  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([305, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.414565086364746  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.414565086364746  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.415146827697754  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4291539192199707  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4297165870666504  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4297165870666504  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4301400184631348  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4424195289611816  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([179, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.443068027496338  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.443068027496338  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4434094429016113  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.455700397491455  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.456371784210205  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.456371784210205  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4566502571105957  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4686245918273926  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([116, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4692659378051758  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4692659378051758  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.469487190246582  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4805498123168945  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([101, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4812159538269043  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4812159538269043  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4814085960388184  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.49238920211792  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4930715560913086  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4930715560913086  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4932432174682617  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5042295455932617  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5048842430114746  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5048842430114746  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5050311088562012  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.515458583831787  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5161256790161133  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5161256790161133  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5162591934204102  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5266733169555664  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([77, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5274949073791504  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5274949073791504  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.527641773223877  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5401253700256348  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.540651798248291  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.540651798248291  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.540743350982666  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.549166202545166  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5497665405273438  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5497665405273438  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5498580932617188  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5589218139648438  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5594673156738281  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5594673156738281  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5595455169677734  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5678348541259766  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5683493614196777  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5683493614196777  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.568418025970459  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5761771202087402  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5766167640686035  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5766167640686035  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.576672077178955  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5833096504211426  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5839223861694336  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5839223861694336  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5839929580688477  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5929555892944336  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5934867858886719  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5934867858886719  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.593545913696289  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6014690399169922  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6019201278686523  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6019201278686523  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6019678115844727  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6086912155151367  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.609151840209961  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.609151840209961  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6091976165771484  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6159725189208984  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.616267204284668  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.616267204284668  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6162958145141602  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6207304000854492  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6211142539978027  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6211142539978027  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6211485862731934  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6267104148864746  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6269702911376953  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6269702911376953  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.626993179321289  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6308612823486328  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([301, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.638082504272461  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.638082504272461  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6386566162109375  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.740950584411621  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 301, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7209739685058594  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.721397876739502  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7218217849731445  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7213764190673828  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([2842, 40])
input nodes number: 21377
output nodes number: 2842
edges number: 23412
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7215576171875  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7215580940246582  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04953193664550781  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

pseudo mini batch 31 input nodes size: 70145
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045443058013916016  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.045443058013916016  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07889080047607422  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.07891225814819336  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.044997215270996094  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04640674591064453  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04640674591064453  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04640674591064453  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([70145, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.04640674591064453  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

m.shape torch.Size([857, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1279902458190918  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1279902458190918  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 857, 128]), torch.Size([1, 857, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.12880754470825195  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1353459358215332  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 857, 128])
m.shape torch.Size([1125, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13619279861450195  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13619279861450195  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1125, 128]), torch.Size([1, 1125, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.13726568222045898  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15335893630981445  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1125, 128])
m.shape torch.Size([1131, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15444040298461914  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.15444040298461914  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1131, 128]), torch.Size([1, 1131, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.1555190086364746  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.17936468124389648  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1131, 128])
m.shape torch.Size([1098, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18091964721679688  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18091964721679688  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.18196678161621094  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21301651000976562  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([1060, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21502017974853516  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21502017974853516  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 1060, 128]), torch.Size([1, 1060, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.21603107452392578  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2529630661010742  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 1060, 128])
m.shape torch.Size([924, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25510120391845703  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.25510120391845703  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 924, 128]), torch.Size([1, 924, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2559823989868164  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2943882942199707  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 924, 128])
m.shape torch.Size([908, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2969784736633301  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.2969784736633301  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 908, 128]), torch.Size([1, 908, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.29784440994262695  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3427109718322754  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 908, 128])
m.shape torch.Size([833, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3454556465148926  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.3454556465148926  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.346250057220459  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.39246225357055664  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([765, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.39534807205200195  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.39534807205200195  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 765, 128]), torch.Size([1, 765, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.39607763290405273  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.4433321952819824  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 765, 128])
m.shape torch.Size([12433, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5022525787353516  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5022525787353516  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 12433, 128]), torch.Size([1, 12433, 128])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.5141096115112305  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3559589385986328  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 12433, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.280564785003662  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3007197380065918  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3208746910095215  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3005619049072266  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([21134, 256])
first layer input nodes number: 70145
first layer output nodes number: 21134
edges number: 165971
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3213996887207031  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3415546417236328  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3465933799743652  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3465933799743652  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

m.shape torch.Size([429, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3693890571594238  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3693890571594238  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3702073097229004  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.37687349319458  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([384, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3772025108337402  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3772025108337402  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3779349327087402  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3901915550231934  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([296, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.390678882598877  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.390678882598877  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.3912434577941895  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4074034690856934  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([211, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4079327583312988  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4079327583312988  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4083352088928223  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.420006275177002  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([200, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4207663536071777  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4207663536071777  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4211478233337402  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4348807334899902  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([122, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4353938102722168  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4353938102722168  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.43562650680542  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4456324577331543  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4464111328125  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4464111328125  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.446664810180664  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4593486785888672  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4600448608398438  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4600448608398438  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4602489471435547  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4718818664550781  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([99, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4726362228393555  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4726362228393555  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.472825050354004  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.484910011291504  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4854884147644043  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4854884147644043  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4856219291687012  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4951014518737793  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4957752227783203  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4957752227783203  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.4959087371826172  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5063228607177734  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5070061683654785  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5070061683654785  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5071301460266113  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5176682472229004  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5182809829711914  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5182809829711914  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5183839797973633  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5278596878051758  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5284137725830078  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5284137725830078  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5284996032714844  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.536996841430664  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.537574291229248  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.537574291229248  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.537656307220459  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5463500022888184  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5468010902404785  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5468010902404785  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5468621253967285  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5537590980529785  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5542354583740234  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5542354583740234  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5542945861816406  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5613899230957031  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5618796348571777  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5618796348571777  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.561936855316162  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5692038536071777  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5695405006408691  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5695405006408691  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5695786476135254  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.574690341949463  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.575190544128418  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.575190544128418  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.575242042541504  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.582503318786621  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5829219818115234  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5829219818115234  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5829639434814453  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5891742706298828  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.589491844177246  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.589491844177246  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.589522361755371  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.594252586364746  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.594569206237793  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.594569206237793  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5945978164672852  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5992326736450195  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5996336936950684  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.5996336936950684  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.599668025970459  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6054701805114746  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([300, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6126618385314941  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.6126618385314941  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.613234043121338  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7268481254577637  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

rst.shape  torch.Size([1, 300, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7071127891540527  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.707536220550537  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes
Using backend: pytorch

----------------------------------------after rst
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7079596519470215  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.707514762878418  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

torch.Size([2839, 40])
input nodes number: 21134
output nodes number: 2839
edges number: 23156
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7076935768127441  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.7076940536499023  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.049017906188964844  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.049017906188964844  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.049017906188964844  GigaBytes
Max Memory Allocated: 1.8163018226623535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018186300992965698 |0.0016836076974868774 |0.1183520182967186 |8.908659219741821e-05 |0.07023884356021881 |0.0035467147827148438 |
----------------------------------------------------------pseudo_mini_loss sum 3.0766077041625977
Total (block generation + training)time/epoch 13.950022220611572
Training time/epoch 6.79206657409668
Training time without block to device /epoch 6.7381911277771
Training time without total dataloading part /epoch 6.041305065155029
load block tensor time/epoch 0.5819616317749023
block to device time/epoch 0.05387544631958008
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  2942363
Number of first layer input nodes during this epoch:  2261536
Number of first layer output nodes during this epoch:  680827
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
