[05:29:06] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 21674458 edges into 32 parts and get 6928597 edge cuts
main start at this time 1651555723.8914046
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02786087989807129
global_2_local spend time (sec) 0.03624105453491211
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004194736480712891
A = g.adjacency_matrix() spent  0.007932901382446289
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07972526550292969
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.3013792037963867
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1912753582000732

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 11680458, 2.0: 2009204, 3.0: 503973, 4.0: 152362, 5.0: 55000, 6.0: 23754, 7.0: 11121, 8.0: 5689, 9.0: 3141, 10.0: 1718, 11.0: 1012, 12.0: 561, 13.0: 341, 14.0: 224, 15.0: 154, 16.0: 98, 17.0: 78, 18.0: 41, 19.0: 29, 20.0: 8, 21.0: 4})
Convert a graph into a bidirected graph: 0.805 seconds
Metis partitioning: 4.652 seconds
Split the graph: 0.302 seconds
Construct subgraphs: 0.042 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  5.8191211223602295
2912
2894
2883
2865
2927
2836
2885
2918
2893
2904
2862
2846
2920
2882
2819
2817
2762
2758
2767
2852
2758
2758
2927
2758
2862
2758
2780
2768
2910
2785
2890
2785
total k batches seeds list generation spend  18.69426441192627
after graph partition
graph partition algorithm spend time 18.77694845199585
2912
2894
2883
2865
2927
2836
2885
2918
2893
2904
2862
2846
2920
2882
2819
2817
2762
2758
2767
2852
2758
2758
2927
2758
2862
2758
2780
2768
2910
2785
2890
2785
partition_len_list
[7222, 5809, 5918, 7107, 8175, 6703, 5391, 6876, 5723, 5361, 6013, 6559, 7835, 6597, 8666, 7207, 15221, 16905, 18339, 19012, 16582, 16217, 18028, 18549, 7108, 11556, 11735, 12755, 6944, 8164, 7883, 10867]
shared_neighbor_graph_partition_s0 selection method  spend 18.868839740753174
time for parepare:  0.01686549186706543
local_output_nid generation:  0.0006794929504394531
local_in_edges_tensor generation:  0.0008921623229980469
mini_batch_src_global generation:  0.001066446304321289
r_  generation:  0.007023334503173828
local_output_nid generation:  0.0007579326629638672
local_in_edges_tensor generation:  0.0007641315460205078
mini_batch_src_global generation:  0.0008473396301269531
r_  generation:  0.005826473236083984
local_output_nid generation:  0.0008022785186767578
local_in_edges_tensor generation:  0.0007109642028808594
mini_batch_src_global generation:  0.0006730556488037109
r_  generation:  0.005977630615234375
local_output_nid generation:  0.0007731914520263672
local_in_edges_tensor generation:  0.0008258819580078125
mini_batch_src_global generation:  0.0008020401000976562
r_  generation:  0.006709575653076172
local_output_nid generation:  0.000789642333984375
local_in_edges_tensor generation:  0.0006873607635498047
mini_batch_src_global generation:  0.0008528232574462891
r_  generation:  0.007238149642944336
local_output_nid generation:  0.0007739067077636719
local_in_edges_tensor generation:  0.0006921291351318359
mini_batch_src_global generation:  0.0007650852203369141
r_  generation:  0.006909847259521484
local_output_nid generation:  0.0007877349853515625
local_in_edges_tensor generation:  0.0006322860717773438
mini_batch_src_global generation:  0.0005667209625244141
r_  generation:  0.004794597625732422
local_output_nid generation:  0.0007700920104980469
local_in_edges_tensor generation:  0.0006337165832519531
mini_batch_src_global generation:  0.0006384849548339844
r_  generation:  0.006127834320068359
local_output_nid generation:  0.0007567405700683594
local_in_edges_tensor generation:  0.0006756782531738281
mini_batch_src_global generation:  0.0008668899536132812
r_  generation:  0.007559537887573242
local_output_nid generation:  0.0013549327850341797
local_in_edges_tensor generation:  0.0025963783264160156
mini_batch_src_global generation:  0.0008740425109863281
r_  generation:  0.0053632259368896484
local_output_nid generation:  0.0008060932159423828
local_in_edges_tensor generation:  0.0009944438934326172
mini_batch_src_global generation:  0.0007731914520263672
r_  generation:  0.007355451583862305
local_output_nid generation:  0.0008180141448974609
local_in_edges_tensor generation:  0.0008146762847900391
mini_batch_src_global generation:  0.0007650852203369141
r_  generation:  0.007165431976318359
local_output_nid generation:  0.0008306503295898438
local_in_edges_tensor generation:  0.0006682872772216797
mini_batch_src_global generation:  0.0009400844573974609
r_  generation:  0.007834434509277344
local_output_nid generation:  0.0008182525634765625
local_in_edges_tensor generation:  0.0006389617919921875
mini_batch_src_global generation:  0.0007059574127197266
r_  generation:  0.006224155426025391
local_output_nid generation:  0.0007920265197753906
local_in_edges_tensor generation:  0.0006034374237060547
mini_batch_src_global generation:  0.0006735324859619141
r_  generation:  0.005877971649169922
local_output_nid generation:  0.0008106231689453125
local_in_edges_tensor generation:  0.0007140636444091797
mini_batch_src_global generation:  0.0007476806640625
r_  generation:  0.00719761848449707
local_output_nid generation:  0.0007581710815429688
local_in_edges_tensor generation:  0.0006392002105712891
mini_batch_src_global generation:  0.0008633136749267578
r_  generation:  0.00695347785949707
local_output_nid generation:  0.0007746219635009766
local_in_edges_tensor generation:  0.0008215904235839844
mini_batch_src_global generation:  0.001291036605834961
r_  generation:  0.014211654663085938
local_output_nid generation:  0.0008730888366699219
local_in_edges_tensor generation:  0.0009315013885498047
mini_batch_src_global generation:  0.0013508796691894531
r_  generation:  0.009901762008666992
local_output_nid generation:  0.0008864402770996094
local_in_edges_tensor generation:  0.0009179115295410156
mini_batch_src_global generation:  0.0012557506561279297
r_  generation:  0.009563922882080078
local_output_nid generation:  0.0008606910705566406
local_in_edges_tensor generation:  0.0008695125579833984
mini_batch_src_global generation:  0.0011425018310546875
r_  generation:  0.00956273078918457
local_output_nid generation:  0.0008609294891357422
local_in_edges_tensor generation:  0.0007197856903076172
mini_batch_src_global generation:  0.0010101795196533203
r_  generation:  0.008136272430419922
local_output_nid generation:  0.0009198188781738281
local_in_edges_tensor generation:  0.0009663105010986328
mini_batch_src_global generation:  0.0017838478088378906
r_  generation:  0.012373924255371094
local_output_nid generation:  0.0009016990661621094
local_in_edges_tensor generation:  0.0007426738739013672
mini_batch_src_global generation:  0.0010831356048583984
r_  generation:  0.013560056686401367
local_output_nid generation:  0.0010578632354736328
local_in_edges_tensor generation:  0.0006780624389648438
mini_batch_src_global generation:  0.0008604526519775391
r_  generation:  0.006128787994384766
local_output_nid generation:  0.0009033679962158203
local_in_edges_tensor generation:  0.00595545768737793
mini_batch_src_global generation:  0.0008759498596191406
r_  generation:  0.005896806716918945
local_output_nid generation:  0.000751495361328125
local_in_edges_tensor generation:  0.0006854534149169922
mini_batch_src_global generation:  0.0009083747863769531
r_  generation:  0.006821393966674805
local_output_nid generation:  0.0008034706115722656
local_in_edges_tensor generation:  0.0006437301635742188
mini_batch_src_global generation:  0.0008153915405273438
r_  generation:  0.006683349609375
local_output_nid generation:  0.0008599758148193359
local_in_edges_tensor generation:  0.0006659030914306641
mini_batch_src_global generation:  0.0006849765777587891
r_  generation:  0.005827665328979492
local_output_nid generation:  0.0008141994476318359
local_in_edges_tensor generation:  0.0006134510040283203
mini_batch_src_global generation:  0.0006442070007324219
r_  generation:  0.005629777908325195
local_output_nid generation:  0.0008215904235839844
local_in_edges_tensor generation:  0.0006356239318847656
mini_batch_src_global generation:  0.0006475448608398438
r_  generation:  0.005895137786865234
local_output_nid generation:  0.0008072853088378906
local_in_edges_tensor generation:  0.0007197856903076172
mini_batch_src_global generation:  0.0008509159088134766
r_  generation:  0.0066525936126708984
----------------------check_connections_block total spend ----------------------------- 0.4120936393737793
generate_one_block  0.013834238052368164
generate_one_block  0.010285377502441406
generate_one_block  0.008619070053100586
generate_one_block  0.009869813919067383
generate_one_block  0.01089620590209961
generate_one_block  0.009963035583496094
generate_one_block  0.0070192813873291016
generate_one_block  0.008808135986328125
generate_one_block  0.011789321899414062
generate_one_block  0.008564949035644531
generate_one_block  0.01001882553100586
generate_one_block  0.012578725814819336
generate_one_block  0.012636423110961914
generate_one_block  0.008657455444335938
generate_one_block  0.008959770202636719
generate_one_block  0.01042938232421875
generate_one_block  0.011758565902709961
generate_one_block  0.016025304794311523
generate_one_block  0.015516042709350586
generate_one_block  0.015586376190185547
generate_one_block  0.016936063766479492
generate_one_block  0.012392282485961914
generate_one_block  0.017575979232788086
generate_one_block  0.01733112335205078
generate_one_block  0.00891876220703125
generate_one_block  0.010161161422729492
generate_one_block  0.011218786239624023
generate_one_block  0.010565042495727539
generate_one_block  0.00854802131652832
generate_one_block  0.008744478225708008
generate_one_block  0.009027957916259766
generate_one_block  0.010935544967651367
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06804037094116211
gen group dst list time:  0.009713411331176758
time for parepare:  0.02418065071105957
local_output_nid generation:  0.0016129016876220703
local_in_edges_tensor generation:  0.009415149688720703
mini_batch_src_global generation:  0.0016295909881591797
r_  generation:  0.016225576400756836
local_output_nid generation:  0.001951456069946289
local_in_edges_tensor generation:  0.0016355514526367188
mini_batch_src_global generation:  0.0016939640045166016
r_  generation:  0.010853290557861328
local_output_nid generation:  0.0018572807312011719
local_in_edges_tensor generation:  0.0013859272003173828
mini_batch_src_global generation:  0.0065920352935791016
r_  generation:  0.012135982513427734
local_output_nid generation:  0.002002239227294922
local_in_edges_tensor generation:  0.0015711784362792969
mini_batch_src_global generation:  0.0011332035064697266
r_  generation:  0.015480995178222656
local_output_nid generation:  0.002218484878540039
local_in_edges_tensor generation:  0.001999378204345703
mini_batch_src_global generation:  0.0018177032470703125
r_  generation:  0.01875162124633789
local_output_nid generation:  0.0018835067749023438
local_in_edges_tensor generation:  0.0015718936920166016
mini_batch_src_global generation:  0.0012962818145751953
r_  generation:  0.015573263168334961
local_output_nid generation:  0.0015902519226074219
local_in_edges_tensor generation:  0.0012559890747070312
mini_batch_src_global generation:  0.0011475086212158203
r_  generation:  0.009032011032104492
local_output_nid generation:  0.0018093585968017578
local_in_edges_tensor generation:  0.0015218257904052734
mini_batch_src_global generation:  0.001111745834350586
r_  generation:  0.01408839225769043
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.0012600421905517578
mini_batch_src_global generation:  0.0010843276977539062
r_  generation:  0.013062477111816406
local_output_nid generation:  0.0015439987182617188
local_in_edges_tensor generation:  0.001119852066040039
mini_batch_src_global generation:  0.0012059211730957031
r_  generation:  0.008951187133789062
local_output_nid generation:  0.0016548633575439453
local_in_edges_tensor generation:  0.0012950897216796875
mini_batch_src_global generation:  0.0011227130889892578
r_  generation:  0.013962984085083008
local_output_nid generation:  0.0017800331115722656
local_in_edges_tensor generation:  0.0015225410461425781
mini_batch_src_global generation:  0.0012407302856445312
r_  generation:  0.015048980712890625
local_output_nid generation:  0.002011537551879883
local_in_edges_tensor generation:  0.0017480850219726562
mini_batch_src_global generation:  0.01772165298461914
r_  generation:  0.017926931381225586
local_output_nid generation:  0.0016701221466064453
local_in_edges_tensor generation:  0.001392364501953125
mini_batch_src_global generation:  0.0013034343719482422
r_  generation:  0.013804435729980469
local_output_nid generation:  0.0021317005157470703
local_in_edges_tensor generation:  0.0018527507781982422
mini_batch_src_global generation:  0.0017240047454833984
r_  generation:  0.019085168838500977
local_output_nid generation:  0.0017125606536865234
local_in_edges_tensor generation:  0.0014731884002685547
mini_batch_src_global generation:  0.001615762710571289
r_  generation:  0.016940832138061523
local_output_nid generation:  0.0038471221923828125
local_in_edges_tensor generation:  0.004789829254150391
mini_batch_src_global generation:  0.0037877559661865234
r_  generation:  0.041567087173461914
local_output_nid generation:  0.004511356353759766
local_in_edges_tensor generation:  0.005855083465576172
mini_batch_src_global generation:  0.005781412124633789
r_  generation:  0.047045230865478516
local_output_nid generation:  0.004904985427856445
local_in_edges_tensor generation:  0.004803895950317383
mini_batch_src_global generation:  0.005501508712768555
r_  generation:  0.05379199981689453
local_output_nid generation:  0.005311012268066406
local_in_edges_tensor generation:  0.005999088287353516
mini_batch_src_global generation:  0.0062084197998046875
r_  generation:  0.05678296089172363
local_output_nid generation:  0.004645109176635742
local_in_edges_tensor generation:  0.0042951107025146484
mini_batch_src_global generation:  0.00530552864074707
r_  generation:  0.04725933074951172
local_output_nid generation:  0.004582881927490234
local_in_edges_tensor generation:  0.004059553146362305
mini_batch_src_global generation:  0.004835844039916992
r_  generation:  0.04473233222961426
local_output_nid generation:  0.004882335662841797
local_in_edges_tensor generation:  0.0044209957122802734
mini_batch_src_global generation:  0.008126258850097656
r_  generation:  0.05207538604736328
local_output_nid generation:  0.005002737045288086
local_in_edges_tensor generation:  0.005422353744506836
mini_batch_src_global generation:  0.007987022399902344
r_  generation:  0.053430795669555664
local_output_nid generation:  0.0021698474884033203
local_in_edges_tensor generation:  0.0018191337585449219
mini_batch_src_global generation:  0.002377033233642578
r_  generation:  0.015836000442504883
local_output_nid generation:  0.0033979415893554688
local_in_edges_tensor generation:  0.0028624534606933594
mini_batch_src_global generation:  0.002145528793334961
r_  generation:  0.028252363204956055
local_output_nid generation:  0.0032553672790527344
local_in_edges_tensor generation:  0.0029289722442626953
mini_batch_src_global generation:  0.003003835678100586
r_  generation:  0.03065347671508789
local_output_nid generation:  0.0035657882690429688
local_in_edges_tensor generation:  0.0029926300048828125
mini_batch_src_global generation:  0.0028824806213378906
r_  generation:  0.03314208984375
local_output_nid generation:  0.002012491226196289
local_in_edges_tensor generation:  0.0017108917236328125
mini_batch_src_global generation:  0.0017561912536621094
r_  generation:  0.014375686645507812
local_output_nid generation:  0.002323150634765625
local_in_edges_tensor generation:  0.0019164085388183594
mini_batch_src_global generation:  0.001310586929321289
r_  generation:  0.01792454719543457
local_output_nid generation:  0.0022373199462890625
local_in_edges_tensor generation:  0.001850128173828125
mini_batch_src_global generation:  0.0014863014221191406
r_  generation:  0.016848087310791016
local_output_nid generation:  0.002997875213623047
local_in_edges_tensor generation:  0.002427816390991211
mini_batch_src_global generation:  0.0021393299102783203
r_  generation:  0.02715897560119629
----------------------check_connections_block total spend ----------------------------- 1.313427448272705
generate_one_block  0.02063441276550293
generate_one_block  0.015030145645141602
generate_one_block  0.015755653381347656
generate_one_block  0.020813941955566406
generate_one_block  0.025699377059936523
generate_one_block  0.020838022232055664
generate_one_block  0.01269984245300293
generate_one_block  0.01794576644897461
generate_one_block  0.01718902587890625
generate_one_block  0.01274251937866211
generate_one_block  0.017353534698486328
generate_one_block  0.03860068321228027
generate_one_block  0.026321887969970703
generate_one_block  0.018712997436523438
generate_one_block  0.026279687881469727
generate_one_block  0.023550987243652344
generate_one_block  0.057944297790527344
generate_one_block  0.06907296180725098
generate_one_block  0.07365131378173828
generate_one_block  0.07670807838439941
generate_one_block  0.06298637390136719
generate_one_block  0.06168842315673828
generate_one_block  0.07362890243530273
generate_one_block  0.07463884353637695
generate_one_block  0.02045130729675293
generate_one_block  0.03898262977600098
generate_one_block  0.041301727294921875
generate_one_block  0.044608354568481445
generate_one_block  0.018686294555664062
generate_one_block  0.02362513542175293
generate_one_block  0.02210211753845215
generate_one_block  0.03692483901977539
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.313427448272705
block generation total time  1.1271700859069824
average batch blocks generation time:  0.0352240651845932
pseudo mini batch 0 input nodes size: 16442
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010617733001708984  GigaBytes
Max Memory Allocated: 0.010617733001708984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010639667510986328  GigaBytes
Max Memory Allocated: 0.010639667510986328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010639667510986328  GigaBytes
Max Memory Allocated: 0.010639667510986328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.01116323471069336  GigaBytes
Max Memory Allocated: 0.01116323471069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.01116323471069336  GigaBytes
Max Memory Allocated: 0.01116323471069336  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.01116323471069336  GigaBytes
Max Memory Allocated: 0.01116323471069336  GigaBytes

torch.Size([16442, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.01116323471069336  GigaBytes
Max Memory Allocated: 0.01116323471069336  GigaBytes

m.shape torch.Size([597, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.0342860221862793  GigaBytes
Max Memory Allocated: 0.034671783447265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.0342860221862793  GigaBytes
Max Memory Allocated: 0.034671783447265625  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.03485536575317383  GigaBytes
Max Memory Allocated: 0.03485536575317383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.039496421813964844  GigaBytes
Max Memory Allocated: 0.03978109359741211  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([685, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.03986501693725586  GigaBytes
Max Memory Allocated: 0.03988075256347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.03986501693725586  GigaBytes
Max Memory Allocated: 0.03988075256347656  GigaBytes

 h.shape torch.Size([1, 685, 128]), torch.Size([1, 685, 128])
----------------------------------------3
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.04051828384399414  GigaBytes
Max Memory Allocated: 0.04051828384399414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2362060546875 GB
    Memory Allocated: 0.05031728744506836  GigaBytes
Max Memory Allocated: 0.05097055435180664  GigaBytes

rst.shape  torch.Size([1, 685, 128])
m.shape torch.Size([650, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2362060546875 GB
    Memory Allocated: 0.05092048645019531  GigaBytes
Max Memory Allocated: 0.05097055435180664  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2362060546875 GB
    Memory Allocated: 0.05092048645019531  GigaBytes
Max Memory Allocated: 0.05097055435180664  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 1.2362060546875 GB
    Memory Allocated: 0.051540374755859375  GigaBytes
Max Memory Allocated: 0.051540374755859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2596435546875 GB
    Memory Allocated: 0.06551265716552734  GigaBytes
Max Memory Allocated: 0.06644248962402344  GigaBytes

rst.shape  torch.Size([1, 650, 128])
m.shape torch.Size([633, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2596435546875 GB
    Memory Allocated: 0.06641006469726562  GigaBytes
Max Memory Allocated: 0.06644248962402344  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2596435546875 GB
    Memory Allocated: 0.06641006469726562  GigaBytes
Max Memory Allocated: 0.06644248962402344  GigaBytes

 h.shape torch.Size([1, 633, 128]), torch.Size([1, 633, 128])
----------------------------------------3
 Nvidia-smi: 1.2596435546875 GB
    Memory Allocated: 0.06701374053955078  GigaBytes
Max Memory Allocated: 0.06701374053955078  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.08452033996582031  GigaBytes
Max Memory Allocated: 0.08572769165039062  GigaBytes

rst.shape  torch.Size([1, 633, 128])
m.shape torch.Size([488, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.08538198471069336  GigaBytes
Max Memory Allocated: 0.08572769165039062  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.08538198471069336  GigaBytes
Max Memory Allocated: 0.08572769165039062  GigaBytes

 h.shape torch.Size([1, 488, 128]), torch.Size([1, 488, 128])
----------------------------------------3
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.08584737777709961  GigaBytes
Max Memory Allocated: 0.08584737777709961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.10260152816772461  GigaBytes
Max Memory Allocated: 0.10376501083374023  GigaBytes

rst.shape  torch.Size([1, 488, 128])
m.shape torch.Size([435, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.10361337661743164  GigaBytes
Max Memory Allocated: 0.10376501083374023  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.10361337661743164  GigaBytes
Max Memory Allocated: 0.10376501083374023  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.10402822494506836  GigaBytes
Max Memory Allocated: 0.10402822494506836  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.12186670303344727  GigaBytes
Max Memory Allocated: 0.12311124801635742  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([385, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.12294435501098633  GigaBytes
Max Memory Allocated: 0.12311124801635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.12294435501098633  GigaBytes
Max Memory Allocated: 0.12311124801635742  GigaBytes

 h.shape torch.Size([1, 385, 128]), torch.Size([1, 385, 128])
----------------------------------------3
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.12331151962280273  GigaBytes
Max Memory Allocated: 0.12331151962280273  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.14166975021362305  GigaBytes
Max Memory Allocated: 0.14295482635498047  GigaBytes

rst.shape  torch.Size([1, 385, 128])
m.shape torch.Size([389, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.14297008514404297  GigaBytes
Max Memory Allocated: 0.14300537109375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.14297008514404297  GigaBytes
Max Memory Allocated: 0.14300537109375  GigaBytes

 h.shape torch.Size([1, 389, 128]), torch.Size([1, 389, 128])
----------------------------------------3
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.143341064453125  GigaBytes
Max Memory Allocated: 0.143341064453125  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.16448688507080078  GigaBytes
Max Memory Allocated: 0.1659708023071289  GigaBytes

rst.shape  torch.Size([1, 389, 128])
m.shape torch.Size([323, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.16568756103515625  GigaBytes
Max Memory Allocated: 0.1659708023071289  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.16568756103515625  GigaBytes
Max Memory Allocated: 0.1659708023071289  GigaBytes

 h.shape torch.Size([1, 323, 128]), torch.Size([1, 323, 128])
----------------------------------------3
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.16599559783935547  GigaBytes
Max Memory Allocated: 0.16599559783935547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.18570995330810547  GigaBytes
Max Memory Allocated: 0.18709611892700195  GigaBytes

rst.shape  torch.Size([1, 323, 128])
m.shape torch.Size([2637, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.19813013076782227  GigaBytes
Max Memory Allocated: 0.1984257698059082  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.19813013076782227  GigaBytes
Max Memory Allocated: 0.1984257698059082  GigaBytes

 h.shape torch.Size([1, 2637, 128]), torch.Size([1, 2637, 128])
----------------------------------------3
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.20064496994018555  GigaBytes
Max Memory Allocated: 0.20064496994018555  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.3839125633239746  GigaBytes
Max Memory Allocated: 0.396486759185791  GigaBytes

rst.shape  torch.Size([1, 2637, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.3637428283691406  GigaBytes
Max Memory Allocated: 0.396486759185791  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.37063026428222656  GigaBytes
Max Memory Allocated: 0.396486759185791  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.3775177001953125  GigaBytes
Max Memory Allocated: 0.396486759185791  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.3705763816833496  GigaBytes
Max Memory Allocated: 0.396486759185791  GigaBytes

torch.Size([7222, 256])
first layer input nodes number: 16442
first layer output nodes number: 7222
edges number: 46583
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.3776421546936035  GigaBytes
Max Memory Allocated: 0.396486759185791  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.38452959060668945  GigaBytes
Max Memory Allocated: 0.396486759185791  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.38625144958496094  GigaBytes
Max Memory Allocated: 0.396486759185791  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.38625144958496094  GigaBytes
Max Memory Allocated: 0.396486759185791  GigaBytes

m.shape torch.Size([369, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.41034936904907227  GigaBytes
Max Memory Allocated: 0.4103507995605469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.41034936904907227  GigaBytes
Max Memory Allocated: 0.4103507995605469  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.4110531806945801  GigaBytes
Max Memory Allocated: 0.4110531806945801  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.4166836738586426  GigaBytes
Max Memory Allocated: 0.4170355796813965  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([338, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.41698169708251953  GigaBytes
Max Memory Allocated: 0.4170355796813965  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.41698169708251953  GigaBytes
Max Memory Allocated: 0.4170355796813965  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.41762638092041016  GigaBytes
Max Memory Allocated: 0.41762638092041016  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.4276576042175293  GigaBytes
Max Memory Allocated: 0.4283022880554199  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([286, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.4281601905822754  GigaBytes
Max Memory Allocated: 0.4283022880554199  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.4281601905822754  GigaBytes
Max Memory Allocated: 0.4283022880554199  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.42870569229125977  GigaBytes
Max Memory Allocated: 0.42870569229125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.44131994247436523  GigaBytes
Max Memory Allocated: 0.4421381950378418  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([263, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.4429469108581543  GigaBytes
Max Memory Allocated: 0.4429512023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.4429469108581543  GigaBytes
Max Memory Allocated: 0.4429512023925781  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.443448543548584  GigaBytes
Max Memory Allocated: 0.443448543548584  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6561279296875 GB
    Memory Allocated: 0.4579958915710449  GigaBytes
Max Memory Allocated: 0.4589991569519043  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([216, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.6561279296875 GB
    Memory Allocated: 0.4587831497192383  GigaBytes
Max Memory Allocated: 0.4589991569519043  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6561279296875 GB
    Memory Allocated: 0.4587831497192383  GigaBytes
Max Memory Allocated: 0.4589991569519043  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 1.6561279296875 GB
    Memory Allocated: 0.4591951370239258  GigaBytes
Max Memory Allocated: 0.4591951370239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.4740266799926758  GigaBytes
Max Memory Allocated: 0.47505664825439453  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.4747319221496582  GigaBytes
Max Memory Allocated: 0.47505664825439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.4747319221496582  GigaBytes
Max Memory Allocated: 0.47505664825439453  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.4750332832336426  GigaBytes
Max Memory Allocated: 0.47505664825439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6873779296875 GB
    Memory Allocated: 0.4879918098449707  GigaBytes
Max Memory Allocated: 0.48889589309692383  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.6873779296875 GB
    Memory Allocated: 0.4887228012084961  GigaBytes
Max Memory Allocated: 0.48889589309692383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6873779296875 GB
    Memory Allocated: 0.4887228012084961  GigaBytes
Max Memory Allocated: 0.48889589309692383  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 1.6873779296875 GB
    Memory Allocated: 0.48897266387939453  GigaBytes
Max Memory Allocated: 0.48897266387939453  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7010498046875 GB
    Memory Allocated: 0.5014657974243164  GigaBytes
Max Memory Allocated: 0.5023403167724609  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([150, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.7010498046875 GB
    Memory Allocated: 0.5024943351745605  GigaBytes
Max Memory Allocated: 0.5024991035461426  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7010498046875 GB
    Memory Allocated: 0.5024943351745605  GigaBytes
Max Memory Allocated: 0.5024991035461426  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 1.7010498046875 GB
    Memory Allocated: 0.5027804374694824  GigaBytes
Max Memory Allocated: 0.5027804374694824  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.5190882682800293  GigaBytes
Max Memory Allocated: 0.5202326774597168  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([108, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.5198798179626465  GigaBytes
Max Memory Allocated: 0.5202326774597168  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.5198798179626465  GigaBytes
Max Memory Allocated: 0.5202326774597168  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.5200858116149902  GigaBytes
Max Memory Allocated: 0.5202326774597168  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.5332694053649902  GigaBytes
Max Memory Allocated: 0.5341963768005371  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([97, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.5340991020202637  GigaBytes
Max Memory Allocated: 0.5341963768005371  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.5340991020202637  GigaBytes
Max Memory Allocated: 0.5341963768005371  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.5342841148376465  GigaBytes
Max Memory Allocated: 0.5342841148376465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.5474200248718262  GigaBytes
Max Memory Allocated: 0.5483450889587402  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.5481204986572266  GigaBytes
Max Memory Allocated: 0.5483450889587402  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.5481204986572266  GigaBytes
Max Memory Allocated: 0.5483450889587402  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.5482635498046875  GigaBytes
Max Memory Allocated: 0.5483450889587402  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.5594215393066406  GigaBytes
Max Memory Allocated: 0.5602083206176758  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.5601577758789062  GigaBytes
Max Memory Allocated: 0.5602083206176758  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.5601577758789062  GigaBytes
Max Memory Allocated: 0.5602083206176758  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.5602912902832031  GigaBytes
Max Memory Allocated: 0.5602912902832031  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7635498046875 GB
    Memory Allocated: 0.5716400146484375  GigaBytes
Max Memory Allocated: 0.5724411010742188  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([63, 13, 256])
----------------------------------------1
 Nvidia-smi: 1.7635498046875 GB
    Memory Allocated: 0.5723605155944824  GigaBytes
Max Memory Allocated: 0.5724411010742188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7635498046875 GB
    Memory Allocated: 0.5723605155944824  GigaBytes
Max Memory Allocated: 0.5724411010742188  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 1.7635498046875 GB
    Memory Allocated: 0.5724806785583496  GigaBytes
Max Memory Allocated: 0.5724806785583496  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.5835356712341309  GigaBytes
Max Memory Allocated: 0.5843167304992676  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.5841622352600098  GigaBytes
Max Memory Allocated: 0.5843167304992676  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.5841622352600098  GigaBytes
Max Memory Allocated: 0.5843167304992676  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.5842595100402832  GigaBytes
Max Memory Allocated: 0.5843167304992676  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7869873046875 GB
    Memory Allocated: 0.5938897132873535  GigaBytes
Max Memory Allocated: 0.5945706367492676  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 1.7869873046875 GB
    Memory Allocated: 0.5945191383361816  GigaBytes
Max Memory Allocated: 0.5945706367492676  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7869873046875 GB
    Memory Allocated: 0.5945191383361816  GigaBytes
Max Memory Allocated: 0.5945706367492676  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 1.7869873046875 GB
    Memory Allocated: 0.5946087837219238  GigaBytes
Max Memory Allocated: 0.5946087837219238  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.6041111946105957  GigaBytes
Max Memory Allocated: 0.6047835350036621  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.6047277450561523  GigaBytes
Max Memory Allocated: 0.6047835350036621  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.6047277450561523  GigaBytes
Max Memory Allocated: 0.6047835350036621  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.6048097610473633  GigaBytes
Max Memory Allocated: 0.6048097610473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.6140775680541992  GigaBytes
Max Memory Allocated: 0.6147336959838867  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.6145596504211426  GigaBytes
Max Memory Allocated: 0.6147336959838867  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.6145596504211426  GigaBytes
Max Memory Allocated: 0.6147336959838867  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.6146206855773926  GigaBytes
Max Memory Allocated: 0.6147336959838867  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.6219449043273926  GigaBytes
Max Memory Allocated: 0.6224637031555176  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.6225376129150391  GigaBytes
Max Memory Allocated: 0.6225404739379883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.6225376129150391  GigaBytes
Max Memory Allocated: 0.6225404739379883  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.6226062774658203  GigaBytes
Max Memory Allocated: 0.6226062774658203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8240966796875 GB
    Memory Allocated: 0.6313266754150391  GigaBytes
Max Memory Allocated: 0.6319446563720703  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.8240966796875 GB
    Memory Allocated: 0.6319866180419922  GigaBytes
Max Memory Allocated: 0.6319894790649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8240966796875 GB
    Memory Allocated: 0.6319866180419922  GigaBytes
Max Memory Allocated: 0.6319894790649414  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 1.8240966796875 GB
    Memory Allocated: 0.6320590972900391  GigaBytes
Max Memory Allocated: 0.6320590972900391  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8338623046875 GB
    Memory Allocated: 0.6417713165283203  GigaBytes
Max Memory Allocated: 0.6424598693847656  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 1.8338623046875 GB
    Memory Allocated: 0.6423120498657227  GigaBytes
Max Memory Allocated: 0.6424598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8338623046875 GB
    Memory Allocated: 0.6423120498657227  GigaBytes
Max Memory Allocated: 0.6424598693847656  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 1.8338623046875 GB
    Memory Allocated: 0.642369270324707  GigaBytes
Max Memory Allocated: 0.6424598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.6504373550415039  GigaBytes
Max Memory Allocated: 0.6510095596313477  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.6509742736816406  GigaBytes
Max Memory Allocated: 0.6510095596313477  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.6509742736816406  GigaBytes
Max Memory Allocated: 0.6510095596313477  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.6510276794433594  GigaBytes
Max Memory Allocated: 0.6510276794433594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.6589317321777344  GigaBytes
Max Memory Allocated: 0.6594924926757812  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.6594128608703613  GigaBytes
Max Memory Allocated: 0.6594924926757812  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.6594128608703613  GigaBytes
Max Memory Allocated: 0.6594924926757812  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.6594586372375488  GigaBytes
Max Memory Allocated: 0.6594924926757812  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8572998046875 GB
    Memory Allocated: 0.6665539741516113  GigaBytes
Max Memory Allocated: 0.6670575141906738  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.667083740234375  GigaBytes
Max Memory Allocated: 0.667086124420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.667083740234375  GigaBytes
Max Memory Allocated: 0.667086124420166  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.6671314239501953  GigaBytes
Max Memory Allocated: 0.6671314239501953  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8670654296875 GB
    Memory Allocated: 0.6748561859130859  GigaBytes
Max Memory Allocated: 0.6754045486450195  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 1.8670654296875 GB
    Memory Allocated: 0.675201416015625  GigaBytes
Max Memory Allocated: 0.6754045486450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8670654296875 GB
    Memory Allocated: 0.675201416015625  GigaBytes
Max Memory Allocated: 0.6754045486450195  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 1.8670654296875 GB
    Memory Allocated: 0.67523193359375  GigaBytes
Max Memory Allocated: 0.6754045486450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.680389404296875  GigaBytes
Max Memory Allocated: 0.680755615234375  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([218, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.6857328414916992  GigaBytes
Max Memory Allocated: 0.685753345489502  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.6857328414916992  GigaBytes
Max Memory Allocated: 0.685753345489502  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.6861486434936523  GigaBytes
Max Memory Allocated: 0.6861486434936523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.7593297958374023  GigaBytes
Max Memory Allocated: 0.7645273208618164  GigaBytes

rst.shape  torch.Size([1, 218, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.7383871078491211  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.7388210296630859  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.7392549514770508  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.7387990951538086  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

torch.Size([2912, 40])
input nodes number: 7222
output nodes number: 2912
edges number: 23672
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.7393088340759277  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.7393097877502441  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.015390872955322266  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

pseudo mini batch 1 input nodes size: 11689
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.013849735260009766  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.013849735260009766  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.019423484802246094  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.019445419311523438  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.011583328247070312  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.011951446533203125  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.011951446533203125  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.011951446533203125  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

torch.Size([11689, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.011951446533203125  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

m.shape torch.Size([743, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.027903079986572266  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.027903079986572266  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 743, 128]), torch.Size([1, 743, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.02861166000366211  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.034424781799316406  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 743, 128])
m.shape torch.Size([724, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.03476095199584961  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.03476095199584961  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 724, 128]), torch.Size([1, 724, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.035451412200927734  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.0464019775390625  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 724, 128])
m.shape torch.Size([650, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.04698657989501953  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.04698657989501953  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.047606468200683594  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.06136322021484375  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 650, 128])
m.shape torch.Size([594, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.062186241149902344  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.062186241149902344  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 594, 128]), torch.Size([1, 594, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.06275272369384766  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.07985591888427734  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 594, 128])
m.shape torch.Size([483, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.08072423934936523  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.08072423934936523  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.08118486404418945  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.09776735305786133  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 483, 128])
m.shape torch.Size([389, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.09864997863769531  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.09864997863769531  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 389, 128]), torch.Size([1, 389, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.09902095794677734  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.11497306823730469  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 389, 128])
m.shape torch.Size([326, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.1158757209777832  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.1158757209777832  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 326, 128]), torch.Size([1, 326, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.11618661880493164  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.13173151016235352  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 326, 128])
m.shape torch.Size([284, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.1326594352722168  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.1326594352722168  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 284, 128]), torch.Size([1, 284, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.13293027877807617  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.14836835861206055  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 284, 128])
m.shape torch.Size([239, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.1495380401611328  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.1495380401611328  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 239, 128]), torch.Size([1, 239, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.1497659683227539  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.1643533706665039  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 239, 128])
m.shape torch.Size([1377, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.1708054542541504  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.1708054542541504  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 1377, 128]), torch.Size([1, 1377, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.1721186637878418  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.26535654067993164  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 1377, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.25221776962280273  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.25775766372680664  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.26329755783081055  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.25771427154541016  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

torch.Size([5809, 256])
first layer input nodes number: 11689
first layer output nodes number: 5809
edges number: 31741
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.26338672637939453  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.26906824111938477  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.2703118324279785  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.2703118324279785  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

m.shape torch.Size([495, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.28779172897338867  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.28779172897338867  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 495, 256]), torch.Size([1, 495, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.28873586654663086  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.29718923568725586  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 495, 256])
m.shape torch.Size([409, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.2975034713745117  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.2975034713745117  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.29828357696533203  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3108386993408203  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([340, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3114290237426758  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3114290237426758  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.31207752227783203  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.32634449005126953  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([301, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3271775245666504  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3271775245666504  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.32775163650512695  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.344667911529541  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([220, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.34546375274658203  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.34546375274658203  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3458833694458008  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3609895706176758  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([172, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.36181163787841797  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.36181163787841797  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3621397018432617  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.37624645233154297  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([160, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.37723731994628906  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.37723731994628906  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.37754249572753906  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.39280128479003906  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([138, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.39380359649658203  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.39380359649658203  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.39406681060791016  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4090700149536133  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.40982961654663086  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.40982961654663086  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.41002607345581055  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.42259931564331055  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.42329883575439453  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.42329883575439453  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.42345714569091797  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.43469715118408203  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.43525266647338867  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.43525266647338867  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4353671073913574  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4442934989929199  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.44480180740356445  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.44480180740356445  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.44489526748657227  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.45283937454223633  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4534926414489746  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4534926414489746  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4535994529724121  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4634261131286621  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4639244079589844  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4639244079589844  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4640026092529297  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4717445373535156  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4723544120788574  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4723544120788574  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.472440242767334  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4815382957458496  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.48194169998168945  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.48194169998168945  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.481997013092041  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4882473945617676  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4885139465332031  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4885139465332031  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.48854827880859375  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.49266815185546875  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.49304914474487305  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.49304914474487305  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.49309301376342773  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.49866437911987305  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4989895820617676  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4989895820617676  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.499025821685791  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5038819313049316  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5041713714599609  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5041713714599609  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5042018890380859  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5085048675537109  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5086917877197266  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5086917877197266  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5087108612060547  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5115337371826172  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5118203163146973  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5118203163146973  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5118470191955566  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5159859657287598  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5161495208740234  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5161495208740234  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5161647796630859  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5186367034912109  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.518883228302002  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.518883228302002  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5189042091369629  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5224499702453613  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([74, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5242176055908203  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5242176055908203  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5243587493896484  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5492000579833984  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 74, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.535071849822998  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5355033874511719  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5359349250793457  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5354814529418945  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

torch.Size([2894, 40])
input nodes number: 5809
output nodes number: 2894
edges number: 17556
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5355443954467773  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5355448722839355  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.012699604034423828  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

pseudo mini batch 2 input nodes size: 12764
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.011580944061279297  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.011580944061279297  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.017698287963867188  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.01772022247314453  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.01212453842163086  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.01252603530883789  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.01252603530883789  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.01252603530883789  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

torch.Size([12764, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.01252603530883789  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

m.shape torch.Size([604, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.029898643493652344  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.029898643493652344  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 604, 128]), torch.Size([1, 604, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.03047466278076172  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.035715579986572266  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 604, 128])
m.shape torch.Size([661, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.03605794906616211  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.03605794906616211  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 661, 128]), torch.Size([1, 661, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.03668832778930664  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.04614400863647461  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 661, 128])
m.shape torch.Size([623, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.046720027923583984  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.046720027923583984  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 623, 128]), torch.Size([1, 623, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.04731416702270508  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.06038522720336914  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 623, 128])
m.shape torch.Size([578, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.061220645904541016  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.061220645904541016  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 578, 128]), torch.Size([1, 578, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.06177186965942383  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.07775735855102539  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 578, 128])
m.shape torch.Size([467, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.07859516143798828  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.07859516143798828  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 467, 128]), torch.Size([1, 467, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.07904052734375  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.09507369995117188  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 467, 128])
m.shape torch.Size([411, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.09602689743041992  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.09602689743041992  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 411, 128]), torch.Size([1, 411, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.09641885757446289  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.11327314376831055  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 411, 128])
m.shape torch.Size([329, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.11417531967163086  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.11417531967163086  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 329, 128]), torch.Size([1, 329, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.11448907852172852  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.13017702102661133  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 329, 128])
m.shape torch.Size([299, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.13116073608398438  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.13116073608398438  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 299, 128]), torch.Size([1, 299, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.13144588470458984  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.14769935607910156  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 299, 128])
m.shape torch.Size([262, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.14898347854614258  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.14898347854614258  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 262, 128]), torch.Size([1, 262, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.14923334121704102  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.16522455215454102  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 262, 128])
m.shape torch.Size([1684, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.17312955856323242  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.17312955856323242  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 1684, 128]), torch.Size([1, 1684, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.17473554611206055  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.2897982597351074  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 1684, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.2751030921936035  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.2807469367980957  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.2863907814025879  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.2807025909423828  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

torch.Size([5918, 256])
first layer input nodes number: 12764
first layer output nodes number: 5918
edges number: 34801
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.28648805618286133  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.2921319007873535  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.2935614585876465  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.2935614585876465  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

m.shape torch.Size([400, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3123917579650879  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3123917579650879  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3131546974182129  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3195977210998535  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([398, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.31998157501220703  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.31998157501220703  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3207406997680664  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.33277225494384766  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([322, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.33332157135009766  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.33332157135009766  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3339357376098633  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3481879234313965  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([273, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.34893083572387695  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.34893083572387695  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.34945154190063477  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.36455202102661133  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([225, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3653731346130371  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3653731346130371  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3658022880554199  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.38125181198120117  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([197, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3821735382080078  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3821735382080078  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3825492858886719  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.39870643615722656  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([164, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.39962196350097656  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.39962196350097656  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3999347686767578  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4155750274658203  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([121, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4163494110107422  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4163494110107422  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4165802001953125  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4297351837158203  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([119, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.43065786361694336  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.43065786361694336  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.43088483810424805  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.44541120529174805  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4461631774902344  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4461631774902344  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4463348388671875  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4585227966308594  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([90, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.45938873291015625  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.45938873291015625  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4595603942871094  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4729499816894531  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4735908508300781  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4735908508300781  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4737110137939453  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.48392486572265625  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.48463964462280273  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.48463964462280273  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4847579002380371  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4956374168395996  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4962782859802246  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4962782859802246  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.49637746810913086  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5061964988708496  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5067815780639648  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5067815780639648  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5068655014038086  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5157613754272461  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5163040161132812  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5163040161132812  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5163764953613281  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.524566650390625  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5250535011291504  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5250535011291504  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5251145362854004  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5324387550354004  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([17, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5327024459838867  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5327024459838867  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5327348709106445  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5368528366088867  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5372567176818848  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5372567176818848  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5373005867004395  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5431790351867676  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5435996055603027  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5435996055603027  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5436434745788574  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5498290061950684  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.55010986328125  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.55010986328125  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5501384735107422  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5543727874755859  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.554633617401123  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.554633617401123  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5546584129333496  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5585017204284668  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5587992668151855  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5587992668151855  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5588259696960449  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5631518363952637  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5633463859558105  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5633463859558105  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5633635520935059  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5662646293640137  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([79, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5681543350219727  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5681543350219727  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5683050155639648  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5948247909545898  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 79, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5792503356933594  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5796799659729004  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5801095962524414  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.579658031463623  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

torch.Size([2883, 40])
input nodes number: 5918
output nodes number: 2883
edges number: 19057
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5797224044799805  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5797228813171387  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.013329505920410156  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

pseudo mini batch 3 input nodes size: 16047
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.012122631072998047  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.012122631072998047  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.019774436950683594  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.019795894622802734  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.0136566162109375  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.014165878295898438  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.014165878295898438  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.014165878295898438  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

torch.Size([16047, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.014165878295898438  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

m.shape torch.Size([626, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.0368504524230957  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.0368504524230957  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 626, 128]), torch.Size([1, 626, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.037447452545166016  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.042693138122558594  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 626, 128])
m.shape torch.Size([685, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.04304790496826172  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.04304790496826172  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 685, 128]), torch.Size([1, 685, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.043701171875  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.05350017547607422  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 685, 128])
m.shape torch.Size([638, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.05408620834350586  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.05408620834350586  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 638, 128]), torch.Size([1, 638, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.05469465255737305  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.06851577758789062  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 638, 128])
m.shape torch.Size([532, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.06922626495361328  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.06922626495361328  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.0697336196899414  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.08533954620361328  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([530, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.0863494873046875  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.0863494873046875  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.08685493469238281  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.10529041290283203  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([447, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.10631656646728516  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.10631656646728516  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 447, 128]), torch.Size([1, 447, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.10674285888671875  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.12507343292236328  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 447, 128])
m.shape torch.Size([378, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.12612199783325195  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.12612199783325195  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 378, 128]), torch.Size([1, 378, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.12648248672485352  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.14450693130493164  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 378, 128])
m.shape torch.Size([367, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.14572668075561523  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.14572668075561523  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 367, 128]), torch.Size([1, 367, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.14607667922973633  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.16602659225463867  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 367, 128])
m.shape torch.Size([329, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.16726350784301758  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.16726350784301758  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 329, 128]), torch.Size([1, 329, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.16757726669311523  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.18765783309936523  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 329, 128])
m.shape torch.Size([2575, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.19977951049804688  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.19977951049804688  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 2575, 128]), torch.Size([1, 2575, 128])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.20223522186279297  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3765907287597656  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 2575, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.35701990127563477  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.363797664642334  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3705754280090332  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.36374425888061523  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

torch.Size([7107, 256])
first layer input nodes number: 16047
first layer output nodes number: 7107
edges number: 45663
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.370697021484375  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.3774747848510742  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.37981605529785156  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.37981605529785156  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

m.shape torch.Size([416, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4022860527038574  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4022860527038574  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4030795097351074  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.40946340560913086  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([354, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4097476005554199  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4097476005554199  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.41042280197143555  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4213542938232422  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([307, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4219021797180176  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4219021797180176  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.422487735748291  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4364795684814453  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([224, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.43704795837402344  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.43704795837402344  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.43747520446777344  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.44986534118652344  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4506969451904297  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4506969451904297  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4510936737060547  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4653759002685547  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.46605443954467773  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.46605443954467773  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.46634435653686523  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.47881078720092773  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.47954750061035156  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.47954750061035156  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.47979736328125  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.4922904968261719  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.49306535720825195  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.49306535720825195  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.493288516998291  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5060086250305176  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5068230628967285  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5068230628967285  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5070271492004395  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5200886726379395  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([94, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5208902359008789  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5208902359008789  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5210695266723633  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5337991714477539  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([87, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5346293449401855  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5346293449401855  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5347952842712402  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5477385520935059  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5484170913696289  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5484170913696289  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5485429763793945  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5592432022094727  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5598053932189941  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5598053932189941  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5599007606506348  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5686745643615723  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5691518783569336  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5691518783569336  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5692262649536133  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5765905380249023  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.577202320098877  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.577202320098877  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5772881507873535  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5863862037658691  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5870199203491211  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5870199203491211  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5871038436889648  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5965871810913086  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5971012115478516  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5971012115478516  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.5971660614013672  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6049480438232422  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6054177284240723  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6054177284240723  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6054730415344238  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6124978065490723  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6131277084350586  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6131277084350586  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6131963729858398  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6223974227905273  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6230359077453613  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6230359077453613  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6231026649475098  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6325154304504395  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6328659057617188  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6328659057617188  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6329021453857422  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6382656097412109  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6386284828186035  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6386284828186035  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6386628150939941  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.643984317779541  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.644343376159668  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.644343376159668  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6443758010864258  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6496286392211914  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6498432159423828  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6498432159423828  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6498622894287109  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6530857086181641  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([226, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6587252616882324  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.6587252616882324  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.659156322479248  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.735023021697998  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 226, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.7156925201416016  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.7161197662353516  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.7165470123291016  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.7160983085632324  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

torch.Size([2865, 40])
input nodes number: 7107
output nodes number: 2865
edges number: 22533
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.7161707878112793  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.7161712646484375  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.015153884887695312  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

pseudo mini batch 4 input nodes size: 21272
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.013654232025146484  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.013654232025146484  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.02379751205444336  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.023819446563720703  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.016146183013916016  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.016759395599365234  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.016759395599365234  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.016759395599365234  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

torch.Size([21272, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.016759395599365234  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

m.shape torch.Size([562, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.04510831832885742  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.04510831832885742  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.045644283294677734  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.05059623718261719  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([645, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.05094337463378906  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.05094337463378906  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 645, 128]), torch.Size([1, 645, 128])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.051558494567871094  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.06137228012084961  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 645, 128])
m.shape torch.Size([598, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.061920166015625  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.061920166015625  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.06249046325683594  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.07598304748535156  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([570, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.07678508758544922  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.07678508758544922  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.07732868194580078  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.0937185287475586  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([502, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.09464359283447266  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.09464359283447266  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.0951223373413086  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.11235713958740234  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([435, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.11336231231689453  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.11336231231689453  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.11377716064453125  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.13161563873291016  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([432, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.13285017013549805  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.13285017013549805  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 432, 128]), torch.Size([1, 432, 128])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.13326215744018555  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.15386152267456055  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 432, 128])
m.shape torch.Size([375, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.15508604049682617  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.15508604049682617  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 375, 128]), torch.Size([1, 375, 128])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.15544366836547852  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.1758284568786621  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 375, 128])
m.shape torch.Size([353, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.17716455459594727  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.17716455459594727  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 353, 128]), torch.Size([1, 353, 128])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.17750120162963867  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.19904661178588867  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 353, 128])
m.shape torch.Size([3703, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.2165355682373047  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.2165355682373047  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 3703, 128]), torch.Size([1, 3703, 128])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.22017526626586914  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.47204113006591797  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 3703, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.4466724395751953  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.4544687271118164  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.4622650146484375  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.4544076919555664  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

torch.Size([8175, 256])
first layer input nodes number: 21272
first layer output nodes number: 8175
edges number: 57277
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.46242570877075195  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.47027063369750977  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.4721713066101074  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.4721713066101074  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

m.shape torch.Size([365, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.4965643882751465  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.4965643882751465  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.49726057052612305  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5031828880310059  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 365, 256])
m.shape torch.Size([352, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5035114288330078  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5035114288330078  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5041828155517578  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5159549713134766  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([262, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5163750648498535  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5163750648498535  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5168747901916504  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5290193557739258  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([233, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.529665470123291  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.529665470123291  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5301098823547363  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5429978370666504  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([207, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5437707901000977  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5437707901000977  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5441656112670898  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5583791732788086  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([161, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5591106414794922  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5591106414794922  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.559417724609375  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5726222991943359  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([150, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5734782218933105  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5734782218933105  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5737643241882324  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5880694389343262  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([128, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5889105796813965  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5889105796813965  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.5891547203063965  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6030707359313965  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([108, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6038832664489746  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6038832664489746  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6040892601013184  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6172728538513184  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([98, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6181120872497559  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6181120872497559  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6182990074157715  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6315703392028809  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6321749687194824  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6321749687194824  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.632300853729248  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6421198844909668  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6429224014282227  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6429224014282227  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6430654525756836  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6552248001098633  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([72, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6560530662536621  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6560530662536621  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6561903953552246  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6688246726989746  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([64, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6696171760559082  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6696171760559082  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6697392463684082  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6818242073059082  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6825418472290039  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6825418472290039  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6826448440551758  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6935625076293945  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6942338943481445  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6942338943481445  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6943235397338867  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7044534683227539  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7051115036010742  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7051115036010742  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7051935195922852  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7150354385375977  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7155656814575195  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7155656814575195  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7156286239624023  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7236223220825195  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7241024971008301  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7241024971008301  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7241559028625488  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7313122749328613  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7318239212036133  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7318239212036133  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.731877326965332  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7394075393676758  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7397847175598145  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7397847175598145  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7398228645324707  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7454686164855957  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7459359169006348  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7459359169006348  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7459797859191895  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.752779483795166  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7530674934387207  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7530674934387207  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7530941963195801  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7574200630187988  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.757845401763916  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.757845401763916  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7578816413879395  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7640061378479004  GigaBytes
Max Memory Allocated: 0.7674598693847656  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([277, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7706441879272461  GigaBytes
Max Memory Allocated: 0.7706704139709473  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7706441879272461  GigaBytes
Max Memory Allocated: 0.7706704139709473  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.7711725234985352  GigaBytes
Max Memory Allocated: 0.7711725234985352  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1229248046875 GB
    Memory Allocated: 0.8658609390258789  GigaBytes
Max Memory Allocated: 0.8724651336669922  GigaBytes

rst.shape  torch.Size([1, 277, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1229248046875 GB
    Memory Allocated: 0.8445868492126465  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1229248046875 GB
    Memory Allocated: 0.8450231552124023  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1229248046875 GB
    Memory Allocated: 0.8454594612121582  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1229248046875 GB
    Memory Allocated: 0.845001220703125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([2927, 40])
input nodes number: 8175
output nodes number: 2927
edges number: 24880
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1229248046875 GB
    Memory Allocated: 0.8450932502746582  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1229248046875 GB
    Memory Allocated: 0.8450937271118164  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.017942428588867188  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

pseudo mini batch 5 input nodes size: 16871
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.016155242919921875  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.016155242919921875  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.024199962615966797  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.024221420288085938  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.014056205749511719  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.014570236206054688  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.014570236206054688  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.014570236206054688  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([16871, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.014570236206054688  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

m.shape torch.Size([504, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.037235260009765625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.037235260009765625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 504, 128]), torch.Size([1, 504, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.037715911865234375  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.041561126708984375  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 504, 128])
m.shape torch.Size([560, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.0418548583984375  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.0418548583984375  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.042388916015625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.05122852325439453  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([565, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.05176973342895508  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.05176973342895508  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.05230855941772461  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.0641627311706543  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([474, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.06479740142822266  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.06479740142822266  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.06524944305419922  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.07835865020751953  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([436, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.07917213439941406  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.07917213439941406  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 436, 128]), torch.Size([1, 436, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.07958793640136719  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.09455680847167969  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 436, 128])
m.shape torch.Size([349, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.09534740447998047  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.09534740447998047  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 349, 128]), torch.Size([1, 349, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.09568023681640625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.10999202728271484  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 349, 128])
m.shape torch.Size([320, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.11176061630249023  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.11176061630249023  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.11206579208374023  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.12732458114624023  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 320, 128])
m.shape torch.Size([317, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.12838125228881836  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.12838125228881836  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 317, 128]), torch.Size([1, 317, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.12868356704711914  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.14591550827026367  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 317, 128])
m.shape torch.Size([270, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.14692306518554688  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.14692306518554688  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 270, 128]), torch.Size([1, 270, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.14718055725097656  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.16366004943847656  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 270, 128])
m.shape torch.Size([2908, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.1773977279663086  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.1773977279663086  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 2908, 128]), torch.Size([1, 2908, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.180694580078125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.3787803649902344  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 2908, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.35863208770751953  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.3650245666503906  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.3714170455932617  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.3649744987487793  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([6703, 256])
first layer input nodes number: 16871
first layer output nodes number: 6703
edges number: 45775
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.37154483795166016  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.37829113006591797  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.3795356750488281  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.3795356750488281  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

m.shape torch.Size([363, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4022245407104492  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4022245407104492  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.40291690826416016  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.40868139266967773  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([326, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4089622497558594  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4089622497558594  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.40958404541015625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4203610420227051  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([300, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4209156036376953  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4209156036376953  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.42148780822753906  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.43407630920410156  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([253, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.43476295471191406  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.43476295471191406  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4352455139160156  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.44923973083496094  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4499692916870117  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4499692916870117  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.45035457611083984  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.46422481536865234  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.46489763259887695  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.46489763259887695  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.46518373489379883  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.47748613357543945  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.47825145721435547  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.47825145721435547  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.47850894927978516  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.49138355255126953  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([122, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.49219322204589844  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.49219322204589844  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.49242591857910156  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5056896209716797  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([112, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5065422058105469  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5065422058105469  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5067558288574219  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5204277038574219  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([103, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5213112831115723  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5213112831115723  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.521507740020752  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5354561805725098  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5360560417175293  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5360560417175293  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5361819267272949  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5460009574890137  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.546745777130127  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.546745777130127  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5468792915344238  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5582280158996582  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([67, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5589985847473145  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5589985847473145  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5591263771057129  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5708832740783691  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5715460777282715  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5715460777282715  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5716490745544434  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.581845760345459  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([57, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5826163291931152  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5826163291931152  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5827250480651855  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5942492485046387  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5945487022399902  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5945487022399902  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5945925712585449  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5995497703552246  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6000347137451172  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6000347137451172  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6000938415527344  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6071891784667969  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6076440811157227  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6076440811157227  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6076974868774414  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6144800186157227  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6148734092712402  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6148734092712402  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6149172782897949  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.620795726776123  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6212544441223145  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6212544441223145  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6213021278381348  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6280255317687988  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6284255981445312  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6284255981445312  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6284656524658203  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6343936920166016  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6350293159484863  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6350293159484863  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6350884437561035  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6442532539367676  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6445112228393555  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6445112228393555  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.644536018371582  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6485528945922852  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6489095687866211  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6489095687866211  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6489400863647461  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6540975570678711  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([245, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6599693298339844  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6599693298339844  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6604366302490234  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.7426815032958984  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 245, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.7230391502380371  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.7234621047973633  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.7238850593566895  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.7234406471252441  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([2836, 40])
input nodes number: 6703
output nodes number: 2836
edges number: 23111
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.7234988212585449  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.7234992980957031  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.015552520751953125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

pseudo mini batch 6 input nodes size: 10980
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.014042854309082031  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.014042854309082031  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.01967000961303711  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.019691944122314453  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.01162576675415039  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.011931896209716797  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.011931896209716797  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.011931896209716797  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([10980, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.011931896209716797  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

m.shape torch.Size([841, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.02534008026123047  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.02534008026123047  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 841, 128]), torch.Size([1, 841, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.026142120361328125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.032558441162109375  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 841, 128])
m.shape torch.Size([815, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.03293466567993164  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.03293466567993164  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 815, 128]), torch.Size([1, 815, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.033711910247802734  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.04549407958984375  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 815, 128])
m.shape torch.Size([719, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.046176910400390625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.046176910400390625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 719, 128]), torch.Size([1, 719, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.04686260223388672  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.06291866302490234  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 719, 128])
m.shape torch.Size([535, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.06359624862670898  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.06359624862670898  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.06410646438598633  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.0789027214050293  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([438, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.07969188690185547  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.07969188690185547  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 438, 128]), torch.Size([1, 438, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.0801095962524414  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.09514713287353516  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 438, 128])
m.shape torch.Size([349, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.09593677520751953  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.09593677520751953  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 349, 128]), torch.Size([1, 349, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.09626960754394531  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1105813980102539  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 349, 128])
m.shape torch.Size([304, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.11142969131469727  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.11142969131469727  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 304, 128]), torch.Size([1, 304, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.11171960830688477  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12621545791625977  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 304, 128])
m.shape torch.Size([236, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12697076797485352  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12697076797485352  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 236, 128]), torch.Size([1, 236, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1271958351135254  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.14002466201782227  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 236, 128])
m.shape torch.Size([183, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.14069747924804688  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.14069747924804688  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 183, 128]), torch.Size([1, 183, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.14087200164794922  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.15204143524169922  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 183, 128])
m.shape torch.Size([971, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1565842628479004  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1565842628479004  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 971, 128]), torch.Size([1, 971, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.15751028060913086  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.2233424186706543  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 971, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.21274185180664062  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.21788311004638672  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.2230243682861328  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.21784257888793945  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([5391, 256])
first layer input nodes number: 10980
first layer output nodes number: 5391
edges number: 26425
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.22310829162597656  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.22824954986572266  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.22960567474365234  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.22960567474365234  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

m.shape torch.Size([611, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.24482154846191406  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.24482154846191406  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 611, 256]), torch.Size([1, 611, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.2459869384765625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.25554990768432617  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 611, 256])
m.shape torch.Size([475, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.25588035583496094  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.25588035583496094  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.2567863464355469  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.27088212966918945  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([384, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.27211952209472656  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.27211952209472656  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.27285194396972656  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.28987693786621094  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([287, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.29061412811279297  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.29061412811279297  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.29116153717041016  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3070363998413086  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([230, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.30786800384521484  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.30786800384521484  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3083066940307617  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3240995407104492  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([180, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.324918270111084  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.324918270111084  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.32526159286499023  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.340024471282959  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([138, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.34078168869018555  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.34078168869018555  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.34104490280151367  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3542056083679199  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3549351692199707  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3549351692199707  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3551487922668457  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3673253059387207  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3679022789001465  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3679022789001465  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.36805295944213867  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.37769651412963867  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([64, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3782362937927246  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3782362937927246  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3783583641052246  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3870253562927246  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([47, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.38746166229248047  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.38746166229248047  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.38755130767822266  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3945436477661133  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([42, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.39498329162597656  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.39498329162597656  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3950634002685547  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4018726348876953  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([28, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.40218257904052734  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.40218257904052734  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4022359848022461  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4071493148803711  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4076070785522461  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4076070785522461  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.40767574310302734  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4144735336303711  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4148573875427246  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4148573875427246  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.41491270065307617  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4207758903503418  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.42108678817749023  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.42108678817749023  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4211287498474121  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.425870418548584  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.42609453201293945  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.42609453201293945  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.42612314224243164  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.42955636978149414  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.42994022369384766  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.42994022369384766  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.42998409271240234  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.43555545806884766  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.43573474884033203  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.43573474884033203  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.43575572967529297  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4385671615600586  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([4, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.43863391876220703  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.43863391876220703  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4386415481567383  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.43971729278564453  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4398345947265625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4398345947265625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4398460388183594  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4415397644042969  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4416189193725586  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4416189193725586  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.44162654876708984  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4428091049194336  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.442960262298584  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.442960262298584  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.44297361373901367  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.44513654708862305  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4452686309814453  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4452686309814453  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4452800750732422  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.44721412658691406  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([45, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4482898712158203  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4482898712158203  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4483757019042969  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4634819030761719  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 45, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.45172548294067383  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.45215559005737305  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.45258569717407227  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4521336555480957  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([2885, 40])
input nodes number: 5391
output nodes number: 2885
edges number: 14582
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.45220327377319336  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.45220375061035156  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.012590885162353516  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

pseudo mini batch 7 input nodes size: 16995
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.011632919311523438  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.011632919311523438  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.019736766815185547  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.01975870132446289  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.014109611511230469  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.014565467834472656  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.014565467834472656  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.014565467834472656  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([16995, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.014565467834472656  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

m.shape torch.Size([841, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.0351719856262207  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.0351719856262207  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 841, 128]), torch.Size([1, 841, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.03597402572631836  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.04298591613769531  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 841, 128])
m.shape torch.Size([786, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.0433344841003418  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.0433344841003418  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 786, 128]), torch.Size([1, 786, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.04408407211303711  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.056293487548828125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 786, 128])
m.shape torch.Size([673, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.05688142776489258  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.05688142776489258  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 673, 128]), torch.Size([1, 673, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.057523250579833984  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.07164335250854492  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 673, 128])
m.shape torch.Size([553, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.07257938385009766  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.07257938385009766  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.07310676574707031  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.08840084075927734  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([455, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.08987665176391602  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.08987665176391602  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 455, 128]), torch.Size([1, 455, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.09031057357788086  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.10593175888061523  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 455, 128])
m.shape torch.Size([405, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1068735122680664  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1068735122680664  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 405, 128]), torch.Size([1, 405, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.10725975036621094  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12386798858642578  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 405, 128])
m.shape torch.Size([321, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12474632263183594  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12474632263183594  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12505245208740234  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.14035892486572266  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 321, 128])
m.shape torch.Size([299, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.14134645462036133  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.14134645462036133  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 299, 128]), torch.Size([1, 299, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1416316032409668  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.15788507461547852  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 299, 128])
m.shape torch.Size([243, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.15878534317016602  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.15878534317016602  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 243, 128]), torch.Size([1, 243, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.15901708602905273  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.17384862899780273  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 243, 128])
m.shape torch.Size([2300, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.18470001220703125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.18470001220703125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 2300, 128]), torch.Size([1, 2300, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.18689346313476562  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3505840301513672  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 2300, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3321094512939453  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3386669158935547  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.34522438049316406  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.33861541748046875  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([6876, 256])
first layer input nodes number: 16995
first layer output nodes number: 6876
edges number: 41175
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3453531265258789  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3519105911254883  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3538942337036133  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3538942337036133  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

m.shape torch.Size([575, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3742551803588867  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3742551803588867  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 575, 256]), torch.Size([1, 575, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3753519058227539  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.38504695892333984  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 575, 256])
m.shape torch.Size([410, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.385286808013916  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.385286808013916  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.38606882095336914  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.39795923233032227  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([312, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.398468017578125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.398468017578125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3990631103515625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4136695861816406  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([246, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4143180847167969  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4143180847167969  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.41478729248046875  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4283943176269531  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([194, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4290924072265625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4290924072265625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4294624328613281  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4427833557128906  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([179, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4436917304992676  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4436917304992676  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.444033145904541  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.45871400833129883  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([116, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4593238830566406  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4593238830566406  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4595451354980469  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4706077575683594  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([103, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.47128915786743164  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.47128915786743164  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.47148561477661133  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4826836585998535  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([74, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.48322582244873047  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.48322582244873047  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4833669662475586  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4924001693725586  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4931950569152832  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4931950569152832  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.49336671829223633  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5055546760559082  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5061774253845215  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5061774253845215  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5063052177429199  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.516273021697998  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5168781280517578  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5168781280517578  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5169887542724609  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5263919830322266  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5269489288330078  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5269489288330078  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5270423889160156  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5356407165527344  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5361189842224121  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5361189842224121  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5361933708190918  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5435576438903809  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5440397262573242  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5440397262573242  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5441083908081055  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.551386833190918  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5517373085021973  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5517373085021973  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5517849922180176  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5571732521057129  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5576071739196777  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5576071739196777  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5576605796813965  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5640692710876465  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5645790100097656  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5645790100097656  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5646381378173828  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5721473693847656  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5726475715637207  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5726475715637207  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5727028846740723  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5801148414611816  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5804524421691895  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5804524421691895  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5804886817932129  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5855984687805176  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.585822582244873  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.585822582244873  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5858454704284668  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5892329216003418  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5894966125488281  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5894966125488281  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5895214080810547  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5933647155761719  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5936622619628906  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5936622619628906  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.59368896484375  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5980148315429688  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5983939170837402  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5983939170837402  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.598426342010498  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6039061546325684  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([182, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6082634925842285  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6082634925842285  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6086106300354004  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6697068214416504  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 182, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6527113914489746  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6531462669372559  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6535811424255371  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6531243324279785  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([2918, 40])
input nodes number: 6876
output nodes number: 2918
edges number: 19900
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6532025337219238  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.653203010559082  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.01548910140991211  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

pseudo mini batch 8 input nodes size: 11161
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.0141143798828125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.0141143798828125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.01968240737915039  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.019704341888427734  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.011578559875488281  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.012059211730957031  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.012059211730957031  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.012059211730957031  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([11161, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.012059211730957031  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

m.shape torch.Size([424, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.031136512756347656  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.031136512756347656  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 424, 128]), torch.Size([1, 424, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.031540870666503906  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.034775733947753906  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 424, 128])
m.shape torch.Size([525, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.03507423400878906  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.03507423400878906  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.035574913024902344  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.04324674606323242  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([485, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.04369020462036133  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.04369020462036133  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 485, 128]), torch.Size([1, 485, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.04415273666381836  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.05432844161987305  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 485, 128])
m.shape torch.Size([429, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.054915428161621094  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.054915428161621094  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 429, 128]), torch.Size([1, 429, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.055324554443359375  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.06718921661376953  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 429, 128])
m.shape torch.Size([356, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.06783342361450195  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.06783342361450195  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 356, 128]), torch.Size([1, 356, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.06817293167114258  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.08039522171020508  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 356, 128])
m.shape torch.Size([309, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.08110952377319336  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.08110952377319336  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 309, 128]), torch.Size([1, 309, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.08140420913696289  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.09407567977905273  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 309, 128])
m.shape torch.Size([298, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.09492301940917969  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.09492301940917969  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 298, 128]), torch.Size([1, 298, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.09520721435546875  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.10941696166992188  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 298, 128])
m.shape torch.Size([279, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.11033916473388672  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.11033916473388672  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 279, 128]), torch.Size([1, 279, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.11060523986816406  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12577152252197266  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 279, 128])
m.shape torch.Size([256, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12673711776733398  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12673711776733398  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 256, 128]), torch.Size([1, 256, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12698125839233398  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.14260625839233398  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 256, 128])
m.shape torch.Size([2362, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1537470817565918  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1537470817565918  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 2362, 128]), torch.Size([1, 2362, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.15618371963500977  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.31957578659057617  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 2362, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.30231332778930664  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3080263137817383  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.31348419189453125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.30772829055786133  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([5723, 256])
first layer input nodes number: 11161
first layer output nodes number: 5723
edges number: 38521
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.31331443786621094  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3190274238586426  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3207669258117676  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3207669258117676  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

m.shape torch.Size([298, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.34676313400268555  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.34676313400268555  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.34733152389526367  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.35233402252197266  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([350, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3527226448059082  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3527226448059082  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3533902168273926  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.36397457122802734  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([254, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.36437320709228516  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.36437320709228516  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.36485767364501953  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3755159378051758  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([245, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.37621593475341797  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.37621593475341797  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.37668323516845703  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.39023494720458984  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([182, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.39087629318237305  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.39087629318237305  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3912234306335449  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4037203788757324  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([154, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4044351577758789  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4044351577758789  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.40472888946533203  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4173593521118164  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([140, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4181547164916992  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4181547164916992  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.41842174530029297  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.43177318572998047  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([127, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4326162338256836  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4326162338256836  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4328584671020508  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.44666576385498047  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([121, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.44759178161621094  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.44759178161621094  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.44782257080078125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.46259307861328125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4632854461669922  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4632854461669922  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.46344566345214844  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4748210906982422  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([90, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4756927490234375  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4756927490234375  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4758644104003906  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4892539978027344  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([93, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.49024105072021484  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.49024105072021484  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4904184341430664  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5054960250854492  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5062699317932129  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5062699317932129  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.506401538848877  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5185093879699707  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([55, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5191841125488281  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5191841125488281  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5192890167236328  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5296745300292969  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5303144454956055  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5303144454956055  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5304059982299805  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5401105880737305  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.540679931640625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.540679931640625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5407562255859375  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.54937744140625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5500583648681641  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5500583648681641  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5501422882080078  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5602130889892578  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([47, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5609846115112305  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5609846115112305  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5610742568969727  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5724592208862305  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.572944164276123  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.572944164276123  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5729994773864746  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.580411434173584  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5809416770935059  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5809416770935059  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5809969902038574  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5887961387634277  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5894145965576172  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5894145965576172  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5894756317138672  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5985088348388672  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5990705490112305  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5990705490112305  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5991239547729492  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6074018478393555  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6080384254455566  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6080384254455566  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.608095645904541  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6173653602600098  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6177058219909668  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6177058219909668  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6177363395690918  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6228938102722168  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([288, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6297988891601562  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6297988891601562  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6303482055664062  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.7304458618164062  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 288, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.7074689865112305  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.7079005241394043  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.7083320617675781  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.707878589630127  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([2893, 40])
input nodes number: 5723
output nodes number: 2893
edges number: 25919
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.7079401016235352  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.7079405784606934  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.012975215911865234  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

pseudo mini batch 9 input nodes size: 9416
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.01157522201538086  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.01157522201538086  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.016065120697021484  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.016087055206298828  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.010497093200683594  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.010822296142578125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.010822296142578125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.010822296142578125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([9416, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.010822296142578125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

m.shape torch.Size([739, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.025255680084228516  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.025255680084228516  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 739, 128]), torch.Size([1, 739, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.025960445404052734  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.031598567962646484  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 739, 128])
m.shape torch.Size([821, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.032029151916503906  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.032029151916503906  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.03281211853027344  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.04481220245361328  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([662, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.04536771774291992  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.04536771774291992  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 662, 128]), torch.Size([1, 662, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.04599905014038086  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.059888362884521484  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 662, 128])
m.shape torch.Size([529, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.06058168411254883  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.06058168411254883  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.061086177825927734  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.07615900039672852  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([479, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.07704877853393555  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.07704877853393555  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.07750558853149414  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.09395074844360352  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([378, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.0948038101196289  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.0948038101196289  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 378, 128]), torch.Size([1, 378, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.09516429901123047  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.11066532135009766  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 378, 128])
m.shape torch.Size([322, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.11155986785888672  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.11155986785888672  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 322, 128]), torch.Size([1, 322, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.11186695098876953  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12722110748291016  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 322, 128])
m.shape torch.Size([243, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12799453735351562  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12799453735351562  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 243, 128]), torch.Size([1, 243, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12822628021240234  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1414356231689453  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 243, 128])
m.shape torch.Size([196, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.14216089248657227  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.14216089248657227  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 196, 128]), torch.Size([1, 196, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1423478126525879  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1543107032775879  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 196, 128])
m.shape torch.Size([992, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.15894746780395508  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.15894746780395508  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 992, 128]), torch.Size([1, 992, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.15989351272583008  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.22889375686645508  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 992, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.21719837188720703  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.22231101989746094  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.22742366790771484  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.22227096557617188  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([5361, 256])
first layer input nodes number: 9416
first layer output nodes number: 5361
edges number: 27028
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.22749614715576172  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.23260879516601562  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.23402166366577148  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.23402166366577148  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

m.shape torch.Size([509, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.25041913986206055  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.25041913986206055  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 509, 256]), torch.Size([1, 509, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.2513899803161621  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.25977134704589844  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 509, 256])
m.shape torch.Size([471, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.2601914405822754  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.2601914405822754  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.2610898017883301  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.2747015953063965  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([376, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.27576589584350586  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.27576589584350586  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.27648305892944336  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.29254817962646484  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([249, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.29314708709716797  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.29314708709716797  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.2936220169067383  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.30739498138427734  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([249, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.30835437774658203  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.30835437774658203  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.30882930755615234  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3259267807006836  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([197, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3268256187438965  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3268256187438965  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.32720136642456055  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.34335851669311523  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([150, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.34496498107910156  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.34496498107910156  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.34525108337402344  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3595561981201172  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([122, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3603515625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3603515625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3605842590332031  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.37384796142578125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3744845390319824  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3744845390319824  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3746504783630371  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3852705955505371  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.38588953018188477  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.38588953018188477  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3860287666320801  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.39591455459594727  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.396543025970459  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.396543025970459  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3966689109802246  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.40648794174194336  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4071516990661621  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4071516990661621  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4072718620300293  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.41748571395874023  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.41790056228637695  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.41790056228637695  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.41797304153442383  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.42464113235473633  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4250221252441406  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4250221252441406  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4250812530517578  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4309349060058594  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4314103126525879  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4314103126525879  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.43147706985473633  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4385533332824707  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4388737678527832  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4388737678527832  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4389176368713379  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4438748359680176  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4442777633666992  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4442777633666992  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.44432735443115234  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.45027828216552734  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4505133628845215  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4505133628845215  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.45054197311401367  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4541754722595215  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.45441722869873047  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.45441722869873047  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.45444393157958984  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4580221176147461  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4581437110900879  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4581437110900879  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4581570625305176  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4600396156311035  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4603762626647949  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4603762626647949  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.46040868759155273  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.465207576751709  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.46540307998657227  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.46540307998657227  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4654221534729004  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.46837854385375977  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4685020446777344  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4685020446777344  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.46851348876953125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.470367431640625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4705924987792969  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4705924987792969  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.470611572265625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4738349914550781  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([60, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4752674102783203  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4752674102783203  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.47538185119628906  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.49552345275878906  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 60, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.48250532150268555  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.482938289642334  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4833712577819824  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.48291635513305664  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([2904, 40])
input nodes number: 5361
output nodes number: 2904
edges number: 16417
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.48297977447509766  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.48298025131225586  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.011495590209960938  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

pseudo mini batch 10 input nodes size: 13096
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.010498523712158203  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.010498523712158203  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.016743183135986328  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.01676464080810547  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.0122528076171875  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.012742996215820312  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.012742996215820312  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.012742996215820312  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([13096, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.012742996215820312  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

m.shape torch.Size([380, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.03325176239013672  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.03325176239013672  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 380, 128]), torch.Size([1, 380, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.033614158630371094  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.036513328552246094  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 380, 128])
m.shape torch.Size([451, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.036762237548828125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.036762237548828125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.037192344665527344  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.043643951416015625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([458, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.04408407211303711  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.04408407211303711  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 458, 128]), torch.Size([1, 458, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.04452085494995117  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.05413007736206055  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 458, 128])
m.shape torch.Size([454, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.05477762222290039  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.05477762222290039  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 454, 128]), torch.Size([1, 454, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.05521059036254883  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.06776666641235352  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 454, 128])
m.shape torch.Size([422, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.06855630874633789  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.06855630874633789  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 422, 128]), torch.Size([1, 422, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.06895875930786133  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.08344697952270508  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 422, 128])
m.shape torch.Size([419, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.08517694473266602  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.08517694473266602  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 419, 128]), torch.Size([1, 419, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.08557653427124023  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.10275888442993164  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 419, 128])
m.shape torch.Size([347, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.10371732711791992  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.10371732711791992  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 347, 128]), torch.Size([1, 347, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.10404825210571289  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12059450149536133  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 347, 128])
m.shape torch.Size([307, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12160015106201172  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12160015106201172  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 307, 128]), torch.Size([1, 307, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12189292907714844  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1385812759399414  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 307, 128])
m.shape torch.Size([235, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1397562026977539  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1397562026977539  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 235, 128]), torch.Size([1, 235, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.13998031616210938  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.15432357788085938  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 235, 128])
m.shape torch.Size([2540, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.16632318496704102  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.16632318496704102  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 2540, 128]), torch.Size([1, 2540, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.16909456253051758  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3431572914123535  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 2540, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3249077796936035  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3306422233581543  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3363766670227051  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3305974006652832  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([6013, 256])
first layer input nodes number: 13096
first layer output nodes number: 6013
edges number: 41496
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.33647632598876953  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3422107696533203  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.34434080123901367  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.34434080123901367  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

m.shape torch.Size([292, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.36836767196655273  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.36836767196655273  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.368924617767334  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.37357473373413086  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([294, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.37386178970336914  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.37386178970336914  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.374422550201416  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3834657669067383  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([266, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.38395261764526367  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.38395261764526367  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3844599723815918  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3970065116882324  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([221, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.39760255813598633  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.39760255813598633  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3980240821838379  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4102482795715332  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4110903739929199  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4110903739929199  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.41150808334350586  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4265456199645996  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([213, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4275650978088379  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4275650978088379  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.42797136306762695  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.44544076919555664  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([165, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4463481903076172  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4463481903076172  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.44666290283203125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4623985290527344  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([136, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4632868766784668  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4632868766784668  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4635462760925293  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4783320426940918  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.479128360748291  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.479128360748291  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.47933244705200195  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.49239397048950195  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([118, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4934263229370117  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4934263229370117  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4936513900756836  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5096311569213867  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([109, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5106711387634277  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5106711387634277  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5108790397644043  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5270953178405762  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.527775764465332  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.527775764465332  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5279054641723633  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5389299392700195  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([67, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5397024154663086  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5397024154663086  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.539830207824707  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5515871047973633  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([69, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5524520874023438  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5524520874023438  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5525836944580078  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.56561279296875  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5660948753356934  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5660948753356934  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5661673545837402  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.573850154876709  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.574521541595459  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.574521541595459  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5746092796325684  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5845236778259277  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([53, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5853462219238281  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5853462219238281  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5854473114013672  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5975780487060547  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5980987548828125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5980987548828125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5981616973876953  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6061553955078125  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6065258979797363  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6065258979797363  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6065678596496582  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6121907234191895  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6128621101379395  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6128621101379395  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6129307746887207  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.622612476348877  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6231436729431152  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6231436729431152  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.623197078704834  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.631101131439209  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6315822601318359  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6315822601318359  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6316280364990234  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6387233734130859  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6391205787658691  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6391205787658691  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6391568183898926  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6450276374816895  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6455173492431641  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6455173492431641  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6455593109130859  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6526508331298828  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([197, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6573634147644043  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6573634147644043  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6577391624450684  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.7238707542419434  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 197, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.7029004096984863  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.7033271789550781  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.7037539482116699  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.703305721282959  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([2862, 40])
input nodes number: 6013
output nodes number: 2862
edges number: 24118
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.7033658027648926  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.7033662796020508  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.013671875  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

pseudo mini batch 11 input nodes size: 15004
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.01224660873413086  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.01224660873413086  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.019401073455810547  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.019422531127929688  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.013156414031982422  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.013657093048095703  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.013657093048095703  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.013657093048095703  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([15004, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.013657093048095703  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

m.shape torch.Size([481, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.035359859466552734  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.035359859466552734  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 481, 128]), torch.Size([1, 481, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.03581857681274414  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.03948831558227539  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 481, 128])
m.shape torch.Size([566, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.039798736572265625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.039798736572265625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.04033851623535156  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.048819541931152344  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([566, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.04935932159423828  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.04935932159423828  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.04989910125732422  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.061814308166503906  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([506, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.06250953674316406  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.06250953674316406  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.06299209594726562  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.07698631286621094  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([463, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.07784891128540039  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.07784891128540039  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.07829046249389648  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.09418630599975586  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([388, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.09507560729980469  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.09507560729980469  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 388, 128]), torch.Size([1, 388, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.09544563293457031  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.11135673522949219  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 388, 128])
m.shape torch.Size([367, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.1123967170715332  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.1123967170715332  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 367, 128]), torch.Size([1, 367, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.1127467155456543  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.13024663925170898  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 367, 128])
m.shape torch.Size([329, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.13132667541503906  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.13132667541503906  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 329, 128]), torch.Size([1, 329, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.13164043426513672  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.14952468872070312  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 329, 128])
m.shape torch.Size([291, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.1507887840270996  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.1507887840270996  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 291, 128]), torch.Size([1, 291, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.15106630325317383  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.16882753372192383  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 291, 128])
m.shape torch.Size([2602, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.18109607696533203  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.18109607696533203  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 2602, 128]), torch.Size([1, 2602, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.1835775375366211  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.36620330810546875  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 2602, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.3464207649230957  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.3526759147644043  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.3596968650817871  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.3533926010131836  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([6559, 256])
first layer input nodes number: 15004
first layer output nodes number: 6559
edges number: 43818
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.35981082916259766  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.36606597900390625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.3682270050048828  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.3682270050048828  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

m.shape torch.Size([323, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.3909468650817871  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.3909468650817871  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.39156293869018555  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.3968791961669922  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([302, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.3971519470214844  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.3971519470214844  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.39772796630859375  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.406402587890625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([307, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.4070000648498535  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.4070000648498535  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.40758562088012695  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.4208674430847168  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([249, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.42153215408325195  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.42153215408325195  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.42200708389282227  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.43578004837036133  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.43651342391967773  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.43651342391967773  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.43689870834350586  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.45076894760131836  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.45152807235717773  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.45152807235717773  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.4518427848815918  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.4653754234313965  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([151, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.46639347076416016  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.46639347076416016  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.46668148040771484  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.4810819625854492  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([129, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.4819302558898926  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.4819302558898926  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.4821763038635254  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.4962010383605957  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([110, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.49702978134155273  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.49702978134155273  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.4972395896911621  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5106673240661621  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([101, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.511533260345459  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.511533260345459  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.511725902557373  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5254034996032715  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([101, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5263752937316895  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5263752937316895  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5265679359436035  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5415940284729004  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5423169136047363  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5423169136047363  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.542452335357666  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5539631843566895  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([70, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5547704696655273  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5547704696655273  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5549039840698242  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5671873092651367  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([63, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5679683685302734  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5679683685302734  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5680885314941406  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5799846649169922  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5805158615112305  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5805158615112305  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5805940628051758  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5888833999633789  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5897054672241211  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5897054672241211  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.5898122787475586  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6018819808959961  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6023678779602051  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6023678779602051  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6024308204650879  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6099839210510254  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6106271743774414  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6106271743774414  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6107015609741211  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6201486587524414  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6206049919128418  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6206049919128418  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6206564903259277  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6275572776794434  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6283774375915527  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6283774375915527  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6284613609313965  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6402945518493652  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6408581733703613  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6408581733703613  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6409153938293457  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6493840217590332  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6497364044189453  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6497364044189453  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6497707366943359  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6550922393798828  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.655362606048584  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.655362606048584  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6553874015808105  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6594042778015137  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6598997116088867  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6598997116088867  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6599416732788086  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6670331954956055  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([179, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6713132858276367  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6713132858276367  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.6716547012329102  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.7317438125610352  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 179, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.7128429412841797  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.7132673263549805  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.7136917114257812  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.7132458686828613  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([2846, 40])
input nodes number: 6559
output nodes number: 2846
edges number: 23183
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.7133140563964844  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.7133145332336426  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.014621257781982422  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

pseudo mini batch 12 input nodes size: 16443
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.013154029846191406  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.013154029846191406  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.02099466323852539  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.021016597747802734  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.013840675354003906  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.014449119567871094  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.014449119567871094  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.014449119567871094  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([16443, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.014449119567871094  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

m.shape torch.Size([557, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.04135560989379883  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.04135560989379883  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.04188680648803711  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.046482086181640625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([594, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.0467829704284668  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.0467829704284668  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 594, 128]), torch.Size([1, 594, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.04734945297241211  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.05615425109863281  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 594, 128])
m.shape torch.Size([575, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.05669355392456055  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.05669355392456055  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.05724191665649414  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.06970834732055664  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([549, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.0704813003540039  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.0704813003540039  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.07100486755371094  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.08618831634521484  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([524, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.08717584609985352  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.08717584609985352  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.08767557144165039  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.10633707046508789  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 524, 128])
m.shape torch.Size([476, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.10744905471801758  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.10744905471801758  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 476, 128]), torch.Size([1, 476, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.10790300369262695  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.12742280960083008  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 476, 128])
m.shape torch.Size([447, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.12868785858154297  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.12868785858154297  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 447, 128]), torch.Size([1, 447, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.12911415100097656  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.15042877197265625  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 447, 128])
m.shape torch.Size([338, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.1515049934387207  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.1515049934387207  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 338, 128]), torch.Size([1, 338, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.15182733535766602  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.17020082473754883  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 338, 128])
m.shape torch.Size([334, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.17147302627563477  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.17147302627563477  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 334, 128]), torch.Size([1, 334, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.17179155349731445  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.19217729568481445  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 334, 128])
m.shape torch.Size([3441, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.20842599868774414  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.20842599868774414  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 3441, 128]), torch.Size([1, 3441, 128])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.21170759201049805  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.4447007179260254  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 3441, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.42070722579956055  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.4281792640686035  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.4356513023376465  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.42812061309814453  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

torch.Size([7835, 256])
first layer input nodes number: 16443
first layer output nodes number: 7835
edges number: 54391
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.4357757568359375  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.44324779510498047  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.44591665267944336  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.44591665267944336  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

m.shape torch.Size([345, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.47257518768310547  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.47257518768310547  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.4732332229614258  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.4786982536315918  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([305, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.4789557456970215  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.4789557456970215  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.4795374870300293  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.49017763137817383  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([253, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.4906163215637207  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.4906163215637207  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.49109888076782227  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5017151832580566  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([214, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5022969245910645  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5022969245910645  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5027050971984863  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5145421028137207  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([207, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5153331756591797  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5153331756591797  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5157279968261719  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5299415588378906  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([160, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5306668281555176  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5306668281555176  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5309720039367676  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5440945625305176  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([143, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5449042320251465  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5449042320251465  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5451769828796387  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.558814525604248  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([127, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.559654712677002  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.559654712677002  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5598969459533691  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5737042427062988  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5745091438293457  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5745091438293457  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5747132301330566  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5877747535705566  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([91, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5885477066040039  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5885477066040039  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.5887212753295898  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6010446548461914  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6016664505004883  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6016664505004883  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6017942428588867  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6117620468139648  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6125636100769043  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6125636100769043  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6127066612243652  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6248660087585449  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([64, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6255941390991211  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6255941390991211  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6257162094116211  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6369466781616211  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([59, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6376795768737793  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6376795768737793  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6377921104431152  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.648932933807373  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6495547294616699  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6495547294616699  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6496443748474121  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.659146785736084  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.659548282623291  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.659548282623291  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6596035957336426  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6658539772033691  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([50, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6666436195373535  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6666436195373535  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6667389869689941  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6781830787658691  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6787757873535156  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6787757873535156  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6788463592529297  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6878089904785156  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6884312629699707  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6884312629699707  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.688499927520752  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6977009773254395  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6984357833862305  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.6984357833862305  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.698512077331543  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.7092695236206055  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.7099180221557617  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.7099180221557617  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.7099828720092773  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.7195806503295898  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.7199501991271973  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.7199501991271973  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.7199864387512207  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.7256035804748535  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.7261605262756348  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.7261605262756348  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.7262101173400879  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.7342438697814941  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.7345423698425293  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.7345423698425293  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.7345690727233887  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.739081859588623  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([371, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.7479829788208008  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.7479829788208008  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.7486906051635742  GigaBytes
Max Memory Allocated: 0.8739781379699707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.8802275657653809  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 371, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.8565897941589355  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.857025146484375  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.8574604988098145  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.8570032119750977  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

torch.Size([2920, 40])
input nodes number: 7835
output nodes number: 2920
edges number: 27260
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.8570947647094727  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.8570952415466309  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.01560354232788086  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

pseudo mini batch 13 input nodes size: 15090
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.013851642608642578  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.013851642608642578  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.021047115325927734  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.021069049835205078  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.01320648193359375  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.013651847839355469  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.013651847839355469  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.013651847839355469  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

torch.Size([15090, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.013651847839355469  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

m.shape torch.Size([734, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.034085750579833984  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.034085750579833984  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 734, 128]), torch.Size([1, 734, 128])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.03478574752807617  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.04038572311401367  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 734, 128])
m.shape torch.Size([716, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.04071855545043945  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.04071855545043945  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 716, 128]), torch.Size([1, 716, 128])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.04140138626098633  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.05255460739135742  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 716, 128])
m.shape torch.Size([676, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.05318021774291992  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.05318021774291992  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 676, 128]), torch.Size([1, 676, 128])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.05382490158081055  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.0684046745300293  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 676, 128])
m.shape torch.Size([546, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.06912374496459961  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.06912374496459961  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.06964445114135742  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.08558034896850586  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([470, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.0864405632019043  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.0864405632019043  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 470, 128]), torch.Size([1, 470, 128])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.08688879013061523  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.10302495956420898  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 470, 128])
m.shape torch.Size([396, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.10393381118774414  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.10393381118774414  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 396, 128]), torch.Size([1, 396, 128])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.10431146621704102  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.12055063247680664  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 396, 128])
m.shape torch.Size([327, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.12145328521728516  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.12145328521728516  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.12176513671875  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.1373577117919922  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 327, 128])
m.shape torch.Size([305, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.1383652687072754  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.1383652687072754  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.1386561393737793  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.15523576736450195  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([234, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.15609455108642578  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.15609455108642578  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 234, 128]), torch.Size([1, 234, 128])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.15631771087646484  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.17059993743896484  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 234, 128])
m.shape torch.Size([2193, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.18094539642333984  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.18094539642333984  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 2193, 128]), torch.Size([1, 2193, 128])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.18303680419921875  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.3369112014770508  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 2193, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.32004880905151367  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.3263401985168457  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.33263158798217773  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.3262906074523926  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

torch.Size([6597, 256])
first layer input nodes number: 15090
first layer output nodes number: 6597
edges number: 39869
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.3327460289001465  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.3396944999694824  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.3411288261413574  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.3411288261413574  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

m.shape torch.Size([496, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.36141157150268555  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.36141157150268555  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 496, 256]), torch.Size([1, 496, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.36235761642456055  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.36992597579956055  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 496, 256])
m.shape torch.Size([404, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.37022972106933594  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.37022972106933594  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.3710002899169922  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.3834247589111328  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([359, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.38430118560791016  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.38430118560791016  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.38498592376708984  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.40005016326904297  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([250, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.4006690979003906  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.4006690979003906  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.40114593505859375  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.4149742126464844  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.4157066345214844  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.4157066345214844  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.4160919189453125  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.429962158203125  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.43070411682128906  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.43070411682128906  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.4310131072998047  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.44429969787597656  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.4449596405029297  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.4449596405029297  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.4451904296875  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.4567298889160156  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.45743751525878906  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.45743751525878906  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.4576416015625  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.46927452087402344  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.46999454498291016  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.46999454498291016  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.47017574310302734  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.48177242279052734  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.48250865936279297  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.48250865936279297  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.48267269134521484  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.49431896209716797  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.4948396682739258  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.4948396682739258  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.4949483871459961  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5034284591674805  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5040316581726074  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5040316581726074  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5041403770446777  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5133814811706543  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5139269828796387  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5139269828796387  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5140185356140137  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5224413871765137  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5229206085205078  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5229206085205078  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5229949951171875  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5303592681884766  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5309710502624512  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5309710502624512  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5310568809509277  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5401549339294434  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5406041145324707  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5406041145324707  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5406651496887207  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5475621223449707  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5480709075927734  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5480709075927734  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5481338500976562  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5556869506835938  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5560016632080078  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5560016632080078  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5560398101806641  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5608844757080078  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5612306594848633  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5612306594848633  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5612688064575195  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.566380500793457  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.566765308380127  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.566765308380127  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.566805362701416  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5724530220031738  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5728168487548828  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5728168487548828  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5728530883789062  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.578216552734375  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5784525871276855  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5784525871276855  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5784754753112793  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5820231437683105  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5822110176086426  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5822110176086426  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5822281837463379  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5850090980529785  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5852546691894531  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5852546691894531  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5852756500244141  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5888214111328125  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([177, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5930643081665039  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5930643081665039  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.5934019088745117  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.6528196334838867  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 177, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.6360335350036621  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.6364631652832031  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.6368927955627441  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.6364412307739258  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

torch.Size([2882, 40])
input nodes number: 6597
output nodes number: 2882
edges number: 19729
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.6365070343017578  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.636507511138916  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.014533519744873047  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

pseudo mini batch 14 input nodes size: 20612
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.013200759887695312  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.013200759887695312  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.023029327392578125  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.023050785064697266  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.015833377838134766  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.016408443450927734  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.016408443450927734  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.016408443450927734  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

torch.Size([20612, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.016408443450927734  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

m.shape torch.Size([765, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.045018672943115234  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.045018672943115234  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 765, 128]), torch.Size([1, 765, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.045748233795166016  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.05286121368408203  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 765, 128])
m.shape torch.Size([828, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.053286075592041016  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.053286075592041016  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 828, 128]), torch.Size([1, 828, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.05407571792602539  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.06592035293579102  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 828, 128])
m.shape torch.Size([702, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.06652975082397461  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.06652975082397461  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 702, 128]), torch.Size([1, 702, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.0671992301940918  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.08244180679321289  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 702, 128])
m.shape torch.Size([617, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.08328390121459961  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.08328390121459961  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 617, 128]), torch.Size([1, 617, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.08387231826782227  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.10168027877807617  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 617, 128])
m.shape torch.Size([557, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.10271406173706055  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.10271406173706055  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.10324525833129883  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.1230010986328125  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([460, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.12405157089233398  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.12405157089233398  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 460, 128]), torch.Size([1, 460, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.12449026107788086  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.14335393905639648  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 460, 128])
m.shape torch.Size([403, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.14447975158691406  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.14447975158691406  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 403, 128]), torch.Size([1, 403, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.14486408233642578  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.16408061981201172  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 403, 128])
m.shape torch.Size([360, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.16526174545288086  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.16526174545288086  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 360, 128]), torch.Size([1, 360, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.1656050682067871  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.18517446517944336  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 360, 128])
m.shape torch.Size([338, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.18645334243774414  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.18645334243774414  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 338, 128]), torch.Size([1, 338, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.18677568435668945  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.20740556716918945  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 338, 128])
m.shape torch.Size([3636, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.22458219528198242  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.22458219528198242  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 3636, 128]), torch.Size([1, 3636, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.22850942611694336  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.4779238700866699  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 3636, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.45220947265625  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.46047401428222656  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.4687385559082031  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.46040916442871094  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

torch.Size([8666, 256])
first layer input nodes number: 20612
first layer output nodes number: 8666
edges number: 57643
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.46889448165893555  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.4771590232849121  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.4793524742126465  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.4793524742126465  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

m.shape torch.Size([498, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.4985818862915039  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.4985818862915039  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 498, 256]), torch.Size([1, 498, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.49953174591064453  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5071306228637695  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 498, 256])
m.shape torch.Size([416, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5074553489685059  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5074553489685059  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5082488059997559  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5216383934020996  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([321, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5221676826477051  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5221676826477051  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5227799415588379  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5380215644836426  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([251, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5386805534362793  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5386805534362793  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5391592979431152  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5530428886413574  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5536832809448242  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5536832809448242  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5540323257446289  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5665979385375977  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5673003196716309  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5673003196716309  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5675902366638184  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5800566673278809  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5807461738586426  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5807461738586426  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5809826850891113  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5928082466125488  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([92, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5933976173400879  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5933976173400879  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5935730934143066  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6035752296447754  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6043615341186523  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6043615341186523  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6045541763305664  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6168832778930664  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6176137924194336  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6176137924194336  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6177778244018555  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6294240951538086  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6299872398376465  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6299872398376465  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.630103588104248  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6391787528991699  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6397666931152344  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6397666931152344  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6398735046386719  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6489524841308594  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6494741439819336  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6494741439819336  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.649561882019043  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6576337814331055  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.658088207244873  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.658088207244873  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6581587791442871  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6651453971862793  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6656002998352051  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6656002998352051  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6656651496887207  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.672539234161377  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6729068756103516  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6729068756103516  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6729564666748047  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6785602569580078  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6791400909423828  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6791400909423828  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6792106628417969  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6876792907714844  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6880249977111816  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6880249977111816  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6880669593811035  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6933960914611816  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6939048767089844  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6939048767089844  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6939601898193359  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7013721466064453  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7017097473144531  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7017097473144531  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7017459869384766  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7068557739257812  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7072615623474121  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7072615623474121  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7073016166687012  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7132296562194824  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.713442325592041  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.713442325592041  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.713463306427002  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7167153358459473  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7169923782348633  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7169923782348633  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7170171737670898  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.721034049987793  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7214140892028809  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7214140892028809  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7214465141296387  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.726926326751709  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([166, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7308988571166992  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7308988571166992  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7312154769897461  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7869405746459961  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 166, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7709188461303711  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.771338939666748  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.771759033203125  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7713174819946289  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

torch.Size([2819, 40])
input nodes number: 8666
output nodes number: 2819
edges number: 19378
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7713942527770996  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7713947296142578  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.017499923706054688  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

pseudo mini batch 15 input nodes size: 14750
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.015823841094970703  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.015823841094970703  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.022857189178466797  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.022878646850585938  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.013028621673583984  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.013593196868896484  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.013593196868896484  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.013593196868896484  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

torch.Size([14750, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.013593196868896484  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

m.shape torch.Size([439, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.0398564338684082  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.0398564338684082  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 439, 128]), torch.Size([1, 439, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.04027509689331055  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.0436244010925293  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 439, 128])
m.shape torch.Size([524, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.043914794921875  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.043914794921875  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.044414520263671875  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.052552223205566406  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 524, 128])
m.shape torch.Size([521, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.05304765701293945  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.05304765701293945  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 521, 128]), torch.Size([1, 521, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.05354452133178711  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.06447553634643555  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 521, 128])
m.shape torch.Size([451, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.06508731842041016  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.06508731842041016  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.06551742553710938  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.07799053192138672  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([451, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.07885074615478516  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.07885074615478516  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.07928085327148438  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.09476470947265625  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([370, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.09560823440551758  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.09560823440551758  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 370, 128]), torch.Size([1, 370, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.09596109390258789  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.11113405227661133  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 370, 128])
m.shape torch.Size([376, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.1122126579284668  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.1122126579284668  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 376, 128]), torch.Size([1, 376, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.11257123947143555  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.13050031661987305  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 376, 128])
m.shape torch.Size([349, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.13166046142578125  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.13166046142578125  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 349, 128]), torch.Size([1, 349, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.13199329376220703  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.15096473693847656  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 349, 128])
m.shape torch.Size([289, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.15203857421875  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.15203857421875  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 289, 128]), torch.Size([1, 289, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.1523141860961914  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.1699533462524414  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 289, 128])
m.shape torch.Size([3437, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.1862044334411621  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.1862044334411621  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 3437, 128]), torch.Size([1, 3437, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.18974542617797852  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.4224677085876465  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 3437, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.39873266220092773  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.4056057929992676  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.4124789237976074  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.4055519104003906  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

torch.Size([7207, 256])
first layer input nodes number: 14750
first layer output nodes number: 7207
edges number: 51724
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.41259098052978516  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.419464111328125  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.42118263244628906  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.42118263244628906  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

m.shape torch.Size([320, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.44523143768310547  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.44523143768310547  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.44584178924560547  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.4511756896972656  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([329, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.45150327682495117  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.45150327682495117  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.4521307945251465  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.46303415298461914  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([276, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.4635162353515625  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.4635162353515625  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.46404266357421875  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.4767308235168457  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([219, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.4773097038269043  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.4773097038269043  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.47772741317749023  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.4898409843444824  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.49051666259765625  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.49051666259765625  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.49086761474609375  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5035018920898438  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([156, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5042262077331543  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5042262077331543  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.504523754119873  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5173182487487793  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([164, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.518272876739502  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.518272876739502  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5185856819152832  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5342259407043457  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([136, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.535609245300293  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.535609245300293  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5358686447143555  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.550654411315918  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.551398754119873  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.551398754119873  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5515913963317871  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5639204978942871  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([95, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5647373199462891  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5647373199462891  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5649185180664062  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5777835845947266  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([108, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5788350105285645  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5788350105285645  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5790410041809082  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5951085090637207  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5957555770874023  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5957555770874023  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5958795547485352  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6064176559448242  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6071181297302246  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6071181297302246  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6072344779968262  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6179385185241699  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([60, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6186881065368652  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6186881065368652  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.618802547454834  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6301321983337402  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([57, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.630897045135498  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.630897045135498  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6310057640075684  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6425299644470215  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6431984901428223  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6431984901428223  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6432881355285645  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6534180641174316  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6540107727050781  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6540107727050781  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6540851593017578  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6630115509033203  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6634764671325684  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6634764671325684  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6635317802429199  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6705565452575684  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6708579063415527  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6708579063415527  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6708922386169434  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6754927635192871  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6760139465332031  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6760139465332031  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6760673522949219  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6835975646972656  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6841363906860352  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6841363906860352  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6841897964477539  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6920938491821289  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6924481391906738  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6924481391906738  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6924824714660645  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6978039741516113  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6981849670410156  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6981849670410156  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6982192993164062  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7037811279296875  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7042717933654785  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7042717933654785  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7043137550354004  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7114052772521973  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([239, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7178492546081543  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7178492546081543  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7183051109313965  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7985358238220215  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 239, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7774853706359863  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7779054641723633  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7783255577087402  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7778840065002441  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

torch.Size([2817, 40])
input nodes number: 7207
output nodes number: 2817
edges number: 23829
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7779593467712402  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.7779598236083984  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.01464080810546875  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

pseudo mini batch 16 input nodes size: 45911
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.013028621673583984  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.013028621673583984  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.034920692443847656  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.034941673278808594  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.02788686752319336  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.02895212173461914  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.02895212173461914  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.02895212173461914  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

torch.Size([45911, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.02895212173461914  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

m.shape torch.Size([808, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.08814144134521484  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.08814144134521484  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.0889120101928711  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.09508085250854492  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([809, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.09546709060668945  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.09546709060668945  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 809, 128]), torch.Size([1, 809, 128])
----------------------------------------3
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.09623861312866211  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.10781145095825195  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 809, 128])
m.shape torch.Size([778, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.10868597030639648  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.10868597030639648  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 778, 128]), torch.Size([1, 778, 128])
----------------------------------------3
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.10942792892456055  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.1260676383972168  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 778, 128])
m.shape torch.Size([691, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.1270279884338379  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.1270279884338379  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 691, 128]), torch.Size([1, 691, 128])
----------------------------------------3
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.1276869773864746  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.14679765701293945  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 691, 128])
m.shape torch.Size([656, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.14803218841552734  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.14803218841552734  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.14865779876708984  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.17208003997802734  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([572, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.1737813949584961  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.1737813949584961  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.17432689666748047  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.1977834701538086  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([517, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.19923639297485352  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.19923639297485352  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.19972944259643555  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.22531890869140625  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([512, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.22702550888061523  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.22702550888061523  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.22751379013061523  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.25534582138061523  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([494, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.25722169876098633  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.25722169876098633  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.257692813873291  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.287844181060791  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([9384, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.4217529296875 GB
    Memory Allocated: 0.33253049850463867  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4217529296875 GB
    Memory Allocated: 0.33253049850463867  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

 h.shape torch.Size([1, 9384, 128]), torch.Size([1, 9384, 128])
----------------------------------------3
 Nvidia-smi: 2.4217529296875 GB
    Memory Allocated: 0.3414797782897949  GigaBytes
Max Memory Allocated: 0.8890728950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.9788622856140137  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

rst.shape  torch.Size([1, 9384, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.9235258102416992  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.9380416870117188  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.9525575637817383  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.9379281997680664  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

torch.Size([15221, 256])
first layer input nodes number: 45911
first layer output nodes number: 15221
edges number: 120237
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.9529018402099609  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.9674177169799805  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.9710469245910645  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.9710469245910645  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

m.shape torch.Size([495, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.993403434753418  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.993403434753418  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

 h.shape torch.Size([1, 495, 256]), torch.Size([1, 495, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.9943475723266602  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0019006729125977  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

rst.shape  torch.Size([1, 495, 256])
m.shape torch.Size([372, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0021438598632812  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0021438598632812  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0028533935546875  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0146517753601074  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([282, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0151104927062988  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0151104927062988  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.015648365020752  GigaBytes
Max Memory Allocated: 1.0237841606140137  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0311956405639648  GigaBytes
Max Memory Allocated: 1.0320024490356445  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([233, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.031822681427002  GigaBytes
Max Memory Allocated: 1.0320024490356445  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.031822681427002  GigaBytes
Max Memory Allocated: 1.0320024490356445  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0322670936584473  GigaBytes
Max Memory Allocated: 1.0322670936584473  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0451550483703613  GigaBytes
Max Memory Allocated: 1.046043872833252  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([162, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0457115173339844  GigaBytes
Max Memory Allocated: 1.046043872833252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0457115173339844  GigaBytes
Max Memory Allocated: 1.046043872833252  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0460205078125  GigaBytes
Max Memory Allocated: 1.046043872833252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0571441650390625  GigaBytes
Max Memory Allocated: 1.0579166412353516  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([134, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.057762622833252  GigaBytes
Max Memory Allocated: 1.0579166412353516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.057762622833252  GigaBytes
Max Memory Allocated: 1.0579166412353516  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0580182075500488  GigaBytes
Max Memory Allocated: 1.0580182075500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0690083503723145  GigaBytes
Max Memory Allocated: 1.069775104522705  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([105, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.069587230682373  GigaBytes
Max Memory Allocated: 1.069775104522705  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.069587230682373  GigaBytes
Max Memory Allocated: 1.069775104522705  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0697875022888184  GigaBytes
Max Memory Allocated: 1.0697875022888184  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.079801082611084  GigaBytes
Max Memory Allocated: 1.0805020332336426  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([90, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0803933143615723  GigaBytes
Max Memory Allocated: 1.0805020332336426  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0803933143615723  GigaBytes
Max Memory Allocated: 1.0805020332336426  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0805649757385254  GigaBytes
Max Memory Allocated: 1.0805649757385254  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0903496742248535  GigaBytes
Max Memory Allocated: 1.091036319732666  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0909476280212402  GigaBytes
Max Memory Allocated: 1.091036319732666  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0909476280212402  GigaBytes
Max Memory Allocated: 1.091036319732666  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.0910983085632324  GigaBytes
Max Memory Allocated: 1.0910983085632324  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1007418632507324  GigaBytes
Max Memory Allocated: 1.1014199256896973  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1013298034667969  GigaBytes
Max Memory Allocated: 1.1014199256896973  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1013298034667969  GigaBytes
Max Memory Allocated: 1.1014199256896973  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.101461410522461  GigaBytes
Max Memory Allocated: 1.101461410522461  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1108055114746094  GigaBytes
Max Memory Allocated: 1.1114635467529297  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1113953590393066  GigaBytes
Max Memory Allocated: 1.1114635467529297  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1113953590393066  GigaBytes
Max Memory Allocated: 1.1114635467529297  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.111513614654541  GigaBytes
Max Memory Allocated: 1.111513614654541  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1207375526428223  GigaBytes
Max Memory Allocated: 1.1213879585266113  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([38, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.121117115020752  GigaBytes
Max Memory Allocated: 1.1213879585266113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.121117115020752  GigaBytes
Max Memory Allocated: 1.1213879585266113  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1211895942687988  GigaBytes
Max Memory Allocated: 1.1213879585266113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1273503303527832  GigaBytes
Max Memory Allocated: 1.1277852058410645  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1276764869689941  GigaBytes
Max Memory Allocated: 1.1277852058410645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1276764869689941  GigaBytes
Max Memory Allocated: 1.1277852058410645  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1277318000793457  GigaBytes
Max Memory Allocated: 1.1277852058410645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1328206062316895  GigaBytes
Max Memory Allocated: 1.1331801414489746  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([26, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1331429481506348  GigaBytes
Max Memory Allocated: 1.1331801414489746  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1331429481506348  GigaBytes
Max Memory Allocated: 1.1331801414489746  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.133192539215088  GigaBytes
Max Memory Allocated: 1.133192539215088  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1381020545959473  GigaBytes
Max Memory Allocated: 1.1384491920471191  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([27, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1384668350219727  GigaBytes
Max Memory Allocated: 1.1384687423706055  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1384668350219727  GigaBytes
Max Memory Allocated: 1.1384687423706055  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1385183334350586  GigaBytes
Max Memory Allocated: 1.1385183334350586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.143977165222168  GigaBytes
Max Memory Allocated: 1.1443634033203125  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.144336223602295  GigaBytes
Max Memory Allocated: 1.1443634033203125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.144336223602295  GigaBytes
Max Memory Allocated: 1.1443634033203125  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1443839073181152  GigaBytes
Max Memory Allocated: 1.1443839073181152  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1497721672058105  GigaBytes
Max Memory Allocated: 1.150153636932373  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1501245498657227  GigaBytes
Max Memory Allocated: 1.150153636932373  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1501245498657227  GigaBytes
Max Memory Allocated: 1.150153636932373  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1501684188842773  GigaBytes
Max Memory Allocated: 1.1501684188842773  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1554327011108398  GigaBytes
Max Memory Allocated: 1.1558055877685547  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.155808925628662  GigaBytes
Max Memory Allocated: 1.155810832977295  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.155808925628662  GigaBytes
Max Memory Allocated: 1.155810832977295  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1558527946472168  GigaBytes
Max Memory Allocated: 1.1558527946472168  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.161424160003662  GigaBytes
Max Memory Allocated: 1.1618189811706543  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.16196870803833  GigaBytes
Max Memory Allocated: 1.161971092224121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.16196870803833  GigaBytes
Max Memory Allocated: 1.161971092224121  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1620278358459473  GigaBytes
Max Memory Allocated: 1.1620278358459473  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1699509620666504  GigaBytes
Max Memory Allocated: 1.1705126762390137  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1704792976379395  GigaBytes
Max Memory Allocated: 1.1705126762390137  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1704792976379395  GigaBytes
Max Memory Allocated: 1.1705126762390137  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.170534610748291  GigaBytes
Max Memory Allocated: 1.170534610748291  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1783337593078613  GigaBytes
Max Memory Allocated: 1.178886890411377  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1788110733032227  GigaBytes
Max Memory Allocated: 1.178886890411377  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1788110733032227  GigaBytes
Max Memory Allocated: 1.178886890411377  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.178858757019043  GigaBytes
Max Memory Allocated: 1.178886890411377  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1859159469604492  GigaBytes
Max Memory Allocated: 1.1864166259765625  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1863574981689453  GigaBytes
Max Memory Allocated: 1.1864166259765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1863574981689453  GigaBytes
Max Memory Allocated: 1.1864166259765625  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1863994598388672  GigaBytes
Max Memory Allocated: 1.1864166259765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1929035186767578  GigaBytes
Max Memory Allocated: 1.1933650970458984  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.193148136138916  GigaBytes
Max Memory Allocated: 1.1933650970458984  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.193148136138916  GigaBytes
Max Memory Allocated: 1.1933650970458984  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1931710243225098  GigaBytes
Max Memory Allocated: 1.1933650970458984  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1968789100646973  GigaBytes
Max Memory Allocated: 1.1971421241760254  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1973061561584473  GigaBytes
Max Memory Allocated: 1.19730806350708  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1973061561584473  GigaBytes
Max Memory Allocated: 1.19730806350708  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.1973423957824707  GigaBytes
Max Memory Allocated: 1.1973423957824707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.2034668922424316  GigaBytes
Max Memory Allocated: 1.203901767730713  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([350, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.2118587493896484  GigaBytes
Max Memory Allocated: 1.2118916511535645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.2118587493896484  GigaBytes
Max Memory Allocated: 1.2118916511535645  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.2125263214111328  GigaBytes
Max Memory Allocated: 1.2125263214111328  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7010498046875 GB
    Memory Allocated: 1.336954116821289  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 350, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.7010498046875 GB
    Memory Allocated: 1.3175950050354004  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.7010498046875 GB
    Memory Allocated: 1.318006992340088  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.7010498046875 GB
    Memory Allocated: 1.3184189796447754  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.7010498046875 GB
    Memory Allocated: 1.317986011505127  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

torch.Size([2762, 40])
input nodes number: 15221
output nodes number: 2762
edges number: 22636
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7010498046875 GB
    Memory Allocated: 1.3181123733520508  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.7010498046875 GB
    Memory Allocated: 1.318112850189209  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.7244873046875 GB
    Memory Allocated: 0.030892372131347656  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

pseudo mini batch 17 input nodes size: 42514
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.7244873046875 GB
    Memory Allocated: 0.027878761291503906  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.7244873046875 GB
    Memory Allocated: 0.027878761291503906  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.7244873046875 GB
    Memory Allocated: 0.04815101623535156  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.7244873046875 GB
    Memory Allocated: 0.0481719970703125  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.7244873046875 GB
    Memory Allocated: 0.02625894546508789  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.7244873046875 GB
    Memory Allocated: 0.02758932113647461  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7244873046875 GB
    Memory Allocated: 0.02758932113647461  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.7244873046875 GB
    Memory Allocated: 0.02758932113647461  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

torch.Size([42514, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.7244873046875 GB
    Memory Allocated: 0.02758932113647461  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

m.shape torch.Size([527, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.09867429733276367  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.09867429733276367  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 527, 128]), torch.Size([1, 527, 128])
----------------------------------------3
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.09917688369750977  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.10339021682739258  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 527, 128])
m.shape torch.Size([573, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.10368537902832031  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.10368537902832031  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 573, 128]), torch.Size([1, 573, 128])
----------------------------------------3
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.1042318344116211  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.11249065399169922  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 573, 128])
m.shape torch.Size([511, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.11294841766357422  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.11294841766357422  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.11343574523925781  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.12415695190429688  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([532, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.12492799758911133  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.12492799758911133  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.12543535232543945  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.14023828506469727  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([579, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.14136505126953125  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.14136505126953125  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.14191722869873047  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.16238737106323242  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([497, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.16353321075439453  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.16353321075439453  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 497, 128]), torch.Size([1, 497, 128])
----------------------------------------3
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.16400718688964844  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.1843881607055664  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 497, 128])
m.shape torch.Size([512, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.18586015701293945  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.18586015701293945  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.18634843826293945  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.21076250076293945  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([522, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.2125096321105957  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.2125096321105957  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.21300745010375977  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.24248456954956055  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([547, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.2445831298828125  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.2445831298828125  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.24510478973388672  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.27902936935424805  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([12105, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.33736228942871094  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.33736228942871094  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 12105, 128]), torch.Size([1, 12105, 128])
----------------------------------------3
 Nvidia-smi: 2.7947998046875 GB
    Memory Allocated: 0.3489065170288086  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.1763129234313965  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 12105, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.1091647148132324  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.12528657913208  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.1414084434509277  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.1251602172851562  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

torch.Size([16905, 256])
first layer input nodes number: 42514
first layer output nodes number: 16905
edges number: 144944
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.1417274475097656  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.1578493118286133  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.162104606628418  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.162104606628418  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

m.shape torch.Size([305, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.1946487426757812  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.1946487426757812  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.195230484008789  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.1999602317810059  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([266, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.200181007385254  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.200181007385254  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.200688362121582  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2087430953979492  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([190, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2090373039245605  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2090373039245605  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.209399700164795  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2173724174499512  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([157, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2177948951721191  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2177948951721191  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2180943489074707  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.226778507232666  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([144, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2273211479187012  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2273211479187012  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2275958061218262  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2374835014343262  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([105, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2379517555236816  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2379517555236816  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.238152027130127  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2467637062072754  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([83, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2472224235534668  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2472224235534668  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2473807334899902  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.255296230316162  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([79, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2558245658874512  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2558245658874512  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2559752464294434  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.264564037322998  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2652587890625  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2652587890625  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2654285430908203  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2762928009033203  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2768807411193848  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2768807411193848  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2770142555236816  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2864937782287598  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2870721817016602  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2870721817016602  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2871885299682617  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2962636947631836  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2968287467956543  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2968287467956543  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.2969317436218262  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3056864738464355  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3062100410461426  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3062100410461426  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.306297779083252  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3143696784973145  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.314918041229248  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.314918041229248  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3150019645690918  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.323310375213623  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3238310813903809  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3238310813903809  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3239054679870605  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3317904472351074  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.332291603088379  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.332291603088379  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3323583602905273  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3399019241333008  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3404078483581543  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3404078483581543  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.340470790863037  GigaBytes
Max Memory Allocated: 1.3452987670898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3480238914489746  GigaBytes
Max Memory Allocated: 1.3485589027404785  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3485808372497559  GigaBytes
Max Memory Allocated: 1.3485832214355469  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3485808372497559  GigaBytes
Max Memory Allocated: 1.3485832214355469  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3486456871032715  GigaBytes
Max Memory Allocated: 1.3486456871032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3568816184997559  GigaBytes
Max Memory Allocated: 1.3574652671813965  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([44, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3576531410217285  GigaBytes
Max Memory Allocated: 1.357656478881836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3576531410217285  GigaBytes
Max Memory Allocated: 1.357656478881836  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3577370643615723  GigaBytes
Max Memory Allocated: 1.3577370643615723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3689827919006348  GigaBytes
Max Memory Allocated: 1.3697800636291504  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3694791793823242  GigaBytes
Max Memory Allocated: 1.3697800636291504  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3694791793823242  GigaBytes
Max Memory Allocated: 1.3697800636291504  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.369532585144043  GigaBytes
Max Memory Allocated: 1.3697800636291504  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3770627975463867  GigaBytes
Max Memory Allocated: 1.3775968551635742  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3775410652160645  GigaBytes
Max Memory Allocated: 1.3775968551635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3775410652160645  GigaBytes
Max Memory Allocated: 1.3775968551635742  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3775887489318848  GigaBytes
Max Memory Allocated: 1.3775968551635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.384645938873291  GigaBytes
Max Memory Allocated: 1.3851466178894043  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.384981632232666  GigaBytes
Max Memory Allocated: 1.3851466178894043  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.384981632232666  GigaBytes
Max Memory Allocated: 1.3851466178894043  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3850140571594238  GigaBytes
Max Memory Allocated: 1.3851466178894043  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3900399208068848  GigaBytes
Max Memory Allocated: 1.3903965950012207  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3905324935913086  GigaBytes
Max Memory Allocated: 1.3905348777770996  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3905324935913086  GigaBytes
Max Memory Allocated: 1.3905348777770996  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3905763626098633  GigaBytes
Max Memory Allocated: 1.3905763626098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3976831436157227  GigaBytes
Max Memory Allocated: 1.3981876373291016  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3981690406799316  GigaBytes
Max Memory Allocated: 1.3981876373291016  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3981690406799316  GigaBytes
Max Memory Allocated: 1.3981876373291016  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.3982110023498535  GigaBytes
Max Memory Allocated: 1.3982110023498535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.4053025245666504  GigaBytes
Max Memory Allocated: 1.405806064605713  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([765, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.4236631393432617  GigaBytes
Max Memory Allocated: 1.4237346649169922  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.4236631393432617  GigaBytes
Max Memory Allocated: 1.4237346649169922  GigaBytes

 h.shape torch.Size([1, 765, 256]), torch.Size([1, 765, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.4251222610473633  GigaBytes
Max Memory Allocated: 1.4251222610473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.6838922500610352  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 765, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.653994083404541  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.654405117034912  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.6548161506652832  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.6543841361999512  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

torch.Size([2758, 40])
input nodes number: 16905
output nodes number: 2758
edges number: 33427
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.6545305252075195  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 1.6545310020446777  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 0.02989673614501953  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

pseudo mini batch 18 input nodes size: 50150
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 0.026257991790771484  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 0.026257991790771484  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 0.0501713752746582  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 0.05019235610961914  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 0.029899120330810547  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 0.03127336502075195  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 0.03127336502075195  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 0.03127336502075195  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

torch.Size([50150, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 0.03127336502075195  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

m.shape torch.Size([634, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.10763692855834961  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.10763692855834961  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 634, 128]), torch.Size([1, 634, 128])
----------------------------------------3
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.10824155807495117  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.11334657669067383  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 634, 128])
m.shape torch.Size([714, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.11372518539428711  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.11372518539428711  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 714, 128]), torch.Size([1, 714, 128])
----------------------------------------3
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.11440610885620117  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.12461996078491211  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 714, 128])
m.shape torch.Size([728, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.1253209114074707  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.1253209114074707  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 728, 128]), torch.Size([1, 728, 128])
----------------------------------------3
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.12601518630981445  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.14194154739379883  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 728, 128])
m.shape torch.Size([599, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.14273691177368164  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.14273691177368164  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.14330816268920898  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.16015291213989258  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([594, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.1612834930419922  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.1612834930419922  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 594, 128]), torch.Size([1, 594, 128])
----------------------------------------3
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.1618499755859375  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.18224334716796875  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 594, 128])
m.shape torch.Size([609, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.1837024688720703  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.1837024688720703  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 609, 128]), torch.Size([1, 609, 128])
----------------------------------------3
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.18428325653076172  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.20993709564208984  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 609, 128])
m.shape torch.Size([577, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.21157264709472656  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.21157264709472656  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.21212291717529297  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.24070119857788086  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([564, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.24257755279541016  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.24257755279541016  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.24311542510986328  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.2738676071166992  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([541, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.27592039108276367  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.27592039108276367  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 541, 128]), torch.Size([1, 541, 128])
----------------------------------------3
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.27643632888793945  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.31063079833984375  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 541, 128])
m.shape torch.Size([12779, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.3713078498840332  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.3713078498840332  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 12779, 128]), torch.Size([1, 12779, 128])
----------------------------------------3
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 0.38349485397338867  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.248772144317627  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 12779, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1768555641174316  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1943449974060059  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.21183443069458  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1942081451416016  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

torch.Size([18339, 256])
first layer input nodes number: 50150
first layer output nodes number: 18339
edges number: 154476
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2122101783752441  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2296996116638184  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2343926429748535  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2343926429748535  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

m.shape torch.Size([352, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2635912895202637  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2635912895202637  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2642626762390137  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.271730899810791  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([320, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.272010326385498  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.272010326385498  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.272620677947998  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2827472686767578  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([244, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2831459045410156  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2831459045410156  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2836112976074219  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2938499450683594  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([160, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2942323684692383  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2942323684692383  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2945375442504883  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3033876419067383  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([142, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3039178848266602  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3039178848266602  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3041887283325195  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.313939094543457  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([122, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3145074844360352  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3145074844360352  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3147401809692383  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3247461318969727  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([80, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3251681327819824  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3251681327819824  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3253207206726074  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3329501152038574  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([80, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.333488941192627  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.333488941192627  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.333641529083252  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.342339038848877  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([80, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3429551124572754  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3429551124572754  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3431077003479004  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3528733253479004  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3534603118896484  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3534603118896484  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3535919189453125  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.362936019897461  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3634943962097168  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3634943962097168  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3636069297790527  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3723845481872559  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3729972839355469  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3729972839355469  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.37310791015625  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3825111389160156  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3829808235168457  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3829808235168457  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3830609321594238  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3904309272766113  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3910102844238281  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3910102844238281  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3910980224609375  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3997840881347656  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4002737998962402  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4002737998962402  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4003443717956543  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.407824993133545  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4085125923156738  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4085125923156738  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.408602237701416  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4187321662902832  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4192266464233398  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4192266464233398  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4192895889282227  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4268426895141602  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4274344444274902  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4274344444274902  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4275031089782715  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4362235069274902  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4367008209228516  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4367008209228516  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4367542266845703  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4439105987548828  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4445185661315918  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4445185661315918  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4445815086364746  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4534564018249512  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4539904594421387  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4539904594421387  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4540438652038574  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4619479179382324  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4622597694396973  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4622597694396973  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4622902870178223  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4670205116271973  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4675803184509277  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4675803184509277  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4676299095153809  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.475663661956787  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4761466979980469  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4761466979980469  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4761886596679688  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4832801818847656  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([607, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4978446960449219  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4978446960449219  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

 h.shape torch.Size([1, 607, 256]), torch.Size([1, 607, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.499002456665039  GigaBytes
Max Memory Allocated: 1.7021312713623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.7083725929260254  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 607, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6825318336486816  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6829442977905273  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.683356761932373  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6829233169555664  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

torch.Size([2767, 40])
input nodes number: 18339
output nodes number: 2767
edges number: 29900
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6830825805664062  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6830830574035645  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.03368854522705078  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

pseudo mini batch 19 input nodes size: 49829
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.029900550842285156  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.029900550842285156  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.05366086959838867  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.05368232727050781  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.029747962951660156  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.031200408935546875  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.031200408935546875  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.031200408935546875  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

torch.Size([49829, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.031200408935546875  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

m.shape torch.Size([574, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.11152935028076172  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.11152935028076172  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.1120767593383789  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.11699151992797852  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([675, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.11736154556274414  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.11736154556274414  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 675, 128]), torch.Size([1, 675, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.11800527572631836  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.12766122817993164  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 675, 128])
m.shape torch.Size([625, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.1282334327697754  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.1282334327697754  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 625, 128]), torch.Size([1, 625, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.1288294792175293  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.14212369918823242  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 625, 128])
m.shape torch.Size([570, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.1429128646850586  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.1429128646850586  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.14345645904541016  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.15922069549560547  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([586, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.16034603118896484  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.16034603118896484  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.1609048843383789  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.1815185546875  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([616, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.18300151824951172  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.18300151824951172  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.18358898162841797  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.2093954086303711  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([558, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.21096420288085938  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.21096420288085938  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.21149635314941406  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.23872089385986328  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([563, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.2406024932861328  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.2406024932861328  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 563, 128]), torch.Size([1, 563, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.24113941192626953  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.2722911834716797  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 563, 128])
m.shape torch.Size([596, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.2745804786682129  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.2745804786682129  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 596, 128]), torch.Size([1, 596, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.275148868560791  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.3119683265686035  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 596, 128])
m.shape torch.Size([13649, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.376767635345459  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.376767635345459  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 13649, 128]), torch.Size([1, 13649, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.3897843360900879  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3140382766723633  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 13649, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2381105422973633  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.256241798400879  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2743730545043945  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2560997009277344  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

torch.Size([19012, 256])
first layer input nodes number: 49829
first layer output nodes number: 19012
edges number: 162969
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2747464179992676  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2928776741027832  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2981066703796387  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2981066703796387  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

m.shape torch.Size([314, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.329136848449707  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.329136848449707  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3297357559204102  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.334864616394043  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([313, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3351669311523438  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3351669311523438  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.335763931274414  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3454170227050781  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([214, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.345736026763916  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.345736026763916  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.346144199371338  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3551239967346191  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([171, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3555774688720703  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3555774688720703  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3559036254882812  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3653621673583984  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([156, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3659491539001465  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3659491539001465  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3662467002868652  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3769583702087402  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([124, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3775248527526855  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3775248527526855  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3777613639831543  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3879313468933105  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([100, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3884859085083008  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3884859085083008  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.388676643371582  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3982133865356445  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([91, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.398818016052246  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.398818016052246  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.398991584777832  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4088850021362305  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([68, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4093866348266602  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4093866348266602  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4095163345336914  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4178171157836914  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.418482780456543  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.418482780456543  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4186277389526367  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.428919792175293  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4295454025268555  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4295454025268555  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.429671287536621  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4394903182983398  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4401311874389648  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4401311874389648  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4402475357055664  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4501371383666992  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([63, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4508662223815918  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4508662223815918  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.450986385345459  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4620413780212402  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4626274108886719  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4626274108886719  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4627189636230469  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4717826843261719  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([57, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4725589752197266  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4725589752197266  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4726676940917969  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.48419189453125  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([58, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.485029697418213  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.485029697418213  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.485140323638916  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4976410865783691  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4981417655944824  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4981417655944824  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.498206615447998  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.505988597869873  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([60, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5072746276855469  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5072746276855469  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5073890686035156  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5219230651855469  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5223045349121094  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5223045349121094  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5223503112792969  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5284843444824219  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.529057502746582  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.529057502746582  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5291166305541992  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5374536514282227  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.538130760192871  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.538130760192871  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5381975173950195  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5480775833129883  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5485730171203613  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5485730171203613  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5486207008361816  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.55601167678833  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5564966201782227  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5564966201782227  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5565404891967773  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5636472702026367  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5642714500427246  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5642714500427246  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5643248558044434  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.573350429534912  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([612, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.588029384613037  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.588029384613037  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

 h.shape torch.Size([1, 612, 256]), torch.Size([1, 612, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5891966819763184  GigaBytes
Max Memory Allocated: 1.7228446006774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.8018221855163574  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 612, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.7735214233398438  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.773946762084961  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.7743721008300781  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.7739253044128418  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

torch.Size([2852, 40])
input nodes number: 19012
output nodes number: 2852
edges number: 31842
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.774101734161377  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.7741022109985352  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.033733367919921875  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

pseudo mini batch 20 input nodes size: 40965
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02976083755493164  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02976083755493164  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.049294471740722656  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.049315452575683594  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.025533676147460938  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02683258056640625  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02683258056640625  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02683258056640625  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

torch.Size([40965, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02683258056640625  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

m.shape torch.Size([558, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09653711318969727  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09653711318969727  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09706926345825195  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10175848007202148  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([579, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10204458236694336  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10204458236694336  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10259675979614258  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1115102767944336  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([581, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11206531524658203  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11206531524658203  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11261940002441406  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1251983642578125  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([525, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12592267990112305  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12592267990112305  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12642335891723633  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14149045944213867  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([486, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14239883422851562  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14239883422851562  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 486, 128]), torch.Size([1, 486, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14286231994628906  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1595478057861328  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 486, 128])
m.shape torch.Size([456, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.16062068939208984  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.16062068939208984  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1610555648803711  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17975521087646484  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([445, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18102312088012695  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18102312088012695  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18144750595092773  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2026667594909668  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([435, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20411396026611328  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20411396026611328  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20452880859375  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22817516326904297  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([404, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22970151901245117  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22970151901245117  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 404, 128]), torch.Size([1, 404, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2300868034362793  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2547450065612793  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 404, 128])
m.shape torch.Size([12113, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.31314611434936523  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.31314611434936523  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 12113, 128]), torch.Size([1, 12113, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.32469797134399414  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1518893241882324  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 12113, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0860238075256348  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1018376350402832  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1176514625549316  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1017136573791504  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

torch.Size([16582, 256])
first layer input nodes number: 40965
first layer output nodes number: 16582
edges number: 142086
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1179590225219727  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.133772850036621  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1377263069152832  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1377263069152832  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

m.shape torch.Size([320, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1689906120300293  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1689906120300293  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1696009635925293  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1747217178344727  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([287, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1749682426452637  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1749682426452637  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1755156517028809  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1837682723999023  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([225, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1841435432434082  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1841435432434082  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.184572696685791  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.194014072418213  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([172, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1944608688354492  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1944608688354492  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.194788932800293  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2043027877807617  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([143, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2048263549804688  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2048263549804688  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.205099105834961  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2149181365966797  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([109, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2154107093811035  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2154107093811035  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.21561861038208  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2245583534240723  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([100, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2251272201538086  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2251272201538086  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2253179550170898  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2348546981811523  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([70, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.235297679901123  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.235297679901123  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.23543119430542  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2430415153503418  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([74, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2436151504516602  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2436151504516602  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2437562942504883  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2527894973754883  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([63, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2533245086669922  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2533245086669922  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2534446716308594  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2619762420654297  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2625188827514648  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2625188827514648  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2626276016235352  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2711076736450195  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2716302871704102  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2716302871704102  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2717256546020508  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.279831886291504  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2802715301513672  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2802715301513672  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2803459167480469  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2871894836425781  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([33, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2875967025756836  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2875967025756836  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2876596450805664  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2938909530639648  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2942924499511719  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2942924499511719  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2943496704101562  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3004150390625  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3009557723999023  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3009557723999023  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3010263442993164  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3090009689331055  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.309603214263916  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.309603214263916  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3096776008605957  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3186039924621582  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3190512657165527  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3190512657165527  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3191046714782715  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3258872032165527  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.326317310333252  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.326317310333252  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3263649940490723  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3327546119689941  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.333326816558838  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.333326816558838  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.333385944366455  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3417229652404785  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3422183990478516  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3422183990478516  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3422679901123047  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3496074676513672  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3500690460205078  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3500690460205078  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3501129150390625  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.356912612915039  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.357532024383545  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.357532024383545  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3575873374938965  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3665480613708496  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3669819831848145  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3669819831848145  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3670201301574707  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.373466968536377  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([728, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3909406661987305  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3909406661987305  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 728, 256]), torch.Size([1, 728, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.392329216003418  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.6420927047729492  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 728, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.6138958930969238  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.614306926727295  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.614717960357666  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.614285945892334  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

torch.Size([2758, 40])
input nodes number: 16582
output nodes number: 2758
edges number: 32081
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.6144165992736816  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.6144170761108398  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.029065608978271484  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

pseudo mini batch 21 input nodes size: 45488
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.025519371032714844  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.025519371032714844  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.047209739685058594  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04723072052001953  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.027676105499267578  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.028854846954345703  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.028854846954345703  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.028854846954345703  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

torch.Size([45488, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.028854846954345703  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

m.shape torch.Size([701, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09401226043701172  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09401226043701172  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 701, 128]), torch.Size([1, 701, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0946807861328125  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10094547271728516  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 701, 128])
m.shape torch.Size([701, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10127973556518555  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10127973556518555  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 701, 128]), torch.Size([1, 701, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10194826126098633  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11197614669799805  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 701, 128])
m.shape torch.Size([746, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11270904541015625  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11270904541015625  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 746, 128]), torch.Size([1, 746, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11342048645019531  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12938594818115234  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 746, 128])
m.shape torch.Size([660, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13028907775878906  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13028907775878906  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 660, 128]), torch.Size([1, 660, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1309185028076172  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14927101135253906  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 660, 128])
m.shape torch.Size([596, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1503772735595703  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1503772735595703  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 596, 128]), torch.Size([1, 596, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15094566345214844  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17140769958496094  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 596, 128])
m.shape torch.Size([575, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17276859283447266  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17276859283447266  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17331695556640625  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19689655303955078  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([566, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19851160049438477  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19851160049438477  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1990513801574707  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22620344161987305  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([502, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22784852981567383  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22784852981567383  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22832727432250977  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2556157112121582  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([495, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.25750064849853516  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.25750064849853516  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.25797271728515625  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.28818511962890625  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([10675, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3388514518737793  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3388514518737793  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 10675, 128]), torch.Size([1, 10675, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.349031925201416  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0720667839050293  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 10675, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0111770629882812  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0266427993774414  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0421085357666016  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0265216827392578  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

torch.Size([16217, 256])
first layer input nodes number: 45488
first layer output nodes number: 16217
edges number: 132594
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0424494743347168  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.057915210723877  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0619807243347168  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0619807243347168  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

m.shape torch.Size([404, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0870251655578613  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0870251655578613  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0877957344055176  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0939602851867676  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([312, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.094174861907959  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.094174861907959  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0947699546813965  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1057791709899902  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([278, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1062836647033691  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1062836647033691  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.106813907623291  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.122419834136963  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([214, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1229777336120605  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1229777336120605  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1233859062194824  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1352229118347168  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([160, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1357879638671875  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1357879638671875  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1360931396484375  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1470794677734375  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([126, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.147653579711914  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.147653579711914  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1478939056396484  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1582279205322266  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([107, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.158827781677246  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.158827781677246  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.159031867980957  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.169236183166504  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([87, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1698031425476074  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1698031425476074  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.169969081878662  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1794276237487793  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1801581382751465  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1801581382751465  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1803374290466309  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1918120384216309  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([60, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1922993659973145  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1922993659973145  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1924138069152832  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2005391120910645  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2011799812316895  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2011799812316895  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.201305866241455  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2111248970031738  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2117657661437988  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2117657661437988  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2118821144104004  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2217717170715332  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2223882675170898  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2223882675170898  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2224912643432617  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2319669723510742  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2323460578918457  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2323460578918457  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2324070930480957  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2384495735168457  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([55, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2392120361328125  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2392120361328125  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2393169403076172  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.250436782836914  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2509536743164062  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2509536743164062  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2510242462158203  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2589988708496094  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2594866752624512  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2594866752624512  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2595477104187012  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2668719291687012  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2673778533935547  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2673778533935547  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2674369812011719  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2749462127685547  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2753734588623047  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2753734588623047  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.275421142578125  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2818107604980469  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2822294235229492  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2822294235229492  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.282273292541504  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2884588241577148  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2889213562011719  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2889213562011719  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2889671325683594  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2957420349121094  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2960786819458008  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2960786819458008  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2961111068725586  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3011369705200195  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3015408515930176  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3015408515930176  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.301577091217041  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.307447910308838  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3078222274780273  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3078222274780273  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3078546524047852  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3133344650268555  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([423, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3234825134277344  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3234825134277344  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.324289321899414  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4710049629211426  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 423, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4488191604614258  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4492301940917969  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.449641227722168  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.449209213256836  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

torch.Size([2758, 40])
input nodes number: 16217
output nodes number: 2758
edges number: 25525
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4493513107299805  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4493517875671387  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.030958175659179688  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

pseudo mini batch 22 input nodes size: 42362
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.027676105499267578  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.027676105499267578  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04787588119506836  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0478978157043457  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.026186466217041016  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.027654170989990234  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.027654170989990234  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.027654170989990234  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

torch.Size([42362, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.027654170989990234  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

m.shape torch.Size([436, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1053304672241211  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1053304672241211  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 436, 128]), torch.Size([1, 436, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10574626922607422  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10907268524169922  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 436, 128])
m.shape torch.Size([496, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10933780670166016  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10933780670166016  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10981082916259766  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11690616607666016  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([469, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1173405647277832  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1173405647277832  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11778783798217773  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12762784957885742  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([519, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12839412689208984  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12839412689208984  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 519, 128]), torch.Size([1, 519, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1288890838623047  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14404773712158203  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 519, 128])
m.shape torch.Size([515, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14502811431884766  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14502811431884766  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14551925659179688  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.16379594802856445  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([488, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1649465560913086  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1649465560913086  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 488, 128]), torch.Size([1, 488, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.16541194915771484  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1854238510131836  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 488, 128])
m.shape torch.Size([491, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1868300437927246  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1868300437927246  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18729829788208008  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.21071100234985352  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([447, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.21218204498291016  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.21218204498291016  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 447, 128]), torch.Size([1, 447, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.21260833740234375  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2369070053100586  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 447, 128])
m.shape torch.Size([535, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.23898983001708984  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.23898983001708984  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2395000457763672  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.27322959899902344  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([13632, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.33797693252563477  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.33797693252563477  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 13632, 128]), torch.Size([1, 13632, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.35097742080688477  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2743477821350098  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 13632, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.200493335723877  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2176861763000488  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2348790168762207  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2175517082214355  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

torch.Size([18028, 256])
first layer input nodes number: 42362
first layer output nodes number: 18028
edges number: 158562
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.235196590423584  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2523894309997559  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2566876411437988  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2566876411437988  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

m.shape torch.Size([241, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2939424514770508  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2939424514770508  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2944021224975586  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.298079490661621  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([226, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2982845306396484  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2982845306396484  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.298715591430664  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3051815032958984  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([177, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3054766654968262  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3054766654968262  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.305814266204834  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3132414817810059  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([152, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.313657283782959  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.313657283782959  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3139472007751465  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.322354793548584  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([137, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3228683471679688  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3228683471679688  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.323129653930664  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3325366973876953  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([112, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.333052158355713  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.333052158355713  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.333265781402588  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.342451572418213  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([95, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3429841995239258  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3429841995239258  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.343165397644043  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3522253036499023  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([78, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3527345657348633  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3527345657348633  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3528833389282227  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.361363410949707  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([78, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3619637489318848  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3619637489318848  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3621125221252441  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3716340065002441  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([94, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3724632263183594  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3724632263183594  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3726425170898438  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3853721618652344  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.38590669631958  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.38590669631958  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.386019229888916  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3947968482971191  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([80, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3956632614135742  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3956632614135742  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3958158493041992  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4087858200073242  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([65, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4095220565795898  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4095220565795898  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4096460342407227  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4210519790649414  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([59, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4217839241027832  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4217839241027832  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4218964576721191  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.433037281036377  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([57, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4338030815124512  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4338030815124512  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4339118003845215  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4454360008239746  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4461045265197754  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4461045265197754  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4461941719055176  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4563241004943848  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([59, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4572434425354004  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4572434425354004  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4573559761047363  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4708600044250488  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([59, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4721546173095703  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4721546173095703  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4722671508789062  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4865589141845703  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([61, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4878544807434082  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4878544807434082  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4879708290100098  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5035614967346191  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5044069290161133  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5044069290161133  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5044965744018555  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.517136573791504  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([48, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5180606842041016  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5180606842041016  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5181522369384766  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5317020416259766  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5323119163513184  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5323119163513184  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5323710441589355  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5415358543395996  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5421476364135742  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5421476364135742  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5422029495239258  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.551163673400879  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([38, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5520129203796387  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5520129203796387  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5520853996276855  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5643343925476074  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([798, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5839781761169434  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5839781761169434  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

 h.shape torch.Size([1, 798, 256]), torch.Size([1, 798, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5855002403259277  GigaBytes
Max Memory Allocated: 1.816413402557373  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.8553481101989746  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 798, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.8207812309265137  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.8212175369262695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.8216538429260254  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.8211956024169922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([2927, 40])
input nodes number: 18028
output nodes number: 2927
edges number: 38390
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.8213772773742676  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.8213777542114258  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.030185222625732422  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

pseudo mini batch 23 input nodes size: 45467
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02621173858642578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02621173858642578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.047892093658447266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0479130744934082  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.027691364288330078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02914571762084961  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02914571762084961  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02914571762084961  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([45467, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02914571762084961  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([558, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10813188552856445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10813188552856445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10866403579711914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11385250091552734  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([591, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1141500473022461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1141500473022461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 591, 128]), torch.Size([1, 591, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11471366882324219  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1231679916381836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 591, 128])
m.shape torch.Size([559, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12368583679199219  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12368583679199219  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 559, 128]), torch.Size([1, 559, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12421894073486328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1364603042602539  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 559, 128])
m.shape torch.Size([522, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13718938827514648  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13718938827514648  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13768720626831055  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15257024765014648  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([513, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15354442596435547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15354442596435547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15403366088867188  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1722731590270996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([498, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17345333099365234  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17345333099365234  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 498, 128]), torch.Size([1, 498, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17392826080322266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1943502426147461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 498, 128])
m.shape torch.Size([510, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1958150863647461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1958150863647461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19630146026611328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22062015533447266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([509, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2223186492919922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2223186492919922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22280406951904297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2504730224609375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([482, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.25229883193969727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.25229883193969727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2527585029602051  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2821774482727051  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 482, 128])
m.shape torch.Size([13807, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.34835386276245117  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.34835386276245117  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 13807, 128]), torch.Size([1, 13807, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.36152124404907227  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.29640531539917  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 13807, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2214927673339844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.239182472229004  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2568721771240234  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.239044189453125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([18549, 256])
first layer input nodes number: 45467
first layer output nodes number: 18549
edges number: 161108
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2572131156921387  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2749028205871582  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2797346115112305  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2797346115112305  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([309, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3127589225769043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3127589225769043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3133482933044434  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.320051670074463  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([246, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3202300071716309  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3202300071716309  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3206992149353027  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3277373313903809  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([198, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3280739784240723  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3280739784240723  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3284516334533691  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3367600440979004  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([150, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3371481895446777  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3371481895446777  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3374342918395996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.345731258392334  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([134, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3462324142456055  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3462324142456055  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3464879989624023  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3556890487670898  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([99, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3561325073242188  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3561325073242188  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3563213348388672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.36444091796875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([80, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.364884853363037  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.364884853363037  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.365037441253662  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.372666835784912  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([63, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.373075008392334  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.373075008392334  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3731951713562012  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3800444602966309  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3806681632995605  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3806681632995605  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3808188438415527  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3904623985290527  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.391021728515625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.391021728515625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3911476135253906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.40008544921875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4007205963134766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4007205963134766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4008464813232422  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.410665512084961  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.411294937133789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.411294937133789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4114093780517578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4211368560791016  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4217920303344727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4217920303344727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.421900749206543  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4319028854370117  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4325485229492188  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4325485229492188  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.432647705078125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4424667358398438  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.443037509918213  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.443037509918213  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4431195259094238  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4518132209777832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.452448844909668  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.452448844909668  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4525327682495117  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4620161056518555  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4625625610351562  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4625625610351562  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4626312255859375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4708709716796875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([46, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.471632480621338  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.471632480621338  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4717202186584473  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.482862949371338  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.483494758605957  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.483494758605957  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.483565330505371  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4930219650268555  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.493659496307373  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.493659496307373  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4937262535095215  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5031390190124512  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5038528442382812  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5038528442382812  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5039234161376953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5143680572509766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.51509428024292  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.51509428024292  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5151629447937012  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.525805950164795  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.526280403137207  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.526280403137207  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5263242721557617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.533431053161621  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5340089797973633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5340089797973633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5340585708618164  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5424394607543945  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([736, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5600996017456055  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5600996017456055  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 736, 256]), torch.Size([1, 736, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5615034103393555  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.8171648979187012  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 736, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.7867827415466309  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.787193775177002  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.787604808807373  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.787172794342041  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([2758, 40])
input nodes number: 18549
output nodes number: 2758
edges number: 33923
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.787306785583496  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.7873072624206543  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.031613826751708984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

pseudo mini batch 24 input nodes size: 16831
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.027666091918945312  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.027666091918945312  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03569173812866211  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03571319580078125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.014011859893798828  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01445627212524414  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01445627212524414  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01445627212524414  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([16831, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01445627212524414  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([797, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.035335540771484375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.035335540771484375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 797, 128]), torch.Size([1, 797, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.036095619201660156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04266023635864258  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 797, 128])
m.shape torch.Size([799, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04304218292236328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04304218292236328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 799, 128]), torch.Size([1, 799, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.043804168701171875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.05523395538330078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 799, 128])
m.shape torch.Size([724, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.05593109130859375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.05593109130859375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 724, 128]), torch.Size([1, 724, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.056621551513671875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07248306274414062  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 724, 128])
m.shape torch.Size([645, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07336807250976562  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07336807250976562  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 645, 128]), torch.Size([1, 645, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07398319244384766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09229660034179688  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 645, 128])
m.shape torch.Size([592, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09340047836303711  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09340047836303711  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09396505355834961  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11428976058959961  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([445, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1152806282043457  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1152806282043457  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11570501327514648  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13395357131958008  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([375, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1349930763244629  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1349930763244629  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 375, 128]), torch.Size([1, 375, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13535070419311523  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15323209762573242  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 375, 128])
m.shape torch.Size([345, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15436935424804688  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15436935424804688  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 345, 128]), torch.Size([1, 345, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15469837188720703  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17345237731933594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 345, 128])
m.shape torch.Size([261, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.174407958984375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.174407958984375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 261, 128]), torch.Size([1, 261, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17465686798095703  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19058704376220703  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 261, 128])
m.shape torch.Size([2125, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20059537887573242  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20059537887573242  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 2125, 128]), torch.Size([1, 2125, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2027745246887207  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3488917350769043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 2125, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3306560516357422  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3374347686767578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.34421348571777344  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.33738136291503906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([7108, 256])
first layer input nodes number: 16831
first layer output nodes number: 7108
edges number: 41761
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.34434080123901367  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3511195182800293  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.35370397567749023  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.35370397567749023  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([507, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3713397979736328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3713397979736328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 507, 256]), torch.Size([1, 507, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.37230682373046875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3807525634765625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 507, 256])
m.shape torch.Size([417, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3810710906982422  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3810710906982422  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 417, 256]), torch.Size([1, 417, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.381866455078125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3937969207763672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 417, 256])
m.shape torch.Size([354, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3946995735168457  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3946995735168457  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.39537477493286133  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4102292060852051  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([277, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.41095685958862305  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.41095685958862305  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4114851951599121  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.42690610885620117  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([264, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.42791080474853516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.42791080474853516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.42841434478759766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.44654178619384766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.447206974029541  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.447206974029541  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4475102424621582  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.46055078506469727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.46131420135498047  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.46131420135498047  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.46157360076904297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.47454357147216797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([114, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.47529077529907227  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.47529077529907227  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4755082130432129  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4879021644592285  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4885287284851074  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4885287284851074  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4886908531188965  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4990668296813965  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([60, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.49956274032592773  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.49956274032592773  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4996771812438965  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5078024864196777  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5083374977111816  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5083374977111816  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5084443092346191  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5167756080627441  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5172877311706543  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5172877311706543  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5173811912536621  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5253252983093262  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5258660316467285  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5258660316467285  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5259556770324707  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.534203052520752  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5345754623413086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5345754623413086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5346345901489258  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5404882431030273  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5408916473388672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5408916473388672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5409488677978516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5470142364501953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5473546981811523  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5473546981811523  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5474004745483398  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5525732040405273  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5528936386108398  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5528936386108398  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5529336929321289  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5577402114868164  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5581183433532715  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5581183433532715  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5581622123718262  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5637335777282715  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5641136169433594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5641136169433594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5641555786132812  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5697784423828125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5701804161071777  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5701804161071777  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5702223777770996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.576138973236084  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5763602256774902  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5763602256774902  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.576383113861084  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.579770565032959  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5800132751464844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5800132751464844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5800361633300781  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5835838317871094  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5837936401367188  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5837936401367188  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5838127136230469  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5869026184082031  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5872163772583008  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5872163772583008  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5872430801391602  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5917558670043945  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([116, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5945301055908203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5945301055908203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5947513580322266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6336917877197266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 116, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6193485260009766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6197752952575684  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6202020645141602  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6197538375854492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([2862, 40])
input nodes number: 7108
output nodes number: 2862
edges number: 17708
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6198444366455078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.619844913482666  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01536703109741211  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

pseudo mini batch 25 input nodes size: 36181
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.014027595520019531  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.014027595520019531  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0312800407409668  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.031301021575927734  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.023253917694091797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.024012088775634766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.024012088775634766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.024012088775634766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([36181, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.024012088775634766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([784, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06500864028930664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06500864028930664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 784, 128]), torch.Size([1, 784, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06575632095336914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07252120971679688  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 784, 128])
m.shape torch.Size([935, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07303905487060547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07303905487060547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 935, 128]), torch.Size([1, 935, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07393074035644531  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08788728713989258  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 935, 128])
m.shape torch.Size([816, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0886087417602539  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0886087417602539  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0893869400024414  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10698223114013672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([689, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10790729522705078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10790729522705078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 689, 128]), torch.Size([1, 689, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10856437683105469  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12776851654052734  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 689, 128])
m.shape torch.Size([616, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12890863418579102  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12890863418579102  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12949609756469727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1507267951965332  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([551, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1520094871520996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1520094871520996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 551, 128]), torch.Size([1, 551, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15253496170043945  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17583322525024414  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 551, 128])
m.shape torch.Size([506, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1772594451904297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1772594451904297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17774200439453125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20186996459960938  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([489, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2037067413330078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2037067413330078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20417308807373047  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.23075485229492188  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([421, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2323284149169922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2323284149169922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 421, 128]), torch.Size([1, 421, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.23272991180419922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2584257125854492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 421, 128])
m.shape torch.Size([5749, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.28563833236694336  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.28563833236694336  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 5749, 128]), torch.Size([1, 5749, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2911210060119629  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6827840805053711  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 5749, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6457376480102539  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6567583084106445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6677789688110352  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6566720008850098  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([11556, 256])
first layer input nodes number: 36181
first layer output nodes number: 11556
edges number: 82977
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6680507659912109  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6790714263916016  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6821269989013672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6821269989013672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([490, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.700624942779541  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.700624942779541  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 490, 256]), torch.Size([1, 490, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7015595436096191  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7099227905273438  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 490, 256])
m.shape torch.Size([460, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7103400230407715  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7103400230407715  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7112174034118652  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7247872352600098  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([318, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7252655029296875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7252655029296875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7258720397949219  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7406325340270996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.741182804107666  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.741182804107666  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7416062355041504  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7538857460021973  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([171, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7544960975646973  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7544960975646973  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7548222541809082  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.766563892364502  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7672662734985352  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7672662734985352  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.767552375793457  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7798547744750977  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([118, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7805056571960449  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7805056571960449  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7807307243347168  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7919840812683105  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7927408218383789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7927408218383789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7929563522338867  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.805241584777832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8058433532714844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8058433532714844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.805999755859375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.816009521484375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([63, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8165369033813477  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8165369033813477  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8166570663452148  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8251886367797852  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8257946968078613  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8257946968078613  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8259148597717285  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8352875709533691  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8359889984130859  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8359889984130859  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8361148834228516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8468151092529297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([33, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8471646308898926  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8471646308898926  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8472275733947754  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8530182838439941  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.853485107421875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.853485107421875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8535556793212891  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8605422973632812  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.860997200012207  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.860997200012207  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8610620498657227  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8679361343383789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8682112693786621  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8682112693786621  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8682494163513184  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8725600242614746  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8729333877563477  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8729333877563477  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8729791641235352  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8784723281860352  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8788647651672363  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8788647651672363  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8789105415344238  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8847241401672363  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.885012149810791  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.885012149810791  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8850445747375488  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8893895149230957  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8896808624267578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8896808624267578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8897113800048828  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8940143585205078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8944029808044434  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8944029808044434  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8944411277770996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9000868797302246  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9003005027770996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9003005027770996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9003214836120605  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9035735130310059  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9038729667663574  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9038729667663574  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9038996696472168  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9082255363464355  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9083738327026367  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9083738327026367  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9083871841430664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9106435775756836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([185, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9155983924865723  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9155983924865723  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9159512519836426  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9780545234680176  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 185, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.963348388671875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9637594223022461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9641704559326172  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9637384414672852  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([2758, 40])
input nodes number: 11556
output nodes number: 2758
edges number: 18627
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9638299942016602  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9638304710388184  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02545452117919922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

pseudo mini batch 26 input nodes size: 31164
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.023238182067871094  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.023238182067871094  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03809833526611328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03811931610107422  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.020845890045166016  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.021680355072021484  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.021680355072021484  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.021680355072021484  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([31164, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.021680355072021484  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([733, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0659322738647461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0659322738647461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 733, 128]), torch.Size([1, 733, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06663131713867188  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07296037673950195  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 733, 128])
m.shape torch.Size([727, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0733041763305664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0733041763305664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 727, 128]), torch.Size([1, 727, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07399749755859375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0848855972290039  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 727, 128])
m.shape torch.Size([593, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0853872299194336  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0853872299194336  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0859527587890625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09839439392089844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([553, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09919500350952148  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09919500350952148  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09972238540649414  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11572599411010742  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([553, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11678075790405273  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11678075790405273  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11730813980102539  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13657569885253906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([543, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13786554336547852  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13786554336547852  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1383833885192871  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.16098356246948242  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([473, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.16230344772338867  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.16230344772338867  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.16275453567504883  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18530893325805664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([480, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18691444396972656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18691444396972656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18737220764160156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.21346473693847656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([421, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2150425910949707  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2150425910949707  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 421, 128]), torch.Size([1, 421, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.21544408798217773  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.24113988876342773  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 421, 128])
m.shape torch.Size([6659, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2726917266845703  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2726917266845703  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 6659, 128]), torch.Size([1, 6659, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.27904224395751953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.735194206237793  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 6659, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6941213607788086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7053127288818359  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7165040969848633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7052249908447266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([11735, 256])
first layer input nodes number: 31164
first layer output nodes number: 11735
edges number: 89731
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.716738224029541  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7279295921325684  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7315845489501953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7315845489501953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([478, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7534399032592773  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7534399032592773  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 478, 256]), torch.Size([1, 478, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7543516159057617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.762150764465332  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 478, 256])
m.shape torch.Size([384, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7624330520629883  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7624330520629883  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7631654739379883  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7746224403381348  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([253, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7749857902526855  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7749857902526855  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7754683494567871  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7860846519470215  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([175, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7865161895751953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7865161895751953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7868499755859375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7965297698974609  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([185, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7972521781921387  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7972521781921387  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.797605037689209  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8103079795837402  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([164, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8110775947570801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8110775947570801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8113903999328613  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8248410224914551  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8255257606506348  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8255257606506348  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8257641792297363  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8376851081848145  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.838411808013916  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.838411808013916  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8386216163635254  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8505806922912598  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.851193904876709  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.851193904876709  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8513522148132324  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8614840507507324  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8622126579284668  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8622126579284668  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.862372875213623  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8737483024597168  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8744826316833496  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8744826316833496  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8746294975280762  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.886085033416748  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8866114616394043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8866114616394043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8867106437683105  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8951411247253418  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8956289291381836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8956289291381836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8957109451293945  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9032564163208008  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9037537574768066  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9037537574768066  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9038300514221191  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9113831520080566  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.911806583404541  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.911806583404541  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.911867618560791  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.918337345123291  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9189529418945312  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9189529418945312  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9190330505371094  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9280853271484375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9286012649536133  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9286012649536133  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9286661148071289  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9364480972290039  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9368486404418945  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9368486404418945  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9368963241577148  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9429521560668945  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9434218406677246  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9434218406677246  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9434733390808105  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9503741264343262  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9507713317871094  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9507713317871094  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9508132934570312  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9567298889160156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9571127891540527  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9571127891540527  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.957150936126709  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.962796688079834  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.963137149810791  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.963137149810791  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9631695747375488  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9681954383850098  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9684004783630371  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9684004783630371  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9684195518493652  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9715094566345215  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9719386100769043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9719386100769043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9719748497009277  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9780993461608887  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([279, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9849634170532227  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9849634170532227  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9854955673217773  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0846900939941406  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 279, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.065896987915039  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0663113594055176  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.066725730895996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0662903785705566  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([2780, 40])
input nodes number: 11735
output nodes number: 2780
edges number: 22134
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0664024353027344  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0664029121398926  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02321004867553711  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

pseudo mini batch 27 input nodes size: 37549
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.020849227905273438  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.020849227905273438  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03875398635864258  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.038774967193603516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02389383316040039  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02476358413696289  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02476358413696289  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02476358413696289  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([37549, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02476358413696289  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([831, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07239151000976562  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07239151000976562  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 831, 128]), torch.Size([1, 831, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07318401336669922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07956552505493164  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 831, 128])
m.shape torch.Size([896, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08002376556396484  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08002376556396484  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 896, 128]), torch.Size([1, 896, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08087825775146484  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09454584121704102  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 896, 128])
m.shape torch.Size([705, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09512710571289062  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09512710571289062  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 705, 128]), torch.Size([1, 705, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09579944610595703  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11078786849975586  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 705, 128])
m.shape torch.Size([684, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1117563247680664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1117563247680664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 684, 128]), torch.Size([1, 684, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11240863800048828  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1319112777709961  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 684, 128])
m.shape torch.Size([556, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13291072845458984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13291072845458984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 556, 128]), torch.Size([1, 556, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13344097137451172  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15279102325439453  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 556, 128])
m.shape torch.Size([483, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15390777587890625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15390777587890625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15436840057373047  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17417526245117188  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 483, 128])
m.shape torch.Size([457, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17547035217285156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17547035217285156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17590618133544922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19769763946533203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([412, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1990513801574707  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1990513801574707  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 412, 128]), torch.Size([1, 412, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19944429397583008  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22184038162231445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 412, 128])
m.shape torch.Size([428, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2234807014465332  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2234807014465332  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 428, 128]), torch.Size([1, 428, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22388887405395508  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2500119209289551  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 428, 128])
m.shape torch.Size([7303, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.28463125228881836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.28463125228881836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 7303, 128]), torch.Size([1, 7303, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2915959358215332  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7860884666442871  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 7303, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7424149513244629  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7545790672302246  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7667431831359863  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.754483699798584  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([12755, 256])
first layer input nodes number: 37549
first layer output nodes number: 12755
edges number: 96529
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7670249938964844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7791891098022461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7822585105895996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7822585105895996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([511, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8021245002746582  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8021245002746582  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 511, 256]), torch.Size([1, 511, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8030991554260254  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8114070892333984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 511, 256])
m.shape torch.Size([460, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8118042945861816  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8118042945861816  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8126816749572754  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.828031063079834  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([295, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8284430503845215  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8284430503845215  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8290057182312012  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8413844108581543  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([257, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8421053886413574  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8421053886413574  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8425955772399902  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8572392463684082  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([160, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8577632904052734  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8577632904052734  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8580684661865234  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8690547943115234  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([127, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8696346282958984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8696346282958984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8698768615722656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8802928924560547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([113, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8809323310852051  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8809323310852051  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8811478614807129  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8919243812561035  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([75, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8923935890197754  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8923935890197754  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8925366401672363  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9006905555725098  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([77, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9012851715087891  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9012851715087891  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9014320373535156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9108314514160156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([65, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9113831520080566  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9113831520080566  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9115071296691895  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9203095436096191  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9209456443786621  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9209456443786621  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9210715293884277  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9308905601501465  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9314389228820801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9314389228820801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9315400123596191  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9401326179504395  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([37, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.940544605255127  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.940544605255127  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.940615177154541  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9471077919006348  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([25, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9474091529846191  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9474091529846191  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9474568367004395  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9521775245666504  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9523987770080566  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9523987770080566  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9524312019348145  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9558682441711426  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9560675621032715  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9560675621032715  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9560942649841309  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9591116905212402  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.959343433380127  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.959343433380127  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9593720436096191  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9628052711486816  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.963223934173584  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.963223934173584  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9632716178894043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.969327449798584  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9697055816650391  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9697055816650391  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9697475433349609  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9753704071044922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9757146835327148  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9757146835327148  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9757509231567383  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.980860710144043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9812264442443848  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9812264442443848  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9812626838684082  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.986626148223877  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9869465827941895  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9869465827941895  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9869771003723145  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9917073249816895  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9919576644897461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9919576644897461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9919805526733398  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9956884384155273  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9960460662841797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9960460662841797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9960765838623047  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0012340545654297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([272, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0077548027038574  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0077548027038574  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0082736015319824  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.107041835784912  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 272, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0904908180236816  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0909032821655273  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.091315746307373  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0908823013305664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([2768, 40])
input nodes number: 12755
output nodes number: 2768
edges number: 20026
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0909967422485352  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0909972190856934  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.026378631591796875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

pseudo mini batch 28 input nodes size: 16130
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.023891925811767578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.023891925811767578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.031583309173583984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03160524368286133  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01367950439453125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01409149169921875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01409149169921875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01409149169921875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([16130, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01409149169921875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([822, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03327178955078125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03327178955078125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 822, 128]), torch.Size([1, 822, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03405570983886719  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04032707214355469  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 822, 128])
m.shape torch.Size([943, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04083442687988281  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04083442687988281  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 943, 128]), torch.Size([1, 943, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.041733741760253906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.05522346496582031  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 943, 128])
m.shape torch.Size([774, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.056050777435302734  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.056050777435302734  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 774, 128]), torch.Size([1, 774, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.05678892135620117  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0730280876159668  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 774, 128])
m.shape torch.Size([690, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07406282424926758  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07406282424926758  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 690, 128]), torch.Size([1, 690, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07472085952758789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09380388259887695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 690, 128])
m.shape torch.Size([581, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09486007690429688  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09486007690429688  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0954141616821289  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11564874649047852  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([430, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11660194396972656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11660194396972656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11701202392578125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1346454620361328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([380, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13570880889892578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13570880889892578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 380, 128]), torch.Size([1, 380, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13607120513916016  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1541910171508789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 380, 128])
m.shape torch.Size([324, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15524578094482422  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15524578094482422  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 324, 128]), torch.Size([1, 324, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15555477142333984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17316722869873047  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 324, 128])
m.shape torch.Size([283, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17422723770141602  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17422723770141602  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 283, 128]), torch.Size([1, 283, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17449712753295898  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19177007675170898  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 283, 128])
m.shape torch.Size([1717, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20067644119262695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20067644119262695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 1717, 128]), torch.Size([1, 1717, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20231389999389648  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3185734748840332  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 1717, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.30269289016723633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.30931520462036133  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.31593751907348633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3092632293701172  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([6944, 256])
first layer input nodes number: 16130
first layer output nodes number: 6944
edges number: 38244
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.31606006622314453  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.32268238067626953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3243379592895508  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3243379592895508  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([550, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.34128427505493164  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.34128427505493164  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 550, 256]), torch.Size([1, 550, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3423333168029785  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3507256507873535  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 550, 256])
m.shape torch.Size([483, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.35113000869750977  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.35113000869750977  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 483, 256]), torch.Size([1, 483, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3520512580871582  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.36586999893188477  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 483, 256])
m.shape torch.Size([342, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.36647605895996094  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.36647605895996094  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3671283721923828  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.38245105743408203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([267, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3831915855407715  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3831915855407715  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3837008476257324  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.39873456954956055  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([259, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.39972496032714844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.39972496032714844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4002189636230469  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4186258316040039  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([147, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.41922664642333984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.41922664642333984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4195070266723633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4315633773803711  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4322643280029297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4322643280029297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.43250274658203125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4444236755371094  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([126, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.44527339935302734  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.44527339935302734  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4455137252807617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4592123031616211  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4598708152770996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4598708152770996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.46004247665405273  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.47102880477905273  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4717216491699219  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4717216491699219  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4718761444091797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4828453063964844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([51, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4833073616027832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4833073616027832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.48340463638305664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.49099206924438477  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([39, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4913935661315918  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4913935661315918  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4914679527282715  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4977908134460449  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4983658790588379  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4983658790588379  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4984593391418457  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5070576667785645  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([33, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5074553489685059  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5074553489685059  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5075182914733887  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5137495994567871  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5141654014587402  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5141654014587402  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5142245292663574  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5204920768737793  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5209546089172363  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5209546089172363  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5210156440734863  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5279126167297363  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5282745361328125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5282745361328125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5283203125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5338134765625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5341367721557617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5341367721557617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.534174919128418  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5390195846557617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.539311408996582  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.539311408996582  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5393438339233398  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5436887741088867  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5439033508300781  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5439033508300781  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5439262390136719  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5471534729003906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5473442077636719  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5473442077636719  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.54736328125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5501861572265625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5503249168395996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5503249168395996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5503382682800293  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5524077415466309  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.552556037902832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.552556037902832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5525693893432617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5547323226928711  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5548644065856934  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5548644065856934  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5548758506774902  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5568099021911621  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([102, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5592551231384277  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5592551231384277  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5594496726989746  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5936903953552246  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 102, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5801324844360352  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.58056640625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5810003280639648  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5805444717407227  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([2910, 40])
input nodes number: 6944
output nodes number: 2910
edges number: 16945
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5806398391723633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5806403160095215  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.014961719512939453  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

pseudo mini batch 29 input nodes size: 22330
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01370096206665039  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01370096206665039  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.024348735809326172  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02436971664428711  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01665639877319336  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01716470718383789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01716470718383789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01716470718383789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([22330, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01716470718383789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([790, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.042583465576171875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.042583465576171875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04333686828613281  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04937458038330078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 790, 128])
m.shape torch.Size([871, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.049828529357910156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.049828529357910156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 871, 128]), torch.Size([1, 871, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0506591796875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06311893463134766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 871, 128])
m.shape torch.Size([787, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06382942199707031  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06382942199707031  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 787, 128]), torch.Size([1, 787, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06457996368408203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08109188079833984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 787, 128])
m.shape torch.Size([652, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08196020126342773  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08196020126342773  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 652, 128]), torch.Size([1, 652, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08258199691772461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10061407089233398  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 652, 128])
m.shape torch.Size([596, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10172414779663086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10172414779663086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 596, 128]), torch.Size([1, 596, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10229253768920898  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12285184860229492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 596, 128])
m.shape torch.Size([451, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12385797500610352  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12385797500610352  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12428808212280273  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14278268814086914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([411, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14393949508666992  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14393949508666992  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 411, 128]), torch.Size([1, 411, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1443314552307129  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.16392946243286133  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 411, 128])
m.shape torch.Size([370, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1651449203491211  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1651449203491211  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 370, 128]), torch.Size([1, 370, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1654977798461914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18561077117919922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 370, 128])
m.shape torch.Size([320, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18680763244628906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18680763244628906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18711280822753906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20664405822753906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 320, 128])
m.shape torch.Size([2916, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2203960418701172  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2203960418701172  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 2916, 128]), torch.Size([1, 2916, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2231769561767578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.42127037048339844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 2916, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.399263858795166  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4071164131164551  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4149022102355957  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.40698862075805664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([8164, 256])
first layer input nodes number: 22330
first layer output nodes number: 8164
edges number: 51064
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.41500377655029297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.42285633087158203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.42473602294921875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.42473602294921875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([500, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.44182586669921875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.44182586669921875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 500, 256]), torch.Size([1, 500, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.442779541015625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.45044803619384766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 500, 256])
m.shape torch.Size([419, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4507770538330078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4507770538330078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.45157623291015625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.46484947204589844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([331, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4654045104980469  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4654045104980469  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4660358428955078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.48079872131347656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([275, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.48156309127807617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.48156309127807617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4820876121520996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4975090026855469  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([238, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.49839067459106445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.49839067459106445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.49884462356567383  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5151867866516113  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([147, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5158076286315918  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5158076286315918  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5160880088806152  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.528144359588623  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5288925170898438  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5288925170898438  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.529144287109375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5417327880859375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.542391300201416  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.542391300201416  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5425858497619629  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5536751747131348  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5543479919433594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5543479919433594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5545177459716797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5653820037841797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5659317970275879  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5659317970275879  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5660576820373535  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5749955177307129  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5755672454833984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5755672454833984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5756816864013672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5846080780029297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5851740837097168  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5851740837097168  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5852770805358887  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.594031810760498  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5946178436279297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5946178436279297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5947151184082031  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6036643981933594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6041674613952637  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6041674613952637  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.604245662689209  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6119875907897949  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6123814582824707  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6123814582824707  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6124386787414551  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6185040473937988  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6188139915466309  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6188139915466309  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6188559532165527  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6235976219177246  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6239199638366699  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6239199638366699  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.623960018157959  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6287665367126465  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.629023551940918  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.629023551940918  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.629054069519043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.632929801940918  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6332254409790039  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6332254409790039  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6332578659057617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6376028060913086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6379327774047852  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6379327774047852  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6379671096801758  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6428079605102539  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6431746482849121  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6431746482849121  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6432108879089355  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6485743522644043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6487045288085938  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6487045288085938  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6487178802490234  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.650787353515625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6510238647460938  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6510238647460938  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6510448455810547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6544437408447266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6546640396118164  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6546640396118164  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6546831130981445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6579065322875977  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([109, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6605162620544434  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6605162620544434  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6607241630554199  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6973147392272949  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 109, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6834378242492676  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6838531494140625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6842684745788574  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6838321685791016  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([2785, 40])
input nodes number: 8164
output nodes number: 2785
edges number: 17150
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6838955879211426  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6838960647583008  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.018163204193115234  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

pseudo mini batch 30 input nodes size: 20110
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.016637802124023438  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.016637802124023438  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02622699737548828  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.026248931884765625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.015580177307128906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01606464385986328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01606464385986328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01606464385986328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([20110, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01606464385986328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([839, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.040558815002441406  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.040558815002441406  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04135894775390625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04864215850830078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([868, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.049069881439208984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.049069881439208984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 868, 128]), torch.Size([1, 868, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04989767074584961  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.062314510345458984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 868, 128])
m.shape torch.Size([802, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06304788589477539  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06304788589477539  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0638127326965332  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08063936233520508  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([650, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0814967155456543  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0814967155456543  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08211660385131836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10089826583862305  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 650, 128])
m.shape torch.Size([654, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10214757919311523  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10214757919311523  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 654, 128]), torch.Size([1, 654, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10277128219604492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12580156326293945  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 654, 128])
m.shape torch.Size([483, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12687158584594727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12687158584594727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12733221054077148  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1471390724182129  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 483, 128])
m.shape torch.Size([411, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14828062057495117  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14828062057495117  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 411, 128]), torch.Size([1, 411, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14867258071899414  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.16827058792114258  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 411, 128])
m.shape torch.Size([361, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.16945171356201172  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.16945171356201172  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 361, 128]), torch.Size([1, 361, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.16979598999023438  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18941974639892578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 361, 128])
m.shape torch.Size([293, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1905050277709961  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1905050277709961  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 293, 128]), torch.Size([1, 293, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19078445434570312  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20866775512695312  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 293, 128])
m.shape torch.Size([2522, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22055387496948242  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22055387496948242  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 2522, 128]), torch.Size([1, 2522, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22342538833618164  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3968014717102051  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 2522, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3754754066467285  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.382993221282959  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.39051103591918945  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3829340934753418  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([7883, 256])
first layer input nodes number: 20110
first layer output nodes number: 7883
edges number: 47371
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.39066314697265625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3981809616088867  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.40057373046875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.40057373046875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([561, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4179825782775879  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4179825782775879  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 561, 256]), torch.Size([1, 561, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4190526008605957  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.42879581451416016  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 561, 256])
m.shape torch.Size([427, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.42908191680908203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.42908191680908203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.42989635467529297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.44211292266845703  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([353, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.44295167922973633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.44295167922973633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.44362497329711914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4589672088623047  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([252, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.45959949493408203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.45959949493408203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4600801467895508  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.47401905059814453  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([245, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4749565124511719  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4749565124511719  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.47542381286621094  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4922466278076172  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.49292421340942383  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.49292421340942383  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4932255744934082  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5061841011047363  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.506894588470459  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.506894588470459  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.507138729095459  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.519345760345459  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5201311111450195  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5201311111450195  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5203561782836914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5331850051879883  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5338683128356934  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5338683128356934  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5340437889099121  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5452742576599121  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5458979606628418  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5458979606628418  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5460391044616699  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5560603141784668  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5566139221191406  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5566139221191406  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5567264556884766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5655040740966797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5661053657531738  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5661053657531738  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5662140846252441  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5754551887512207  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5759258270263672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5759258270263672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5760059356689453  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5833759307861328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5840086936950684  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5840086936950684  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.584104061126709  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5935454368591309  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5939450263977051  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5939450263977051  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5940041542053223  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6002717018127441  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6006112098693848  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6006112098693848  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6006569862365723  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6058297157287598  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6061663627624512  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6061663627624512  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.606208324432373  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.611243724822998  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6115169525146484  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6115169525146484  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6115493774414062  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6156673431396484  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.615962028503418  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.615962028503418  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6159944534301758  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6203393936157227  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6205735206604004  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6205735206604004  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.620598316192627  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6240944862365723  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6242032051086426  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6242032051086426  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6242146492004395  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.625908374786377  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6260933876037598  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6260933876037598  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6261105537414551  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6287713050842285  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6290726661682129  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6290726661682129  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6290993690490723  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.633425235748291  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6335506439208984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6335506439208984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6335620880126953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6354961395263672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([115, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6382536888122559  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6382536888122559  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6384730339050293  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6770777702331543  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 115, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6630401611328125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6634712219238281  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6639022827148438  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6634492874145508  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([2890, 40])
input nodes number: 7883
output nodes number: 2890
edges number: 17419
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.663546085357666  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6635465621948242  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.017055988311767578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

pseudo mini batch 31 input nodes size: 33096
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01559591293334961  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01559591293334961  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.031377315521240234  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03139829635620117  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.021787166595458984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.022533893585205078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.022533893585205078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.022533893585205078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([33096, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.022533893585205078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([701, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06139516830444336  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06139516830444336  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 701, 128]), torch.Size([1, 701, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06206369400024414  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06741189956665039  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 701, 128])
m.shape torch.Size([775, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06781673431396484  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06781673431396484  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 775, 128]), torch.Size([1, 775, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06855583190917969  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07978677749633789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 775, 128])
m.shape torch.Size([694, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08049297332763672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08049297332763672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 694, 128]), torch.Size([1, 694, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08115482330322266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0958414077758789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 694, 128])
m.shape torch.Size([644, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09673881530761719  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09673881530761719  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 644, 128]), torch.Size([1, 644, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09735298156738281  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11522865295410156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 644, 128])
m.shape torch.Size([660, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11649513244628906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11649513244628906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 660, 128]), torch.Size([1, 660, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11712455749511719  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14020919799804688  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 660, 128])
m.shape torch.Size([637, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14171695709228516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14171695709228516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14232444763183594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.16897010803222656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([513, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1703786849975586  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1703786849975586  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.170867919921875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1956009864807129  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([472, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1971569061279297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1971569061279297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 472, 128]), torch.Size([1, 472, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19760704040527344  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2232646942138672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 472, 128])
m.shape torch.Size([407, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22478628158569336  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22478628158569336  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 407, 128]), torch.Size([1, 407, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2251744270324707  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2500157356262207  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 407, 128])
m.shape torch.Size([5364, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.27539920806884766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.27539920806884766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 5364, 128]), torch.Size([1, 5364, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2812209129333496  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6452574729919434  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 5364, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6101436614990234  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6205072402954102  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6308708190917969  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6204261779785156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([10867, 256])
first layer input nodes number: 33096
first layer output nodes number: 10867
edges number: 78701
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6311197280883789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6414833068847656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6441936492919922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6441936492919922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([416, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.665278434753418  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.665278434753418  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.666071891784668  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6725397109985352  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([381, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6728754043579102  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6728754043579102  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6736021041870117  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6853361129760742  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([298, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6858320236206055  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6858320236206055  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6864004135131836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7008867263793945  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([208, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7014021873474121  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7014021873474121  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7017989158630371  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7133040428161621  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([192, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7140283584594727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7140283584594727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7143945693969727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7275781631469727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([177, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7284159660339355  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7284159660339355  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7287535667419434  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7432703971862793  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7440099716186523  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7440099716186523  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.744267463684082  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7571420669555664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7578516006469727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7578516006469727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7580595016479492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7699098587036133  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7706537246704102  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7706537246704102  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7708406448364258  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7828035354614258  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7835369110107422  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7835369110107422  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7837009429931641  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7953472137451172  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7958784103393555  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7958784103393555  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7959890365600586  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8046178817749023  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8053007125854492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8053007125854492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8054227828979492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8157987594604492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.816349983215332  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.816349983215332  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8164434432983398  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8250417709350586  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8256411552429199  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8256411552429199  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8257327079772949  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8347964286804199  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8352842330932617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8352842330932617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8353548049926758  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8428354263305664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8433079719543457  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8433079719543457  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8433709144592285  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8504834175109863  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8509750366210938  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8509750366210938  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8510360717773438  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8583602905273438  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8586587905883789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8586587905883789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8586950302124023  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8632974624633789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8636445999145508  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8636445999145508  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.863682746887207  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8687944412231445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.869236946105957  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.869236946105957  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8692827224731445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.875737190246582  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8761787414550781  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8761787414550781  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8762226104736328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8827152252197266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8829050064086914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8829050064086914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8829240798950195  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8858804702758789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8861141204833984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8861141204833984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8861351013183594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8895339965820312  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.889915943145752  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.889915943145752  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8899483680725098  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8954281806945801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([240, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9011788368225098  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9011788368225098  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9016366004943848  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9822030067443848  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes
[05:29:37] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 21719692 edges into 32 parts and get 6853239 edge cuts

rst.shape  torch.Size([1, 240, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9650802612304688  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9654955863952637  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9659109115600586  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9654746055603027  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([2785, 40])
input nodes number: 10867
output nodes number: 2785
edges number: 21393
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9655609130859375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9655613899230957  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.023946762084960938  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.029497146606445312  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.029497146606445312  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01202470064163208 |0.01209145039319992 |0.1303616538643837 |8.812546730041504e-05 |0.07615231722593307 |0.005776405334472656 |
----------------------------------------------------------pseudo_mini_loss sum 5.337268829345703
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1137736
Number of first layer input nodes during this epoch:  814709
Number of first layer output nodes during this epoch:  323027
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02949666976928711  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.020069599151611328
global_2_local spend time (sec) 0.04566240310668945
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004324913024902344
A = g.adjacency_matrix() spent  0.007544279098510742
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.10561418533325195
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.32771897315979
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.3105871677398682

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 11701738, 2.0: 2017886, 3.0: 504377, 4.0: 152112, 5.0: 55817, 6.0: 23824, 7.0: 11409, 8.0: 5685, 9.0: 3070, 10.0: 1700, 11.0: 1036, 12.0: 534, 13.0: 336, 14.0: 225, 15.0: 120, 16.0: 118, 17.0: 96, 18.0: 53, 19.0: 34, 20.0: 8, 21.0: 6})
Convert a graph into a bidirected graph: 0.806 seconds
Metis partitioning: 4.610 seconds
Split the graph: 0.294 seconds
Construct subgraphs: 0.076 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  5.800415277481079
2767
2760
2867
2762
2802
2889
2912
2758
2758
2759
2758
2927
2760
2863
2776
2759
2871
2831
2926
2898
2828
2851
2811
2927
2923
2879
2858
2829
2904
2900
2911
2917
total k batches seeds list generation spend  19.2322096824646
after graph partition
graph partition algorithm spend time 19.32775044441223
2767
2760
2867
2762
2802
2889
2912
2758
2758
2759
2758
2927
2760
2863
2776
2759
2871
2831
2926
2898
2828
2851
2811
2927
2923
2879
2858
2829
2904
2900
2911
2917
partition_len_list
[12644, 10989, 7554, 10973, 9846, 6380, 6602, 8391, 17140, 19728, 17482, 17871, 17107, 18641, 16173, 17623, 6448, 6755, 6276, 5768, 6813, 6634, 7287, 7621, 7801, 7862, 6730, 8648, 5493, 5390, 5516, 7214]
shared_neighbor_graph_partition_s0 selection method  spend 19.43191909790039
time for parepare:  0.019997596740722656
local_output_nid generation:  0.0008182525634765625
local_in_edges_tensor generation:  0.0009958744049072266
mini_batch_src_global generation:  0.0014710426330566406
r_  generation:  0.0076487064361572266
local_output_nid generation:  0.0008342266082763672
local_in_edges_tensor generation:  0.0008096694946289062
mini_batch_src_global generation:  0.0011048316955566406
r_  generation:  0.0057451725006103516
local_output_nid generation:  0.0008871555328369141
local_in_edges_tensor generation:  0.0008053779602050781
mini_batch_src_global generation:  0.0007495880126953125
r_  generation:  0.005944967269897461
local_output_nid generation:  0.0008671283721923828
local_in_edges_tensor generation:  0.0007703304290771484
mini_batch_src_global generation:  0.0009188652038574219
r_  generation:  0.006232023239135742
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.0007231235504150391
mini_batch_src_global generation:  0.0008194446563720703
r_  generation:  0.006085395812988281
local_output_nid generation:  0.0009324550628662109
local_in_edges_tensor generation:  0.0007443428039550781
mini_batch_src_global generation:  0.0007426738739013672
r_  generation:  0.006346225738525391
local_output_nid generation:  0.0008938312530517578
local_in_edges_tensor generation:  0.0007035732269287109
mini_batch_src_global generation:  0.0007393360137939453
r_  generation:  0.005947589874267578
local_output_nid generation:  0.0008509159088134766
local_in_edges_tensor generation:  0.0006709098815917969
mini_batch_src_global generation:  0.0007224082946777344
r_  generation:  0.005709409713745117
local_output_nid generation:  0.0008504390716552734
local_in_edges_tensor generation:  0.0007302761077880859
mini_batch_src_global generation:  0.0012013912200927734
r_  generation:  0.008710622787475586
local_output_nid generation:  0.0009045600891113281
local_in_edges_tensor generation:  0.0007576942443847656
mini_batch_src_global generation:  0.0013103485107421875
r_  generation:  0.010846376419067383
local_output_nid generation:  0.0009806156158447266
local_in_edges_tensor generation:  0.0007767677307128906
mini_batch_src_global generation:  0.0009591579437255859
r_  generation:  0.01097416877746582
local_output_nid generation:  0.0010304450988769531
local_in_edges_tensor generation:  0.0008015632629394531
mini_batch_src_global generation:  0.0010623931884765625
r_  generation:  0.012737751007080078
local_output_nid generation:  0.0009732246398925781
local_in_edges_tensor generation:  0.0007898807525634766
mini_batch_src_global generation:  0.0011484622955322266
r_  generation:  0.01123809814453125
local_output_nid generation:  0.0010745525360107422
local_in_edges_tensor generation:  0.0007898807525634766
mini_batch_src_global generation:  0.0013451576232910156
r_  generation:  0.009663581848144531
local_output_nid generation:  0.0010564327239990234
local_in_edges_tensor generation:  0.0006983280181884766
mini_batch_src_global generation:  0.00106048583984375
r_  generation:  0.007370710372924805
local_output_nid generation:  0.0009882450103759766
local_in_edges_tensor generation:  0.0007393360137939453
mini_batch_src_global generation:  0.0010836124420166016
r_  generation:  0.008713722229003906
local_output_nid generation:  0.0010581016540527344
local_in_edges_tensor generation:  0.0007343292236328125
mini_batch_src_global generation:  0.0009667873382568359
r_  generation:  0.00813150405883789
local_output_nid generation:  0.001046895980834961
local_in_edges_tensor generation:  0.0006794929504394531
mini_batch_src_global generation:  0.0006806850433349609
r_  generation:  0.005242109298706055
local_output_nid generation:  0.0010449886322021484
local_in_edges_tensor generation:  0.0007169246673583984
mini_batch_src_global generation:  0.0008287429809570312
r_  generation:  0.0075151920318603516
local_output_nid generation:  0.0010228157043457031
local_in_edges_tensor generation:  0.0007050037384033203
mini_batch_src_global generation:  0.0008165836334228516
r_  generation:  0.007803678512573242
local_output_nid generation:  0.0013422966003417969
local_in_edges_tensor generation:  0.0009953975677490234
mini_batch_src_global generation:  0.0012290477752685547
r_  generation:  0.0069386959075927734
local_output_nid generation:  0.0010161399841308594
local_in_edges_tensor generation:  0.0006787776947021484
mini_batch_src_global generation:  0.000698089599609375
r_  generation:  0.006657838821411133
local_output_nid generation:  0.0010302066802978516
local_in_edges_tensor generation:  0.000732421875
mini_batch_src_global generation:  0.0008742809295654297
r_  generation:  0.007217884063720703
local_output_nid generation:  0.0010879039764404297
local_in_edges_tensor generation:  0.0007333755493164062
mini_batch_src_global generation:  0.0010180473327636719
r_  generation:  0.008133411407470703
local_output_nid generation:  0.0011267662048339844
local_in_edges_tensor generation:  0.0007874965667724609
mini_batch_src_global generation:  0.0010743141174316406
r_  generation:  0.007860183715820312
local_output_nid generation:  0.0011184215545654297
local_in_edges_tensor generation:  0.0007405281066894531
mini_batch_src_global generation:  0.0009272098541259766
r_  generation:  0.0067501068115234375
local_output_nid generation:  0.0010447502136230469
local_in_edges_tensor generation:  0.0007388591766357422
mini_batch_src_global generation:  0.0009632110595703125
r_  generation:  0.0070953369140625
local_output_nid generation:  0.0010378360748291016
local_in_edges_tensor generation:  0.0007212162017822266
mini_batch_src_global generation:  0.0009245872497558594
r_  generation:  0.007115602493286133
local_output_nid generation:  0.0010383129119873047
local_in_edges_tensor generation:  0.0007035732269287109
mini_batch_src_global generation:  0.0007345676422119141
r_  generation:  0.005608558654785156
local_output_nid generation:  0.0010466575622558594
local_in_edges_tensor generation:  0.0007278919219970703
mini_batch_src_global generation:  0.0006003379821777344
r_  generation:  0.005052328109741211
local_output_nid generation:  0.0010023117065429688
local_in_edges_tensor generation:  0.0006928443908691406
mini_batch_src_global generation:  0.0007159709930419922
r_  generation:  0.006119251251220703
local_output_nid generation:  0.0009920597076416016
local_in_edges_tensor generation:  0.0007135868072509766
mini_batch_src_global generation:  0.0008378028869628906
r_  generation:  0.0067861080169677734
----------------------check_connections_block total spend ----------------------------- 0.4172377586364746
generate_one_block  0.02035045623779297
generate_one_block  0.009680747985839844
generate_one_block  0.008563756942749023
generate_one_block  0.009784221649169922
generate_one_block  0.00908660888671875
generate_one_block  0.008728265762329102
generate_one_block  0.009570837020874023
generate_one_block  0.008290290832519531
generate_one_block  0.014368295669555664
generate_one_block  0.016581296920776367
generate_one_block  0.017268657684326172
generate_one_block  0.020131826400756836
generate_one_block  0.01781320571899414
generate_one_block  0.01691126823425293
generate_one_block  0.015605688095092773
generate_one_block  0.015555620193481445
generate_one_block  0.01779794692993164
generate_one_block  0.008795976638793945
generate_one_block  0.012020349502563477
generate_one_block  0.011639118194580078
generate_one_block  0.009573936462402344
generate_one_block  0.008474588394165039
generate_one_block  0.01090383529663086
generate_one_block  0.012286186218261719
generate_one_block  0.011435508728027344
generate_one_block  0.013895988464355469
generate_one_block  0.01071929931640625
generate_one_block  0.013252735137939453
generate_one_block  0.008703470230102539
generate_one_block  0.0075359344482421875
generate_one_block  0.012545108795166016
generate_one_block  0.011583805084228516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03660917282104492
gen group dst list time:  0.009714365005493164
time for parepare:  0.024752140045166016
local_output_nid generation:  0.0031347274780273438
local_in_edges_tensor generation:  0.014399051666259766
mini_batch_src_global generation:  0.0038466453552246094
r_  generation:  0.03422713279724121
local_output_nid generation:  0.0036725997924804688
local_in_edges_tensor generation:  0.0035104751586914062
mini_batch_src_global generation:  0.0032777786254882812
r_  generation:  0.028377056121826172
local_output_nid generation:  0.002582550048828125
local_in_edges_tensor generation:  0.0020101070404052734
mini_batch_src_global generation:  0.0016984939575195312
r_  generation:  0.01666879653930664
local_output_nid generation:  0.0035047531127929688
local_in_edges_tensor generation:  0.0029439926147460938
mini_batch_src_global generation:  0.002330303192138672
r_  generation:  0.029358386993408203
local_output_nid generation:  0.0031461715698242188
local_in_edges_tensor generation:  0.0027387142181396484
mini_batch_src_global generation:  0.0037915706634521484
r_  generation:  0.026937484741210938
local_output_nid generation:  0.0021042823791503906
local_in_edges_tensor generation:  0.0016674995422363281
mini_batch_src_global generation:  0.0014576911926269531
r_  generation:  0.01393580436706543
local_output_nid generation:  0.002115488052368164
local_in_edges_tensor generation:  0.0016717910766601562
mini_batch_src_global generation:  0.0011615753173828125
r_  generation:  0.013983488082885742
local_output_nid generation:  0.0026264190673828125
local_in_edges_tensor generation:  0.001996755599975586
mini_batch_src_global generation:  0.0014269351959228516
r_  generation:  0.01878523826599121
local_output_nid generation:  0.004767656326293945
local_in_edges_tensor generation:  0.004424333572387695
mini_batch_src_global generation:  0.005131721496582031
r_  generation:  0.05068016052246094
local_output_nid generation:  0.0055162906646728516
local_in_edges_tensor generation:  0.006289243698120117
mini_batch_src_global generation:  0.009289264678955078
r_  generation:  0.059824228286743164
local_output_nid generation:  0.005205392837524414
local_in_edges_tensor generation:  0.005021095275878906
mini_batch_src_global generation:  0.005961894989013672
r_  generation:  0.05152130126953125
local_output_nid generation:  0.005041360855102539
local_in_edges_tensor generation:  0.004369258880615234
mini_batch_src_global generation:  0.005899906158447266
r_  generation:  0.05223965644836426
local_output_nid generation:  0.0048100948333740234
local_in_edges_tensor generation:  0.004140615463256836
mini_batch_src_global generation:  0.005461931228637695
r_  generation:  0.049628496170043945
local_output_nid generation:  0.00528717041015625
local_in_edges_tensor generation:  0.004458189010620117
mini_batch_src_global generation:  0.006018638610839844
r_  generation:  0.059538841247558594
local_output_nid generation:  0.005007743835449219
local_in_edges_tensor generation:  0.004216670989990234
mini_batch_src_global generation:  0.005110263824462891
r_  generation:  0.04782986640930176
local_output_nid generation:  0.005171775817871094
local_in_edges_tensor generation:  0.0049343109130859375
mini_batch_src_global generation:  0.006051063537597656
r_  generation:  0.05752062797546387
local_output_nid generation:  0.0021920204162597656
local_in_edges_tensor generation:  0.0018668174743652344
mini_batch_src_global generation:  0.0024127960205078125
r_  generation:  0.017076969146728516
local_output_nid generation:  0.0021538734436035156
local_in_edges_tensor generation:  0.0016622543334960938
mini_batch_src_global generation:  0.0012111663818359375
r_  generation:  0.013628482818603516
local_output_nid generation:  0.001969575881958008
local_in_edges_tensor generation:  0.0015170574188232422
mini_batch_src_global generation:  0.0012929439544677734
r_  generation:  0.015384674072265625
local_output_nid generation:  0.001682281494140625
local_in_edges_tensor generation:  0.0013575553894042969
mini_batch_src_global generation:  0.0011785030364990234
r_  generation:  0.013121366500854492
local_output_nid generation:  0.0019812583923339844
local_in_edges_tensor generation:  0.001535654067993164
mini_batch_src_global generation:  0.0011928081512451172
r_  generation:  0.01513981819152832
local_output_nid generation:  0.001855611801147461
local_in_edges_tensor generation:  0.0013976097106933594
mini_batch_src_global generation:  0.0011718273162841797
r_  generation:  0.01382756233215332
local_output_nid generation:  0.001976490020751953
local_in_edges_tensor generation:  0.0015637874603271484
mini_batch_src_global generation:  0.0013456344604492188
r_  generation:  0.017052650451660156
local_output_nid generation:  0.0019383430480957031
local_in_edges_tensor generation:  0.0015964508056640625
mini_batch_src_global generation:  0.0015099048614501953
r_  generation:  0.018684864044189453
local_output_nid generation:  0.0021736621856689453
local_in_edges_tensor generation:  0.0017971992492675781
mini_batch_src_global generation:  0.0015342235565185547
r_  generation:  0.01819324493408203
local_output_nid generation:  0.0021119117736816406
local_in_edges_tensor generation:  0.001682281494140625
mini_batch_src_global generation:  0.0014722347259521484
r_  generation:  0.01843547821044922
local_output_nid generation:  0.0018830299377441406
local_in_edges_tensor generation:  0.0015385150909423828
mini_batch_src_global generation:  0.001383066177368164
r_  generation:  0.015913724899291992
local_output_nid generation:  0.002333402633666992
local_in_edges_tensor generation:  0.0019135475158691406
mini_batch_src_global generation:  0.001592397689819336
r_  generation:  0.02165675163269043
local_output_nid generation:  0.0015866756439208984
local_in_edges_tensor generation:  0.0012297630310058594
mini_batch_src_global generation:  0.0013301372528076172
r_  generation:  0.010073184967041016
local_output_nid generation:  0.001535177230834961
local_in_edges_tensor generation:  0.0011746883392333984
mini_batch_src_global generation:  0.0010395050048828125
r_  generation:  0.009123802185058594
local_output_nid generation:  0.00152587890625
local_in_edges_tensor generation:  0.0012049674987792969
mini_batch_src_global generation:  0.0011076927185058594
r_  generation:  0.010220527648925781
local_output_nid generation:  0.0019130706787109375
local_in_edges_tensor generation:  0.001547098159790039
mini_batch_src_global generation:  0.0012574195861816406
r_  generation:  0.016266584396362305
----------------------check_connections_block total spend ----------------------------- 1.354203462600708
generate_one_block  0.04618668556213379
generate_one_block  0.047315359115600586
generate_one_block  0.022948503494262695
generate_one_block  0.03980302810668945
generate_one_block  0.03318524360656738
generate_one_block  0.01804804801940918
generate_one_block  0.02236771583557129
generate_one_block  0.0292661190032959
generate_one_block  0.08194637298583984
generate_one_block  0.08251690864562988
generate_one_block  0.07000398635864258
generate_one_block  0.0719912052154541
generate_one_block  0.06915545463562012
generate_one_block  0.07536077499389648
generate_one_block  0.0938873291015625
generate_one_block  0.08293414115905762
generate_one_block  0.021865367889404297
generate_one_block  0.017910003662109375
generate_one_block  0.020215272903442383
generate_one_block  0.01735687255859375
generate_one_block  0.02090764045715332
generate_one_block  0.01905679702758789
generate_one_block  0.022405147552490234
generate_one_block  0.025038480758666992
generate_one_block  0.024411439895629883
generate_one_block  0.024372100830078125
generate_one_block  0.021785259246826172
generate_one_block  0.028691530227661133
generate_one_block  0.015374898910522461
generate_one_block  0.012542724609375
generate_one_block  0.01349020004272461
generate_one_block  0.020482301712036133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02949666976928711  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

connection checking time:  1.354203462600708
block generation total time  1.2128229141235352
average batch blocks generation time:  0.037900716066360474
block dataloader generation time/epoch 23.06703472137451
pseudo mini batch 0 input nodes size: 32349
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02732086181640625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02732086181640625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04274606704711914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04276704788208008  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.026964664459228516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.027881145477294922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.027881145477294922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.027881145477294922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([32349, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.027881145477294922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([684, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07648897171020508  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07648897171020508  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 684, 128]), torch.Size([1, 684, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07714128494262695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08255195617675781  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 684, 128])
m.shape torch.Size([696, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08288955688476562  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08288955688476562  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 696, 128]), torch.Size([1, 696, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08355331420898438  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09350967407226562  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 696, 128])
m.shape torch.Size([605, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09404325485229492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09404325485229492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0946202278137207  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10741186141967773  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([617, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10830020904541016  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10830020904541016  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 617, 128]), torch.Size([1, 617, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10888862609863281  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1268167495727539  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 617, 128])
m.shape torch.Size([558, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1278529167175293  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1278529167175293  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12838506698608398  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14834070205688477  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([573, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14971399307250977  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14971399307250977  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 573, 128]), torch.Size([1, 573, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15026044845581055  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17453527450561523  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 573, 128])
m.shape torch.Size([510, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17596435546875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17596435546875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1764507293701172  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20076942443847656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([500, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20243358612060547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20243358612060547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2029104232788086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.23009014129638672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([457, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2318129539489746  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2318129539489746  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.23224878311157227  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.26014184951782227  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([7444, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.29541969299316406  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.29541969299316406  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 7444, 128]), torch.Size([1, 7444, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3025188446044922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8065586090087891  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 7444, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7617287635803223  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7737870216369629  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7858452796936035  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7736926078796387  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([12644, 256])
first layer input nodes number: 32349
first layer output nodes number: 12644
edges number: 98710
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7860884666442871  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7981467247009277  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8013567924499512  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8013567924499512  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([418, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8254985809326172  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8254985809326172  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8262958526611328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8332405090332031  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([342, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8334994316101074  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8334994316101074  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8341517448425293  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8461418151855469  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([240, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8465080261230469  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8465080261230469  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8469657897949219  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8570365905761719  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([188, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8575305938720703  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8575305938720703  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8578891754150391  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8682880401611328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([163, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8688921928405762  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8688921928405762  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8692030906677246  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8803954124450684  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([182, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8820319175720215  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8820319175720215  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8823790550231934  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.897305965423584  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8979802131652832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8979802131652832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8982205390930176  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9102368354797363  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9110088348388672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9110088348388672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9112300872802734  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9238414764404297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9245095252990723  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9245095252990723  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9246811866760254  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9356675148010254  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9362931251525879  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9362931251525879  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.936434268951416  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9464554786682129  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9471888542175293  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9471888542175293  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.947333812713623  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9586405754089355  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9592490196228027  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9592490196228027  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9593615531921387  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9689269065856934  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9694080352783203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9694080352783203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9694900512695312  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9770355224609375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9774789810180664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9774789810180664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9775476455688477  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9843454360961914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9848880767822266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9848880767822266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9849643707275391  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9930515289306641  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9935517311096191  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9935517311096191  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9936184883117676  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.001162052154541  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0016026496887207  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0016026496887207  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0016579627990723  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0082955360412598  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0088214874267578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0088214874267578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0088825225830078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0166339874267578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0172429084777832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0172429084777832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0173096656799316  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0262551307678223  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0266833305358887  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0266833305358887  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0267291069030762  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0331835746765137  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0336856842041016  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0336856842041016  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0337352752685547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0410747528076172  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0414729118347168  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0414729118347168  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.041511058807373  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0474238395690918  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0477147102355957  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0477147102355957  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.047741413116455  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0520672798156738  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0525846481323242  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.0525846481323242  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.052628517150879  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.060042381286621  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([336, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.068094253540039  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.068094253540039  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.068735122680664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1892127990722656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 336, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1680240631103516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1684365272521973  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.168848991394043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1684155464172363  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([2767, 40])
input nodes number: 12644
output nodes number: 2767
edges number: 24082
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1685280799865723  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1685290336608887  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02953195571899414  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

pseudo mini batch 1 input nodes size: 33589
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.026962757110595703  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.026962757110595703  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04297924041748047  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.043000221252441406  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.027554035186767578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02826070785522461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02826070785522461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02826070785522461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([33589, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02826070785522461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([902, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06677722930908203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06677722930908203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 902, 128]), torch.Size([1, 902, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06763744354248047  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07459306716918945  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 902, 128])
m.shape torch.Size([905, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07502603530883789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07502603530883789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07588911056518555  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08977031707763672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 905, 128])
m.shape torch.Size([782, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09045743942260742  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09045743942260742  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 782, 128]), torch.Size([1, 782, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09120321273803711  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10761022567749023  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 782, 128])
m.shape torch.Size([656, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10864591598510742  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10864591598510742  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10927152633666992  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12741422653198242  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([599, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12852954864501953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12852954864501953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12910079956054688  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14982843399047852  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([476, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15090465545654297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15090465545654297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 476, 128]), torch.Size([1, 476, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15135860443115234  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17087841033935547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 476, 128])
m.shape torch.Size([413, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17202997207641602  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17202997207641602  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 413, 128]), torch.Size([1, 413, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1724238395690918  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19211721420288086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 413, 128])
m.shape torch.Size([418, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19351482391357422  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19351482391357422  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 418, 128]), torch.Size([1, 418, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19391345977783203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.21663570404052734  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 418, 128])
m.shape torch.Size([369, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.21801996231079102  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.21801996231079102  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 369, 128]), torch.Size([1, 369, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.21837186813354492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.24089384078979492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 369, 128])
m.shape torch.Size([5469, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2667961120605469  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2667961120605469  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 5469, 128]), torch.Size([1, 5469, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2724113464355469  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6427221298217773  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 5469, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6080527305603027  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.618532657623291  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6290125846862793  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6184506416320801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([10989, 256])
first layer input nodes number: 33589
first layer output nodes number: 10989
edges number: 77779
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6292648315429688  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.639744758605957  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6423649787902832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6423649787902832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([593, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6593184471130371  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6593184471130371  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 593, 256]), torch.Size([1, 593, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6604495048522949  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6702418327331543  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 593, 256])
m.shape torch.Size([466, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6705722808837891  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6705722808837891  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6714611053466797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6859526634216309  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([342, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6867561340332031  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6867561340332031  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.687408447265625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7024288177490234  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([234, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7030024528503418  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7030024528503418  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7034487724304199  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7163920402526855  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7170534133911133  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7170534133911133  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7174043655395508  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7300386428833008  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([144, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7306938171386719  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7306938171386719  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7309684753417969  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7427787780761719  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([98, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7433009147644043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7433009147644043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7434878349304199  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7528338432312012  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([86, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7534017562866211  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7534017562866211  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.753565788269043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7629156112670898  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([75, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7634825706481934  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7634825706481934  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7636256217956543  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7727808952331543  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([58, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7732672691345215  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7732672691345215  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7733778953552246  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7812323570251465  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7818326950073242  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7818326950073242  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7819509506225586  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7911748886108398  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([36, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7915310859680176  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7915310859680176  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7915997505187988  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7974362373352051  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7977771759033203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7977771759033203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7978343963623047  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8030986785888672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8034067153930664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8034067153930664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8034543991088867  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8081750869750977  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8084831237792969  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8084831237792969  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8085269927978516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8131771087646484  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8134784698486328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8134784698486328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8135185241699219  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8180446624755859  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8184008598327637  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8184008598327637  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8184447288513184  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8237090110778809  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8239989280700684  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8239989280700684  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.824033260345459  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8283934593200684  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8286137580871582  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8286137580871582  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8286385536193848  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8319611549377441  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8322372436523438  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8322372436523438  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8322658538818359  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8362998962402344  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8366694450378418  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8366694450378418  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8367056846618652  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.842069149017334  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8423051834106445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8423051834106445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8423280715942383  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8458757400512695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8459973335266113  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8459973335266113  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8460087776184082  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.847862720489502  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8480648994445801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8480648994445801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8480820655822754  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8509831428527832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([168, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8550114631652832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8550114631652832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8553318977355957  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9117283821105957  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 168, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8979964256286621  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8984079360961914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8988194465637207  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8983869552612305  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([2760, 40])
input nodes number: 10989
output nodes number: 2760
edges number: 16914
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8984889984130859  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8984894752502441  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.029621124267578125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

pseudo mini batch 2 input nodes size: 18059
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.027553081512451172  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.027553081512451172  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.036164283752441406  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03618574142456055  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.020148277282714844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.020603179931640625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.020603179931640625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.020603179931640625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([18059, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.020603179931640625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([889, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.042685508728027344  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.042685508728027344  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 889, 128]), torch.Size([1, 889, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0435333251953125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.05101966857910156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 889, 128])
m.shape torch.Size([880, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.051434993743896484  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.051434993743896484  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 880, 128]), torch.Size([1, 880, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.052274227142333984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06486272811889648  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 880, 128])
m.shape torch.Size([774, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06611251831054688  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06611251831054688  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 774, 128]), torch.Size([1, 774, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06685066223144531  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08373832702636719  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 774, 128])
m.shape torch.Size([665, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08463764190673828  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08463764190673828  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08527183532714844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10398197174072266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 665, 128])
m.shape torch.Size([593, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10507869720458984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10507869720458984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10564422607421875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12633085250854492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([454, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12734699249267578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12734699249267578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 454, 128]), torch.Size([1, 454, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12777996063232422  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14639759063720703  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 454, 128])
m.shape torch.Size([391, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14748620986938477  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14748620986938477  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 391, 128]), torch.Size([1, 391, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1478590965270996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1665034294128418  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 391, 128])
m.shape torch.Size([369, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.167724609375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.167724609375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 369, 128]), torch.Size([1, 369, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1680765151977539  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18813514709472656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 369, 128])
m.shape torch.Size([279, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18915653228759766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18915653228759766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 279, 128]), torch.Size([1, 279, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.189422607421875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.206451416015625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 279, 128])
m.shape torch.Size([2260, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.21709489822387695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.21709489822387695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 2260, 128]), torch.Size([1, 2260, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.21925020217895508  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.37334489822387695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 2260, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.35552406311035156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3627281188964844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3699321746826172  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3626713752746582  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([7554, 256])
first layer input nodes number: 18059
first layer output nodes number: 7554
edges number: 44120
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3700690269470215  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3772730827331543  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3790740966796875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3790740966796875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([609, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3959236145019531  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3959236145019531  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 609, 256]), torch.Size([1, 609, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.39708518981933594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.40685462951660156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 609, 256])
m.shape torch.Size([445, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.40712928771972656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.40712928771972656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4079780578613281  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.42084360122680664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([352, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4214973449707031  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4214973449707031  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4221687316894531  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.43742942810058594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([265, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.43829965591430664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.43829965591430664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.43880510330200195  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.453463077545166  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([220, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4542679786682129  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4542679786682129  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.45468759536743164  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.46979379653930664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4704780578613281  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4704780578613281  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.47077369689941406  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4834861755371094  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4841728210449219  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4841728210449219  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4844093322753906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4962348937988281  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.49695491790771484  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.49695491790771484  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4971628189086914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5090131759643555  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5096101760864258  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5096101760864258  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5097646713256836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5196523666381836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([61, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5201616287231445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5201616287231445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5202779769897461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.528538703918457  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([44, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5289459228515625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5289459228515625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5290298461914062  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5355758666992188  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([45, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5360531806945801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5360531806945801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5361390113830566  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5434346199035645  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5439167022705078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5439167022705078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5439968109130859  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5513668060302734  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([27, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5516901016235352  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5516901016235352  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5517416000366211  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5568399429321289  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5571460723876953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5571460723876953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.55718994140625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5618400573730469  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.562218189239502  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.562218189239502  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5622677803039551  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5678715705871582  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.568173885345459  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.568173885345459  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5682120323181152  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5727896690368652  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5731339454650879  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5731339454650879  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.573173999786377  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5782608985900879  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5785880088806152  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5785880088806152  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5786242485046387  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5834803581237793  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5838661193847656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5838661193847656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5839061737060547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5895538330078125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5897154808044434  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5897154808044434  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5897326469421387  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5922732353210449  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5924339294433594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5924339294433594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5924491882324219  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5948143005371094  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5950722694396973  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5950722694396973  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.595095157623291  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5988030433654785  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.599022388458252  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.599022388458252  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5990414619445801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6022648811340332  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([119, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6051149368286133  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6051149368286133  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.605341911315918  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.645289421081543  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 119, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6318259239196777  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6322531700134277  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6326804161071777  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6322317123413086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([2867, 40])
input nodes number: 7554
output nodes number: 2867
edges number: 16788
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6323256492614746  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6323261260986328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02153778076171875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

pseudo mini batch 3 input nodes size: 36497
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.020164012908935547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.020164012908935547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.037567138671875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03758811950683594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.028955459594726562  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.029697418212890625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.029697418212890625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.029697418212890625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([36497, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.029697418212890625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([723, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06921577453613281  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06921577453613281  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 723, 128]), torch.Size([1, 723, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06990528106689453  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07617044448852539  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 723, 128])
m.shape torch.Size([796, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0765848159790039  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0765848159790039  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 796, 128]), torch.Size([1, 796, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07734394073486328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08969831466674805  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 796, 128])
m.shape torch.Size([722, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09035158157348633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09035158157348633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 722, 128]), torch.Size([1, 722, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09104013442993164  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10618829727172852  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 722, 128])
m.shape torch.Size([615, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10701704025268555  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10701704025268555  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 615, 128]), torch.Size([1, 615, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10760354995727539  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1255335807800293  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 615, 128])
m.shape torch.Size([635, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1267542839050293  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1267542839050293  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 635, 128]), torch.Size([1, 635, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12735986709594727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14931583404541016  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 635, 128])
m.shape torch.Size([525, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15051507949829102  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15051507949829102  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1510157585144043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17293024063110352  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([489, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17431211471557617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17431211471557617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17477846145629883  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19809579849243164  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([463, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1996288299560547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1996288299560547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20007038116455078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22523880004882812  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([416, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22680330276489258  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22680330276489258  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 416, 128]), torch.Size([1, 416, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22720003128051758  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2525906562805176  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 416, 128])
m.shape torch.Size([5589, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2797360420227051  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2797360420227051  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 5589, 128]), torch.Size([1, 5589, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.28507137298583984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6696391105651855  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 5589, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6339325904846191  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6443972587585449  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6548619270324707  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.644315242767334  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([10973, 256])
first layer input nodes number: 36497
first layer output nodes number: 10973
edges number: 80027
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6551361083984375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6656007766723633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6682658195495605  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6682658195495605  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([440, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.687467098236084  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.687467098236084  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6883063316345215  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6962885856628418  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([411, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6966590881347656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6966590881347656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6974430084228516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7102227210998535  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([318, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7107477188110352  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7107477188110352  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7113542556762695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7250776290893555  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7256278991699219  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7256278991699219  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7260513305664062  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7383308410644531  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([221, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7391815185546875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7391815185546875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7396030426025391  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7547779083251953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7555074691772461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7555074691772461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7558183670043945  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7691869735717773  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([122, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7698526382446289  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7698526382446289  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.770085334777832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7817201614379883  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7824344635009766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7824344635009766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7826404571533203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7943820953369141  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7950406074523926  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7950406074523926  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7952084541320801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8059506416320801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8065686225891113  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8065686225891113  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8067078590393066  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8165936470031738  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.817169189453125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.817169189453125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8172855377197266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8263607025146484  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8269834518432617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8269834518432617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8270959854125977  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8366613388061523  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8371052742004395  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8371052742004395  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.837181568145752  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.844200611114502  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8446202278137207  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8446202278137207  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8446850776672363  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8511052131652832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8516497611999512  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8516497611999512  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8517260551452637  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8598132133483887  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8602519035339355  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8602519035339355  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8603110313415527  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8669924736022949  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8674206733703613  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8674206733703613  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8674740791320801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8738827705383301  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8743062019348145  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8743062019348145  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8743557929992676  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8806538581848145  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8809762001037598  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8809762001037598  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8810124397277832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8858685493469238  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8861775398254395  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8861775398254395  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8862099647521973  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8907818794250488  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8912501335144043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8912501335144043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8912959098815918  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8980708122253418  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8982806205749512  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8982806205749512  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8983016014099121  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9015536308288574  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9017643928527832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9017643928527832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9017834663391113  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9048733711242676  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9050717353820801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9050717353820801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9050889015197754  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9079899787902832  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([187, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9134078025817871  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9134078025817871  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.913764476776123  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.976539134979248  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 187, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9613828659057617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9617948532104492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9622068405151367  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9617738723754883  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([2762, 40])
input nodes number: 10973
output nodes number: 2762
edges number: 19410
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9618616104125977  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.9618620872497559  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03111886978149414  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

pseudo mini batch 4 input nodes size: 29742
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.028940200805664062  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.028940200805664062  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.043122291564941406  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.043143272399902344  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.025719165802001953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.026351451873779297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.026351451873779297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.026351451873779297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([29742, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.026351451873779297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([774, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.05937004089355469  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.05937004089355469  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 774, 128]), torch.Size([1, 774, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.060108184814453125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06693363189697266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 774, 128])
m.shape torch.Size([887, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06741046905517578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06741046905517578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 887, 128]), torch.Size([1, 887, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.06825637817382812  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08094501495361328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 887, 128])
m.shape torch.Size([783, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08164215087890625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08164215087890625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 783, 128]), torch.Size([1, 783, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08238887786865234  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0991964340209961  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 783, 128])
m.shape torch.Size([665, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10054731369018555  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10054731369018555  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1011815071105957  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11957311630249023  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 665, 128])
m.shape torch.Size([681, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1208796501159668  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1208796501159668  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 681, 128]), torch.Size([1, 681, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12152910232543945  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14490938186645508  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 681, 128])
m.shape torch.Size([538, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14612388610839844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14612388610839844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 538, 128]), torch.Size([1, 538, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.146636962890625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.16923856735229492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 538, 128])
m.shape torch.Size([490, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17061758041381836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17061758041381836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17108488082885742  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19444990158081055  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([432, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19586420059204102  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19586420059204102  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 432, 128]), torch.Size([1, 432, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19627618789672852  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.21975946426391602  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 432, 128])
m.shape torch.Size([393, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22124004364013672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22124004364013672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 393, 128]), torch.Size([1, 393, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22161483764648438  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.24560165405273438  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 393, 128])
m.shape torch.Size([4203, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2654557228088379  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2654557228088379  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 4203, 128]), torch.Size([1, 4203, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.26946401596069336  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5540528297424316  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 4203, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5247745513916016  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5341644287109375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5443058013916016  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5348424911499023  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([9846, 256])
first layer input nodes number: 29742
first layer output nodes number: 9846
edges number: 66643
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5445294380187988  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5539193153381348  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5562667846679688  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5562667846679688  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([481, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5742835998535156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5742835998535156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5752010345458984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5829439163208008  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 481, 256])
m.shape torch.Size([425, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5833024978637695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5833024978637695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5841131210327148  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5970320701599121  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([328, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5975728034973145  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5975728034973145  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.598198413848877  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.613734245300293  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([238, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6143364906311035  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6143364906311035  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6147904396057129  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6279549598693848  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([226, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6292304992675781  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6292304992675781  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6296615600585938  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6451797485351562  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([171, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6459603309631348  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6459603309631348  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6462864875793457  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.660311222076416  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6610498428344727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6610498428344727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6613054275512695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6740846633911133  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6748180389404297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6748180389404297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6750316619873047  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6872081756591797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6879754066467285  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6879754066467285  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6881680488586426  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7004971504211426  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7012467384338379  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7012467384338379  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7014145851135254  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7133316993713379  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([50, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7137765884399414  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7137765884399414  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.713871955871582  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7213106155395508  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([45, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7217822074890137  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7217822074890137  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7218680381774902  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.729163646697998  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.729670524597168  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.729670524597168  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7297544479370117  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7374753952026367  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7379584312438965  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7379584312438965  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7380328178405762  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7453970909118652  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7457780838012695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7457780838012695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7458333969116211  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7516965866088867  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7520995140075684  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7520995140075684  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7521529197692871  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7581877708435059  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([14, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.758389949798584  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.758389949798584  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7584166526794434  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7616209983825684  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7619366645812988  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7619366645812988  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7619729042053223  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7665753364562988  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7670321464538574  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7670321464538574  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7670817375183105  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7737269401550293  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7739524841308594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7739524841308594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7739772796630859  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7774734497070312  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.777763843536377  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.777763843536377  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7777924537658691  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7820267677307129  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7821183204650879  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7821183204650879  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.782127857208252  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7836060523986816  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7838668823242188  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7838668823242188  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7838897705078125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.78759765625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7879095077514648  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7879095077514648  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7879362106323242  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7924489974975586  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([145, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7959198951721191  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7959198951721191  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.796196460723877  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.844871997833252  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 145, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8300395011901855  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8304572105407715  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8308749198913574  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8304362297058105  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([2802, 40])
input nodes number: 9846
output nodes number: 2802
edges number: 18133
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8305363655090332  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.8305368423461914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02759838104248047  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

pseudo mini batch 5 input nodes size: 13993
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02572488784790039  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02572488784790039  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03239727020263672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03241920471191406  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.01821613311767578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.018630027770996094  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.018630027770996094  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.018630027770996094  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([13993, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.018630027770996094  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([743, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03690290451049805  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03690290451049805  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 743, 128]), torch.Size([1, 743, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03761148452758789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04399394989013672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 743, 128])
m.shape torch.Size([753, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0443577766418457  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0443577766418457  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 753, 128]), torch.Size([1, 753, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04507589340209961  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0558476448059082  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 753, 128])
m.shape torch.Size([706, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.05678129196166992  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.05678129196166992  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 706, 128]), torch.Size([1, 706, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.057454586029052734  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07226705551147461  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 706, 128])
m.shape torch.Size([571, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07312440872192383  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07312440872192383  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0736689567565918  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08946084976196289  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([522, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09043312072753906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09043312072753906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09093093872070312  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1089324951171875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([431, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10991668701171875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10991668701171875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 431, 128]), torch.Size([1, 431, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11032772064208984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12800216674804688  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 431, 128])
m.shape torch.Size([342, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1289381980895996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1289381980895996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 342, 128]), torch.Size([1, 342, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12926435470581055  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14557218551635742  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 342, 128])
m.shape torch.Size([303, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14738225936889648  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14738225936889648  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 303, 128]), torch.Size([1, 303, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14767122268676758  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.16414213180541992  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 303, 128])
m.shape torch.Size([264, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.165130615234375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.165130615234375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.16538238525390625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18149566650390625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([1745, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18969058990478516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18969058990478516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 1745, 128]), torch.Size([1, 1745, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19135475158691406  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3096027374267578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 1745, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.29428625106811523  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3003706932067871  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.306455135345459  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3003230094909668  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([6380, 256])
first layer input nodes number: 13993
first layer output nodes number: 6380
edges number: 36491
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3065614700317383  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.31264591217041016  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3141670227050781  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3141670227050781  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([483, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3328695297241211  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3328695297241211  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 483, 256]), torch.Size([1, 483, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.33379077911376953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.34116077423095703  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 483, 256])
m.shape torch.Size([408, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.34148454666137695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.34148454666137695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.34226274490356445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.35457849502563477  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([344, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.35524463653564453  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.35524463653564453  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.35590076446533203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3711433410644531  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([267, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3718705177307129  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3718705177307129  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.37237977981567383  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.38772010803222656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([228, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3885612487792969  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3885612487792969  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3889961242675781  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4046516418457031  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([173, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.40543222427368164  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.40543222427368164  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4057621955871582  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4199509620666504  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.42072153091430664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.42072153091430664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4209866523742676  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.43424272537231445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4350099563598633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4350099563598633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.43523311614990234  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4479532241821289  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([104, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.44874143600463867  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.44874143600463867  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.44893980026245117  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.46163511276245117  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4623241424560547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4623241424560547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4624805450439453  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4735851287841797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([50, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.47403573989868164  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.47403573989868164  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.47413110733032227  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.481569766998291  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.48215675354003906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.48215675354003906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.48226165771484375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4911785125732422  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4918508529663086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4918508529663086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4919614791870117  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5021390914916992  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5027704238891602  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5027704238891602  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5028676986694336  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5124979019165039  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5129251480102539  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5129251480102539  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5129880905151367  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5196599960327148  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5200748443603516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5200748443603516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5201301574707031  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5263805389404297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5268268585205078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5268268585205078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5268821716308594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5335197448730469  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5339593887329102  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5339593887329102  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5340108871459961  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5405511856079102  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5409455299377441  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5409455299377441  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5409893989562988  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.546867847442627  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5471343994140625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5471343994140625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5471630096435547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5511970520019531  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5513443946838379  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5513443946838379  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5513596534729004  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5536179542541504  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5539064407348633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5539064407348633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5539331436157227  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5580720901489258  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.558258056640625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.558258056640625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5582752227783203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5610561370849609  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.561347484588623  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.561347484588623  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5613722801208496  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5655627250671387  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([130, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5686740875244141  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5686740875244141  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5689220428466797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6125621795654297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 130, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5971512794494629  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5975818634033203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5980124473571777  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.597559928894043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([2889, 40])
input nodes number: 6380
output nodes number: 2889
edges number: 18840
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5976424217224121  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5976428985595703  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.019478321075439453  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

pseudo mini batch 6 input nodes size: 16763
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.018229007720947266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.018229007720947266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02622222900390625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.026244163513183594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.019549846649169922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.019961833953857422  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.019961833953857422  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.019961833953857422  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([16763, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.019961833953857422  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([758, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03888225555419922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03888225555419922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 758, 128]), torch.Size([1, 758, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.039605140686035156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04544973373413086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 758, 128])
m.shape torch.Size([828, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.045877933502197266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.045877933502197266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 828, 128]), torch.Size([1, 828, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04666757583618164  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.058512210845947266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 828, 128])
m.shape torch.Size([703, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.059325218200683594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.059325218200683594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 703, 128]), torch.Size([1, 703, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.05999565124511719  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07515716552734375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 703, 128])
m.shape torch.Size([600, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07596635818481445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07596635818481445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0765385627746582  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09337091445922852  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 600, 128])
m.shape torch.Size([491, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09425544738769531  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09425544738769531  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09472370147705078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11158084869384766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([441, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11260843276977539  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11260843276977539  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 441, 128]), torch.Size([1, 441, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11302900314331055  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13111352920532227  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 441, 128])
m.shape torch.Size([365, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13212156295776367  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13212156295776367  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 365, 128]), torch.Size([1, 365, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13246965408325195  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14987421035766602  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 365, 128])
m.shape torch.Size([331, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15096282958984375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15096282958984375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 331, 128]), torch.Size([1, 331, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15127849578857422  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.16927146911621094  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 331, 128])
m.shape torch.Size([278, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17030668258666992  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17030668258666992  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 278, 128]), torch.Size([1, 278, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17057180404663086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18753957748413086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 278, 128])
m.shape torch.Size([1807, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19602346420288086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19602346420288086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 1807, 128]), torch.Size([1, 1807, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19774675369262695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3201003074645996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 1807, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.30423402786254883  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3105301856994629  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.31682634353637695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.31048059463500977  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([6602, 256])
first layer input nodes number: 16763
first layer output nodes number: 6602
edges number: 37799
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.316953182220459  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.32324934005737305  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3255476951599121  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3255476951599121  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([499, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.34279394149780273  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.34279394149780273  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 499, 256]), torch.Size([1, 499, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.34374570846557617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.35254430770874023  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 499, 256])
m.shape torch.Size([467, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.35296630859375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.35296630859375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.35385704040527344  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3689899444580078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([353, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3697962760925293  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3697962760925293  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3704695701599121  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3862590789794922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([276, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3879384994506836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3879384994506836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.38846492767333984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.40433216094970703  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([220, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.40512657165527344  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.40512657165527344  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4055461883544922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4206523895263672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([178, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.42146921157836914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.42146921157836914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.42180871963500977  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.43640756607055664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.43717336654663086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.43717336654663086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4374384880065918  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.45069456100463867  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([129, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4515542984008789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4515542984008789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4518003463745117  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.46582508087158203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([106, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.46661901473999023  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.46661901473999023  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.46682119369506836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.47976064682006836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.48047685623168945  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.48047685623168945  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4806389808654785  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.49214982986450195  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.49271392822265625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.49271392822265625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4928302764892578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5019054412841797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5024704933166504  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5024704933166504  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5025734901428223  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5113282203674316  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5118889808654785  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5118889808654785  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5119824409484863  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5205807685852051  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([33, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5209784507751465  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5209784507751465  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5210413932800293  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5272727012634277  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5276741981506348  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5276741981506348  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5277314186096191  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5337967872619629  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.534276008605957  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.534276008605957  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5343389511108398  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5414514541625977  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5418939590454102  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5418939590454102  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5419492721557617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5485868453979492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5488882064819336  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5488882064819336  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.548924446105957  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5535268783569336  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5538558959960938  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5538558959960938  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5538921356201172  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5587482452392578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5591340065002441  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5591340065002441  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5591740608215332  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.564821720123291  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5649833679199219  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5649833679199219  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5650005340576172  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5675411224365234  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5677018165588379  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5677018165588379  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5677170753479004  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5700821876525879  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5702075958251953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5702075958251953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5702190399169922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5720729827880859  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5721826553344727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5721826553344727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5721921920776367  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5738039016723633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([84, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5758175849914551  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5758175849914551  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5759778022766113  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6041760444641113  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 84, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5902910232543945  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5907249450683594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5911588668823242  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.590703010559082  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([2912, 40])
input nodes number: 6602
output nodes number: 2912
edges number: 17308
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5907778739929199  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5907783508300781  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.020813465118408203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

pseudo mini batch 7 input nodes size: 21425
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.019553184509277344  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.019553184509277344  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.029769420623779297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.029790401458740234  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.021775245666503906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02229022979736328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02229022979736328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02229022979736328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([21425, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.02229022979736328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([798, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04877424240112305  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04877424240112305  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 798, 128]), torch.Size([1, 798, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.049535274505615234  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.05603504180908203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 798, 128])
m.shape torch.Size([949, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.05655956268310547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.05655956268310547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 949, 128]), torch.Size([1, 949, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.057464599609375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07104015350341797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 949, 128])
m.shape torch.Size([811, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07187700271606445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07187700271606445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 811, 128]), torch.Size([1, 811, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.07265043258666992  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.08966588973999023  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 811, 128])
m.shape torch.Size([650, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09051895141601562  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09051895141601562  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.09113883972167969  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10976600646972656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 650, 128])
m.shape torch.Size([584, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11084842681884766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11084842681884766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 584, 128]), torch.Size([1, 584, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1114053726196289  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13175296783447266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 584, 128])
m.shape torch.Size([451, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1327648162841797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1327648162841797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1331949234008789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1516895294189453  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([409, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15283966064453125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15283966064453125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 409, 128]), torch.Size([1, 409, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1532297134399414  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17273235321044922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 409, 128])
m.shape torch.Size([381, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17399072647094727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17399072647094727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 381, 128]), torch.Size([1, 381, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.17435407638549805  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19506502151489258  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 381, 128])
m.shape torch.Size([307, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19620084762573242  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19620084762573242  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 307, 128]), torch.Size([1, 307, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.19649362564086914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.21523141860961914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 307, 128])
m.shape torch.Size([3051, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22963333129882812  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.22963333129882812  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 3051, 128]), torch.Size([1, 3051, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2325429916381836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.44593191146850586  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 3051, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4223055839538574  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.43030786514282227  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4383101463317871  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.43024492263793945  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([8391, 256])
first layer input nodes number: 21425
first layer output nodes number: 8391
edges number: 52539
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.43847179412841797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4464740753173828  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.44854736328125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.44854736328125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([494, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4649205207824707  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4649205207824707  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 494, 256]), torch.Size([1, 494, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4658627510070801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4735121726989746  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 494, 256])
m.shape torch.Size([490, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4739832878112793  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4739832878112793  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 490, 256]), torch.Size([1, 490, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4749178886413574  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4893527030944824  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 490, 256])
m.shape torch.Size([349, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4900636672973633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.4900636672973633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.49072933197021484  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5056848526000977  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([272, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5064940452575684  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5064940452575684  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5070128440856934  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5223298072814941  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5230703353881836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5230703353881836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5234670639038086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5377492904663086  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([139, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5383529663085938  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5383529663085938  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5386180877685547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.550018310546875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5506730079650879  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5506730079650879  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.550896167755127  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5620541572570801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5627269744873047  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5627269744873047  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5629215240478516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5740108489990234  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([74, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5745539665222168  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5745539665222168  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5746951103210449  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5837283134460449  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([64, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5842728614807129  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5842728614807129  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5843949317932129  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5930619239807129  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5936036109924316  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.5936036109924316  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.593712329864502  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6021924018859863  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([40, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6025996208190918  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6025996208190918  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6026759147644043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6091609001159668  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6096353530883789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6096353530883789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6097135543823242  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.616908073425293  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.617340087890625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.617340087890625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6174068450927734  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6240158081054688  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6244297027587891  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6244297027587891  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6244888305664062  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6307563781738281  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6311116218566895  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6311116218566895  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6311593055725098  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6365475654602051  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6368832588195801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6368832588195801  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.636925220489502  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.641960620880127  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6421647071838379  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6421647071838379  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6421895027160645  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6453385353088379  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.645545482635498  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.645545482635498  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6455683708190918  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6486353874206543  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6488742828369141  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6488742828369141  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6488990783691406  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6523952484130859  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6526656150817871  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6526656150817871  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6526923179626465  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.656644344329834  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6567583084106445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6567583084106445  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6567697525024414  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.658543586730957  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6587591171264648  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6587591171264648  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.658778190612793  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6618680953979492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6620893478393555  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6620893478393555  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6621084213256836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6653318405151367  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([120, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.668205738067627  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.668205738067627  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6684346199035645  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.7087178230285645  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 120, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6955108642578125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6959218978881836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6963329315185547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6959009170532227  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([2758, 40])
input nodes number: 8391
output nodes number: 2758
edges number: 16411
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6959619522094727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.6959624290466309  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.023285388946533203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

pseudo mini batch 8 input nodes size: 46945
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.021752357482910156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.021752357482910156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.04413747787475586  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.0441584587097168  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.033921241760253906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.035198211669921875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.035198211669921875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.035198211669921875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([46945, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.035198211669921875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([613, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10555124282836914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10555124282836914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.10613584518432617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11160850524902344  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([692, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11197614669799805  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11197614669799805  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 692, 128]), torch.Size([1, 692, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.11263608932495117  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12253522872924805  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 692, 128])
m.shape torch.Size([668, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12316083908081055  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12316083908081055  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 668, 128]), torch.Size([1, 668, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.12379789352416992  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13867902755737305  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 668, 128])
m.shape torch.Size([607, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13951826095581055  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.13951826095581055  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.14009714126586914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15700674057006836  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([649, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1582646369934082  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.1582646369934082  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 649, 128]), torch.Size([1, 649, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.15888357162475586  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18130207061767578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 649, 128])
m.shape torch.Size([567, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18261480331420898  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18261480331420898  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 567, 128]), torch.Size([1, 567, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.18315553665161133  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20668649673461914  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 567, 128])
m.shape torch.Size([553, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20826196670532227  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20826196670532227  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.20878934860229492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.23564720153808594  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([509, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.23732519149780273  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.23732519149780273  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.23781061172485352  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.26547956466674805  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([504, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.26739978790283203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.26739978790283203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 504, 128]), torch.Size([1, 504, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2678804397583008  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.2986421585083008  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 504, 128])
m.shape torch.Size([11778, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.35456371307373047  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.35456371307373047  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 11778, 128]), torch.Size([1, 11778, 128])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.3657960891723633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1837224960327148  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 11778, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.117732048034668  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.134078025817871  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1504240036010742  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1339502334594727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([17140, 256])
first layer input nodes number: 46945
first layer output nodes number: 17140
edges number: 143335
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1507759094238281  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1671218872070312  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.171316146850586  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.171316146850586  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([362, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1993374824523926  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.1993374824523926  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2000279426574707  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2057709693908691  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([302, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2060065269470215  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2060065269470215  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2065825462341309  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2161297798156738  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([233, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2165136337280273  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2165136337280273  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2169580459594727  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2267351150512695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([170, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2271666526794434  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2271666526794434  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2274909019470215  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.236894130706787  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([179, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2375922203063965  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2375922203063965  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.23793363571167  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2502245903015137  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([128, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2507920265197754  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2507920265197754  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2510361671447754  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2615342140197754  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([111, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2621593475341797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2621593475341797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2623710632324219  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2729568481445312  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([84, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2734971046447754  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2734971046447754  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2736573219299316  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.282789707183838  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.283444881439209  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.283444881439209  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.283607006072998  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.293982982635498  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2945747375488281  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.2945747375488281  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.294708251953125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3041877746582031  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.304840087890625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.304840087890625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3049697875976562  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3150863647460938  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3156790733337402  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3156790733337402  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3157877922058105  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.325028896331787  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3256120681762695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3256120681762695  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.325709342956543  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3346586227416992  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.335242748260498  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.335242748260498  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3353323936462402  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3442072868347168  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.344797134399414  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.344797134399414  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3448810577392578  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3537769317626953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3543500900268555  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3543500900268555  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.354426383972168  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3630475997924805  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3637123107910156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3637123107910156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3637943267822266  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.373636245727539  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3742008209228516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3742008209228516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.374267578125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3827457427978516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([42, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3834795951843262  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3834795951843262  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3835597038269043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.394294261932373  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3946194648742676  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3946194648742676  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.394655704498291  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.3997654914855957  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4001917839050293  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4001917839050293  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4002337455749512  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4064440727233887  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.406782627105713  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.406782627105713  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4068150520324707  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4118409156799316  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4122228622436523  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4122228622436523  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.412257194519043  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4178190231323242  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4182405471801758  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4182405471801758  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4182767868041992  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.4244012832641602  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([512, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.436685562133789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.436685562133789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 512, 256]), torch.Size([1, 512, 256])
----------------------------------------3
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.437662124633789  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.6197509765625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 512, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5944809913635254  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5948920249938965  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5953030586242676  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5948710441589355  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([2758, 40])
input nodes number: 17140
output nodes number: 2758
edges number: 28020
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.595019817352295  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 1.5950202941894531  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.037448883056640625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

pseudo mini batch 9 input nodes size: 49316
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.033921241760253906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.033921241760253906  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.05743694305419922  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.057457923889160156  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.035051822662353516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03657865524291992  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03657865524291992  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03657865524291992  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([49316, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4022216796875 GB
    Memory Allocated: 0.03657865524291992  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([594, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.12091636657714844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.12091636657714844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 594, 128]), torch.Size([1, 594, 128])
----------------------------------------3
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.12148284912109375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.1267566680908203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 594, 128])
m.shape torch.Size([641, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.12708473205566406  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.12708473205566406  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 641, 128]), torch.Size([1, 641, 128])
----------------------------------------3
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.12769603729248047  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.13686561584472656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 641, 128])
m.shape torch.Size([581, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.1373910903930664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.1373910903930664  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.13794517517089844  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.1508808135986328  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([550, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.15165281295776367  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.15165281295776367  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 550, 128]), torch.Size([1, 550, 128])
----------------------------------------3
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.1521773338317871  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.16811704635620117  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 550, 128])
m.shape torch.Size([569, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.16921138763427734  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.16921138763427734  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 569, 128]), torch.Size([1, 569, 128])
----------------------------------------3
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.1697540283203125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.18928909301757812  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 569, 128])
m.shape torch.Size([519, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.19050264358520508  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.19050264358520508  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 519, 128]), torch.Size([1, 519, 128])
----------------------------------------3
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.19099760055541992  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.21300029754638672  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 519, 128])
m.shape torch.Size([543, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.21456527709960938  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.21456527709960938  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.21508312225341797  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.2413620948791504  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([534, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.24314022064208984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.24314022064208984  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.24364948272705078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.27268505096435547  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([520, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.2746620178222656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.2746620178222656  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.2751579284667969  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.3075675964355469  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([14677, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.37763214111328125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.37763214111328125  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 14677, 128]), torch.Size([1, 14677, 128])
----------------------------------------3
 Nvidia-smi: 4.4842529296875 GB
    Memory Allocated: 0.3916292190551758  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3854217529296875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 14677, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3054213523864746  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3249526023864746  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3444838523864746  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3248052597045898  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

torch.Size([19728, 256])
first layer input nodes number: 49316
first layer output nodes number: 19728
edges number: 171301
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.344853401184082  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.364384651184082  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3699188232421875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3699188232421875  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

m.shape torch.Size([318, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.402559757232666  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.402559757232666  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4031662940979004  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.408287525177002  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([262, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4084882736206055  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4084882736206055  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4089879989624023  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4183034896850586  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([193, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4186105728149414  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4186105728149414  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4189786911010742  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.427077293395996  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([159, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.427504539489746  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.427504539489746  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4278078079223633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4366025924682617  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([127, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4370613098144531  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4370613098144531  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4373035430908203  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.446023941040039  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([114, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4465603828430176  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4465603828430176  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4467778205871582  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.456127643585205  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([89, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.456617832183838  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.456617832183838  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4567875862121582  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4652752876281738  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([76, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4657750129699707  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4657750129699707  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4659199714660645  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4741826057434082  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([70, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4747157096862793  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4747157096862793  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4748492240905762  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4833941459655762  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4840774536132812  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4840774536132812  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4842262268066406  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4947891235351562  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([53, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4952754974365234  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4952754974365234  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4953765869140625  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5032615661621094  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5037765502929688  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5037765502929688  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5038700103759766  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5118141174316406  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5123424530029297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5123424530029297  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.512430191040039  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5205020904541016  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5209293365478516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5209293365478516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.52099609375  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5276050567626953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5281920433044434  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5281920433044434  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5282740592956543  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5369677543640137  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([51, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5377111434936523  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5377111434936523  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5378084182739258  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5488004684448242  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5492911338806152  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5492911338806152  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.549354076385498  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5569071769714355  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5575504302978516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5575504302978516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5576248168945312  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5670719146728516  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5675463676452637  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5675463676452637  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5675997734069824  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.574756145477295  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.575364112854004  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.575364112854004  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5754270553588867  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5843019485473633  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5849366188049316  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5849366188049316  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5849995613098145  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5943150520324707  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5946011543273926  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5946011543273926  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5946297645568848  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5990643501281738  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5995807647705078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5995807647705078  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5996265411376953  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.6070423126220703  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.607619285583496  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.607619285583496  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.6076688766479492  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.6160497665405273  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([765, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.634406566619873  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.634406566619873  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

 h.shape torch.Size([1, 765, 256]), torch.Size([1, 765, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.6358656883239746  GigaBytes
Max Memory Allocated: 1.8748793601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.8938722610473633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 765, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.8637409210205078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.864152431488037  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.8645639419555664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.8641314506530762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2759, 40])
input nodes number: 19728
output nodes number: 2759
edges number: 33516
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.86430025100708  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.8643007278442383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.039197444915771484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 10 input nodes size: 42804
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.03505229949951172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.03505229949951172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.05546283721923828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.05548381805419922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.03194713592529297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.03331756591796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.03331756591796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.03331756591796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([42804, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.03331756591796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([539, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.10724449157714844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.10724449157714844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 539, 128]), torch.Size([1, 539, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.1077585220336914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.11214733123779297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 539, 128])
m.shape torch.Size([540, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.11240530014038086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.11240530014038086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.11292028427124023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.12161397933959961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([579, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.12218475341796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.12218475341796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.12273693084716797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.13567638397216797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([541, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.13643217086791992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.13643217086791992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 541, 128]), torch.Size([1, 541, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.1369481086730957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.1520228385925293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 541, 128])
m.shape torch.Size([518, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.1529998779296875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.1529998779296875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 518, 128]), torch.Size([1, 518, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.15349388122558594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.1712779998779297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 518, 128])
m.shape torch.Size([512, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.17249584197998047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.17249584197998047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.17298412322998047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.19398021697998047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([517, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.19546175003051758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.19546175003051758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.1959547996520996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.22159671783447266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([464, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.22312021255493164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.22312021255493164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.22356271743774414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.24878549575805664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([477, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.2506113052368164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.2506113052368164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 477, 128]), torch.Size([1, 477, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.2510662078857422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.2801799774169922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 477, 128])
m.shape torch.Size([12795, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.34096384048461914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.34096384048461914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 12795, 128]), torch.Size([1, 12795, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.3531661033630371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.219526767730713  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 12795, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.1495418548583984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.1662139892578125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.1828861236572266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.1660833358764648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([17482, 256])
first layer input nodes number: 42804
first layer output nodes number: 17482
edges number: 150756
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.1832070350646973  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.1998791694641113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2040472030639648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2040472030639648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([303, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.236236572265625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.236236572265625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2368144989013672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2416539192199707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([241, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.241828441619873  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.241828441619873  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2422881126403809  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.249183177947998  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([211, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2495617866516113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2495617866516113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2499642372131348  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2588181495666504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([187, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.259335994720459  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.259335994720459  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.259692668914795  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.270036220550537  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([128, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2704730033874512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2704730033874512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2707171440124512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2795062065124512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([123, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2800936698913574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2800936698913574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2803282737731934  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2904162406921387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([103, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.290992259979248  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.290992259979248  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2911887168884277  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.301011562347412  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([65, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3014135360717773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3014135360717773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3015375137329102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3086042404174805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([64, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.309095859527588  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.309095859527588  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.309217929840088  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.317030429840088  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([65, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3175945281982422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3175945281982422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.317718505859375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3265209197998047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3271465301513672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3271465301513672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3272705078125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3369407653808594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3375825881958008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3375825881958008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3376989364624023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3475885391235352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.348093032836914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.348093032836914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3481788635253906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3560752868652344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3565306663513184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3565306663513184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3566012382507324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3635878562927246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.364201545715332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.364201545715332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3642873764038086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3733854293823242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3740191459655762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3740191459655762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.37410306930542  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3835864067077637  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3841657638549805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3841657638549805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3842382431030273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3929357528686523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.393418788909912  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.393418788909912  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3934760093688965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.400743007659912  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.401371955871582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.401371955871582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4014406204223633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4106416702270508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4113574028015137  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4113574028015137  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4114317893981934  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4219202995300293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4223675727844238  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4223675727844238  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4224133491516113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4291882514953613  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.429609775543213  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.429609775543213  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.429649829864502  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4358582496643066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4363245964050293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4363245964050293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4363665580749512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.443164348602295  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4437203407287598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4437203407287598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.44376802444458  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.451826572418213  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([736, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4694876670837402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4694876670837402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 736, 256]), torch.Size([1, 736, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4708914756774902  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.7194323539733887  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 736, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.6898727416992188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.6902837753295898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.690694808959961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.690262794494629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2758, 40])
input nodes number: 17482
output nodes number: 2758
edges number: 33062
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.6904139518737793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.6904144287109375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.03567695617675781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 11 input nodes size: 40364
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.031946659088134766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.031946659088134766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.051477909088134766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.05149984359741211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.03106832504272461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.032544612884521484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.032544612884521484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.032544612884521484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([40364, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.032544612884521484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([383, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.11018800735473633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.11018800735473633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 383, 128]), torch.Size([1, 383, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.11055326461791992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.11347532272338867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 383, 128])
m.shape torch.Size([456, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.11372756958007812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.11372756958007812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.11416244506835938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.12068557739257812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([461, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.12112760543823242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.12112760543823242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.1215672492980957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.1312394142150879  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([471, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.13191795349121094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.13191795349121094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.13236713409423828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.14539337158203125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 471, 128])
m.shape torch.Size([469, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.1462869644165039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.1462869644165039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.14673423767089844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.16283607482910156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([463, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.16401386260986328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.16401386260986328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.16445541381835938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.1834421157836914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([472, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.18479681015014648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.18479681015014648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 472, 128]), torch.Size([1, 472, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.18524694442749023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.20775365829467773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 472, 128])
m.shape torch.Size([450, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.2092452049255371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.2092452049255371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 450, 128]), torch.Size([1, 450, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.20967435836791992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.23413610458374023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 450, 128])
m.shape torch.Size([493, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.2360372543334961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.2360372543334961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 493, 128]), torch.Size([1, 493, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.23650741577148438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.2665977478027344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 493, 128])
m.shape torch.Size([13753, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.33276891708374023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.33276891708374023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 13753, 128]), torch.Size([1, 13753, 128])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 0.3458847999572754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2776684761047363  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 13753, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2036867141723633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2207298278808594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2377729415893555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2205963134765625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([17871, 256])
first layer input nodes number: 40364
first layer output nodes number: 17871
edges number: 158556
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2380757331848145  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2551188468933105  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.259570598602295  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.259570598602295  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([218, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2978882789611816  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2978882789611816  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.2983040809631348  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3016304969787598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([201, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.301809310913086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.301809310913086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3021926879882812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.307943344116211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([183, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3082795143127441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3082795143127441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3086285591125488  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.316307544708252  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([138, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3166637420654297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3166637420654297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3169269561767578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3245601654052734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([127, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3250389099121094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3250389099121094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3252811431884766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3340015411376953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([102, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3344688415527344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3344688415527344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3346633911132812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3430290222167969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([94, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.343564510345459  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.343564510345459  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3437438011169434  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.352708339691162  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([73, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3531804084777832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3531804084777832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3533196449279785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3612561225891113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3620777130126953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3620777130126953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.362274169921875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.374847412109375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3756146430969238  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3756146430969238  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.375786304473877  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3879742622375488  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3886709213256836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3886709213256836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3888120651245117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.3998212814331055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([76, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.400627613067627  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.400627613067627  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4007725715637207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4130940437316895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([75, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.41395902633667  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.41395902633667  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4141020774841309  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.427262783050537  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([62, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.428025722503662  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.428025722503662  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4281439781188965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4398512840270996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([57, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4406142234802246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4406142234802246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.440722942352295  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.452247142791748  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([48, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4529309272766113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4529309272766113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4530224800109863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4633679389953613  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([48, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.464106559753418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.464106559753418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.464198112487793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.475184440612793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4761075973510742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4761075973510742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4762144088745117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4897794723510742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([59, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4908466339111328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4908466339111328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.4909591674804688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5060386657714844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.506943702697754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.506943702697754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5070390701293945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5204858779907227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([63, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5221543312072754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5221543312072754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5222744941711426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5400586128234863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([40, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.540844440460205  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.540844440460205  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5409207344055176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.552746295928955  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5534601211547852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5534601211547852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5535249710083008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.564030647277832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5649209022521973  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5649209022521973  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5649971961975098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5778908729553223  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([816, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5975360870361328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5975360870361328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 816, 256]), torch.Size([1, 816, 256])
----------------------------------------3
 Nvidia-smi: 4.9940185546875 GB
    Memory Allocated: 1.5990924835205078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0369873046875 GB
    Memory Allocated: 1.8815622329711914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 816, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0369873046875 GB
    Memory Allocated: 1.8463644981384277  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0369873046875 GB
    Memory Allocated: 1.8468008041381836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0369873046875 GB
    Memory Allocated: 1.8472371101379395  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0369873046875 GB
    Memory Allocated: 1.8467788696289062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2927, 40])
input nodes number: 17871
output nodes number: 2927
edges number: 39519
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0369873046875 GB
    Memory Allocated: 1.8469595909118652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0369873046875 GB
    Memory Allocated: 1.8469600677490234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03507518768310547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 12 input nodes size: 43168
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031093597412109375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031093597412109375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.051677703857421875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05169868469238281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03214550018310547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03350067138671875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03350067138671875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03350067138671875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([43168, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03350067138671875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([512, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10580062866210938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10580062866210938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10628890991210938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11019515991210938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([572, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11049652099609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11049652099609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11104202270507812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11989593505859375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([512, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12035560607910156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12035560607910156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12084388732910156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13158607482910156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([524, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1323413848876953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1323413848876953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1328411102294922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1476459503173828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 524, 128])
m.shape torch.Size([535, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14867162704467773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14867162704467773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14918184280395508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1677846908569336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([514, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16900014877319336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16900014877319336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 514, 128]), torch.Size([1, 514, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16949033737182617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19070196151733398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 514, 128])
m.shape torch.Size([530, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19222593307495117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19222593307495117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19273138046264648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2187943458557129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([530, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22056341171264648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22056341171264648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2210688591003418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25020360946655273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([564, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25237131118774414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25237131118774414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25290918350219727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28856706619262695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([12314, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3470158576965332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3470158576965332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 12314, 128]), torch.Size([1, 12314, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35875940322875977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1925511360168457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 12314, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1241979598999023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.140512466430664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1568269729614258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1403846740722656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([17107, 256])
first layer input nodes number: 43168
first layer output nodes number: 17107
edges number: 147213
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1571507453918457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1734652519226074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.177544116973877  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.177544116973877  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([304, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2110857963562012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2110857963562012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2116656303405762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2179784774780273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([250, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2181692123413086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2181692123413086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2186460494995117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2257986068725586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([183, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.226088047027588  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.226088047027588  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2264370918273926  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2341160774230957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([134, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.234457015991211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.234457015991211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2347126007080078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2421245574951172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([134, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2426409721374512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2426409721374512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.242896556854248  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2520976066589355  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([108, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2525930404663086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2525930404663086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2527990341186523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2616567611694336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([98, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2622132301330566  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2622132301330566  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2624001502990723  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2717461585998535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([82, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2722835540771484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2722835540771484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.272439956665039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2813549041748047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2819604873657227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2819604873657227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2821111679077148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2917547225952148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([63, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2922849655151367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2922849655151367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.292405128479004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3009366989135742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.30153226852417  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.30153226852417  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3016505241394043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3108744621276855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3115191459655762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3115191459655762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3116354942321777  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3215250968933105  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.322016716003418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.322016716003418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3221006393432617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3298215866088867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3304929733276367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3304929733276367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3305940628051758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.340601921081543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.341012954711914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.341012954711914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.341073989868164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.347543716430664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.347928524017334  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.347928524017334  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.34798002243042  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3537993431091309  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3543295860290527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3543295860290527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3543944358825684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3621764183044434  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([43, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3628883361816406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3628883361816406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3629703521728516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3733863830566406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3740944862365723  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3740944862365723  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3741726875305176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3846516609191895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3851509094238281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3851509094238281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3852043151855469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3927345275878906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3931922912597656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3931922912597656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3932380676269531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4000129699707031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4006247520446777  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4006247520446777  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.400681972503662  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4095511436462402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4099650382995605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4099650382995605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4100031852722168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4161829948425293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4168100357055664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4168100357055664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4168634414672852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.425889015197754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([798, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.445542335510254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.445542335510254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 798, 256]), torch.Size([1, 798, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4470643997192383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.724501609802246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 798, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6936287879943848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.694040298461914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6944518089294434  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6940193176269531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2760, 40])
input nodes number: 17107
output nodes number: 2760
edges number: 34467
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.694143295288086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6941437721252441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.035825252532958984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 13 input nodes size: 49053
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.032120704650878906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.032120704650878906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.055558204650878906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05557966232299805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03497457504272461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03638887405395508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03638887405395508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03638887405395508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([49053, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03638887405395508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([611, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11384344100952148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11384344100952148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 611, 128]), torch.Size([1, 611, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1144261360168457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11959695816040039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 611, 128])
m.shape torch.Size([716, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11998844146728516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11998844146728516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 716, 128]), torch.Size([1, 716, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12067127227783203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13091373443603516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 716, 128])
m.shape torch.Size([656, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13151073455810547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13151073455810547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13213634490966797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14645862579345703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([617, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1473226547241211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1473226547241211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 617, 128]), torch.Size([1, 617, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14791107177734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16525554656982422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 617, 128])
m.shape torch.Size([607, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16640853881835938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16640853881835938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16698741912841797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18839216232299805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([591, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18979358673095703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18979358673095703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 591, 128]), torch.Size([1, 591, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19035720825195312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21528053283691406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 591, 128])
m.shape torch.Size([622, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21707487106323242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21707487106323242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2176680564880371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24818658828735352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([560, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25002622604370117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25002622604370117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25056028366088867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2811884880065918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([620, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2835822105407715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2835822105407715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 620, 128]), torch.Size([1, 620, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28417348861694336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3227877616882324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 620, 128])
m.shape torch.Size([13041, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3849921226501465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3849921226501465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 13041, 128]), torch.Size([1, 13041, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3974289894104004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2969160079956055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 13041, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2230720520019531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.240849494934082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.258626937866211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2407102584838867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([18641, 256])
first layer input nodes number: 49053
first layer output nodes number: 18641
edges number: 157884
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2589945793151855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2767720222473145  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2812166213989258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2812166213989258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([345, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.312225341796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.312225341796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3128833770751953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3194608688354492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([309, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3197259902954102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3197259902954102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3203153610229492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3304414749145508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([222, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.330787181854248  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.330787181854248  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3312106132507324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3405261039733887  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([172, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3409757614135742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3409757614135742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.341303825378418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3508176803588867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([141, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3513317108154297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3513317108154297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3516006469726562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3612823486328125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([114, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3618054389953613  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3618054389953613  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.362022876739502  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3713726997375488  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([107, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3719840049743652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3719840049743652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3721880912780762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.382392406463623  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([71, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3828363418579102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3828363418579102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3829717636108398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.390690803527832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([71, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3912372589111328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3912372589111328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3913726806640625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4000396728515625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4006834030151367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4006834030151367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4008245468139648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4108457565307617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4115896224975586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4115896224975586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4117364883422852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.423192024230957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4238567352294922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4238567352294922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4239788055419922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4343547821044922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4350309371948242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4350309371948242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4351434707641602  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4454965591430664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.446126937866211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.446126937866211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4462242126464844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4558544158935547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.456498146057129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.456498146057129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.456589698791504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.466294288635254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([54, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4670791625976562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4670791625976562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4671821594238281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.47882080078125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4794883728027344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4794883728027344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4795722961425781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4896430969238281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([52, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4905009269714355  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4905009269714355  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4906001091003418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5031962394714355  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5036401748657227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5036401748657227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5036916732788086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5105924606323242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.511335849761963  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.511335849761963  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5114121437072754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.522169589996338  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([44, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.523019790649414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.523019790649414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5231037139892578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5355243682861328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.535905361175537  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.535905361175537  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5359435081481934  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.541856288909912  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.542412281036377  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.542412281036377  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.54246187210083  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5504956245422363  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5511398315429688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5511398315429688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5511951446533203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5605430603027344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([602, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.575235366821289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.575235366821289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 602, 256]), torch.Size([1, 602, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5763835906982422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.780064582824707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 602, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.7518353462219238  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.7522621154785156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.7526888847351074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.7522406578063965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2863, 40])
input nodes number: 18641
output nodes number: 2863
edges number: 31787
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.7524166107177734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.7524170875549316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03887176513671875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 14 input nodes size: 51956
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03498983383178711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03498983383178711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06038045883178711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06040143966674805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.036942481994628906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03807830810546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03807830810546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03807830810546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([51956, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03807830810546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([707, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10248899459838867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10248899459838867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 707, 128]), torch.Size([1, 707, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10316324234008789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10855722427368164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 707, 128])
m.shape torch.Size([811, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1089935302734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1089935302734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 811, 128]), torch.Size([1, 811, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10976696014404297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12171363830566406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 811, 128])
m.shape torch.Size([743, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1223897933959961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1223897933959961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 743, 128]), torch.Size([1, 743, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12309837341308594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1386871337890625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 743, 128])
m.shape torch.Size([765, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13979196548461914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13979196548461914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 765, 128]), torch.Size([1, 765, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14052152633666992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16228342056274414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 765, 128])
m.shape torch.Size([743, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16369009017944336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16369009017944336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 743, 128]), torch.Size([1, 743, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1643986701965332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19061946868896484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 743, 128])
m.shape torch.Size([624, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19205045700073242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19205045700073242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 624, 128]), torch.Size([1, 624, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19264554977416992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2184915542602539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 624, 128])
m.shape torch.Size([587, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2201533317565918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2201533317565918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 587, 128]), torch.Size([1, 587, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22071313858032227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24898719787597656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 587, 128])
m.shape torch.Size([598, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2509884834289551  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2509884834289551  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.251558780670166  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2846207618713379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([548, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28668737411499023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28668737411499023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28720998764038086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.32065725326538086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([10047, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3683037757873535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3683037757873535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 10047, 128]), torch.Size([1, 10047, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3778853416442871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.066643238067627  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 10047, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0070586204528809  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0224823951721191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0379061698913574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0223617553710938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([16173, 256])
first layer input nodes number: 51956
first layer output nodes number: 16173
edges number: 129372
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0382952690124512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0537190437316895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0579934120178223  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0579934120178223  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([407, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.080599308013916  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.080599308013916  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0813755989074707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0877957344055176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([378, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0881342887878418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0881342887878418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.088855266571045  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0997471809387207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([289, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1002202033996582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1002202033996582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.100771427154541  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1151375770568848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([238, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1157770156860352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1157770156860352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1162309646606445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1293954849243164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([216, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.13020658493042  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.13020658493042  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1306185722351074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1454501152038574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([136, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1460285186767578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1460285186767578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1462879180908203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1574420928955078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([101, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1579923629760742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1579923629760742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1581850051879883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1678171157836914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([96, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1684589385986328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1684589385986328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1686420440673828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1790790557861328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([74, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1796278953552246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1796278953552246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1797690391540527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1888022422790527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1895294189453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1895294189453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.189687728881836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.200927734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.201451301574707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.201451301574707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2015600204467773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2100400924682617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2105741500854492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2105741500854492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2106714248657227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2189397811889648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.219428539276123  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.219428539276123  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.219510555267334  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2270560264587402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2274456024169922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2274456024169922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2275066375732422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2335491180419922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2340235710144043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2340235710144043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2340903282165527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.241166591644287  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2415485382080078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2415485382080078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2416000366210938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2474193572998047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2478184700012207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2478184700012207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2478680610656738  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2538189888000488  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2542963027954102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2542963027954102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2543516159057617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2613763809204102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2618966102600098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2618966102600098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2619538307189941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2696213722229004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2700352668762207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2700352668762207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2700791358947754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2762646675109863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.276646614074707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.276646614074707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2766847610473633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2823305130004883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2827134132385254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2827134132385254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2827496528625488  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2883667945861816  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2887248992919922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2887248992919922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.28875732421875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2940101623535156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.294386386871338  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.294386386871338  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2944188117980957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.299898624420166  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([332, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3079581260681152  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3079581260681152  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.308591365814209  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4253520965576172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 332, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4056925773620605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4061064720153809  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4065203666687012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.40608549118042  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2776, 40])
input nodes number: 16173
output nodes number: 2776
edges number: 22983
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4062142372131348  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.406214714050293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04015398025512695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 15 input nodes size: 48642
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03692960739135742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03692960739135742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06036710739135742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06038808822631836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03497648239135742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03628110885620117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03628110885620117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03628110885620117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([48642, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03628110885620117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([682, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10867691040039062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10867691040039062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 682, 128]), torch.Size([1, 682, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10932731628417969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11453056335449219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 682, 128])
m.shape torch.Size([710, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1148824691772461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1148824691772461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 710, 128]), torch.Size([1, 710, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11555957794189453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1257162094116211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 710, 128])
m.shape torch.Size([729, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12702178955078125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12702178955078125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 729, 128]), torch.Size([1, 729, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1277170181274414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14301204681396484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 729, 128])
m.shape torch.Size([676, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14395380020141602  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14395380020141602  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 676, 128]), torch.Size([1, 676, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14459848403930664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16329431533813477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 676, 128])
m.shape torch.Size([602, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16440725326538086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16440725326538086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16498136520385742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18584489822387695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([599, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1872715950012207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1872715950012207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18784284591674805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2130122184753418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([521, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21446561813354492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21446561813354492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 521, 128]), torch.Size([1, 521, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21496248245239258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24096202850341797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 521, 128])
m.shape torch.Size([547, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24280023574829102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24280023574829102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24332189559936523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2739567756652832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([503, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.27585458755493164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.27585458755493164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 503, 128]), torch.Size([1, 503, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.276334285736084  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.307034969329834  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 503, 128])
m.shape torch.Size([12054, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3642730712890625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3642730712890625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 12054, 128]), torch.Size([1, 12054, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3759169578552246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2014765739440918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 12054, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1334834098815918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1502900123596191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1670966148376465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.150158405303955  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([17623, 256])
first layer input nodes number: 48642
first layer output nodes number: 17623
edges number: 146687
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1674613952636719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1842679977416992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1884698867797852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1884698867797852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([384, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2165164947509766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2165164947509766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2172489166259766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2255773544311523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([306, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.225799560546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.225799560546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2263832092285156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2352027893066406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([244, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2356147766113281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2356147766113281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2360801696777344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2463188171386719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([199, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2468514442443848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2468514442443848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2472310066223145  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2582383155822754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([161, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2588224411010742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2588224411010742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.259129524230957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2701845169067383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([118, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.270711898803711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.270711898803711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2709369659423828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2806148529052734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([85, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2810745239257812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2810745239257812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2812366485595703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2893428802490234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([78, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2898616790771484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2898616790771484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2900104522705078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2984905242919922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([77, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2990822792053223  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2990822792053223  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2992291450500488  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3086285591125488  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([54, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3090744018554688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3090744018554688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3091773986816406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3164901733398438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3170099258422852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3170099258422852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.317112922668457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3251466751098633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3258452415466309  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3258452415466309  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3259692192077637  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3365073204040527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.337082862854004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.337082862854004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3371801376342773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3461294174194336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3466863632202148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3466863632202148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3467721939086914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.355269432067871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3558177947998047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3558177947998047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.35589599609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3641853332519531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3646845817565918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3646845817565918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3647513389587402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3722949028015137  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3726863861083984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3726863861083984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3727359771728516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3786869049072266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3793025016784668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3793025016784668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3793730735778809  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3883357048034668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3887205123901367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3887205123901367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3887643814086914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3946428298950195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3952746391296387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3952746391296387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3953394889831543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4044833183288574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4049758911132812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4049758911132812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4050254821777344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4123649597167969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4129748344421387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4129748344421387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.413032054901123  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4219012260437012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4223814010620117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4223814010620117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4224252700805664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4295320510864258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4297871589660645  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4297871589660645  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4298100471496582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.433678150177002  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([551, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.446906566619873  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.446906566619873  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 551, 256]), torch.Size([1, 551, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4479575157165527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6415715217590332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 551, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6163487434387207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.61676025390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6171717643737793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.616739273071289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2759, 40])
input nodes number: 17623
output nodes number: 2759
edges number: 28354
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.616889476776123  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6168899536132812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.038584232330322266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 16 input nodes size: 13977
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.034974098205566406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.034974098205566406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.041638851165771484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.041660308837890625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018201828002929688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01873493194580078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01873493194580078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01873493194580078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([13977, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01873493194580078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([375, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.041131019592285156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.041131019592285156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 375, 128]), torch.Size([1, 375, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0414886474609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04434967041015625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 375, 128])
m.shape torch.Size([469, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04461812973022461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04461812973022461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04506540298461914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05177450180053711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([491, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05225324630737305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05225324630737305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.052721500396728516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06302309036254883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([476, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06369686126708984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06369686126708984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 476, 128]), torch.Size([1, 476, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06415081024169922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0773153305053711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 476, 128])
m.shape torch.Size([424, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07889413833618164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07889413833618164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 424, 128]), torch.Size([1, 424, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07929849624633789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09385538101196289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 424, 128])
m.shape torch.Size([377, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09473180770874023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09473180770874023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 377, 128]), torch.Size([1, 377, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09509134292602539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11055135726928711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 377, 128])
m.shape torch.Size([355, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1115565299987793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1115565299987793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 355, 128]), torch.Size([1, 355, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11189508438110352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12882280349731445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 355, 128])
m.shape torch.Size([350, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1299886703491211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1299886703491211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 350, 128]), torch.Size([1, 350, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13032245635986328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14934825897216797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 350, 128])
m.shape torch.Size([302, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15047740936279297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15047740936279297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 302, 128]), torch.Size([1, 302, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15076541900634766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16919803619384766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 302, 128])
m.shape torch.Size([2829, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1827259063720703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1827259063720703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 2829, 128]), torch.Size([1, 2829, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1861872673034668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3841977119445801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 2829, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3641653060913086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3703145980834961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3764638900756836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3702664375305176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([6448, 256])
first layer input nodes number: 13977
first layer output nodes number: 6448
edges number: 45365
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3765702247619629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3827195167541504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38425683975219727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38425683975219727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([253, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41021156311035156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41021156311035156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4106941223144531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4145545959472656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([273, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4148383140563965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4148383140563965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4153590202331543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4233999252319336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([261, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4238924980163574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4238924980163574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4243903160095215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4354681968688965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([229, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4361000061035156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4361000061035156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4365367889404297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4492034912109375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([195, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4499225616455078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4499225616455078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45029449462890625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46368408203125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([168, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46446704864501953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46446704864501953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46478748321533203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47856616973876953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([147, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47940587997436523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47940587997436523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47968626022338867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49370527267456055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([152, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4947338104248047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4947338104248047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4950237274169922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5115489959716797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([118, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5124249458312988  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5124249458312988  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5126500129699707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5270543098449707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([104, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5279417037963867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5279417037963867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5281400680541992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5422239303588867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([129, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5434889793395996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5434889793395996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5437350273132324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5629267692565918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([84, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5637726783752441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5637726783752441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5639328956604004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5775513648986816  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([87, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5785584449768066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5785584449768066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5787243843078613  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5939908027648926  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([61, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.594728946685791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.594728946685791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5948452949523926  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6063637733459473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([59, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6071562767028809  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6071562767028809  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6072688102722168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6191973686218262  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6199870109558105  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6199870109558105  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6200919151306152  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6319460868835449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.632596492767334  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.632596492767334  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6326785087585449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6425204277038574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([43, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.643223762512207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.643223762512207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.643305778503418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.653721809387207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6543021202087402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6543021202087402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6543669700622559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6630568504333496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6638703346252441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6638703346252441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6639542579650879  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6757874488830566  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6763510704040527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6763510704040527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6764082908630371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6848769187927246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6854195594787598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6854195594787598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6854710578918457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.693453311920166  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.69384765625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.69384765625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6938838958740234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6997547149658203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7002444267272949  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7002444267272949  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7002863883972168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7073779106140137  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([234, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.712979793548584  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.712979793548584  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7134261131286621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7919783592224121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 234, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7696700096130371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7700982093811035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7705264091491699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7700767517089844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2871, 40])
input nodes number: 6448
output nodes number: 2871
edges number: 26075
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7701630592346191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7701635360717773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019761085510253906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 17 input nodes size: 15210
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018218517303466797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018218517303466797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.025471210479736328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02549266815185547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01880645751953125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019186973571777344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019186973571777344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019186973571777344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([15210, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019186973571777344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([922, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03699302673339844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03699302673339844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 922, 128]), torch.Size([1, 922, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.037872314453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.045835018157958984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 922, 128])
m.shape torch.Size([935, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04628705978393555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04628705978393555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 935, 128]), torch.Size([1, 935, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04717874526977539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06055402755737305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 935, 128])
m.shape torch.Size([855, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06133127212524414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06133127212524414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 855, 128]), torch.Size([1, 855, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.062146663665771484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08035564422607422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 855, 128])
m.shape torch.Size([695, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08127355575561523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08127355575561523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 695, 128]), torch.Size([1, 695, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08193635940551758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10131978988647461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 695, 128])
m.shape torch.Size([544, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10228538513183594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10228538513183594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 544, 128]), torch.Size([1, 544, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10280418395996094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12221622467041016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 544, 128])
m.shape torch.Size([435, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12320137023925781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12320137023925781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12361621856689453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14145469665527344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([338, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14237546920776367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14237546920776367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 338, 128]), torch.Size([1, 338, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14269781112670898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1588149070739746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 338, 128])
m.shape torch.Size([295, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15977907180786133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15977907180786133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 295, 128]), torch.Size([1, 295, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16006040573120117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17609643936157227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 295, 128])
m.shape torch.Size([228, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17693424224853516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17693424224853516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 228, 128]), torch.Size([1, 228, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17715167999267578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19106769561767578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 228, 128])
m.shape torch.Size([1508, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1981496810913086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1981496810913086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 1508, 128]), torch.Size([1, 1508, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19958782196044922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3016958236694336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 1508, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28722095489501953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.29366302490234375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.30010509490966797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2936124801635742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([6755, 256])
first layer input nodes number: 15210
first layer output nodes number: 6755
edges number: 35325
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3002204895019531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.30666255950927734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3083009719848633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3083009719848633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([558, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3240213394165039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3240213394165039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 558, 256]), torch.Size([1, 558, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3250856399536133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.33403491973876953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 558, 256])
m.shape torch.Size([462, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.33439111709594727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.33439111709594727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.33527231216430664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3499479293823242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([388, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35097503662109375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35097503662109375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.351715087890625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3679962158203125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([291, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3689875602722168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3689875602722168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36954259872436523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38577699661254883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([229, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3866000175476074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3866000175476074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3870368003845215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40276098251342773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([167, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.403505802154541  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.403505802154541  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4038243293762207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41752099990844727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([91, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41797399520874023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41797399520874023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41814756393432617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42682600021362305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([94, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.427462100982666  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.427462100982666  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4276413917541504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43786096572875977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43851566314697266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43851566314697266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43867969512939453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44917774200439453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4497685432434082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4497685432434082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4499020576477051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4593815803527832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([49, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45983314514160156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45983314514160156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4599266052246094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46721649169921875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([41, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46764278411865234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46764278411865234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46772098541259766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4743680953979492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4748415946960449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4748415946960449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47491979598999023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.482114315032959  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48253297805786133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48253297805786133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48259782791137695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48901796340942383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48941850662231445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48941850662231445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48947572708129883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4955410957336426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4958357810974121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4958357810974121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49587583541870117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5004019737243652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5006437301635742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5006437301635742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5006742477416992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5043363571166992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5045981407165527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5045981407165527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5046286582946777  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5085043907165527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.508763313293457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.508763313293457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5087919235229492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5126256942749023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5128040313720703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5128040313720703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5128231048583984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5155124664306641  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5157251358032227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5157251358032227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5157461166381836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5188512802124023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5189046859741211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5189046859741211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5189104080200195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5197973251342773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.519993782043457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.519993782043457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5200109481811523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.522791862487793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5229678153991699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5229678153991699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5229830741882324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5255618095397949  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([91, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5277409553527832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5277409553527832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5279145240783691  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5584626197814941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 91, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5460629463195801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5464849472045898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5469069480895996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5464634895324707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2831, 40])
input nodes number: 6755
output nodes number: 2831
edges number: 15662
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5465292930603027  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5465297698974609  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019976139068603516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 18 input nodes size: 13550
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01880025863647461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01880025863647461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.025261402130126953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.025283336639404297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018009185791015625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018530845642089844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018530845642089844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018530845642089844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([13550, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018530845642089844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([341, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04037332534790039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04037332534790039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 341, 128]), torch.Size([1, 341, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04069852828979492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04330015182495117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 341, 128])
m.shape torch.Size([449, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04356575012207031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04356575012207031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 449, 128]), torch.Size([1, 449, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04399394989013672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05041694641113281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 449, 128])
m.shape torch.Size([444, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05083799362182617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05083799362182617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 444, 128]), torch.Size([1, 444, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05126142501831055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0605769157409668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 444, 128])
m.shape torch.Size([473, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06126737594604492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06126737594604492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06171846389770508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07480001449584961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([431, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07560205459594727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07560205459594727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 431, 128]), torch.Size([1, 431, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07601308822631836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09081029891967773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 431, 128])
m.shape torch.Size([425, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09190750122070312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09190750122070312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 425, 128]), torch.Size([1, 425, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09231281280517578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1097412109375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 425, 128])
m.shape torch.Size([362, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11074686050415039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11074686050415039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 362, 128]), torch.Size([1, 362, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11109209060668945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12835359573364258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 362, 128])
m.shape torch.Size([345, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12949705123901367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12949705123901367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 345, 128]), torch.Size([1, 345, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12982606887817383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14858007431030273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 345, 128])
m.shape torch.Size([257, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14951848983764648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14951848983764648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 257, 128]), torch.Size([1, 257, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1497635841369629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1654496192932129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 257, 128])
m.shape torch.Size([2749, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1789989471435547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1789989471435547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 2749, 128]), torch.Size([1, 2749, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18258237838745117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36871957778930664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 2749, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3499784469604492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35596370697021484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36194896697998047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35591650009155273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([6276, 256])
first layer input nodes number: 13550
first layer output nodes number: 6276
edges number: 44265
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36205196380615234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36803722381591797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3696126937866211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3696126937866211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([250, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39556264877319336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39556264877319336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3960394859313965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3998541831970215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([275, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4001445770263672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4001445770263672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4006690979003906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4093208312988281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([248, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4097738265991211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4097738265991211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4102468490600586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4206533432006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([241, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4213438034057617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4213438034057617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42180347442626953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4351339340209961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([229, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4360923767089844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4360923767089844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43652915954589844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4522533416748047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([220, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45330381393432617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45330381393432617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4537234306335449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47176694869995117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([179, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4733004570007324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4733004570007324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47364187240600586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49071264266967773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([142, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4917302131652832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4917302131652832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4920010566711426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.507439136505127  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([111, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5082640647888184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5082640647888184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5084757804870605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5220255851745605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([129, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5231599807739258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5231599807739258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5234060287475586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5408754348754883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([114, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5419578552246094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5419578552246094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.54217529296875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5591354370117188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([79, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5599379539489746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5599379539489746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5600886344909668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5728964805603027  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([71, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5737085342407227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5737085342407227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5738439559936523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5863027572631836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([75, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5874228477478027  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5874228477478027  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5875658988952637  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6017279624938965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.602262020111084  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.602262020111084  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6023421287536621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6108336448669434  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6115627288818359  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6115627288818359  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6116580963134766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6224346160888672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([58, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6233348846435547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6233348846435547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6234455108642578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6367206573486328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6373400688171387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6373400688171387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6374144554138184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6468615531921387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6472811698913574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6472811698913574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6473288536071777  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6537184715270996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([41, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6544828414916992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6544828414916992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6545610427856445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6655874252319336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6661744117736816  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6661744117736816  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6662335395812988  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6749844551086426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6754627227783203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6754627227783203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6755084991455078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6826038360595703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6830234527587891  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6830234527587891  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6830615997314453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6892414093017578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6897759437561035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6897759437561035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.689821720123291  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6975579261779785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([209, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7025570869445801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7025570869445801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7029557228088379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7731156349182129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 209, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7502436637878418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7506799697875977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7511162757873535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7506580352783203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2926, 40])
input nodes number: 6276
output nodes number: 2926
edges number: 25679
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7507414817810059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7507419586181641  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019534587860107422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 19 input nodes size: 11344
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01802349090576172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01802349090576172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02343273162841797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.023454666137695312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.016971588134765625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.017425537109375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.017425537109375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.017425537109375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([11344, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.017425537109375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([519, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03565216064453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03565216064453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 519, 128]), torch.Size([1, 519, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.036147117614746094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04098844528198242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 519, 128])
m.shape torch.Size([571, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04128551483154297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04128551483154297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04183006286621094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04999828338623047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([530, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05048418045043945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05048418045043945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.050989627838134766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06211423873901367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([492, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06279993057250977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06279993057250977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 492, 128]), torch.Size([1, 492, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06326913833618164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07687616348266602  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 492, 128])
m.shape torch.Size([377, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07754039764404297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07754039764404297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 377, 128]), torch.Size([1, 377, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07789993286132812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09084320068359375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 377, 128])
m.shape torch.Size([385, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09176492691040039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09176492691040039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 385, 128]), torch.Size([1, 385, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0921320915222168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10792016983032227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 385, 128])
m.shape torch.Size([302, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10874462127685547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10874462127685547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 302, 128]), torch.Size([1, 302, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10903263092041016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12343311309814453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 302, 128])
m.shape torch.Size([269, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12431526184082031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12431526184082031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 269, 128]), torch.Size([1, 269, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1245718002319336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13919448852539062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 269, 128])
m.shape torch.Size([249, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1404261589050293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1404261589050293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 249, 128]), torch.Size([1, 249, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14066362380981445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15586137771606445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 249, 128])
m.shape torch.Size([2074, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1656322479248047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1656322479248047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 2074, 128]), torch.Size([1, 2074, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16761016845703125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3132295608520508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 2074, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.29665327072143555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3021540641784668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.30765485763549805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3021106719970703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([5768, 256])
first layer input nodes number: 11344
first layer output nodes number: 5768
edges number: 36661
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.307741641998291  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.31324243545532227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3149724006652832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3149724006652832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([351, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3390541076660156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3390541076660156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3397235870361328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34563636779785156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([347, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34596872329711914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34596872329711914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3466305732727051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35655832290649414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([282, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3570408821105957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3570408821105957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35757875442504883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3695211410522461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([247, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37020206451416016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37020206451416016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37067317962646484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3843355178833008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3850564956665039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3850564956665039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3854360580444336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39910030364990234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([170, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3998908996582031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3998908996582031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40021514892578125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4141578674316406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([149, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41506433486938477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41506433486938477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41534852981567383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42955827713012695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43027734756469727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43027734756469727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43049097061157227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44266748428344727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([118, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44358158111572266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44358158111572266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44380664825439453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45821094512939453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([97, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4590311050415039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4590311050415039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4592161178588867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4723520278930664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4730105400085449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4730105400085449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4731459617614746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48370885848999023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([92, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48470258712768555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48470258712768555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4848780632019043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49979352951049805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5004429817199707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5004429817199707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5005555152893066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5109086036682129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5115656852722168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5115656852722168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5116667747497559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.521674633026123  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5222296714782715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5222296714782715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5223097801208496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5308012962341309  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5312843322753906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5312843322753906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5313491821289062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5386772155761719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5393147468566895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5393147468566895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5393929481506348  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5487771034240723  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.549412727355957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.549412727355957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5494871139526367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.558934211730957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5594997406005859  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5594997406005859  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5595626831054688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5679969787597656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5683884620666504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5683884620666504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5684304237365723  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5743470191955566  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5749921798706055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5749921798706055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5750551223754883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5843706130981445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5847835540771484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5847835540771484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5848236083984375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5910320281982422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.591609001159668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.591609001159668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5916604995727539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6000032424926758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.600346565246582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.600346565246582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.600377082824707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.605534553527832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([243, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6113581657409668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6113581657409668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6118216514587402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6933951377868652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 243, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6727204322814941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6731524467468262  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6735844612121582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6731305122375488  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2898, 40])
input nodes number: 5768
output nodes number: 2898
edges number: 24134
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6731915473937988  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.673192024230957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018303871154785156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 20 input nodes size: 15212
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.016967296600341797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.016967296600341797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.024220943450927734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.024242401123046875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01881122589111328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01927947998046875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01927947998046875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01927947998046875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([15212, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01927947998046875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([678, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04055452346801758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04055452346801758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 678, 128]), torch.Size([1, 678, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.041201114654541016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04685497283935547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 678, 128])
m.shape torch.Size([707, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04720592498779297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04720592498779297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 707, 128]), torch.Size([1, 707, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04788017272949219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05799388885498047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 707, 128])
m.shape torch.Size([641, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05857372283935547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05857372283935547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 641, 128]), torch.Size([1, 641, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.059185028076171875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07263374328613281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 641, 128])
m.shape torch.Size([562, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07340764999389648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07340764999389648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0739436149597168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08948659896850586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([474, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09034872055053711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09034872055053711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09080076217651367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10707426071166992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([387, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1079554557800293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1079554557800293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 387, 128]), torch.Size([1, 387, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10832452774047852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12419462203979492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 387, 128])
m.shape torch.Size([347, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12599563598632812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12599563598632812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 347, 128]), torch.Size([1, 347, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1263265609741211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14287281036376953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 347, 128])
m.shape torch.Size([300, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14385175704956055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14385175704956055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 300, 128]), torch.Size([1, 300, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14413785934448242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1604456901550293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 300, 128])
m.shape torch.Size([235, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16137075424194336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16137075424194336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 235, 128]), torch.Size([1, 235, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16159486770629883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17593812942504883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 235, 128])
m.shape torch.Size([2482, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18766117095947266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18766117095947266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 2482, 128]), torch.Size([1, 2482, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19002819061279297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3634815216064453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 2482, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34504127502441406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35153865814208984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3580360412597656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3514876365661621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([6813, 256])
first layer input nodes number: 15212
first layer output nodes number: 6813
edges number: 42719
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3581514358520508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3646879196166992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3667292594909668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3667292594909668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([495, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38701438903808594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38701438903808594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 495, 256]), torch.Size([1, 495, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3879585266113281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39600563049316406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 495, 256])
m.shape torch.Size([410, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39632177352905273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39632177352905273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39710378646850586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40883398056030273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([338, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40941762924194336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40941762924194336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.410062313079834  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42470645904541016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([229, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.425264835357666  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.425264835357666  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4257016181945801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4383683204650879  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([201, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4391160011291504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4391160011291504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4394993782043457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45330095291137695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4540262222290039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4540262222290039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4543294906616211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46737003326416016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4680662155151367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4680662155151367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4683065414428711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48032283782958984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([87, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48087167739868164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48087167739868164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48103761672973633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4904961585998535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([74, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49105358123779297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49105358123779297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4911947250366211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5002279281616211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5008206367492676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5008206367492676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5009522438049316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5102963447570801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5109601020812988  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5109601020812988  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5110917091369629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5213570594787598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5218219757080078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5218219757080078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5219097137451172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5293674468994141  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5298986434936523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5298986434936523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5299863815307617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5380582809448242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5385260581970215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5385260581970215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5385985374450684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.545773983001709  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5463724136352539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5463724136352539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5464563369750977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5553522109985352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5557255744934082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5557255744934082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5557770729064941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5615963935852051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.562044620513916  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.562044620513916  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5620999336242676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5687375068664551  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5691251754760742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5691251754760742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5691709518432617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5749845504760742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5755095481872559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5755095481872559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5755667686462402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5832343101501465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5837440490722656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5837440490722656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5837974548339844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5913276672363281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5916848182678223  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5916848182678223  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5917210578918457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5970845222473145  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.597383975982666  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.597383975982666  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5974125862121582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6018471717834473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6020541191101074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6020541191101074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6020731925964355  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6051630973815918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6054534912109375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6054534912109375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6054782867431641  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6096687316894531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([202, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6145100593566895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6145100593566895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6148953437805176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6827054023742676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 202, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6656041145324707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6660256385803223  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6664471626281738  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6660041809082031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2828, 40])
input nodes number: 6813
output nodes number: 2828
edges number: 20047
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6660661697387695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6660666465759277  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020186424255371094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 21 input nodes size: 15191
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018800735473632812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018800735473632812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.026044368743896484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.026065826416015625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018790721893310547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019196033477783203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019196033477783203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019196033477783203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([15191, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019196033477783203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([917, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03801393508911133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03801393508911133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 917, 128]), torch.Size([1, 917, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03888845443725586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04588460922241211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 917, 128])
m.shape torch.Size([854, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04626178741455078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04626178741455078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 854, 128]), torch.Size([1, 854, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04707622528076172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05934906005859375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 854, 128])
m.shape torch.Size([708, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06012296676635742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06012296676635742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 708, 128]), torch.Size([1, 708, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06079816818237305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07577848434448242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 708, 128])
m.shape torch.Size([575, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0765376091003418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0765376091003418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07708597183227539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0937037467956543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([470, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09455013275146484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09455013275146484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 470, 128]), torch.Size([1, 470, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09499835968017578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11113452911376953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 470, 128])
m.shape torch.Size([357, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11193180084228516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11193180084228516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 357, 128]), torch.Size([1, 357, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11227226257324219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12691211700439453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 357, 128])
m.shape torch.Size([291, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12771320343017578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12771320343017578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 291, 128]), torch.Size([1, 291, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12799072265625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14186668395996094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 291, 128])
m.shape torch.Size([277, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14278459548950195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14278459548950195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 277, 128]), torch.Size([1, 277, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14304876327514648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15810632705688477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 277, 128])
m.shape torch.Size([218, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15890979766845703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15890979766845703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 218, 128]), torch.Size([1, 218, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1591176986694336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1724233627319336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 218, 128])
m.shape torch.Size([1967, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18169879913330078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18169879913330078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 1967, 128]), torch.Size([1, 1967, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18357467651367188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.32062435150146484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 1967, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3048725128173828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3111991882324219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.31752586364746094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.31114959716796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([6634, 256])
first layer input nodes number: 15191
first layer output nodes number: 6634
edges number: 37426
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3176412582397461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.32396793365478516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.32610082626342773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.32610082626342773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([636, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34300851821899414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34300851821899414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 636, 256]), torch.Size([1, 636, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3442215919494629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3542666435241699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 636, 256])
m.shape torch.Size([490, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3546023368835449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3546023368835449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 490, 256]), torch.Size([1, 490, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35553693771362305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37027502059936523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 490, 256])
m.shape torch.Size([353, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3708791732788086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3708791732788086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3715524673461914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3866143226623535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([256, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38726186752319336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38726186752319336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38775014877319336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40191030502319336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([196, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40260839462280273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40260839462280273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.402982234954834  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.416440486907959  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([133, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4170207977294922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4170207977294922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41727447509765625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42818260192871094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([96, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42870187759399414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42870187759399414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42888498306274414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43804025650024414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([103, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43874073028564453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43874073028564453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4389371871948242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4501352310180664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([78, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.450711727142334  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.450711727142334  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45086050033569336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46038198471069336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([60, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46088457107543945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46088457107543945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4609990119934082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46912431716918945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([42, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4695115089416504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4695115089416504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4695916175842285  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47584009170532227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([43, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47629642486572266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47629642486572266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4763784408569336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4833498001098633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([31, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48369646072387695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48369646072387695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48375558853149414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4891953468322754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([20, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48943519592285156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48943519592285156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4894733428955078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49324989318847656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49349069595336914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49349069595336914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49352502822875977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.497164249420166  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4974856376647949  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4974856376647949  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4975275993347168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5022692680358887  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.50262451171875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.50262451171875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5026683807373047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5079326629638672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5082049369812012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5082049369812012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.508237361907959  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5123553276062012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5126862525939941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5126862525939941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5127224922180176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5175786018371582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5178298950195312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5178298950195312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5178565979003906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5216217041015625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5218505859375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5218505859375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5218734741210938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5252609252929688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5253767967224121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5253767967224121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.525388240814209  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5271620750427246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5274438858032227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5274438858032227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5274686813354492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5314855575561523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5316576957702637  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5316576957702637  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5316729545593262  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5342516899108887  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([162, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5387721061706543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5387721061706543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5390810966491699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5934634208679199  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 162, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5799112319946289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5803360939025879  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5807609558105469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5803146362304688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2851, 40])
input nodes number: 6634
output nodes number: 2851
edges number: 16821
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5803890228271484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5803894996643066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020025253295898438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 22 input nodes size: 14939
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01879405975341797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01879405975341797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.025917530059814453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02593851089477539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018673419952392578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019215106964111328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019215106964111328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019215106964111328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([14939, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019215106964111328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([558, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04362916946411133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04362916946411133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.044161319732666016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.049243927001953125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([603, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04955291748046875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04955291748046875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 603, 128]), torch.Size([1, 603, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05012798309326172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0597233772277832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 603, 128])
m.shape torch.Size([604, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06029987335205078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06029987335205078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 604, 128]), torch.Size([1, 604, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.060875892639160156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0735483169555664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 604, 128])
m.shape torch.Size([528, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07426738739013672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07426738739013672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07477092742919922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08937358856201172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([500, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09031391143798828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09031391143798828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0907907485961914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1079568862915039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([431, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10895156860351562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10895156860351562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 431, 128]), torch.Size([1, 431, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10936260223388672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12703704833984375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 431, 128])
m.shape torch.Size([389, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1281299591064453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1281299591064453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 389, 128]), torch.Size([1, 389, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12850093841552734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1470499038696289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 389, 128])
m.shape torch.Size([329, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14842796325683594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14842796325683594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 329, 128]), torch.Size([1, 329, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1487417221069336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1666259765625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 329, 128])
m.shape torch.Size([294, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16773080825805664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16773080825805664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 294, 128]), torch.Size([1, 294, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16801118850708008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18595552444458008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 294, 128])
m.shape torch.Size([3051, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2003636360168457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2003636360168457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 3051, 128]), torch.Size([1, 3051, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2040848731994629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4168553352355957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 3051, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3952312469482422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40218067169189453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4091300964355469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4021263122558594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([7287, 256])
first layer input nodes number: 14939
first layer output nodes number: 7287
edges number: 49285
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4092435836791992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41619300842285156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4183506965637207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4183506965637207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([370, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4411277770996094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4411277770996094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44183349609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44813108444213867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([336, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4484243392944336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4484243392944336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4490652084350586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4587106704711914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([264, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4591517448425293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4591517448425293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4596552848815918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47242116928100586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([239, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47308826446533203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47308826446533203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4735441207885742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48676395416259766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([211, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4875502586364746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4875502586364746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48795270919799805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5024409294128418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5031914710998535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5031914710998535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5035061836242676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5170388221740723  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([148, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5178947448730469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5178947448730469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5181770324707031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5322914123535156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5330653190612793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5330653190612793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.533292293548584  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5462298393249512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([109, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5470595359802246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5470595359802246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5472674369812012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5605731010437012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5613245964050293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5613245964050293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5614943504333496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5735468864440918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5742025375366211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5742025375366211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.574336051940918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5847501754760742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5853757858276367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5853757858276367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5854902267456055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5952177047729492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5957980155944824  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5957980155944824  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5958952903747559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6048445701599121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([55, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6055364608764648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6055364608764648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6056413650512695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6160268783569336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6165370941162109  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6165370941162109  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6166114807128906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6244964599609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([19, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6247515678405762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6247515678405762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6247878074645996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.628882884979248  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.629453182220459  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.629453182220459  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6295218467712402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6377615928649902  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.638211727142334  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.638211727142334  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6382651329040527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.645047664642334  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6454777717590332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6454777717590332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6455254554748535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6519150733947754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6524491310119629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6524491310119629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6525044441223145  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6603035926818848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6607809066772461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6607809066772461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6608285903930664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6678857803344727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6682639122009277  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6682639122009277  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6683001518249512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.673917293548584  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.674252986907959  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.674252986907959  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.674283504486084  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.679227352142334  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.679558277130127  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.679558277130127  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6795868873596191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6844220161437988  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([274, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6909918785095215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6909918785095215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6915144920349121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7872633934020996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 274, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7674875259399414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.767906665802002  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7683258056640625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.767885684967041  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2811, 40])
input nodes number: 7287
output nodes number: 2811
edges number: 23198
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7679553031921387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7679557800292969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020230770111083984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 23 input nodes size: 15127
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01866769790649414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01866769790649414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.025880813598632812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.025902748107910156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018758296966552734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019370555877685547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019370555877685547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019370555877685547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([15127, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019370555877685547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([443, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.047631263732910156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.047631263732910156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 443, 128]), torch.Size([1, 443, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.048053741455078125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.051433563232421875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 443, 128])
m.shape torch.Size([508, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.051706790924072266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.051706790924072266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 508, 128]), torch.Size([1, 508, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05219125747680664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.059458255767822266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 508, 128])
m.shape torch.Size([534, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.059979915618896484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.059979915618896484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06048917770385742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07204055786132812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([459, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0726613998413086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0726613998413086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 459, 128]), torch.Size([1, 459, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07309913635253906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08579349517822266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 459, 128])
m.shape torch.Size([464, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08668088912963867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08668088912963867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08712339401245117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10305356979370117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([413, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10401391983032227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10401391983032227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 413, 128]), torch.Size([1, 413, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10440778732299805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12134408950805664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 413, 128])
m.shape torch.Size([391, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1224522590637207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1224522590637207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 391, 128]), torch.Size([1, 391, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12282514572143555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14146947860717773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 391, 128])
m.shape torch.Size([380, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1427326202392578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1427326202392578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 380, 128]), torch.Size([1, 380, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1430950164794922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16375160217285156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 380, 128])
m.shape torch.Size([326, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16496944427490234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16496944427490234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 326, 128]), torch.Size([1, 326, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16528034210205078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18517780303955078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 326, 128])
m.shape torch.Size([3703, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.20267963409423828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.20267963409423828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 3703, 128]), torch.Size([1, 3703, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.20631933212280273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4584536552429199  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 3703, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4327211380004883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4399890899658203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44725704193115234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43993186950683594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([7621, 256])
first layer input nodes number: 15127
first layer output nodes number: 7621
edges number: 55436
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4473719596862793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45463991165161133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45645713806152344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45645713806152344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([312, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48247528076171875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48247528076171875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48307037353515625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4896259307861328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([286, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48987817764282227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48987817764282227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49042367935180664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4992375373840332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([294, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49981260299682617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49981260299682617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.500373363494873  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5141997337341309  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([203, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5146999359130859  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5146999359130859  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5150871276855469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5263156890869141  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([188, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5270256996154785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5270256996154785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5273842811584473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5402932167053223  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5409908294677734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5409908294677734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5412807464599609  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5537471771240234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([151, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5546183586120605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5546183586120605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5549063682556152  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5693068504333496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([143, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5702624320983887  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5702624320983887  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5705351829528809  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5860819816589355  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([121, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5869927406311035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5869927406311035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5872235298156738  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6019940376281738  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([105, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6029195785522461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6029195785522461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6031198501586914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6173391342163086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([101, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6183071136474609  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6183071136474609  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.618499755859375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6335258483886719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([78, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6343293190002441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6343293190002441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6344780921936035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6471238136291504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([72, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.64794921875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.64794921875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6480865478515625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6607208251953125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([75, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6616616249084473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6616616249084473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6618046760559082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.675966739654541  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([66, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.676846981048584  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.676846981048584  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6769728660583496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6903166770935059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([58, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6911458969116211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6911458969116211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6912565231323242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7037572860717773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([49, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.704503059387207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.704503059387207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7045965194702148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7158117294311523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7163362503051758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7163362503051758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7163991928100586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7243928909301758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7247815132141113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7247815132141113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.724825382232666  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7307038307189941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.731412410736084  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.731412410736084  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7314848899841309  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7417044639587402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7423343658447266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7423343658447266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7423973083496094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7517127990722656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7520408630371094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7520408630371094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7520732879638672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7570991516113281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7576355934143066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7576355934143066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.757683277130127  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7654080390930176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7659149169921875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7659149169921875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7659587860107422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7733726501464844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([281, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7806711196899414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7806711196899414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7812070846557617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8765268325805664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 281, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8535852432250977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8540215492248535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8544578552246094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8539996147155762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2927, 40])
input nodes number: 7621
output nodes number: 2927
edges number: 26564
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8540959358215332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8540964126586914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020515918731689453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 24 input nodes size: 18970
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018775463104248047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018775463104248047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.027821063995361328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.027842998504638672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020607948303222656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.021181106567382812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.021181106567382812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.021181106567382812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([18970, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.021181106567382812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([600, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04754495620727539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04754495620727539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04811716079711914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05269479751586914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 600, 128])
m.shape torch.Size([639, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05301809310913086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05301809310913086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05362749099731445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06276845932006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([656, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06340217590332031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06340217590332031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06402778625488281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07789421081542969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([615, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07877445220947266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07877445220947266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 615, 128]), torch.Size([1, 615, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0793609619140625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09681987762451172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 615, 128])
m.shape torch.Size([531, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0977926254272461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0977926254272461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09829902648925781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11652946472167969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([426, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11749505996704102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11749505996704102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 426, 128]), torch.Size([1, 426, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11790132522583008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13537073135375977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 426, 128])
m.shape torch.Size([424, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1370220184326172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1370220184326172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 424, 128]), torch.Size([1, 424, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13742637634277344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15764427185058594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 424, 128])
m.shape torch.Size([441, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15912437438964844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15912437438964844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 441, 128]), torch.Size([1, 441, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1595449447631836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1835174560546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 441, 128])
m.shape torch.Size([374, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18491220474243164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18491220474243164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18526887893676758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.20809602737426758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 374, 128])
m.shape torch.Size([3095, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22267580032348633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22267580032348633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 3095, 128]), torch.Size([1, 3095, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22563743591308594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43900537490844727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 3095, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4153614044189453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4237332344055176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43117284774780273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4227428436279297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([7801, 256])
first layer input nodes number: 18970
first layer output nodes number: 7801
edges number: 52329
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43038415908813477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43875598907470703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4396839141845703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4396839141845703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([388, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4638056755065918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4638056755065918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46454572677612305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4712257385253906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([327, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4714846611022949  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4714846611022949  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4721083641052246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4823307991027832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([292, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4828610420227051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4828610420227051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48341798782348633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49584484100341797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([241, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4964933395385742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4964933395385742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49695301055908203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5102834701538086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5110535621643066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5110535621643066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5114502906799316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5257325172424316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([135, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5263128280639648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5263128280639648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5265703201293945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5376424789428711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5383615493774414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5383615493774414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5386018753051758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5506181716918945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([153, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5516748428344727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5516748428344727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.551966667175293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5686006546020508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([105, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5693631172180176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5693631172180176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5695633888244629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5823807716369629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([92, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.583165168762207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.583165168762207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5833406448364258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.595799446105957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5964522361755371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5964522361755371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.596585750579834  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6069998741149902  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([78, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6078329086303711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6078329086303711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6079816818237305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6206274032592773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([63, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.621340274810791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.621340274810791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6214604377746582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6325154304504395  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([61, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6332764625549316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6332764625549316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6333928108215332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6449112892150879  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6455883979797363  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6455883979797363  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6456856727600098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6559967994689941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([48, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6566863059997559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6566863059997559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6567778587341309  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6671233177185059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6677803993225098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6677803993225098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6678624153137207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6777043342590332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6782517433166504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6782517433166504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.678316593170166  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6865525245666504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6871957778930664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6871957778930664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6872663497924805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6967229843139648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.697110652923584  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.697110652923584  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6971526145935059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7030692100524902  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7036337852478027  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7036337852478027  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7036890983581543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7118754386901855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7123556137084961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7123556137084961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7124013900756836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7194967269897461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7200708389282227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7200708389282227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7201223373413086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7284650802612305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7288317680358887  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7288317680358887  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7288641929626465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7343440055847168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([252, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7403831481933594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7403831481933594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7408638000488281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8254585266113281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 252, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8044953346252441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8049311637878418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8053669929504395  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8049092292785645  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2923, 40])
input nodes number: 7801
output nodes number: 2923
edges number: 24567
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8049888610839844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8049893379211426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022285938262939453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 25 input nodes size: 20105
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020607471466064453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020607471466064453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03019428253173828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.030215740203857422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.021148204803466797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.021687984466552734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.021687984466552734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.021687984466552734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([20105, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.021687984466552734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([697, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04707813262939453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04707813262939453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 697, 128]), torch.Size([1, 697, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04774284362792969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05315732955932617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 697, 128])
m.shape torch.Size([764, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05355358123779297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05355358123779297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 764, 128]), torch.Size([1, 764, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.054282188415527344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06521129608154297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 764, 128])
m.shape torch.Size([687, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06586122512817383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06586122512817383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 687, 128]), torch.Size([1, 687, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06651639938354492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08093023300170898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 687, 128])
m.shape torch.Size([581, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0817108154296875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0817108154296875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08226490020751953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09892082214355469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([515, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09987163543701172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09987163543701172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10036277770996094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11805915832519531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([496, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1192326545715332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1192326545715332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1197056770324707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1400456428527832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([397, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14113426208496094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14113426208496094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 397, 128]), torch.Size([1, 397, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14151287078857422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16044330596923828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 397, 128])
m.shape torch.Size([379, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16169977188110352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16169977188110352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 379, 128]), torch.Size([1, 379, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16206121444702148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1826634407043457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 379, 128])
m.shape torch.Size([311, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18381738662719727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18381738662719727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 311, 128]), torch.Size([1, 311, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1841139793395996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2030959129333496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 311, 128])
m.shape torch.Size([3035, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21741962432861328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21741962432861328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 3035, 128]), torch.Size([1, 3035, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22031402587890625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43371057510375977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 3035, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4114828109741211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4197673797607422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4272651672363281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41892194747924805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([7862, 256])
first layer input nodes number: 20105
first layer output nodes number: 7862
edges number: 51121
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42663049697875977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43491506576538086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4360027313232422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4360027313232422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([454, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4569740295410156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4569740295410156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4578399658203125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46491003036499023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([412, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4652690887451172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4652690887451172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46605491638183594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4782686233520508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([279, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4786806106567383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4786806106567383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47921276092529297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49164342880249023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([254, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4923539161682129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4923539161682129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49283838272094727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5068879127502441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([186, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5075397491455078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5075397491455078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5078945159912109  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5206661224365234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([175, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5214982032775879  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5214982032775879  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5218319892883301  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5361847877502441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([146, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5370001792907715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5370001792907715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5372786521911621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5512022972106934  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5518860816955566  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5518860816955566  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5520901679992676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.563723087310791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5644168853759766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5644168853759766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5645923614501953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5758228302001953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.576542854309082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.576542854309082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5767030715942383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.588078498840332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([82, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5888657569885254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5888657569885254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.589022159576416  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6012215614318848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6019048690795898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6019048690795898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6020307540893555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6127309799194336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6132931709289551  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6132931709289551  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6133885383605957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6221623420715332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6226263046264648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6226263046264648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6226987838745117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6298742294311523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6305160522460938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6305160522460938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6306056976318359  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6401081085205078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6404170989990234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6404170989990234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6404609680175781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6454181671142578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6459684371948242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6459684371948242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6460351943969727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6540460586547852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6545491218566895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6545491218566895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6546082496643066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6621174812316895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6624717712402344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6624717712402344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6625118255615234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6678791046142578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6684551239013672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6684551239013672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6685142517089844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6768512725830078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6772456169128418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6772456169128418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6772856712341309  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6832137107849121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6836166381835938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6836166381835938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.68365478515625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6895675659179688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6899685859680176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6899685859680176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.690004825592041  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6958756446838379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6961808204650879  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6961808204650879  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6962075233459473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7007203102111816  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([192, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7053890228271484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7053890228271484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7057552337646484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7702083587646484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 192, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.752448558807373  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7528777122497559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7533068656921387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7528562545776367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2879, 40])
input nodes number: 7862
output nodes number: 2879
edges number: 21232
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7529296875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7529301643371582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02273845672607422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 26 input nodes size: 16841
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.021141529083251953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.021141529083251953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02917194366455078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.029193401336669922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019585132598876953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02009439468383789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02009439468383789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02009439468383789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([16841, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02009439468383789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([571, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04268217086791992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04268217086791992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04322671890258789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04821348190307617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([574, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.048488616943359375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.048488616943359375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04903602600097656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05742597579956055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([544, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05793046951293945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05793046951293945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 544, 128]), torch.Size([1, 544, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05844926834106445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06986284255981445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 544, 128])
m.shape torch.Size([485, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07052850723266602  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07052850723266602  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 485, 128]), torch.Size([1, 485, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07099103927612305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08440446853637695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 485, 128])
m.shape torch.Size([412, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08522224426269531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08522224426269531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 412, 128]), torch.Size([1, 412, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08561515808105469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09976005554199219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 412, 128])
m.shape torch.Size([358, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10058784484863281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10058784484863281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 358, 128]), torch.Size([1, 358, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10092926025390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11561012268066406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 358, 128])
m.shape torch.Size([313, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11648416519165039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11648416519165039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 313, 128]), torch.Size([1, 313, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11678266525268555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13170766830444336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 313, 128])
m.shape torch.Size([305, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1327219009399414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1327219009399414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1330127716064453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14959239959716797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([264, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15057992935180664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15057992935180664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1508316993713379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1669449806213379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([2904, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18066644668579102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18066644668579102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 2904, 128]), torch.Size([1, 2904, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18343591690063477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38166284561157227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 2904, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3614926338195801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36862707138061523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3750452995300293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3678603172302246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([6730, 256])
first layer input nodes number: 16841
first layer output nodes number: 6730
edges number: 45546
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37445688247680664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3811516761779785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3831958770751953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3831958770751953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([411, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4056053161621094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4056053161621094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4063892364501953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41269731521606445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([361, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41299962997436523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41299962997436523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41368818283081055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4248213768005371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([288, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4253077507019043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4253077507019043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4258570671081543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43816184997558594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([250, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43884849548339844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43884849548339844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43932533264160156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4531536102294922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([185, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45380449295043945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45380449295043945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45415735244750977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.466860294342041  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([139, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4674859046936035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4674859046936035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46775102615356445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47915124893188477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4799203872680664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4799203872680664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4801759719848633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49295520782470703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49375009536743164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49375009536743164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49397897720336914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5070252418518066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([104, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5078105926513672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5078105926513672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5080089569091797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5207042694091797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([102, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5215854644775391  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5215854644775391  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5217800140380859  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5355930328369141  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.536278247833252  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.536278247833252  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5364193916320801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5474286079406738  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5481538772583008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5481538772583008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5482854843139648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5594720840454102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([64, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5602059364318848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5602059364318848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5603280067443848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5715584754943848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5722780227661133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5722780227661133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5723886489868164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5833406448364258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5839920043945312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5839920043945312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5840854644775391  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5939922332763672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5942840576171875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5942840576171875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5943260192871094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5990676879882812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5996026992797852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5996026992797852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5996675491333008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6074495315551758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6079192161560059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6079192161560059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6079745292663574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6149992942810059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.615318775177002  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.615318775177002  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6153550148010254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.620211124420166  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6207313537597656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6207313537597656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6207847595214844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6283149719238281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6286721229553223  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6286721229553223  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6287083625793457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6340718269348145  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.634666919708252  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.634666919708252  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6347222328186035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6432957649230957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6435999870300293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6435999870300293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6436285972595215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6482634544372559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6486644744873047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6486644744873047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6486988067626953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6545009613037109  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([237, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6601786613464355  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6601786613464355  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6606307029724121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7401900291442871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 237, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7208991050720215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7213253974914551  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7217516899108887  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7213039398193359  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2858, 40])
input nodes number: 6730
output nodes number: 2858
edges number: 22743
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7213730812072754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7213735580444336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.021080493927001953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 27 input nodes size: 23199
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019582271575927734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019582271575927734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03064441680908203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.030665874481201172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022614002227783203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02324533462524414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02324533462524414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02324533462524414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([23199, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02324533462524414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([594, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.053609371185302734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.053609371185302734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 594, 128]), torch.Size([1, 594, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05417585372924805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.059051513671875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 594, 128])
m.shape torch.Size([650, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.059388160705566406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.059388160705566406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06000804901123047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0693063735961914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 650, 128])
m.shape torch.Size([625, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06989049911499023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06989049911499023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 625, 128]), torch.Size([1, 625, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07048654556274414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08393144607543945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 625, 128])
m.shape torch.Size([558, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08469772338867188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08469772338867188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08522987365722656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10146141052246094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([569, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10255193710327148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10255193710327148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 569, 128]), torch.Size([1, 569, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10309457778930664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12346076965332031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 569, 128])
m.shape torch.Size([504, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12463140487670898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12463140487670898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 504, 128]), torch.Size([1, 504, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12511205673217773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14578008651733398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 504, 128])
m.shape torch.Size([457, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1470651626586914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1470651626586914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14750099182128906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16929244995117188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([408, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17063093185424805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17063093185424805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1710200309753418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19319868087768555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([344, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19448041915893555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19448041915893555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 344, 128]), torch.Size([1, 344, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1948084831237793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2158045768737793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 344, 128])
m.shape torch.Size([3939, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23517179489135742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23517179489135742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 3939, 128]), torch.Size([1, 3939, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23892831802368164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5135111808776855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 3939, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48630619049072266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4945535659790039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5028009414672852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4944887161254883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([8648, 256])
first layer input nodes number: 23199
first layer output nodes number: 8648
edges number: 60819
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5029759407043457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.511223316192627  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.513850212097168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.513850212097168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([377, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5379548072814941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5379548072814941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5386738777160645  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5445866584777832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([349, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5448980331420898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5448980331420898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5455636978149414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5564641952514648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([263, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5568900108337402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5568900108337402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5573916435241699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5693507194519043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([212, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5699152946472168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5699152946472168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.570319652557373  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5820460319519043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([203, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5828194618225098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5828194618225098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5832066535949707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5971455574035645  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([170, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5979323387145996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5979323387145996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5982565879821777  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6121993064880371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([146, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6130194664001465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6130194664001465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6132979393005371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6272215843200684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([123, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.628028392791748  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.628028392791748  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.628262996673584  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6416354179382324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.642331600189209  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.642331600189209  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6425108909606934  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6539855003356934  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6547613143920898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6547613143920898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.654932975769043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6671209335327148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6677541732788086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6677541732788086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6678838729858398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6780004501342773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6786971092224121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6786971092224121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6788229942321777  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6895232200622559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6901226043701172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6901226043701172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6902236938476562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.69952392578125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.700200080871582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.700200080871582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7003030776977539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7104997634887695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7110686302185059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7110686302185059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7111506462097168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7198443412780762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7205109596252441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7205109596252441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7205986976623535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7305130958557129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7311229705810547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7311229705810547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7311992645263672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7403545379638672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.74078369140625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.74078369140625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7408351898193359  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.74737548828125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7477884292602539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7477884292602539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7478342056274414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7539682388305664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7544069290161133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7544069290161133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7544527053833008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7609071731567383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7613286972045898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7613286972045898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7613706588745117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7675809860229492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7680678367614746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7680678367614746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7681136131286621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7752089500427246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7754960060119629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7754960060119629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7755227088928223  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.779848575592041  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7802042961120605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7802042961120605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7802348136901855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7853922843933105  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([281, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7921290397644043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7921290397644043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7926650047302246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8877043724060059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 281, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8666234016418457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8670454025268555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8674674034118652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8670239448547363  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2829, 40])
input nodes number: 8648
output nodes number: 2829
edges number: 23688
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8671059608459473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8671064376831055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.024449825286865234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 28 input nodes size: 10223
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022609710693359375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022609710693359375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.027484416961669922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.027506351470947266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.016422748565673828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01676797866821289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01676797866821289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01676797866821289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([10223, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01676797866821289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([686, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031345367431640625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031345367431640625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 686, 128]), torch.Size([1, 686, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03199958801269531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03723335266113281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 686, 128])
m.shape torch.Size([763, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03763389587402344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03763389587402344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 763, 128]), torch.Size([1, 763, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.038361549377441406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.049605369567871094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 763, 128])
m.shape torch.Size([644, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05016279220581055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05016279220581055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 644, 128]), torch.Size([1, 644, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05077695846557617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06458091735839844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 644, 128])
m.shape torch.Size([553, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06532859802246094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06532859802246094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0658559799194336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08183097839355469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([492, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08274030685424805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08274030685424805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 492, 128]), torch.Size([1, 492, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08320951461791992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10010099411010742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 492, 128])
m.shape torch.Size([400, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10101079940795898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10101079940795898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 400, 128]), torch.Size([1, 400, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10139226913452148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11779546737670898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 400, 128])
m.shape torch.Size([328, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11869955062866211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11869955062866211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11901235580444336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13465261459350586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([277, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13555288314819336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13555288314819336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 277, 128]), torch.Size([1, 277, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1358170509338379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15087461471557617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 277, 128])
m.shape torch.Size([242, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1517810821533203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1517810821533203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 242, 128]), torch.Size([1, 242, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15201187133789062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16678237915039062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 242, 128])
m.shape torch.Size([1108, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1719503402709961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1719503402709961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 1108, 128]), torch.Size([1, 1108, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17300701141357422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2490530014038086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 1108, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2372126579284668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24245119094848633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24768972396850586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24241018295288086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([5493, 256])
first layer input nodes number: 10223
first layer output nodes number: 5493
edges number: 28986
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24776792526245117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2530064582824707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25436925888061523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25436925888061523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([464, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.27153539657592773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.27153539657592773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.27242040634155273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2803497314453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 464, 256])
m.shape torch.Size([439, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28075122833251953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28075122833251953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 439, 256]), torch.Size([1, 439, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2815885543823242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2942628860473633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 439, 256])
m.shape torch.Size([347, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.29495906829833984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.29495906829833984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2956209182739258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3108358383178711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([262, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3118138313293457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3118138313293457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3123135566711426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.32680559158325195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([254, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3277764320373535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3277764320373535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3282608985900879  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3457016944885254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([191, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3465609550476074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3465609550476074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3469252586364746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36259031295776367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([167, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36353206634521484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36353206634521484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36385059356689453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3797769546508789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([136, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3806633949279785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3806633949279785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.380922794342041  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3957085609436035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([108, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3965134620666504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3965134620666504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39671945571899414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40990304946899414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41053056716918945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41053056716918945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4106755256652832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42096757888793945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42166709899902344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42166709899902344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42180633544921875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4326667785644531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43331241607666016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43331241607666016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43343067169189453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4434823989868164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4440732002258301  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4440732002258301  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44417238235473633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45329713821411133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4538397789001465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4538397789001465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45392370223999023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4622321128845215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4627814292907715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4627814292907715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4628596305847168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4711489677429199  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4715404510498047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4715404510498047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47159385681152344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4776287078857422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47794532775878906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47794532775878906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4779853820800781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4827919006347656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4830317497253418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4830317497253418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.483060359954834  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4866938591003418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([7, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48680782318115234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48680782318115234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48682117462158203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48861026763916016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([12, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4888343811035156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4888343811035156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4888572692871094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4920845031738281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4922952651977539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4922952651977539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49231624603271484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4954214096069336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4956226348876953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4956226348876953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49564170837402344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4985980987548828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.498809814453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.498809814453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4988288879394531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5019187927246094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5021171569824219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5021171569824219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5021343231201172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.505035400390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([65, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5065889358520508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5065889358520508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5067129135131836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5285329818725586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 65, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5147042274475098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5151371955871582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5155701637268066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5151152610778809  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2904, 40])
input nodes number: 5493
output nodes number: 2904
edges number: 17260
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5151891708374023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5151896476745605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01748514175415039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 29 input nodes size: 10611
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0164337158203125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0164337158203125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02149343490600586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.021515369415283203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.016618728637695312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01692962646484375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01692962646484375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01692962646484375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([10611, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01692962646484375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([812, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031397342681884766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031397342681884766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03217172622680664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.039006710052490234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([839, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03941965103149414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03941965103149414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.040219783782958984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05234718322753906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([672, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05290842056274414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05290842056274414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 672, 128]), torch.Size([1, 672, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05354928970336914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06764841079711914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 672, 128])
m.shape torch.Size([534, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06892251968383789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06892251968383789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06943178176879883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08420038223266602  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([468, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08506155014038086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08506155014038086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08550786972045898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10157537460327148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([332, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10230207443237305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10230207443237305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 332, 128]), torch.Size([1, 332, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10261869430541992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11623334884643555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 332, 128])
m.shape torch.Size([316, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11712980270385742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11712980270385742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 316, 128]), torch.Size([1, 316, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1174311637878418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13249921798706055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 316, 128])
m.shape torch.Size([228, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13321828842163086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13321828842163086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 228, 128]), torch.Size([1, 228, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13343572616577148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1458296775817871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 228, 128])
m.shape torch.Size([191, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14654064178466797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14654064178466797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 191, 128]), torch.Size([1, 191, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14672279357910156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15838050842285156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 191, 128])
m.shape torch.Size([998, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16342782974243164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16342782974243164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 998, 128]), torch.Size([1, 998, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16437959671020508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2334427833557129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 998, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2217574119567871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2268977165222168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23203802108764648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22685718536376953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([5390, 256])
first layer input nodes number: 10611
first layer output nodes number: 5390
edges number: 26709
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23211908340454102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2372593879699707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2387995719909668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2387995719909668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([563, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2538585662841797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2538585662841797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 563, 256]), torch.Size([1, 563, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2549324035644531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2639455795288086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 563, 256])
m.shape torch.Size([486, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.26434326171875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.26434326171875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2652702331542969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2791748046875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([372, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2798585891723633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2798585891723633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28056812286376953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.29630565643310547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([299, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.29720354080200195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.29720354080200195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2977738380432129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3146481513977051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([238, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3155069351196289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3155069351196289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3159608840942383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3323030471801758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([167, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3330392837524414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3330392837524414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3333578109741211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34705448150634766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([144, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34786415100097656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34786415100097656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34813880920410156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36187171936035156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36264944076538086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36264944076538086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36287641525268555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37581396102905273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37644481658935547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37644481658935547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37660884857177734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38710689544677734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38781309127807617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38781309127807617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3879694938659668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39907407760620117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3996620178222656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3996620178222656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3997821807861328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40915489196777344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4096946716308594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4096946716308594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4097938537597656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4182243347167969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([32, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41857481002807617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41857481002807617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41863584518432617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42425107955932617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4246511459350586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4246511459350586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4247121810913086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4307546615600586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4311714172363281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4311714172363281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4312305450439453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4374980926513672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([19, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4377608299255371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4377608299255371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43779706954956055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.441892147064209  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4421520233154297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4421520233154297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4421844482421875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.446075439453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44640541076660156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44640541076660156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4464435577392578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45128822326660156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45154333114624023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45154333114624023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4515719413757324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45540571212768555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4554877281188965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4554877281188965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45549726486206055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45684194564819336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45697879791259766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45697879791259766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45699214935302734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4589681625366211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4590888023376465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4590888023376465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45910024642944336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.460874080657959  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46091270446777344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46091270446777344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46091651916503906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4615345001220703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46169424057006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46169424057006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46170759201049805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46396398544311523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([36, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46482276916503906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46482276916503906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4648914337158203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4769763946533203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 36, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46535634994506836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4657888412475586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46622133255004883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46576690673828125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2900, 40])
input nodes number: 5390
output nodes number: 2900
edges number: 14970
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46582889556884766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46582937240600586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01758575439453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 30 input nodes size: 10350
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01661825180053711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01661825180053711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.021553516387939453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.021575450897216797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.016493797302246094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01687145233154297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01687145233154297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01687145233154297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([10350, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01687145233154297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([654, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03245210647583008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03245210647583008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 654, 128]), torch.Size([1, 654, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.033075809478759766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.039032936096191406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 654, 128])
m.shape torch.Size([676, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03936576843261719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03936576843261719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 676, 128]), torch.Size([1, 676, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04001045227050781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04968070983886719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 676, 128])
m.shape torch.Size([598, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05021381378173828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05021381378173828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05078411102294922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06333065032958984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([531, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06405830383300781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06405830383300781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06456470489501953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07961845397949219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([468, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08048105239868164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08048105239868164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08092737197875977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09699487686157227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([328, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09771013259887695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09771013259887695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0980229377746582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11147356033325195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([317, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11237525939941406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11237525939941406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 317, 128]), torch.Size([1, 317, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11267757415771484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1277933120727539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 317, 128])
m.shape torch.Size([284, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12872552871704102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12872552871704102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 284, 128]), torch.Size([1, 284, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1289963722229004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14443445205688477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 284, 128])
m.shape torch.Size([240, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14532899856567383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14532899856567383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 240, 128]), torch.Size([1, 240, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14555788040161133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16020631790161133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 240, 128])
m.shape torch.Size([1420, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16686296463012695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16686296463012695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 1420, 128]), torch.Size([1, 1420, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16821718215942383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2660832405090332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 1420, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2539100646972656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2591705322265625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2644309997558594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25912904739379883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([5516, 256])
first layer input nodes number: 10350
first layer output nodes number: 5516
edges number: 31083
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2645101547241211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.26977062225341797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2716970443725586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2716970443725586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([444, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2919316291809082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2919316291809082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.29277849197387695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.30120372772216797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([393, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.30153608322143555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.30153608322143555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.30228567123413086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.31352949142456055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([313, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3140573501586914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3140573501586914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3146543502807617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3285069465637207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([270, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.32924652099609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.32924652099609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3297615051269531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.344696044921875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([214, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34546709060668945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34546709060668945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34587526321411133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36056947708129883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([167, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3613286018371582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3613286018371582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3616471290588379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37534379959106445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([174, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37673330307006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37673330307006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37706518173217773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3936591148376465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([141, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3945775032043457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3945775032043457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39484643936157227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41017580032348633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([106, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41095829010009766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41095829010009766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4111604690551758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4240999221801758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([93, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4248929023742676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4248929023742676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42507028579711914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4376645088195801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43834781646728516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43834781646728516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43848705291748047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44934749603271484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([76, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45015478134155273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45015478134155273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4502997398376465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46262121200561523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([67, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46338605880737305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46338605880737305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4635138511657715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47527074813842773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4759068489074707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4759068489074707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47600603103637695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4858250617980957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4864821434020996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4864821434020996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4865756034851074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49648237228393555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49702024459838867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49702024459838867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49709272384643555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5052828788757324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5056552886962891  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5056552886962891  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5057029724121094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5114250183105469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5118684768676758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5118684768676758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5119199752807617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5184602737426758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.518836498260498  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.518836498260498  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5188784599304199  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5245013236999512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5248842239379883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5248842239379883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5249242782592773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5305719375610352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5308146476745605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5308146476745605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5308394432067871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5345091819763184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5348353385925293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5348353385925293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5348658561706543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5395960807800293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5398240089416504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5398240089416504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5398449897766113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5432438850402832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5435104370117188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5435104370117188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5435333251953125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5474014282226562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([94, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5496487617492676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5496487617492676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.549828052520752  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.581383228302002  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 94, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5644626617431641  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5648965835571289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5653305053710938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5648746490478516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2911, 40])
input nodes number: 5516
output nodes number: 2911
edges number: 19473
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5649394989013672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5649399757385254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01763153076171875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 31 input nodes size: 16010
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.016495227813720703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.016495227813720703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.024129390716552734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.024151325225830078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01919412612915039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019704341888427734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019704341888427734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019704341888427734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([16010, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019704341888427734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([690, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04247331619262695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04247331619262695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 690, 128]), torch.Size([1, 690, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.043131351470947266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.048696041107177734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 690, 128])
m.shape torch.Size([709, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04904317855834961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04904317855834961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 709, 128]), torch.Size([1, 709, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04971933364868164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06081247329711914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 709, 128])
m.shape torch.Size([647, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06139993667602539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06139993667602539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 647, 128]), torch.Size([1, 647, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.062016963958740234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07633161544799805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 647, 128])
m.shape torch.Size([547, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07712554931640625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07712554931640625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07764720916748047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09277534484863281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([528, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0945897102355957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0945897102355957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0950932502746582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1132206916809082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([445, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1142420768737793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1142420768737793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11466646194458008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13291501998901367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([395, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13402128219604492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13402128219604492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 395, 128]), torch.Size([1, 395, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1343979835510254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15323305130004883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 395, 128])
m.shape torch.Size([372, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1548781394958496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1548781394958496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 372, 128]), torch.Size([1, 372, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15523290634155273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17545461654663086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 372, 128])
m.shape torch.Size([336, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17671918869018555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17671918869018555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 336, 128]), torch.Size([1, 336, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17703962326049805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19754743576049805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 336, 128])
m.shape torch.Size([2545, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.20952272415161133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.20952272415161133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 2545, 128]), torch.Size([1, 2545, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21194982528686523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3851895332336426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 2545, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36545228958129883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3723320960998535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3792119026184082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37227821350097656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([7214, 256])
first layer input nodes number: 16010
first layer output nodes number: 7214
edges number: 45762
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37933349609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3862133026123047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3886404037475586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3886404037475586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([444, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41118478775024414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41118478775024414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4120316505432129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41885900497436523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([357, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41912221908569336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41912221908569336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4198031425476074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43018388748168945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([311, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4307403564453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4307403564453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4313335418701172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4448127746582031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([238, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4454312324523926  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4454312324523926  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44588518142700195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45904970169067383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([203, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45979833602905273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45979833602905273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46018552780151367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4741244316101074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([142, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4747500419616699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4747500419616699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4750208854675293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4866671562194824  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48743343353271484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48743343353271484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4876890182495117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5004682540893555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5012402534484863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5012402534484863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5014634132385254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.514183521270752  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([124, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5151801109313965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5151801109313965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5154166221618652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5305533409118652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([95, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5313482284545898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5313482284545898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.531529426574707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5443944931030273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([84, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5451922416687012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5451922416687012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5453524589538574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5578494071960449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5585536956787109  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5585536956787109  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5586833953857422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5697078704833984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.570343017578125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.570343017578125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5704498291015625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5802764892578125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5807886123657227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5807886123657227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5808687210083008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5887994766235352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5893940925598145  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5893940925598145  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5894780158996582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5983738899230957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5990548133850098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5990548133850098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.599144458770752  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6092743873596191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6097855567932129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6097855567932129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6098504066467285  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6176323890686035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6181192398071289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6181192398071289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6181764602661133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6254434585571289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6260542869567871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6260542869567871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6261210441589355  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6350665092468262  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6356678009033203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6356678009033203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6357307434082031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6446056365966797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6449980735778809  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6449980735778809  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6450381278991699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6509661674499512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6513481140136719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6513481140136719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6513843536376953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6570014953613281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6574034690856934  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6574034690856934  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6574397087097168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6633105278015137  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6636157035827637  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6636157035827637  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.663642406463623  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6681551933288574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([206, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6730918884277344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6730918884277344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6734848022460938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7426376342773438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 206, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7233290672302246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7237639427185059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7241988182067871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7237420082092285  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2917, 40])
input nodes number: 7214
output nodes number: 2917
edges number: 22543
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7238187789916992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7238192558288574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020699024200439453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020699024200439453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020699024200439453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00810220092535019 |0.0018502846360206604 |0.1152350977063179 |8.603930473327637e-05 |0.07609329372644424 |0.00481104850769043 |
----------------------------------------------------------pseudo_mini_loss sum 4.860080718994141
Total (block generation + training)time/epoch 29.68358612060547
Training time/epoch 6.616234302520752
Training time without block to device /epoch 6.557025194168091
Training time without total dataloading part /epoch 6.130072832107544
load block tensor time/epoch 0.25927042961120605
block to device time/epoch 0.05920910835266113
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1138924
Number of first layer input nodes during this epoch:  815524
Number of first layer output nodes during this epoch:  323400
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02069854736328125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.022092819213867188
global_2_local spend time (sec) 0.05242300033569336
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004388570785522461
A = g.adjacency_matrix() spent  0.013219833374023438
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0907435417175293
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3067309856414795
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1648008823394775

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------[05:30:06] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 21724554 edges into 32 parts and get 6703304 edge cuts

--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 11704867, 2.0: 2016386, 3.0: 505014, 4.0: 151832, 5.0: 55157, 6.0: 24090, 7.0: 11047, 8.0: 5737, 9.0: 3033, 10.0: 1743, 11.0: 999, 12.0: 546, 13.0: 336, 14.0: 193, 15.0: 115, 16.0: 108, 17.0: 90, 18.0: 42, 19.0: 26, 20.0: 6, 21.0: 3})
Convert a graph into a bidirected graph: 0.797 seconds
Metis partitioning: 4.716 seconds
Split the graph: 0.310 seconds
Construct subgraphs: 0.115 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  5.948415756225586
2927
2927
2865
2904
2868
2925
2893
2857
2920
2877
2876
2859
2915
2797
2800
2786
2761
2835
2825
2794
2758
2758
2759
2884
2824
2784
2763
2808
2826
2884
2787
2895
total k batches seeds list generation spend  19.14878249168396
after graph partition
graph partition algorithm spend time 19.23777723312378
2927
2927
2865
2904
2868
2925
2893
2857
2920
2877
2876
2859
2915
2797
2800
2786
2761
2835
2825
2794
2758
2758
2759
2884
2824
2784
2763
2808
2826
2884
2787
2895
partition_len_list
[8822, 8976, 8524, 6071, 6108, 6376, 5486, 5668, 6081, 6558, 6755, 5948, 7756, 7260, 6875, 7465, 16564, 18869, 14815, 18044, 16009, 16763, 18503, 17661, 7722, 11643, 12092, 12730, 8285, 6049, 7997, 6019]
shared_neighbor_graph_partition_s0 selection method  spend 19.349388360977173
time for parepare:  0.017790555953979492
local_output_nid generation:  0.0008461475372314453
local_in_edges_tensor generation:  0.001016378402709961
mini_batch_src_global generation:  0.0011379718780517578
r_  generation:  0.007112026214599609
local_output_nid generation:  0.0008294582366943359
local_in_edges_tensor generation:  0.0008604526519775391
mini_batch_src_global generation:  0.0011563301086425781
r_  generation:  0.007233858108520508
local_output_nid generation:  0.0008325576782226562
local_in_edges_tensor generation:  0.0007488727569580078
mini_batch_src_global generation:  0.0007638931274414062
r_  generation:  0.006526470184326172
local_output_nid generation:  0.0008575916290283203
local_in_edges_tensor generation:  0.0007445812225341797
mini_batch_src_global generation:  0.0007224082946777344
r_  generation:  0.006628274917602539
local_output_nid generation:  0.0008435249328613281
local_in_edges_tensor generation:  0.0006952285766601562
mini_batch_src_global generation:  0.0006244182586669922
r_  generation:  0.005527973175048828
local_output_nid generation:  0.0008480548858642578
local_in_edges_tensor generation:  0.0007071495056152344
mini_batch_src_global generation:  0.0006763935089111328
r_  generation:  0.006555795669555664
local_output_nid generation:  0.0008757114410400391
local_in_edges_tensor generation:  0.0007164478302001953
mini_batch_src_global generation:  0.0006711483001708984
r_  generation:  0.0054302215576171875
local_output_nid generation:  0.0008537769317626953
local_in_edges_tensor generation:  0.000789642333984375
mini_batch_src_global generation:  0.0009086132049560547
r_  generation:  0.006810665130615234
local_output_nid generation:  0.0008869171142578125
local_in_edges_tensor generation:  0.0007493495941162109
mini_batch_src_global generation:  0.0008265972137451172
r_  generation:  0.007405757904052734
local_output_nid generation:  0.0008594989776611328
local_in_edges_tensor generation:  0.0006854534149169922
mini_batch_src_global generation:  0.0007543563842773438
r_  generation:  0.006988525390625
local_output_nid generation:  0.0008471012115478516
local_in_edges_tensor generation:  0.0006959438323974609
mini_batch_src_global generation:  0.0007615089416503906
r_  generation:  0.006875038146972656
local_output_nid generation:  0.0008330345153808594
local_in_edges_tensor generation:  0.0006601810455322266
mini_batch_src_global generation:  0.0006754398345947266
r_  generation:  0.006475687026977539
local_output_nid generation:  0.0008618831634521484
local_in_edges_tensor generation:  0.0006918907165527344
mini_batch_src_global generation:  0.0007932186126708984
r_  generation:  0.007720232009887695
local_output_nid generation:  0.0008606910705566406
local_in_edges_tensor generation:  0.0007867813110351562
mini_batch_src_global generation:  0.0008397102355957031
r_  generation:  0.007356405258178711
local_output_nid generation:  0.0008571147918701172
local_in_edges_tensor generation:  0.0007274150848388672
mini_batch_src_global generation:  0.0007016658782958984
r_  generation:  0.00637054443359375
local_output_nid generation:  0.0008466243743896484
local_in_edges_tensor generation:  0.0007143020629882812
mini_batch_src_global generation:  0.0007014274597167969
r_  generation:  0.006367683410644531
local_output_nid generation:  0.0008318424224853516
local_in_edges_tensor generation:  0.0008656978607177734
mini_batch_src_global generation:  0.0010156631469726562
r_  generation:  0.011363744735717773
local_output_nid generation:  0.0009799003601074219
local_in_edges_tensor generation:  0.0008194446563720703
mini_batch_src_global generation:  0.001436471939086914
r_  generation:  0.009693384170532227
local_output_nid generation:  0.000978231430053711
local_in_edges_tensor generation:  0.0009565353393554688
mini_batch_src_global generation:  0.0010657310485839844
r_  generation:  0.007877826690673828
local_output_nid generation:  0.0009632110595703125
local_in_edges_tensor generation:  0.0008745193481445312
mini_batch_src_global generation:  0.0010197162628173828
r_  generation:  0.008563995361328125
local_output_nid generation:  0.0009405612945556641
local_in_edges_tensor generation:  0.0008692741394042969
mini_batch_src_global generation:  0.0009813308715820312
r_  generation:  0.008278369903564453
local_output_nid generation:  0.0009179115295410156
local_in_edges_tensor generation:  0.0008342266082763672
mini_batch_src_global generation:  0.001107931137084961
r_  generation:  0.009351253509521484
local_output_nid generation:  0.0009412765502929688
local_in_edges_tensor generation:  0.0008461475372314453
mini_batch_src_global generation:  0.00112152099609375
r_  generation:  0.009569406509399414
local_output_nid generation:  0.0009860992431640625
local_in_edges_tensor generation:  0.0008325576782226562
mini_batch_src_global generation:  0.0013079643249511719
r_  generation:  0.013756036758422852
local_output_nid generation:  0.0011951923370361328
local_in_edges_tensor generation:  0.0007576942443847656
mini_batch_src_global generation:  0.0009012222290039062
r_  generation:  0.006738185882568359
local_output_nid generation:  0.0010309219360351562
local_in_edges_tensor generation:  0.0007367134094238281
mini_batch_src_global generation:  0.0007326602935791016
r_  generation:  0.0057642459869384766
local_output_nid generation:  0.0009708404541015625
local_in_edges_tensor generation:  0.0006909370422363281
mini_batch_src_global generation:  0.0007457733154296875
r_  generation:  0.006026029586791992
local_output_nid generation:  0.0009889602661132812
local_in_edges_tensor generation:  0.0007083415985107422
mini_batch_src_global generation:  0.0008616447448730469
r_  generation:  0.007505178451538086
local_output_nid generation:  0.0009684562683105469
local_in_edges_tensor generation:  0.0007109642028808594
mini_batch_src_global generation:  0.0007641315460205078
r_  generation:  0.0061740875244140625
local_output_nid generation:  0.0009610652923583984
local_in_edges_tensor generation:  0.0006761550903320312
mini_batch_src_global generation:  0.0005719661712646484
r_  generation:  0.005182027816772461
local_output_nid generation:  0.0008957386016845703
local_in_edges_tensor generation:  0.00066375732421875
mini_batch_src_global generation:  0.0005712509155273438
r_  generation:  0.0049517154693603516
local_output_nid generation:  0.0009360313415527344
local_in_edges_tensor generation:  0.0006787776947021484
mini_batch_src_global generation:  0.0005655288696289062
r_  generation:  0.0055980682373046875
----------------------check_connections_block total spend ----------------------------- 0.40974879264831543
generate_one_block  0.017932653427124023
generate_one_block  0.01247096061706543
generate_one_block  0.010437250137329102
generate_one_block  0.009729385375976562
generate_one_block  0.008129358291625977
generate_one_block  0.009283304214477539
generate_one_block  0.007796287536621094
generate_one_block  0.010114431381225586
generate_one_block  0.010734796524047852
generate_one_block  0.009972333908081055
generate_one_block  0.010158061981201172
generate_one_block  0.009315013885498047
generate_one_block  0.011253833770751953
generate_one_block  0.011100292205810547
generate_one_block  0.00919961929321289
generate_one_block  0.009619474411010742
generate_one_block  0.0203399658203125
generate_one_block  0.017512083053588867
generate_one_block  0.013144493103027344
generate_one_block  0.014162302017211914
generate_one_block  0.013208627700805664
generate_one_block  0.014742374420166016
generate_one_block  0.01510763168334961
generate_one_block  0.01752185821533203
generate_one_block  0.009956836700439453
generate_one_block  0.010143756866455078
generate_one_block  0.009789228439331055
generate_one_block  0.011289119720458984
generate_one_block  0.008967399597167969
generate_one_block  0.007298946380615234
generate_one_block  0.007609128952026367
generate_one_block  0.007833719253540039
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040059566497802734
gen group dst list time:  0.009821414947509766
time for parepare:  0.01958775520324707
local_output_nid generation:  0.002135753631591797
local_in_edges_tensor generation:  0.010199785232543945
mini_batch_src_global generation:  0.0019550323486328125
r_  generation:  0.02018427848815918
local_output_nid generation:  0.0028412342071533203
local_in_edges_tensor generation:  0.0025670528411865234
mini_batch_src_global generation:  0.002313852310180664
r_  generation:  0.02267932891845703
local_output_nid generation:  0.002611875534057617
local_in_edges_tensor generation:  0.002039194107055664
mini_batch_src_global generation:  0.0017743110656738281
r_  generation:  0.0196230411529541
local_output_nid generation:  0.0018851757049560547
local_in_edges_tensor generation:  0.0014338493347167969
mini_batch_src_global generation:  0.0012392997741699219
r_  generation:  0.013317108154296875
local_output_nid generation:  0.0019352436065673828
local_in_edges_tensor generation:  0.0014657974243164062
mini_batch_src_global generation:  0.0009601116180419922
r_  generation:  0.014575481414794922
local_output_nid generation:  0.0018231868743896484
local_in_edges_tensor generation:  0.0013828277587890625
mini_batch_src_global generation:  0.0013272762298583984
r_  generation:  0.025990962982177734
local_output_nid generation:  0.0030367374420166016
local_in_edges_tensor generation:  0.002149820327758789
mini_batch_src_global generation:  0.001657247543334961
r_  generation:  0.010318279266357422
local_output_nid generation:  0.0027883052825927734
local_in_edges_tensor generation:  0.0017595291137695312
mini_batch_src_global generation:  0.0011186599731445312
r_  generation:  0.012492656707763672
local_output_nid generation:  0.0028276443481445312
local_in_edges_tensor generation:  0.0018236637115478516
mini_batch_src_global generation:  0.0010919570922851562
r_  generation:  0.016118764877319336
local_output_nid generation:  0.0027937889099121094
local_in_edges_tensor generation:  0.0017087459564208984
mini_batch_src_global generation:  0.0013349056243896484
r_  generation:  0.01511240005493164
local_output_nid generation:  0.002897024154663086
local_in_edges_tensor generation:  0.001895904541015625
mini_batch_src_global generation:  0.0012090206146240234
r_  generation:  0.015460729598999023
local_output_nid generation:  0.002496957778930664
local_in_edges_tensor generation:  0.0015311241149902344
mini_batch_src_global generation:  0.0012977123260498047
r_  generation:  0.013075828552246094
local_output_nid generation:  0.0030829906463623047
local_in_edges_tensor generation:  0.0020647048950195312
mini_batch_src_global generation:  0.001383066177368164
r_  generation:  0.01802682876586914
local_output_nid generation:  0.002700328826904297
local_in_edges_tensor generation:  0.002451658248901367
mini_batch_src_global generation:  0.0016210079193115234
r_  generation:  0.017536401748657227
local_output_nid generation:  0.002908945083618164
local_in_edges_tensor generation:  0.0017848014831542969
mini_batch_src_global generation:  0.001203775405883789
r_  generation:  0.015127420425415039
local_output_nid generation:  0.0030412673950195312
local_in_edges_tensor generation:  0.0020046234130859375
mini_batch_src_global generation:  0.0015897750854492188
r_  generation:  0.0170285701751709
local_output_nid generation:  0.006516933441162109
local_in_edges_tensor generation:  0.005233049392700195
mini_batch_src_global generation:  0.007123470306396484
r_  generation:  0.0489962100982666
local_output_nid generation:  0.00844264030456543
local_in_edges_tensor generation:  0.008677244186401367
mini_batch_src_global generation:  0.0075414180755615234
r_  generation:  0.06015896797180176
local_output_nid generation:  0.0072901248931884766
local_in_edges_tensor generation:  0.005657196044921875
mini_batch_src_global generation:  0.005284786224365234
r_  generation:  0.05290055274963379
local_output_nid generation:  0.009261369705200195
local_in_edges_tensor generation:  0.005787849426269531
mini_batch_src_global generation:  0.008005619049072266
r_  generation:  0.05740046501159668
local_output_nid generation:  0.005780935287475586
local_in_edges_tensor generation:  0.0043621063232421875
mini_batch_src_global generation:  0.006686687469482422
r_  generation:  0.04831266403198242
local_output_nid generation:  0.005392789840698242
local_in_edges_tensor generation:  0.004485607147216797
mini_batch_src_global generation:  0.0055844783782958984
r_  generation:  0.049590110778808594
local_output_nid generation:  0.005684375762939453
local_in_edges_tensor generation:  0.0045871734619140625
mini_batch_src_global generation:  0.006255388259887695
r_  generation:  0.05670738220214844
local_output_nid generation:  0.0051882266998291016
local_in_edges_tensor generation:  0.004678249359130859
mini_batch_src_global generation:  0.006445646286010742
r_  generation:  0.052809953689575195
local_output_nid generation:  0.0027666091918945312
local_in_edges_tensor generation:  0.002219676971435547
mini_batch_src_global generation:  0.003408193588256836
r_  generation:  0.024072647094726562
local_output_nid generation:  0.00601649284362793
local_in_edges_tensor generation:  0.005259275436401367
mini_batch_src_global generation:  0.0068359375
r_  generation:  0.03264474868774414
local_output_nid generation:  0.004933357238769531
local_in_edges_tensor generation:  0.0029985904693603516
mini_batch_src_global generation:  0.005482196807861328
r_  generation:  0.036981821060180664
local_output_nid generation:  0.0058481693267822266
local_in_edges_tensor generation:  0.0037949085235595703
mini_batch_src_global generation:  0.0033583641052246094
r_  generation:  0.03467845916748047
local_output_nid generation:  0.0041446685791015625
local_in_edges_tensor generation:  0.0026340484619140625
mini_batch_src_global generation:  0.002269744873046875
r_  generation:  0.020263671875
local_output_nid generation:  0.0028657913208007812
local_in_edges_tensor generation:  0.0017371177673339844
mini_batch_src_global generation:  0.0014483928680419922
r_  generation:  0.010624170303344727
local_output_nid generation:  0.003819704055786133
local_in_edges_tensor generation:  0.002399921417236328
mini_batch_src_global generation:  0.001361846923828125
r_  generation:  0.018239259719848633
local_output_nid generation:  0.0026853084564208984
local_in_edges_tensor generation:  0.0016510486602783203
mini_batch_src_global generation:  0.0013217926025390625
r_  generation:  0.012605667114257812
----------------------check_connections_block total spend ----------------------------- 1.4632105827331543
generate_one_block  0.04135322570800781
generate_one_block  0.03930354118347168
generate_one_block  0.049407243728637695
generate_one_block  0.01918625831604004
generate_one_block  0.01669025421142578
generate_one_block  0.025136232376098633
generate_one_block  0.01952672004699707
generate_one_block  0.01862311363220215
generate_one_block  0.028109312057495117
generate_one_block  0.02104353904724121
generate_one_block  0.0218503475189209
generate_one_block  0.0182344913482666
generate_one_block  0.02420496940612793
generate_one_block  0.02448105812072754
generate_one_block  0.02407670021057129
generate_one_block  0.036029815673828125
generate_one_block  0.07371830940246582
generate_one_block  0.10263490676879883
generate_one_block  0.05709385871887207
generate_one_block  0.07138323783874512
generate_one_block  0.06314921379089355
generate_one_block  0.06651711463928223
generate_one_block  0.07895779609680176
generate_one_block  0.07224464416503906
generate_one_block  0.023896217346191406
generate_one_block  0.05259299278259277
generate_one_block  0.04982876777648926
generate_one_block  0.0458528995513916
generate_one_block  0.02893853187561035
generate_one_block  0.01524209976196289
generate_one_block  0.023121118545532227
generate_one_block  0.016902923583984375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02069854736328125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

connection checking time:  1.4632105827331543
block generation total time  1.269331455230713
average batch blocks generation time:  0.03966660797595978
block dataloader generation time/epoch 23.110005378723145
pseudo mini batch 0 input nodes size: 21860
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01919412612915039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01919412612915039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.029617786407470703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.029639720916748047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.021983623504638672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022598743438720703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022598743438720703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022598743438720703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([21860, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022598743438720703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([667, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.051682472229003906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.051682472229003906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 667, 128]), torch.Size([1, 667, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.052318572998046875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05814409255981445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 667, 128])
m.shape torch.Size([719, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05851173400878906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05851173400878906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 719, 128]), torch.Size([1, 719, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.059197425842285156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06948280334472656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 719, 128])
m.shape torch.Size([770, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07024145126342773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07024145126342773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 770, 128]), torch.Size([1, 770, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07097578048706055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08713102340698242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 770, 128])
m.shape torch.Size([651, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08816862106323242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08816862106323242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 651, 128]), torch.Size([1, 651, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08878946304321289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10735273361206055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 651, 128])
m.shape torch.Size([696, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10870170593261719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10870170593261719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 696, 128]), torch.Size([1, 696, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10936546325683594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13326072692871094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 696, 128])
m.shape torch.Size([558, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13452529907226562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13452529907226562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1350574493408203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1580677032470703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([486, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.159423828125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.159423828125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 486, 128]), torch.Size([1, 486, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15988731384277344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1830615997314453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 486, 128])
m.shape torch.Size([461, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18458843231201172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18458843231201172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.185028076171875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21008777618408203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([374, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2114729881286621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2114729881286621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21182966232299805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23465681076049805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 374, 128])
m.shape torch.Size([3440, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2508816719055176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2508816719055176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 3440, 128]), torch.Size([1, 3440, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2541623115539551  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48770952224731445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 3440, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4621124267578125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47052574157714844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4789390563964844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4704599380493164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([8822, 256])
first layer input nodes number: 21860
first layer output nodes number: 8822
edges number: 58703
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47910404205322266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4875173568725586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4897193908691406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4897193908691406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([399, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5138483047485352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5138483047485352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5146093368530273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5213775634765625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([331, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5216336250305176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5216336250305176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5222649574279785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5330853462219238  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([308, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5336580276489258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5336580276489258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.534245491027832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5475664138793945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([220, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5481185913085938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5481185913085938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5485382080078125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5607070922851562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([243, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5616650581359863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5616650581359863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5621285438537598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5788140296936035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([154, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5794706344604492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5794706344604492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5797643661499023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5923948287963867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5931563377380371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5931563377380371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5934138298034668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6062884330749512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([134, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6072111129760742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6072111129760742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6074666976928711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.622035026550293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([99, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6227636337280273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6227636337280273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6229524612426758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6350374221801758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([97, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6358757019042969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6358757019042969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6360607147216797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6491966247558594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6498336791992188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6498336791992188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6499652862548828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6602306365966797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6609725952148438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6609725952148438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6611061096191406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.672454833984375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([72, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6732878684997559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6732878684997559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6734251976013184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6860594749450684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6867713928222656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6867713928222656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6868820190429688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6978340148925781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([55, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6985716819763184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6985716819763184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.698676586151123  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7097964286804199  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.710451602935791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.710451602935791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7105393409729004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7204537391662598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7210311889648438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7210311889648438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7211036682128906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7298011779785156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.730318546295166  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.730318546295166  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.730379581451416  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.738131046295166  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7385940551757812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7385940551757812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7386455535888672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7455463409423828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7460975646972656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7460975646972656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.74615478515625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7542228698730469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7545175552368164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7545175552368164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7545480728149414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7590646743774414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7594304084777832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7594304084777832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7594647407531738  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7647862434387207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7650566101074219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7650566101074219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7650814056396484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7690982818603516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7693629264831543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7693629264831543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.769385814666748  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7732539176940918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([251, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.779698371887207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.779698371887207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.780177116394043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.864436149597168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 251, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8444099426269531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.844846248626709  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8452825546264648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8448243141174316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2927, 40])
input nodes number: 8822
output nodes number: 2927
edges number: 23719
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8449134826660156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.844914436340332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02378702163696289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 1 input nodes size: 24618
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.021986007690429688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.021986007690429688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03372478485107422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03374671936035156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.023301124572753906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.023960113525390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.023960113525390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.023960113525390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([24618, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.023960113525390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([577, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.055457115173339844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.055457115173339844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05600738525390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.061242103576660156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([659, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06159543991088867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06159543991088867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 659, 128]), torch.Size([1, 659, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06222391128540039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07165098190307617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 659, 128])
m.shape torch.Size([633, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07224225997924805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07224225997924805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 633, 128]), torch.Size([1, 633, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0728459358215332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08643388748168945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 633, 128])
m.shape torch.Size([596, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08726882934570312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08726882934570312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 596, 128]), torch.Size([1, 596, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08783721923828125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10477638244628906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 596, 128])
m.shape torch.Size([581, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10587739944458008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10587739944458008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10643148422241211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12659358978271484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([516, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1277928352355957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1277928352355957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12828493118286133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1500248908996582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([454, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15129423141479492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15129423141479492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 454, 128]), torch.Size([1, 454, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15172719955444336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17337560653686523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 454, 128])
m.shape torch.Size([417, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17474985122680664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17474985122680664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 417, 128]), torch.Size([1, 417, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17514753341674805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1978154182434082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 417, 128])
m.shape torch.Size([367, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19919157028198242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19919157028198242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 367, 128]), torch.Size([1, 367, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19954156875610352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22194147109985352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 367, 128])
m.shape torch.Size([4176, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24167919158935547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24167919158935547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 4176, 128]), torch.Size([1, 4176, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24566173553466797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5284223556518555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 4176, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5001335144042969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5086936950683594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5172538757324219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5086264610290527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([8976, 256])
first layer input nodes number: 24618
first layer output nodes number: 8976
edges number: 63756
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5174393653869629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5259995460510254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5284104347229004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5284104347229004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([365, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5525112152099609  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5525112152099609  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5532073974609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5593528747558594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 365, 256])
m.shape torch.Size([336, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5596508979797363  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5596508979797363  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5602917671203613  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5718731880187988  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([283, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5723690986633301  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5723690986633301  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.572908878326416  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5888729095458984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5894951820373535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5894951820373535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.589937686920166  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6027703285217285  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([213, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.603999137878418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.603999137878418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.604405403137207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6190309524536133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([192, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6199350357055664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6199350357055664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6203012466430664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6360483169555664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([150, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6368746757507324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6368746757507324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6371607780456543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.651465892791748  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([133, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6523456573486328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6523456573486328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6525993347167969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6670589447021484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([109, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6678752899169922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6678752899169922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6680831909179688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6813888549804688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([91, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6821599006652832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6821599006652832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6823334693908691  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6946568489074707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([81, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6954264640808105  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6954264640808105  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6955809593200684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7076315879821777  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([76, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7084312438964844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7084312438964844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7085762023925781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7208976745605469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7215876579284668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7215876579284668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7217040061950684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7324080467224121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([55, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7330904006958008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7330904006958008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7331953048706055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7435808181762695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7441196441650391  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7441196441650391  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7441978454589844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7524871826171875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([45, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7531404495239258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7531404495239258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7532262802124023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7629251480102539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7633891105651855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7633891105651855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7634482383728027  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7705435752868652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7708258628845215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7708258628845215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7708601951599121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7752203941345215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7756600379943848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7756600379943848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7757077217102051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.782097339630127  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.782496452331543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.782496452331543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7825384140014648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7884550094604492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7888784408569336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7888784408569336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7889204025268555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.795130729675293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7956809997558594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7956809997558594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7957324981689453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8037147521972656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8039765357971191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8039765357971191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8040013313293457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8080182075500488  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8085136413574219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8085136413574219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8085556030273438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8156471252441406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([284, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8224501609802246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8224501609802246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8229918479919434  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9203753471374512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 284, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8993840217590332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8998203277587891  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9002566337585449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8997983932495117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2927, 40])
input nodes number: 8976
output nodes number: 2927
edges number: 24486
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8998875617980957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8998880386352539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.025220870971679688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 2 input nodes size: 22021
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.023301124572753906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.023301124572753906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03380155563354492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03382301330566406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022062301635742188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022640228271484375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022640228271484375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022640228271484375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([22021, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022640228271484375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([752, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05108451843261719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05108451843261719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 752, 128]), torch.Size([1, 752, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05180168151855469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05784177780151367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 752, 128])
m.shape torch.Size([833, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05827760696411133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05827760696411133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.059072017669677734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07098817825317383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([719, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07161951065063477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07161951065063477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 719, 128]), torch.Size([1, 719, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07230520248413086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08769512176513672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 719, 128])
m.shape torch.Size([607, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08851003646850586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08851003646850586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08908891677856445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10633230209350586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([547, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10734701156616211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10734701156616211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10786867141723633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12749576568603516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([503, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12867403030395508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12867403030395508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 503, 128]), torch.Size([1, 503, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12915372848510742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1497807502746582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 503, 128])
m.shape torch.Size([432, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15098285675048828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15098285675048828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 432, 128]), torch.Size([1, 432, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15139484405517578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17199420928955078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 432, 128])
m.shape torch.Size([424, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17340564727783203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17340564727783203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 424, 128]), torch.Size([1, 424, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17381000518798828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19685840606689453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 424, 128])
m.shape torch.Size([359, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1981968879699707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1981968879699707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 359, 128]), torch.Size([1, 359, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19853925704956055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22045087814331055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 359, 128])
m.shape torch.Size([3348, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23624420166015625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23624420166015625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 3348, 128]), torch.Size([1, 3348, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23981094360351562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47091245651245117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 3348, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44644927978515625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4545783996582031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46270751953125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4545145034790039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([8524, 256])
first layer input nodes number: 22021
first layer output nodes number: 8524
edges number: 55883
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4628739356994629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47100305557250977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4730353355407715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4730353355407715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([460, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49437952041625977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49437952041625977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4952569007873535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5024914741516113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([380, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5027832984924316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5027832984924316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5035080909729004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5144486427307129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([291, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.514925479888916  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.514925479888916  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5154805183410645  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.528327465057373  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([229, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5289306640625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5289306640625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5293674468994141  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5420341491699219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5427002906799316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5427002906799316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5430512428283691  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5556855201721191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([182, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5565886497497559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5565886497497559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5569357872009277  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5718626976013184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5725841522216797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5725841522216797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5728378295898438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5855216979980469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([129, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5863871574401855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5863871574401855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5866332054138184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6006579399108887  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([109, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.601478099822998  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.601478099822998  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6016860008239746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6149916648864746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6156182289123535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6156182289123535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6157631874084473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6260552406311035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6266913414001465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6266913414001465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6268191337585449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.636786937713623  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6373343467712402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6373343467712402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6374354362487793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6460280418395996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6465649604797363  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6465649604797363  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6466546058654785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6549019813537598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6552877426147461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6552877426147461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6553487777709961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6613912582397461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6620240211486816  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6620240211486816  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.662111759185791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6714119911193848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6719989776611328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6719989776611328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6720771789550781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6809139251708984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6814308166503906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6814308166503906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6814956665039062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6892776489257812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6899199485778809  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6899199485778809  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6899943351745605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6994414329528809  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6998610496520996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6998610496520996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6999087333679199  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7062983512878418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7068705558776855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7068705558776855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7069296836853027  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7152667045593262  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7156209945678711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7156209945678711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7156572341918945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7210206985473633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7214045524597168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7214045524597168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7214407920837402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.727057933807373  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7275261878967285  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7275261878967285  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7275681495666504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7343659400939941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7346220016479492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7346220016479492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.734644889831543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7385129928588867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([205, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7434277534484863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7434277534484863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7438187599182129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8126358985900879  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 205, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7944860458374023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7949132919311523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7953405380249023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7948918342590332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2865, 40])
input nodes number: 8524
output nodes number: 2865
edges number: 21614
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7949681282043457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7949686050415039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.023758888244628906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 3 input nodes size: 12611
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022053241729736328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022053241729736328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.028066635131835938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02808856964111328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.017566680908203125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018001556396484375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018001556396484375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018001556396484375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([12611, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018001556396484375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([662, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.036252498626708984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.036252498626708984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 662, 128]), torch.Size([1, 662, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03688383102416992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.042774200439453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 662, 128])
m.shape torch.Size([679, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0431060791015625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0431060791015625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 679, 128]), torch.Size([1, 679, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.043753623962402344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.053466796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 679, 128])
m.shape torch.Size([592, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05398988723754883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05398988723754883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05455446243286133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06784725189208984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([536, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0685873031616211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0685873031616211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 536, 128]), torch.Size([1, 536, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06909847259521484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0839223861694336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 536, 128])
m.shape torch.Size([440, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0847158432006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0847158432006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 440, 128]), torch.Size([1, 440, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08513545989990234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10024166107177734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 440, 128])
m.shape torch.Size([353, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10104179382324219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10104179382324219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 353, 128]), torch.Size([1, 353, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1013784408569336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11585426330566406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 353, 128])
m.shape torch.Size([306, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11670732498168945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11670732498168945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 306, 128]), torch.Size([1, 306, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11699914932250977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1315903663635254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 306, 128])
m.shape torch.Size([313, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13263845443725586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13263845443725586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 313, 128]), torch.Size([1, 313, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13293695449829102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14995145797729492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 313, 128])
m.shape torch.Size([253, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15176868438720703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15176868438720703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 253, 128]), torch.Size([1, 253, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1520099639892578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1674518585205078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 253, 128])
m.shape torch.Size([1937, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17656755447387695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17656755447387695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 1937, 128]), torch.Size([1, 1937, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17841482162475586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3095707893371582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 1937, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.294003963470459  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.29979372024536133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.30564308166503906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2998080253601074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([6071, 256])
first layer input nodes number: 12611
first layer output nodes number: 6071
edges number: 36551
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3057394027709961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.31152915954589844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3129768371582031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3129768371582031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([458, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.33440208435058594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.33440208435058594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.33527565002441406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34226417541503906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([383, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3425636291503906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3425636291503906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3432941436767578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3542518615722656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([299, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3547492027282715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3547492027282715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3553194999694824  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36794281005859375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([249, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36861515045166016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36861515045166016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36909008026123047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38286304473876953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38359642028808594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38359642028808594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38398170471191406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39785194396972656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([154, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3985476493835449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3985476493835449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39884138107299805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4114718437194824  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41216611862182617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41216611862182617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41240453720092773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42432546615600586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([136, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42526817321777344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42526817321777344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42552757263183594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44031333923339844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44097089767456055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44097089767456055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4411444664001465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4522528648376465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4530215263366699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4530215263366699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45319128036499023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4652438163757324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4658675193786621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4658675193786621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46599531173706055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47596311569213867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47669506072998047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47669506072998047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47682666778564453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48801326751708984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48867225646972656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48867225646972656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4887828826904297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4989604949951172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([59, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49969911575317383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49969911575317383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49981164932250977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5109524726867676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.511444091796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.511444091796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5115165710449219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5191993713378906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5197324752807617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5197324752807617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5198030471801758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5277776718139648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5282983779907227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5282983779907227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5283632278442383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5361452102661133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5366840362548828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5366840362548828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5367469787597656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5447406768798828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5453667640686035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5453667640686035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5454354286193848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5546364784240723  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5550827980041504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5550827980041504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5551304817199707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5618538856506348  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5623550415039062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5623550415039062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5624046325683594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5697441101074219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5702905654907227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5702905654907227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5703420639038086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5783243179321289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5786967277526855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5786967277526855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5787310600280762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5842928886413574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5846219062805176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5846219062805176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5846505165100098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5894856452941895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([176, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5937004089355469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5937004089355469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5940361022949219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6531181335449219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 176, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6349520683288574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6353850364685059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6358180046081543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6353631019592285  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2904, 40])
input nodes number: 6071
output nodes number: 2904
edges number: 21700
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6354360580444336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6354365348815918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018867969512939453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 4 input nodes size: 13244
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.017572402954101562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.017572402954101562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02388763427734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02390909194946289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.017873764038085938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01825237274169922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01825237274169922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01825237274169922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([13244, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01825237274169922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([747, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.035169124603271484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.035169124603271484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 747, 128]), torch.Size([1, 747, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03588151931762695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0421910285949707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 747, 128])
m.shape torch.Size([782, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.042580604553222656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.042580604553222656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 782, 128]), torch.Size([1, 782, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.043326377868652344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0546269416809082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 782, 128])
m.shape torch.Size([683, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05559730529785156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05559730529785156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 683, 128]), torch.Size([1, 683, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05624866485595703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07065677642822266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 683, 128])
m.shape torch.Size([605, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07148504257202148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07148504257202148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07206201553344727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08879423141479492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([525, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09043025970458984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09043025970458984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09093093872070312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10895538330078125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([392, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10982656478881836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10982656478881836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 392, 128]), torch.Size([1, 392, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11020040512084961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12627553939819336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 392, 128])
m.shape torch.Size([328, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1271834373474121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1271834373474121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12749624252319336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14313650131225586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([275, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1440291404724121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1440291404724121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 275, 128]), torch.Size([1, 275, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14429140090942383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1592402458190918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 275, 128])
m.shape torch.Size([259, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1603546142578125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1603546142578125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 259, 128]), torch.Size([1, 259, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16060161590576172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17640972137451172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 259, 128])
m.shape torch.Size([1512, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18349599838256836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18349599838256836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 1512, 128]), torch.Size([1, 1512, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1849379539489746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2881026268005371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 1512, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.27409982681274414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2799248695373535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2857499122619629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.279879093170166  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([6108, 256])
first layer input nodes number: 13244
first layer output nodes number: 6108
edges number: 33704
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28585052490234375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2916755676269531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.293731689453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.293731689453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([503, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3106555938720703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3106555938720703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 503, 256]), torch.Size([1, 503, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.311614990234375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3202171325683594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 503, 256])
m.shape torch.Size([436, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3205757141113281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3205757141113281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3214073181152344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.33446598052978516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([334, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.33501338958740234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.33501338958740234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3356504440307617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35081958770751953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([292, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3517594337463379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3517594337463379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35231637954711914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36916208267211914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([226, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36996984481811523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36996984481811523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37040090560913086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38591909408569336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([172, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38669586181640625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38669586181640625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38702392578125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40113067626953125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([141, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4019155502319336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4019155502319336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40218448638916016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4156312942504883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4164118766784668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4164118766784668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4166388511657715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42957639694213867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([109, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4304060935974121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4304060935974121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43061399459838867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44391965866088867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4445657730102539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4445657730102539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4447145462036133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4552774429321289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45594358444213867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45594358444213867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45607709884643555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4664912223815918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([47, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4669666290283203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4669666290283203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4670562744140625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47467613220214844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47524356842041016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47524356842041016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47533702850341797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4839353561401367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48442697525024414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48442697525024414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48450326919555664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49205636978149414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49260950088500977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49260950088500977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4926877021789551  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5009770393371582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5013227462768555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5013227462768555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5013704299926758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5067586898803711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.507176399230957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.507176399230957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.507227897644043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5134077072143555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5137801170349121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5137801170349121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5138239860534668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5193953514099121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5196475982666016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5196475982666016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5196762084960938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5235099792480469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5237841606140137  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5237841606140137  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5238127708435059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5278468132019043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5279741287231445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5279741287231445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5279874801635742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.529963493347168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5301475524902344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5301475524902344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5301647186279297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5328254699707031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5330824851989746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5330824851989746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5331053733825684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5368132591247559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5370559692382812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5370559692382812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5370769500732422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5406227111816406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([67, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5422224998474121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5422224998474121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5423502922058105  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5648417472839355  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 67, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5512533187866211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5516810417175293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5521087646484375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5516595840454102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2868, 40])
input nodes number: 6108
output nodes number: 2868
edges number: 16971
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5517215728759766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5517220497131348  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019021034240722656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 5 input nodes size: 12441
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.017868518829345703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.017868518829345703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.023881912231445312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.023903846740722656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.017567157745361328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01800680160522461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01800680160522461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01800680160522461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([12441, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01800680160522461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([660, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.037003517150878906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.037003517150878906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 660, 128]), torch.Size([1, 660, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03763294219970703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04278755187988281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 660, 128])
m.shape torch.Size([672, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04311370849609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04311370849609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 672, 128]), torch.Size([1, 672, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04375457763671875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05338144302368164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 672, 128])
m.shape torch.Size([641, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05397796630859375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05397796630859375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 641, 128]), torch.Size([1, 641, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.054589271545410156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06814289093017578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 641, 128])
m.shape torch.Size([598, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06897783279418945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06897783279418945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06954813003540039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08608675003051758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([501, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08699607849121094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08699607849121094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08747386932373047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1046743392944336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([439, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10569143295288086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10569143295288086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 439, 128]), torch.Size([1, 439, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1061100959777832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12411260604858398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 439, 128])
m.shape torch.Size([371, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12514162063598633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12514162063598633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 371, 128]), torch.Size([1, 371, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12549543380737305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14318609237670898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 371, 128])
m.shape torch.Size([314, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14420700073242188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14420700073242188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 314, 128]), torch.Size([1, 314, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14450645446777344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1615753173828125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 314, 128])
m.shape torch.Size([297, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16270017623901367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16270017623901367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 297, 128]), torch.Size([1, 297, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16298341751098633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18111085891723633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 297, 128])
m.shape torch.Size([1883, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18994808197021484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18994808197021484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 1883, 128]), torch.Size([1, 1883, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1917438507080078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.32014036178588867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 1883, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3040041923522949  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.31008481979370117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3161654472351074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.31003713607788086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([6376, 256])
first layer input nodes number: 12441
first layer output nodes number: 6376
edges number: 38070
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.31626033782958984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3223409652709961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3239145278930664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3239145278930664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([405, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3444051742553711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3444051742553711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34517765045166016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3514432907104492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([356, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3517417907714844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3517417907714844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3524208068847656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3639822006225586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([320, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.364565372467041  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.364565372467041  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.365175724029541  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3794369697570801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([274, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3802495002746582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3802495002746582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38077211380004883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3966069221496582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([217, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3973884582519531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3973884582519531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39780235290527344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4127025604248047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([184, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4135570526123047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4135570526123047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4139080047607422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4289989471435547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([171, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4299740791320801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4299740791320801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.430300235748291  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4466080665588379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4473142623901367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4473142623901367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44752979278564453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45981502532958984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([130, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4608321189880371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4608321189880371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46108007431030273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47694921493530273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([102, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47780561447143555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47780561447143555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4780001640319824  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49181318283081055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([79, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.492551326751709  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.492551326751709  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49270200729370117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5044550895690918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5052452087402344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5052452087402344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5053882598876953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.517547607421875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.518338680267334  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.518338680267334  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.518470287322998  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5305781364440918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([55, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5312528610229492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5312528610229492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5313577651977539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.541743278503418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5423831939697266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5423831939697266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5424747467041016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5521793365478516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5526413917541504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5526413917541504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5527043342590332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.559816837310791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5602269172668457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5602269172668457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5602784156799316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5664582252502441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5669345855712891  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5669345855712891  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5669898986816406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5740146636962891  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5745534896850586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5745534896850586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5746126174926758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5825357437133789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5830445289611816  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5830445289611816  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5830979347229004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5906281471252441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5910053253173828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5910053253173828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5910434722900391  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5966892242431641  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5969452857971191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5969452857971191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5969700813293457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6008133888244629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6011548042297363  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6011548042297363  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6011853218078613  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6061291694641113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6063909530639648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6063909530639648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6064138412475586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6102819442749023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([118, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6131062507629395  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6131062507629395  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6133313179016113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6529431343078613  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 118, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6357293128967285  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6361656188964844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6366019248962402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.636143684387207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2925, 40])
input nodes number: 6376
output nodes number: 2925
edges number: 20779
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6362218856811523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6362223625183105  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018879413604736328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 6 input nodes size: 10777
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.017575740814208984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.017575740814208984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022714614868164062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022736549377441406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.016701221466064453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.017041683197021484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.017041683197021484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.017041683197021484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([10777, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.017041683197021484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([717, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031511783599853516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031511783599853516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0321955680847168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03766584396362305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([778, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03806591033935547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03806591033935547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 778, 128]), torch.Size([1, 778, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03880786895751953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.050142765045166016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 778, 128])
m.shape torch.Size([663, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05072021484375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05072021484375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 663, 128]), torch.Size([1, 663, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.051352500915527344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0652627944946289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 663, 128])
m.shape torch.Size([530, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06609869003295898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06609869003295898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0666041374206543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08153104782104492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([486, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08243703842163086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08243703842163086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 486, 128]), torch.Size([1, 486, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0829005241394043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09958600997924805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 486, 128])
m.shape torch.Size([369, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10040998458862305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10040998458862305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 369, 128]), torch.Size([1, 369, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10076189041137695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11589384078979492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 369, 128])
m.shape torch.Size([326, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1168060302734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1168060302734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 326, 128]), torch.Size([1, 326, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11711692810058594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1326618194580078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 326, 128])
m.shape torch.Size([267, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13352489471435547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13352489471435547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 267, 128]), torch.Size([1, 267, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13377952575683594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14829349517822266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 267, 128])
m.shape torch.Size([212, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14907598495483398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14907598495483398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 212, 128]), torch.Size([1, 212, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1492781639099121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1622176170349121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 212, 128])
m.shape torch.Size([1138, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1675429344177246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1675429344177246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16862821578979492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2464432716369629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23470544815063477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23993730545043945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24516916275024414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23989629745483398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([5486, 256])
first layer input nodes number: 10777
first layer output nodes number: 5486
edges number: 28732
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24525165557861328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25048351287841797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25265026092529297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25265026092529297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([503, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2694520950317383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2694520950317383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 503, 256]), torch.Size([1, 503, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.27041149139404297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2783346176147461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 503, 256])
m.shape torch.Size([448, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2787160873413086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2787160873413086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2795705795288086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2926521301269531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 448, 256])
m.shape torch.Size([359, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.29331445693969727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.29331445693969727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.29399919509887695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3101840019226074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([246, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3107876777648926  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3107876777648926  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.31125688552856445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.32486391067504883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([250, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.32596349716186523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.32596349716186523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.32644033432006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34360647201538086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([195, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34449291229248047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34449291229248047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3448648452758789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3608579635620117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([174, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3618431091308594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3618431091308594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36217498779296875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3787689208984375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3795180320739746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3795180320739746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3797450065612793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3926825523376465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39336490631103516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39336490631103516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3935403823852539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4047708511352539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40535593032836914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40535593032836914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.405489444732666  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41496896743774414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.415557861328125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.415557861328125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4156761169433594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4249000549316406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4255218505859375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4255218505859375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42563438415527344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4351997375488281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43561840057373047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43561840057373047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43569087982177734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44235897064208984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44283437728881836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44283437728881836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44290685653686523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45008230209350586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45055103302001953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45055103302001953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45061779022216797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45769405364990234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45809125900268555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45809125900268555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4581446647644043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46417951583862305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4644961357116699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4644961357116699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.464536190032959  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4693427085876465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4696345329284668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4696345329284668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4696688652038574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4740290641784668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4741945266723633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4741945266723633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4742136001586914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47676944732666016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47701025009155273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47701025009155273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4770350456237793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4805312156677246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4808216094970703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4808216094970703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4808502197265625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48508453369140625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48528194427490234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48528194427490234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48530101776123047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48825740814208984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48857975006103516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48857975006103516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48860836029052734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4932432174682617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49341344833374023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49341344833374023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49342870712280273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49600744247436523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([67, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49761009216308594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49761009216308594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4977378845214844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5202293395996094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 67, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5073189735412598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5077505111694336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5081820487976074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5077285766601562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2893, 40])
input nodes number: 5486
output nodes number: 2893
edges number: 16845
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.507786750793457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5077872276306152  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01773977279663086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 7 input nodes size: 11376
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.016696453094482422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.016696453094482422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02270984649658203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022731304168701172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01757049560546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01801013946533203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01801013946533203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01801013946533203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([11376, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01801013946533203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([537, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03574323654174805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03574323654174805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 537, 128]), torch.Size([1, 537, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0362553596496582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.040843963623046875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 537, 128])
m.shape torch.Size([612, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04117155075073242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04117155075073242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 612, 128]), torch.Size([1, 612, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04175519943237305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05130767822265625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 612, 128])
m.shape torch.Size([542, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05179119110107422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05179119110107422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.052308082580566406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06367969512939453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([449, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06427764892578125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06427764892578125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 449, 128]), torch.Size([1, 449, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06470584869384766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07712364196777344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 449, 128])
m.shape torch.Size([368, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07778692245483398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07778692245483398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 368, 128]), torch.Size([1, 368, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07813787460327148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09077215194702148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 368, 128])
m.shape torch.Size([342, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09157514572143555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09157514572143555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 342, 128]), torch.Size([1, 342, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09190130233764648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1059260368347168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 342, 128])
m.shape torch.Size([291, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1067342758178711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1067342758178711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 291, 128]), torch.Size([1, 291, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10701179504394531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12088775634765625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 291, 128])
m.shape torch.Size([263, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12175226211547852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12175226211547852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 263, 128]), torch.Size([1, 263, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12200307846069336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13629961013793945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 263, 128])
m.shape torch.Size([223, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1371312141418457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1371312141418457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 223, 128]), torch.Size([1, 223, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1373438835144043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1509547233581543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 223, 128])
m.shape torch.Size([2041, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16058063507080078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16058063507080078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 2041, 128]), torch.Size([1, 2041, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16252708435058594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3010587692260742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 2041, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28568363189697266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2910890579223633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2971067428588867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.291658878326416  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([5668, 256])
first layer input nodes number: 11376
first layer output nodes number: 5668
edges number: 35633
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2971935272216797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3025989532470703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3046121597290039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3046121597290039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([375, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.327486515045166  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.327486515045166  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3282017707824707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.33478212356567383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([376, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3351473808288574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3351473808288574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3358645439147949  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3466219902038574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([298, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3471226692199707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3471226692199707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34769105911254883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3608236312866211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3614315986633301  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3614315986633301  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3618741035461426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3747067451477051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([189, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3753938674926758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3753938674926758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37575435638427734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3887319564819336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3894228935241699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3894228935241699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3897109031677246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40209531784057617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40280580520629883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40280580520629883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.403048038482666  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4151597023010254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41586923599243164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41586923599243164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4160752296447754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42781686782836914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([109, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42865705490112305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42865705490112305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4288649559020996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4421706199645996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4428839683532715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4428839683532715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44304609298706055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.454556941986084  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4552798271179199  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4552798271179199  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45542478561401367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46673154830932617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([85, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4676394462585449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4676394462585449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.467801570892334  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4815821647644043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4821133613586426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4821133613586426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4822068214416504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49080514907836914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49144506454467773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49144506454467773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49154233932495117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5011725425720215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5016865730285645  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5016865730285645  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5017609596252441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.509645938873291  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5103316307067871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5103316307067871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5104212760925293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5205512046813965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5210785865783691  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5210785865783691  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5211453437805176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5291562080383301  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([43, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5298671722412109  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5298671722412109  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5299491882324219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5403652191162109  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5409088134765625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5409088134765625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5409698486328125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5491485595703125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.549464225769043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.549464225769043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5494985580444336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5543394088745117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5549883842468262  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5549883842468262  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.555051326751709  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5643668174743652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5648431777954102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5648431777954102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5648889541625977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5719842910766602  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5724921226501465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5724921226501465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.572537899017334  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.579953670501709  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5803232192993164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5803232192993164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5803556442260742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5858354568481445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([234, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5914421081542969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5914421081542969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.591888427734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.670440673828125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 234, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6506557464599609  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6510815620422363  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6515073776245117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6510601043701172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2857, 40])
input nodes number: 5668
output nodes number: 2857
edges number: 23296
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.651118278503418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6511187553405762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01886272430419922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 8 input nodes size: 12964
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.017564773559570312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.017564773559570312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.023746490478515625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02376842498779297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01773357391357422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01823139190673828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01823139190673828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01823139190673828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([12964, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01823139190673828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([394, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03894996643066406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03894996643066406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 394, 128]), torch.Size([1, 394, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.039325714111328125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.042331695556640625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 394, 128])
m.shape torch.Size([461, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.042583465576171875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.042583465576171875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.043023109436035156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.049617767333984375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([466, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0500645637512207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0500645637512207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 466, 128]), torch.Size([1, 466, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.050508975982666016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06028604507446289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 466, 128])
m.shape torch.Size([460, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.060941219329833984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.060941219329833984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 460, 128]), torch.Size([1, 460, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06137990951538086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07410192489624023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 460, 128])
m.shape torch.Size([413, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07535934448242188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07535934448242188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 413, 128]), torch.Size([1, 413, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07575321197509766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08993244171142578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 413, 128])
m.shape torch.Size([410, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09090852737426758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09090852737426758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 410, 128]), torch.Size([1, 410, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09129953384399414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10811281204223633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 410, 128])
m.shape torch.Size([350, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1090855598449707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1090855598449707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 350, 128]), torch.Size([1, 350, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10941934585571289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12610864639282227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 350, 128])
m.shape torch.Size([319, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12715864181518555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12715864181518555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 319, 128]), torch.Size([1, 319, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12746286392211914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14480352401733398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 319, 128])
m.shape torch.Size([253, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14576435089111328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14576435089111328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 253, 128]), torch.Size([1, 253, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14600563049316406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16144752502441406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 253, 128])
m.shape torch.Size([2555, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17351007461547852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17351007461547852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 2555, 128]), torch.Size([1, 2555, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17621707916259766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34952354431152344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 2555, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3311014175415039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3369007110595703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3427000045776367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3368549346923828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([6081, 256])
first layer input nodes number: 12964
first layer output nodes number: 6081
edges number: 41908
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34279870986938477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34859800338745117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35060977935791016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35060977935791016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([294, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37483739852905273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37483739852905273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3753981590270996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3805413246154785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([305, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3808474540710449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3808474540710449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38142919540405273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39087963104248047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([270, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39136743545532227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39136743545532227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39188241958618164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4035344123840332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([234, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4041767120361328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4041767120361328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40462303161621094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41756629943847656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([211, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41835737228393555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41835737228393555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.418759822845459  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43324804306030273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([212, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4348330497741699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4348330497741699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43523740768432617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4526247978210449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([174, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45359373092651367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45359373092651367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45392560958862305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4705195426940918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([137, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.471407413482666  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.471407413482666  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47166872024536133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48656320571899414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4873237609863281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4873237609863281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4875202178955078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5000934600830078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([125, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5011968612670898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5011968612670898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5014352798461914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5183629989624023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([105, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5193543434143066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5193543434143066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.519554615020752  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5351758003234863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5358834266662598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5358834266662598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5360169410705566  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.547365665435791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([72, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5481986999511719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5481986999511719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5483360290527344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5609703063964844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([63, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5617494583129883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5617494583129883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5618696212768555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.573765754699707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5742826461791992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5742826461791992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5743589401245117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5824460983276367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5830845832824707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5830845832824707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5831685066223145  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5926518440246582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5936069488525391  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5936069488525391  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5937232971191406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6076850891113281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6082501411437988  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6082501411437988  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6083188056945801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6170392036437988  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6174798011779785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6174798011779785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6175293922424316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6241745948791504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6249189376831055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6249189376831055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.624995231628418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6357526779174805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6362595558166504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6362595558166504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6363110542297363  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6439328193664551  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6443724632263184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6443724632263184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6444144248962402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6509184837341309  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6513175964355469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6513175964355469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6513538360595703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6572246551513672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6577143669128418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6577143669128418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6577563285827637  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6648478507995605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([208, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6698250770568848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6698250770568848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6702218055725098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7400460243225098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 208, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7196559906005859  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7200913429260254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7205266952514648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.720069408416748  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2920, 40])
input nodes number: 6081
output nodes number: 2920
edges number: 24780
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.720146656036377  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7201471328735352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01919078826904297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 9 input nodes size: 15053
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01774311065673828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01774311065673828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.024920940399169922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.024942398071289062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018738746643066406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01923084259033203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01923084259033203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01923084259033203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([15053, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01923084259033203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([501, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.040669918060302734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.040669918060302734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.041147708892822266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.044970035552978516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([614, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04531669616699219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04531669616699219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 614, 128]), torch.Size([1, 614, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.045902252197265625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05515623092651367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 614, 128])
m.shape torch.Size([566, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05567312240600586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05567312240600586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0562129020690918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0688180923461914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([517, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0695343017578125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0695343017578125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07002735137939453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08443069458007812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([449, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08525466918945312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08525466918945312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 449, 128]), torch.Size([1, 449, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08568286895751953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10109806060791016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 449, 128])
m.shape torch.Size([402, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10203409194946289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10203409194946289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 402, 128]), torch.Size([1, 402, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1024174690246582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11890268325805664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 402, 128])
m.shape torch.Size([354, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11989259719848633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11989259719848633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 354, 128]), torch.Size([1, 354, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12023019790649414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13711023330688477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 354, 128])
m.shape torch.Size([329, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13819646835327148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13819646835327148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 329, 128]), torch.Size([1, 329, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13851022720336914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15639448165893555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 329, 128])
m.shape torch.Size([269, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15739202499389648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15739202499389648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 269, 128]), torch.Size([1, 269, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15764856338500977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17406702041625977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 269, 128])
m.shape torch.Size([2557, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18613147735595703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18613147735595703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 2557, 128]), torch.Size([1, 2557, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1885700225830078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36288928985595703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 2557, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34401941299438477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35027360916137695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3572964668273926  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35099315643310547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([6558, 256])
first layer input nodes number: 15053
first layer output nodes number: 6558
edges number: 43253
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35741090774536133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3636651039123535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36522865295410156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36522865295410156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([337, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38747692108154297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38747692108154297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3881196975708008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39406442642211914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([345, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3944063186645508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3944063186645508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3950643539428711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40497398376464844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([305, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40552473068237305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40552473068237305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40610647201538086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41890478134155273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([254, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41959047317504883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41959047317504883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4200749397277832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4341244697570801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43503284454345703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43503284454345703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43542957305908203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44971179962158203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([180, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45055150985717773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45055150985717773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.450894832611084  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46565771102905273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([143, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4664483070373535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4664483070373535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4667210578918457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4803586006164551  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([126, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48119115829467773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48119115829467773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4814314842224121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4951300621032715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([108, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4959444999694824  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4959444999694824  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49615049362182617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5093340873718262  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([99, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5101828575134277  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5101828575134277  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5103716850280762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5237784385681152  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([91, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5246462821960449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5246462821960449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5248198509216309  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.538358211517334  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5390558242797852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5390558242797852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5391855239868164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5502099990844727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([65, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5509576797485352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5509576797485352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.551081657409668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5624876022338867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([66, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5633139610290527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5633139610290527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5634398460388184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5759024620056152  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5764307975769043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5764307975769043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5765089988708496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5847983360290527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([52, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5855588912963867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5855588912963867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.585658073425293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5968656539916992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5973882675170898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5973882675170898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5974550247192383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6054658889770508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6061248779296875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6061248779296875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.606201171875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6158905029296875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6162910461425781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6162910461425781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6163368225097656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6224708557128906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6231784820556641  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6231784820556641  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6232509613037109  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6334705352783203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6340804100036621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6340804100036621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6341414451599121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6431746482849121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6435670852661133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6435670852661133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6436052322387695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6495180130004883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6498088836669922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6498088836669922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6498355865478516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6541614532470703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6545867919921875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6545867919921875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6546230316162109  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6607475280761719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([167, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6647424697875977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6647424697875977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6650609970092773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7211217880249023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 167, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7022013664245605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7026305198669434  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7030596733093262  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7026090621948242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2877, 40])
input nodes number: 6558
output nodes number: 2877
edges number: 22678
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7026734352111816  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7026739120483398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020179271697998047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 10 input nodes size: 17348
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018732547760009766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018732547760009766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.027004718780517578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02702617645263672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019826889038085938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020336151123046875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020336151123046875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020336151123046875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([17348, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020336151123046875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([583, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04277610778808594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04277610778808594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04333209991455078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04854011535644531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([603, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04883718490600586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04883718490600586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 603, 128]), torch.Size([1, 603, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04941225051879883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0589137077331543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 603, 128])
m.shape torch.Size([564, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0594329833984375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0594329833984375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.059970855712890625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07226943969726562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([495, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07294464111328125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07294464111328125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07341670989990234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08710670471191406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([436, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08791017532348633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08791017532348633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 436, 128]), torch.Size([1, 436, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08832597732543945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10329484939575195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 436, 128])
m.shape torch.Size([342, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1040654182434082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1040654182434082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 342, 128]), torch.Size([1, 342, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10439157485961914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11841630935668945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 342, 128])
m.shape torch.Size([308, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11928129196166992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11928129196166992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 308, 128]), torch.Size([1, 308, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11957502365112305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1342616081237793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 308, 128])
m.shape torch.Size([302, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13526678085327148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13526678085327148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 302, 128]), torch.Size([1, 302, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13555479049682617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15197134017944336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 302, 128])
m.shape torch.Size([259, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1529388427734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1529388427734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 259, 128]), torch.Size([1, 259, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15318584442138672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16899394989013672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 259, 128])
m.shape torch.Size([2863, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18252229690551758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18252229690551758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 2863, 128]), torch.Size([1, 2863, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18525266647338867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3841547966003418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 2863, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.363893985748291  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37033605575561523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3769831657409668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37049055099487305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([6755, 256])
first layer input nodes number: 17348
first layer output nodes number: 6755
edges number: 45226
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37711477279663086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3835568428039551  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38534069061279297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38534069061279297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([388, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40790367126464844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40790367126464844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4086437225341797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41489171981811523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([373, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4152388572692871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4152388572692871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41595029830932617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4267606735229492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([304, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42728185653686523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42728185653686523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42786169052124023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44061803817749023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([251, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44129323959350586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44129323959350586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4417719841003418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.455655574798584  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4563870429992676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4563870429992676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4567723274230957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4706425666809082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([141, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47126340866088867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47126340866088867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47153234481811523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4830965995788574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4838438034057617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4838438034057617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48409366607666016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49658679962158203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([114, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49733877182006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49733877182006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.497556209564209  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5099501609802246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([106, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5107583999633789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5107583999633789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.510960578918457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.523900032043457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([102, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5247793197631836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5247793197631836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5249738693237305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5387868881225586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5394086837768555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5394086837768555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5395383834838867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5496549606323242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5503859519958496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5503859519958496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5505175590515137  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.561704158782959  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.562413215637207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.562413215637207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5625314712524414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5734109878540039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([55, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5740923881530762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5740923881530762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5741972923278809  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5845828056335449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([55, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5853233337402344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5853233337402344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5854282379150391  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5965480804443359  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5968647003173828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5968647003173828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5969104766845703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6020832061767578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6025834083557129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6025834083557129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6026444435119629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6099686622619629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.610405445098877  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.610405445098877  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6104569435119629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.616997241973877  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6173553466796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6173553466796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6173954010009766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6227626800537109  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6231851577758789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6231851577758789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6232290267944336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6294145584106445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.629857063293457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.629857063293457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6299009323120117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6363935470581055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6368794441223145  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6368794441223145  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.636925220489502  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6440205574035645  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6442632675170898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6442632675170898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6442861557006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6479940414428711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6483750343322754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6483750343322754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6484074592590332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6538872718811035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([252, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6599264144897461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6599264144897461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6604070663452148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7450017929077148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 252, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7255401611328125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7259688377380371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7263975143432617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.725947380065918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2876, 40])
input nodes number: 6755
output nodes number: 2876
edges number: 22954
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7260189056396484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7260193824768066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02133035659790039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 11 input nodes size: 14420
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019826412200927734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019826412200927734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.026702404022216797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.026723861694335938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018430233001708984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018860340118408203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018860340118408203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018860340118408203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([14420, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018860340118408203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([598, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.037353515625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.037353515625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03792381286621094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04317474365234375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([608, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04346942901611328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04346942901611328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 608, 128]), torch.Size([1, 608, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04404926300048828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05274677276611328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 608, 128])
m.shape torch.Size([575, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05327939987182617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05327939987182617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.053827762603759766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06621408462524414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([478, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06685161590576172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06685161590576172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0673074722290039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08052730560302734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([396, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08124351501464844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08124351501464844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 396, 128]), torch.Size([1, 396, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08162117004394531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09521675109863281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 396, 128])
m.shape torch.Size([372, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09609222412109375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09609222412109375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 372, 128]), torch.Size([1, 372, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09644699096679688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11170196533203125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 372, 128])
m.shape torch.Size([303, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11256027221679688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11256027221679688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 303, 128]), torch.Size([1, 303, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11284923553466797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12729740142822266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 303, 128])
m.shape torch.Size([295, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12827825546264648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12827825546264648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 295, 128]), torch.Size([1, 295, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12855958938598633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14459562301635742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 295, 128])
m.shape torch.Size([250, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14552783966064453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14552783966064453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 250, 128]), torch.Size([1, 250, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1457662582397461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1610250473022461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 250, 128])
m.shape torch.Size([2073, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1707906723022461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1707906723022461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 2073, 128]), torch.Size([1, 2073, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17276763916015625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3188357353210449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 2073, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.30211400985717773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3077864646911621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.31414365768432617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3084268569946289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([5948, 256])
first layer input nodes number: 14420
first layer output nodes number: 5948
edges number: 37124
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3142533302307129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.31992578506469727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.32166433334350586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.32166433334350586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([427, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3418889045715332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3418889045715332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34270334243774414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3494577407836914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([390, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34980058670043945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34980058670043945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35054445266723633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36229896545410156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([315, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3628354072570801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3628354072570801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.363436222076416  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37666749954223633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([253, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37733983993530273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37733983993530273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3778223991394043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3918166160583496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([197, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39252233505249023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39252233505249023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3928980827331543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40642499923706055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40717172622680664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40717172622680664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40748071670532227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42076730728149414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42150115966796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42150115966796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4217529296875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4343414306640625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([130, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43521547317504883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43521547317504883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43546342849731445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4495968818664551  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([105, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4503812789916992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4503812789916992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45058155059814453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46339893341064453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4641256332397461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4641256332397461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46428966522216797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4759359359741211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([97, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4768795967102051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4768795967102051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4770646095275879  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49149560928344727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49226856231689453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49226856231689453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49241161346435547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5045709609985352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([65, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5053119659423828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5053119659423828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5054359436035156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5168418884277344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5173587799072266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5173587799072266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5174407958984375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5255603790283203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5261397361755371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5261397361755371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.526221752166748  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5349154472351074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5352745056152344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5352745056152344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5353240966796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5409278869628906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5413932800292969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5413932800292969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5414505004882812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5483169555664062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5486516952514648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5486516952514648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5486917495727539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5537786483764648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5543065071105957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5543065071105957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5543637275695801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5620312690734863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5624833106994629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5624833106994629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5625309944152832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5692543983459473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5695538520812988  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5695538520812988  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5695843696594238  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5741009712219238  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5744242668151855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5744242668151855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5744547843933105  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5791850090026855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.579369068145752  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.579369068145752  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5793862342834473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5821671485900879  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.582481861114502  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.582481861114502  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5825085639953613  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5870213508605957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([152, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.590660572052002  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.590660572052002  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5909504890441895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6419758796691895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 152, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6249499320983887  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6253762245178223  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6258025169372559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6253547668457031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2859, 40])
input nodes number: 5948
output nodes number: 2859
edges number: 20354
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6254181861877441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6254186630249023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01971435546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 12 input nodes size: 16161
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01842784881591797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01842784881591797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.026134014129638672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.026155948638916016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019258499145507812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019842147827148438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019842147827148438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019842147827148438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([16161, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019842147827148438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([549, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0461883544921875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0461883544921875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04671192169189453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05090045928955078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([625, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05123472213745117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05123472213745117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 625, 128]), torch.Size([1, 625, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05183076858520508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.061211585998535156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 625, 128])
m.shape torch.Size([642, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06183195114135742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06183195114135742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 642, 128]), torch.Size([1, 642, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.062444210052490234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07624578475952148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 642, 128])
m.shape torch.Size([532, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07695436477661133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07695436477661133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07746171951293945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09217500686645508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([533, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09319210052490234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09319210052490234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09370040893554688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11258649826049805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([476, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1136941909790039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1136941909790039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 476, 128]), torch.Size([1, 476, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11414813995361328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1336679458618164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 476, 128])
m.shape torch.Size([426, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13486289978027344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13486289978027344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 426, 128]), torch.Size([1, 426, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1352691650390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15558242797851562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 426, 128])
m.shape torch.Size([348, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1567068099975586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1567068099975586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 348, 128]), torch.Size([1, 348, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15703868865966797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17595577239990234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 348, 128])
m.shape torch.Size([326, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1779937744140625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1779937744140625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 326, 128]), torch.Size([1, 326, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17830467224121094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19820213317871094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 326, 128])
m.shape torch.Size([3299, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2137775421142578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2137775421142578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 3299, 128]), torch.Size([1, 3299, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21757793426513672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4488067626953125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 3299, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42473459243774414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.432131290435791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4395279884338379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43207311630249023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([7756, 256])
first layer input nodes number: 16161
first layer output nodes number: 7756
edges number: 53064
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4396505355834961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44704723358154297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4488964080810547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4488964080810547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([342, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4735879898071289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4735879898071289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4742403030395508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47959232330322266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([314, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4798698425292969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4798698425292969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48046875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4894523620605469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([284, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4899721145629883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4899721145629883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49051380157470703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5026044845581055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5032258033752441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5032258033752441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5036683082580566  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5165009498596191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([214, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.517308235168457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.517308235168457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5177164077758789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5324106216430664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([181, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5333495140075684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5333495140075684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5336947441101074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5485396385192871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([149, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5493698120117188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5493698120117188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5496540069580078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5638637542724609  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.564629077911377  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.564629077911377  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5648541450500488  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5776829719543457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([119, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5785999298095703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5785999298095703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.578826904296875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.593353271484375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([104, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5942397117614746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5942397117614746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5944380760192871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6085219383239746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6092157363891602  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6092157363891602  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6093587875366211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6205167770385742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6212530136108398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6212530136108398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6213865280151367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6327352523803711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([65, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6334810256958008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6334810256958008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6336050033569336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6450109481811523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([60, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.645756721496582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.645756721496582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6458711624145508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.657200813293457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6578359603881836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6578359603881836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6579275131225586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6676321029663086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.667971134185791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.667971134185791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6680188179016113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6734070777893066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6740531921386719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6740531921386719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6741313934326172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6835155487060547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6840476989746094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6840476989746094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6841106414794922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6921043395996094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6925115585327148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6925115585327148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6925573348999023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6986913681030273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([41, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6994566917419434  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6994566917419434  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6995348930358887  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7105612754821777  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7111077308654785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7111077308654785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7111630439758301  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7193493843078613  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7197237014770508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7197237014770508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7197599411010742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.725377082824707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7257571220397949  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7257571220397949  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7257914543151855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7313532829284668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7317285537719727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7317285537719727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7317609786987305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7372407913208008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([293, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.744265079498291  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.744265079498291  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7448239326477051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8453030586242676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 293, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8236837387084961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8241181373596191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8245525360107422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8240962028503418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2915, 40])
input nodes number: 7756
output nodes number: 2915
edges number: 25215
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8241844177246094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8241848945617676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020949840545654297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 13 input nodes size: 15233
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019266605377197266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019266605377197266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02653026580810547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.026551246643066406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01882314682006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019398212432861328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019398212432861328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019398212432861328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([15233, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019398212432861328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([439, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04566669464111328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04566669464111328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 439, 128]), torch.Size([1, 439, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.046085357666015625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.049434661865234375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 439, 128])
m.shape torch.Size([511, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0497126579284668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0497126579284668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05019998550415039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0575098991394043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([508, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05799293518066406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05799293518066406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 508, 128]), torch.Size([1, 508, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05847740173339844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06913566589355469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 508, 128])
m.shape torch.Size([450, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06975173950195312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06975173950195312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 450, 128]), torch.Size([1, 450, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07018089294433594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0826263427734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 450, 128])
m.shape torch.Size([443, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08346796035766602  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08346796035766602  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 443, 128]), torch.Size([1, 443, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08389043807983398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09909963607788086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 443, 128])
m.shape torch.Size([389, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10000133514404297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10000133514404297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 389, 128]), torch.Size([1, 389, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.100372314453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11632442474365234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 389, 128])
m.shape torch.Size([376, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11739397048950195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11739397048950195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 376, 128]), torch.Size([1, 376, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1177525520324707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1356816291809082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 376, 128])
m.shape torch.Size([361, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13687944412231445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13687944412231445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 361, 128]), torch.Size([1, 361, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1372237205505371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15684747695922852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 361, 128])
m.shape torch.Size([322, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15828227996826172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15828227996826172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 322, 128]), torch.Size([1, 322, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15858936309814453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17824268341064453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 322, 128])
m.shape torch.Size([3461, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19459247589111328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19459247589111328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 3461, 128]), torch.Size([1, 3461, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1978931427001953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4327096939086914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 3461, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40898895263671875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4159126281738281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4228363037109375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41585826873779297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([7260, 256])
first layer input nodes number: 15233
first layer output nodes number: 7260
edges number: 52362
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42295217514038086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42987585067749023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4316067695617676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4316067695617676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([317, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45576000213623047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45576000213623047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45636463165283203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46170663833618164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([304, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4619889259338379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4619889259338379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4625687599182129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4731588363647461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([266, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4736361503601074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4736361503601074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47414350509643555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4860367774963379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([216, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48661375045776367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48661375045776367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48702573776245117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49897336959838867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([169, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49957990646362305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49957990646362305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49990224838256836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5115065574645996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([139, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5121474266052246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5121474266052246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5124125480651855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5238127708435059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([154, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5247163772583008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5247163772583008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5250101089477539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5396966934204102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([147, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5406804084777832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5406804084777832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5409607887268066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5569424629211426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([113, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5577797889709473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5577797889709473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5579953193664551  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5717892646789551  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5725178718566895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5725178718566895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5726838111877441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.584465503692627  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([100, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5854401588439941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5854401588439941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5856308937072754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6005082130432129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6012206077575684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6012206077575684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6013541221618652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6127028465270996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6133732795715332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6133732795715332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6134858131408691  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6238389015197754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6246843338012695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6246843338012695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.624812126159668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6374635696411133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([56, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6382074356079102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6382074356079102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6383142471313477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6496362686157227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6503520011901855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6503520011901855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6504473686218262  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6612238883972168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6618952751159668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6618952751159668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6619791984558105  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6720499992370605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6725273132324219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6725273132324219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6725845336914062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6798515319824219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6802430152893066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6802430152893066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6802868843078613  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6861653327941895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6866817474365234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6866817474365234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6867351531982422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6942653656005859  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.69482421875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.69482421875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6948795318603516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7030658721923828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7034192085266113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7034192085266113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.703453540802002  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7087750434875488  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7093105316162109  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7093105316162109  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7093582153320312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7170829772949219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7176127433776855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7176127433776855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.717658519744873  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7253947257995605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([262, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7317495346069336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7317495346069336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7322492599487305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8237371444702148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 262, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8025426864624023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8029599189758301  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8033771514892578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8029389381408691  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2797, 40])
input nodes number: 7260
output nodes number: 2797
edges number: 24683
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8029971122741699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8029975891113281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020448684692382812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 14 input nodes size: 15822
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018805980682373047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018805980682373047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02635049819946289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.026371479034423828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019086837768554688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01955699920654297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01955699920654297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01955699920654297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([15822, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01955699920654297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([722, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.040854454040527344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.040854454040527344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 722, 128]), torch.Size([1, 722, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.041543006896972656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04736185073852539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 722, 128])
m.shape torch.Size([747, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0477299690246582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0477299690246582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 747, 128]), torch.Size([1, 747, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04844236373901367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05960416793823242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 747, 128])
m.shape torch.Size([626, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.060143470764160156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.060143470764160156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 626, 128]), torch.Size([1, 626, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06074047088623047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07387447357177734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 626, 128])
m.shape torch.Size([564, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07465171813964844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07465171813964844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07518959045410156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09078788757324219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([484, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09167289733886719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09167289733886719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09213447570800781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10875129699707031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([380, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11052513122558594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11052513122558594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 380, 128]), torch.Size([1, 380, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11088752746582031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12647056579589844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 380, 128])
m.shape torch.Size([331, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1273941993713379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1273941993713379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 331, 128]), torch.Size([1, 331, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12770986557006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1434931755065918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 331, 128])
m.shape torch.Size([309, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1445140838623047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1445140838623047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 309, 128]), torch.Size([1, 309, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14480876922607422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1616058349609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 309, 128])
m.shape torch.Size([234, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16249799728393555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16249799728393555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 234, 128]), torch.Size([1, 234, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1627211570739746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1770033836364746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 234, 128])
m.shape torch.Size([2478, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18870782852172852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18870782852172852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 2478, 128]), torch.Size([1, 2478, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1910710334777832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36456871032714844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 2478, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3461594581604004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35271596908569336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35927248001098633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3526644706726074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([6875, 256])
first layer input nodes number: 15822
first layer output nodes number: 6875
edges number: 42725
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3593926429748535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3659491539001465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3680229187011719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3680229187011719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([502, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38831186294555664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38831186294555664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3892693519592285  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39737749099731445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 502, 256])
m.shape torch.Size([412, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3976907730102539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3976907730102539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39847660064697266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4102640151977539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([295, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4107217788696289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4107217788696289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4112844467163086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.424135684967041  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([240, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4247770309448242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4247770309448242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4252347946166992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4385099411010742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4391608238220215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4391608238220215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43950986862182617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4520754814147949  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([143, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.452725887298584  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.452725887298584  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45299863815307617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46472692489624023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([111, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46533775329589844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46533775329589844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4655494689941406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47613525390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([85, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4766831398010254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4766831398010254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47684526443481445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.486086368560791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([75, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48665428161621094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48665428161621094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4867973327636719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4959526062011719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4967365264892578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4967365264892578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4969062805175781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5089588165283203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5095505714416504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5095505714416504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5096726417541504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5191941261291504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5198020935058594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5198020935058594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5199127197265625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5293159484863281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5297980308532715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5297980308532715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5298800468444824  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5374255180358887  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5378961563110352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5378961563110352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.537968635559082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5451440811157227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5458431243896484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5458431243896484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5459403991699219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5562515258789062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5566644668579102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5566644668579102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5567216873168945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5631875991821289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5637636184692383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5637636184692383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5638341903686523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5723028182983398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5727176666259766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5727176666259766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5727672576904297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5790653228759766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5795154571533203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5795154571533203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5795650482177734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5862102508544922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5865702629089355  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5865702629089355  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5866084098815918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.591987133026123  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5924124717712402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5924124717712402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5924544334411621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5986647605895996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5989823341369629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5989823341369629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5990128517150879  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6037430763244629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6039934158325195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6039934158325195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6040163040161133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6077241897583008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6080126762390137  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6080126762390137  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6080374717712402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6122279167175293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([209, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6172375679016113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6172375679016113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6176362037658691  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6877961158752441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 209, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6706647872924805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6710820198059082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6714992523193359  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6710610389709473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2800, 40])
input nodes number: 6875
output nodes number: 2800
edges number: 20320
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6711335182189941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6711339950561523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020483016967773438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 15 input nodes size: 18730
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019086837768554688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019086837768554688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02801799774169922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.028038978576660156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020473480224609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020992279052734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020992279052734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020992279052734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([18730, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020992279052734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([685, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04540443420410156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04540443420410156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 685, 128]), torch.Size([1, 685, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.046057701110839844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.052104949951171875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 685, 128])
m.shape torch.Size([693, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.052439212799072266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.052439212799072266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 693, 128]), torch.Size([1, 693, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0531001091003418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06301355361938477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 693, 128])
m.shape torch.Size([636, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06359291076660156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06359291076660156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 636, 128]), torch.Size([1, 636, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06419944763183594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07843208312988281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 636, 128])
m.shape torch.Size([578, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07923126220703125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07923126220703125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 578, 128]), torch.Size([1, 578, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07978248596191406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09600448608398438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 578, 128])
m.shape torch.Size([524, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09697818756103516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09697818756103516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09747791290283203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11546802520751953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 524, 128])
m.shape torch.Size([451, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11740589141845703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11740589141845703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11783599853515625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13633060455322266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([381, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13738727569580078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13738727569580078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 381, 128]), torch.Size([1, 381, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13775062561035156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15591812133789062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 381, 128])
m.shape torch.Size([315, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1569380760192871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1569380760192871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 315, 128]), torch.Size([1, 315, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15723848342895508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1743617057800293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 315, 128])
m.shape torch.Size([298, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1754903793334961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1754903793334961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 298, 128]), torch.Size([1, 298, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17577457427978516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19396305084228516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 298, 128])
m.shape torch.Size([2904, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.20766830444335938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.20766830444335938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 2904, 128]), torch.Size([1, 2904, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2109847068786621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40906667709350586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 2904, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38765811920166016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3951258659362793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40224504470825195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39472150802612305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([7465, 256])
first layer input nodes number: 18730
first layer output nodes number: 7465
edges number: 48526
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4020380973815918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40950584411621094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4109373092651367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4109373092651367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([462, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43158531188964844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43158531188964844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4324665069580078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4395332336425781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([369, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4398021697998047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4398021697998047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4405059814453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4521217346191406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([319, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45268964767456055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45268964767456055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45329809188842773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4674949645996094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([233, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46808671951293945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46808671951293945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46853113174438477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48141908645629883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([194, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4821295738220215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4821295738220215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4824995994567871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4958205223083496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4965066909790039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4965066909790039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4967947006225586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5091791152954102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5098896026611328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5098896026611328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5101318359375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5222434997558594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5229067802429199  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5229067802429199  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5231013298034668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5341906547546387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([80, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5347857475280762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5347857475280762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5349383354187012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5447039604187012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5453581809997559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5453581809997559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5455031394958496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5557951927185059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5563888549804688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5563888549804688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5565090179443359  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5658817291259766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.566490650177002  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.566490650177002  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5666012763977051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5760045051574707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5765743255615234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5765743255615234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5766696929931641  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5854434967041016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([29, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5857863426208496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5857863426208496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5858416557312012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5913176536560059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5917949676513672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5917949676513672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5918617248535156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.59893798828125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5993199348449707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5993199348449707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5993714332580566  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6051907539367676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6056880950927734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6056880950927734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6057491302490234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6130733489990234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6134929656982422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6134929656982422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6135425567626953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6198406219482422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6204733848571777  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6204733848571777  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.620542049407959  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6297430992126465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6301703453063965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6301703453063965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.630216121673584  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6366705894470215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.637092113494873  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.637092113494873  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6371340751647949  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6433444023132324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6435141563415527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6435141563415527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.643531322479248  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6461920738220215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6465597152709961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6465597152709961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6465921401977539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6518449783325195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6521058082580566  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6521058082580566  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6521286964416504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6559967994689941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([233, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6615843772888184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6615843772888184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6620287895202637  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7402453422546387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 233, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7226853370666504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7231006622314453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7235159873962402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7230796813964844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2786, 40])
input nodes number: 7465
output nodes number: 2786
edges number: 20892
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7231545448303223  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7231550216674805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02200460433959961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 16 input nodes size: 40999
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020471572875976562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020471572875976562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.040021419525146484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04004240036010742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031090259552001953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.032396793365478516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.032396793365478516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.032396793365478516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([40999, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.032396793365478516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([543, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10184812545776367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10184812545776367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10236597061157227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1072397232055664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([603, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10755586624145508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10755586624145508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 603, 128]), torch.Size([1, 603, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10813093185424805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1173086166381836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 603, 128])
m.shape torch.Size([527, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11777496337890625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11777496337890625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 527, 128]), torch.Size([1, 527, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11827754974365234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12935924530029297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 527, 128])
m.shape torch.Size([525, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13010931015014648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13010931015014648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13060998916625977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1457839012145996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([533, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1468043327331543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1468043327331543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14731264114379883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16561174392700195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([460, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1666736602783203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1666736602783203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 460, 128]), torch.Size([1, 460, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1671123504638672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1859760284423828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 460, 128])
m.shape torch.Size([509, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1874556541442871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1874556541442871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1879410743713379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21221208572387695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([477, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2137889862060547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2137889862060547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 477, 128]), torch.Size([1, 477, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21424388885498047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24017333984375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 477, 128])
m.shape torch.Size([525, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24219894409179688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24219894409179688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24269962310791016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.27617883682250977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([11862, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3324909210205078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3324909210205078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 11862, 128]), torch.Size([1, 11862, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34466075897216797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1649103164672852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 11862, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0996451377868652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1154417991638184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1312384605407715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1153182983398438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([16564, 256])
first layer input nodes number: 40999
first layer output nodes number: 16564
edges number: 141579
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1315460205078125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1473426818847656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.151291847229004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.151291847229004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([323, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.184065341949463  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.184065341949463  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1846814155578613  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.190507411956787  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([292, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1907610893249512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1907610893249512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1913180351257324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.200676441192627  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([196, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2009634971618652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2009634971618652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2013373374938965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.209561824798584  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([151, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2099556922912598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2099556922912598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2102437019348145  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2185959815979004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([122, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.219038486480713  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.219038486480713  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.219271183013916  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2276482582092285  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([89, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2280454635620117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2280454635620117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.228215217590332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2355146408081055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([95, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2360692024230957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2360692024230957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.236250400543213  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2453103065490723  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([59, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.245673656463623  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.245673656463623  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.245786190032959  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2522006034851074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.252871036529541  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.252871036529541  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2530312538146973  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2632851600646973  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([58, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2637629508972168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2637629508972168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.26387357711792  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2717280387878418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2723603248596191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2723603248596191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.272484302520752  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2821545600891113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2826809883117676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2826809883117676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.282778263092041  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2910466194152832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2915854454040527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2915854454040527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.291675090789795  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2999224662780762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.300483226776123  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.300483226776123  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3005690574645996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3090662956237793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3094415664672852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3094415664672852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3094968795776367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3153600692749023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.315901756286621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.315901756286621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3159723281860352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3239469528198242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3243694305419922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3243694305419922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.324422836303711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.330831527709961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.331428050994873  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.331428050994873  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3314967155456543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.340217113494873  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([46, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3410229682922363  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3410229682922363  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3411107063293457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.352867603302002  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3534197807312012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3534197807312012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3534789085388184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3618159294128418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3622307777404785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3622307777404785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3622727394104004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.368483066558838  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3688850402832031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3688850402832031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3689231872558594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3748359680175781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.375236988067627  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.375236988067627  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3752732276916504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3811440467834473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.38161039352417  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.38161039352417  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.381650447845459  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3884196281433105  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([795, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4080791473388672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4080791473388672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 795, 256]), torch.Size([1, 795, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4095954895019531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.680898666381836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 795, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6508793830871582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6512908935546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6517024040222168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6512699127197266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2761, 40])
input nodes number: 16564
output nodes number: 2761
edges number: 33647
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6514105796813965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6514110565185547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03465843200683594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 17 input nodes size: 49980
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031086444854736328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031086444854736328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.054918766021728516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.054940223693847656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0353693962097168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.036806583404541016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.036806583404541016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.036806583404541016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([49980, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.036806583404541016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([599, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11584901809692383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11584901809692383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11642026901245117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12154436111450195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([644, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1218729019165039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1218729019165039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 644, 128]), torch.Size([1, 644, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12248706817626953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1316995620727539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 644, 128])
m.shape torch.Size([639, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13230657577514648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13230657577514648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13291597366333008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1466069221496582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([599, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1474447250366211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1474447250366211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14801597595214844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16530513763427734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([623, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1665048599243164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1665048599243164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 623, 128]), torch.Size([1, 623, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1670989990234375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18903017044067383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 623, 128])
m.shape torch.Size([607, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19046974182128906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19046974182128906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19104862213134766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2161550521850586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([563, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2177448272705078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2177448272705078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 563, 128]), torch.Size([1, 563, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21828174591064453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2458329200744629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 563, 128])
m.shape torch.Size([554, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24791431427001953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24791431427001953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 554, 128]), torch.Size([1, 554, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2484426498413086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2790689468383789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 554, 128])
m.shape torch.Size([586, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28131961822509766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28131961822509766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2818784713745117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.31879234313964844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([13455, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3826713562011719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3826713562011719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 13455, 128]), torch.Size([1, 13455, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39550304412841797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3085389137268066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 13455, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2336335182189941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2516283988952637  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2696232795715332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2514877319335938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([18869, 256])
first layer input nodes number: 49980
first layer output nodes number: 18869
edges number: 161154
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2699975967407227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2879924774169922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2924914360046387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2924914360046387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([318, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3232388496398926  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3232388496398926  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.323845386505127  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.329667568206787  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([272, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3298873901367188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3298873901367188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3304061889648438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3413033485412598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([226, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.341695785522461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.341695785522461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3421268463134766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3516101837158203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([161, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3520140647888184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3520140647888184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3523211479187012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3612265586853027  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([166, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3618707656860352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3618707656860352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.362187385559082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3735857009887695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([140, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3742351531982422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3742351531982422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.374502182006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3859844207763672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([105, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3865575790405273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3865575790405273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3867578506469727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3967714309692383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([86, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3973326683044434  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3973326683044434  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3974967002868652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.406846523284912  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([73, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4073963165283203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4073963165283203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4075355529785156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4164466857910156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.417098045349121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.417098045349121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.417241096496582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4273977279663086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4280028343200684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4280028343200684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4281249046325684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4376463890075684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4382543563842773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4382543563842773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4383649826049805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.447768211364746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4484500885009766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4484500885009766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4485626220703125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4589157104492188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4595460891723633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4595460891723633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4596433639526367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.469273567199707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.46998929977417  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.46998929977417  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.470090389251709  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4808058738708496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4815092086791992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4815092086791992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.481602668762207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4921636581420898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.492966651916504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.492966651916504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4930658340454102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5049676895141602  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([59, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5066065788269043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5066065788269043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5067191123962402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5210108757019043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5216121673583984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5216121673583984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5216808319091797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5308818817138672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5316166877746582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5316166877746582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5316929817199707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5424504280090332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.543260097503662  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.543260097503662  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5433402061462402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5551962852478027  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.555748462677002  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.555748462677002  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5558018684387207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.564079761505127  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.564605712890625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.564605712890625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5646533966064453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.572378158569336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.573000431060791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.573000431060791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5730538368225098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5820794105529785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([569, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5957250595092773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5957250595092773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 569, 256]), torch.Size([1, 569, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5968103408813477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.7884001731872559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 569, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.7609763145446777  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.7613987922668457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.7618212699890137  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.7613773345947266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2835, 40])
input nodes number: 18869
output nodes number: 2835
edges number: 31544
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.7615504264831543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.7615509033203125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03931760787963867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 18 input nodes size: 42037
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03538036346435547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03538036346435547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.055425167083740234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.055446624755859375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03159284591674805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03265523910522461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03265523910522461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03265523910522461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([42037, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03265523910522461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([728, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09039449691772461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09039449691772461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 728, 128]), torch.Size([1, 728, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09108877182006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0972585678100586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 728, 128])
m.shape torch.Size([803, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09767723083496094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09767723083496094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 803, 128]), torch.Size([1, 803, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09844303131103516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10993003845214844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 803, 128])
m.shape torch.Size([782, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1107940673828125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1107940673828125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 782, 128]), torch.Size([1, 782, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11153984069824219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12795448303222656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 782, 128])
m.shape torch.Size([650, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12882137298583984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12882137298583984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1294412612915039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14741802215576172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 650, 128])
m.shape torch.Size([608, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1485576629638672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1485576629638672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 608, 128]), torch.Size([1, 608, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1491374969482422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1700115203857422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 608, 128])
m.shape torch.Size([557, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17131519317626953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17131519317626953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1718463897705078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1956195831298828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([564, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1972365379333496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1972365379333496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19777441024780273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22545957565307617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([508, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2271285057067871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2271285057067871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 508, 128]), torch.Size([1, 508, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22761297225952148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25522756576538086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 508, 128])
m.shape torch.Size([471, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2570066452026367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2570066452026367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25745582580566406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28620338439941406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 471, 128])
m.shape torch.Size([9144, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.32958078384399414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.32958078384399414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 9144, 128]), torch.Size([1, 9144, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3383011817932129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9574494361877441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 9144, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9039125442504883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9180412292480469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9321699142456055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9179306030273438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([14815, 256])
first layer input nodes number: 42037
first layer output nodes number: 14815
edges number: 117353
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9324851036071777  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9466137886047363  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9501461982727051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9501461982727051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([419, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9749069213867188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9749069213867188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9757061004638672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9822139739990234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([392, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9825682640075684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9825682640075684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9833159446716309  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9967398643493652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 392, 256])
m.shape torch.Size([291, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9972052574157715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9972052574157715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9977602958679199  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0107231140136719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([184, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.011153221130371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.011153221130371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0115041732788086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.021681785583496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([157, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.022261142730713  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.022261142730713  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0225605964660645  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0333409309387207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([122, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0338950157165527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0338950157165527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0341277122497559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0441336631774902  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([109, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.044750690460205  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.044750690460205  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0449585914611816  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0553536415100098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([97, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0559959411621094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0559959411621094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0561809539794922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0667266845703125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0672917366027832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0672917366027832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.067436695098877  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.076714038848877  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0775070190429688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0775070190429688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0776786804199219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0898666381835938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0903940200805664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0903940200805664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0905046463012695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0991334915161133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0997591018676758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0997591018676758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0998716354370117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1094369888305664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1100683212280273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1100683212280273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.110173225402832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1198244094848633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.120323657989502  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.120323657989502  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1204018592834473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1281437873840332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.128854751586914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.128854751586914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1289539337158203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1394672393798828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.139848232269287  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.139848232269287  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1399016380310059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1459364891052246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.146449089050293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.146449089050293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1465120315551758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1540651321411133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1546049118041992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1546049118041992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.154667854309082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1626615524291992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1632146835327148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1632146835327148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1632757186889648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1714544296264648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1719818115234375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1719818115234375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.172037124633789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1798362731933594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1801319122314453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1801319122314453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1801624298095703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1846790313720703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.184959888458252  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.184959888458252  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1849865913391113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1891255378723145  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1893997192382812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1893997192382812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1894245147705078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.193441390991211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1937522888183594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1937522888183594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1937789916992188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1982917785644531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([411, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2081542015075684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2081542015075684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2089381217956543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3571105003356934  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 411, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.335296630859375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3357176780700684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3361387252807617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3356962203979492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2825, 40])
input nodes number: 14815
output nodes number: 2825
edges number: 25212
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3358268737792969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.335827350616455  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.034581661224365234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 19 input nodes size: 49050
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03159141540527344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03159141540527344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05502891540527344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.055049896240234375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03498363494873047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03632640838623047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03632640838623047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03632640838623047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([49050, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03632640838623047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([691, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11059141159057617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11059141159057617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 691, 128]), torch.Size([1, 691, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11125040054321289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11729669570922852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 691, 128])
m.shape torch.Size([742, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1176748275756836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1176748275756836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 742, 128]), torch.Size([1, 742, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11838245391845703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1289968490600586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 742, 128])
m.shape torch.Size([715, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12966585159301758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12966585159301758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 715, 128]), torch.Size([1, 715, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13034772872924805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1455068588256836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 715, 128])
m.shape torch.Size([603, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1463160514831543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1463160514831543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 603, 128]), torch.Size([1, 603, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14689111709594727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16402959823608398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 603, 128])
m.shape torch.Size([580, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16512489318847656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16512489318847656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1656780242919922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1855907440185547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([592, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18700790405273438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18700790405273438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18757247924804688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21187210083007812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([521, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21332883834838867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21332883834838867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 521, 128]), torch.Size([1, 521, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21382570266723633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23887920379638672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 521, 128])
m.shape torch.Size([521, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24126863479614258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24126863479614258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 521, 128]), torch.Size([1, 521, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24176549911499023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2707371711730957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 521, 128])
m.shape torch.Size([529, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.27275896072387695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.27275896072387695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.27326345443725586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.30573558807373047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([12550, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3653264045715332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3653264045715332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 12550, 128]), torch.Size([1, 12550, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37729501724243164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2276453971862793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 12550, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1572141647338867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.174422264099121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1916303634643555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1742877960205078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([18044, 256])
first layer input nodes number: 49050
first layer output nodes number: 18044
edges number: 151260
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.19199800491333  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2092061042785645  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2136025428771973  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2136025428771973  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([407, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.241884708404541  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.241884708404541  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2426609992980957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.248948574066162  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([321, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2491779327392578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2491779327392578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2497901916503906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2603473663330078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([256, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2607793807983398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2607793807983398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2612676620483398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2720098495483398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([196, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.272519588470459  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.272519588470459  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2728934288024902  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2837347984313965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([151, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.284273624420166  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.284273624420166  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2845616340637207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2949299812316895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([113, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2954378128051758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2954378128051758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2956533432006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3049211502075195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([94, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3054461479187012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3054461479187012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3056254386901855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3145899772644043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([77, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3150925636291504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3150925636291504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.315239429473877  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.323610782623291  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([67, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3241171836853027  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3241171836853027  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3242449760437012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3324236869812012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([60, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3329367637634277  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3329367637634277  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3330512046813965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3411765098571777  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3416905403137207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3416905403137207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3417935371398926  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3498272895812988  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([47, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3503179550170898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3503179550170898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.350407600402832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.358027458190918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3584699630737305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3584699630737305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3585443496704102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3653879165649414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3659162521362305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3659162521362305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3659963607788086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.373927116394043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3744349479675293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3744349479675293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3745074272155762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.382190227508545  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3826923370361328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3826923370361328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3827590942382812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3903026580810547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3905963897705078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3905963897705078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.390634536743164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.395212173461914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3956432342529297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3956432342529297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3956928253173828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4019908905029297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4025874137878418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4025874137878418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4026522636413574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4113421440124512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.411867618560791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.411867618560791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4119229316711426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.419722080230713  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4201993942260742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4201993942260742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4202470779418945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4273042678833008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4277667999267578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4277667999267578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4278106689453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.434610366821289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4352078437805176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4352078437805176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4352612495422363  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4439129829406738  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4442095756530762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4442095756530762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4442362785339355  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.44874906539917  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([598, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4631047248840332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4631047248840332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 598, 256]), torch.Size([1, 598, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.464245319366455  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6662030220031738  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 598, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6406745910644531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6410913467407227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6415081024169922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6410703659057617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2794, 40])
input nodes number: 18044
output nodes number: 2794
edges number: 28889
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.641221523284912  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6412220001220703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0386810302734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 20 input nodes size: 42801
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03497934341430664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03497934341430664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.055388450622558594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05540943145751953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031950950622558594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03314781188964844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03314781188964844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03314781188964844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([42801, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03314781188964844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([639, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09874153137207031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09874153137207031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0993509292602539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1045064926147461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([654, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10482549667358398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10482549667358398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 654, 128]), torch.Size([1, 654, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10544919967651367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11536693572998047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 654, 128])
m.shape torch.Size([596, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11590766906738281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11590766906738281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 596, 128]), torch.Size([1, 596, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11647605895996094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1295948028564453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 596, 128])
m.shape torch.Size([571, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1303997039794922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1303997039794922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13094425201416016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14719581604003906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([566, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14827299118041992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14827299118041992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14881277084350586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16911554336547852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([524, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17034482955932617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17034482955932617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17084455490112305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19313383102416992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 524, 128])
m.shape torch.Size([534, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19466638565063477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19466638565063477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1951756477355957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22114896774291992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([476, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22271013259887695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22271013259887695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 476, 128]), torch.Size([1, 476, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22316408157348633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2490391731262207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 476, 128])
m.shape torch.Size([465, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2508077621459961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2508077621459961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.251251220703125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.279632568359375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([10984, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3317866325378418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3317866325378418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 10984, 128]), torch.Size([1, 10984, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.34226179122924805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0859980583190918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 10984, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.024400234222412  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0396676063537598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0549349784851074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0395479202270508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([16009, 256])
first layer input nodes number: 42801
first layer output nodes number: 16009
edges number: 133564
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0552558898925781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0705232620239258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0743417739868164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0743417739868164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([387, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1007156372070312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1007156372070312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1014537811279297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1084065437316895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([317, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1086468696594238  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1086468696594238  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1092514991760254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1185269355773926  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([222, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1188650131225586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1188650131225586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.119288444519043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1286039352416992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([182, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1290922164916992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1290922164916992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.129439353942871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1395063400268555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([178, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.140188217163086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.140188217163086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1405277252197266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.152750015258789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([135, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1533589363098145  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1533589363098145  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1536164283752441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1646885871887207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1653943061828613  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1653943061828613  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.16563081741333  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1774563789367676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([80, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1779532432556152  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1779532432556152  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1781058311462402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1868033409118652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1875405311584473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1875405311584473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1877198219299316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1991944313049316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.199777603149414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.199777603149414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.199911117553711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.209390640258789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.209916114807129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.209916114807129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2100229263305664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2183542251586914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.218946933746338  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.218946933746338  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2190537452697754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.228132724761963  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.228729248046875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.228729248046875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2288284301757812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2379531860351562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2383341789245605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2383341789245605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2383952140808105  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2444376945495605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.245070457458496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.245070457458496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2451581954956055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2544584274291992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2550454139709473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2550454139709473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2551236152648926  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.263960361480713  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2645750045776367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2645750045776367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2646512985229492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2738065719604492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2743220329284668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2743220329284668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2743830680847168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2821345329284668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.282761573791504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.282761573791504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2828302383422852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2920312881469727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2926506996154785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2926506996154785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2927155494689941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3018593788146973  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.302412509918213  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.302412509918213  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3024678230285645  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3106541633605957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3109440803527832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3109440803527832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3109726905822754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3154072761535645  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3159236907958984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3159236907958984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.315969467163086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.323385238647461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.323662281036377  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.323662281036377  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3236870765686035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3278775215148926  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([463, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3398489952087402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3398489952087402  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 463, 256]), torch.Size([1, 463, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3407320976257324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5205388069152832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 463, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4969797134399414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4973907470703125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4978017807006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4973697662353516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2758, 40])
input nodes number: 16009
output nodes number: 2758
edges number: 26925
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.497504711151123  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4975051879882812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.035250186920166016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 21 input nodes size: 41775
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031945228576660156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031945228576660156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0518651008605957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05188608169555664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03145599365234375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.032749176025390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.032749176025390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.032749176025390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([41775, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.032749176025390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([595, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10275650024414062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10275650024414062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 595, 128]), torch.Size([1, 595, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10332393646240234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1078786849975586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 595, 128])
m.shape torch.Size([646, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10821104049682617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10821104049682617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10882711410522461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11806821823120117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([599, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11861705780029297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11861705780029297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11918830871582031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13242006301879883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([528, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13314151763916016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13314151763916016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13364505767822266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14855670928955078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([510, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1495208740234375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1495208740234375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1500072479248047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16751670837402344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([495, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16868972778320312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16868972778320312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16916179656982422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18946075439453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([408, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19058656692504883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19058656692504883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19097566604614258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21043062210083008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([449, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21194887161254883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21194887161254883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 449, 128]), torch.Size([1, 449, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21237707138061523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2367844581604004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 449, 128])
m.shape torch.Size([430, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23841571807861328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23841571807861328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23882579803466797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.26507091522216797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([12103, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3234596252441406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3234596252441406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 12103, 128]), torch.Size([1, 12103, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.33500194549560547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.161916732788086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 12103, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0957908630371094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1117773056030273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1277637481689453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1116523742675781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([16763, 256])
first layer input nodes number: 41775
first layer output nodes number: 16763
edges number: 142664
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1280770301818848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1440634727478027  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1482572555541992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1482572555541992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([360, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1782946586608887  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1782946586608887  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1789813041687012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1870079040527344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([297, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1872358322143555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1872358322143555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1878023147583008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1963396072387695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([225, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1967053413391113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1967053413391113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1971344947814941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.206575870513916  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([170, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.207015037536621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.207015037536621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2073392868041992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2167425155639648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([139, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2172484397888184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2172484397888184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2175135612487793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.227057933807373  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([112, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2275714874267578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2275714874267578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2277851104736328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2369709014892578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([92, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2374835014343262  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2374835014343262  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.237658977508545  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2464327812194824  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([75, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2469220161437988  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2469220161437988  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2470650672912598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2552189826965332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([77, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2558135986328125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2558135986328125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.255960464477539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.265359878540039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([61, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2658729553222656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2658729553222656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2659893035888672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2742500305175781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2748475074768066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2748475074768066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.274965763092041  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2841897010803223  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2848114967346191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2848114967346191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.284924030303955  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2944893836975098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2949457168579102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2949457168579102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2950239181518555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3022184371948242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.302663803100586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.302663803100586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3027324676513672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.309530258178711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3099861145019531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3099861145019531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3100509643554688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.316925048828125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.317446231842041  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.317446231842041  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3175148963928223  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3252739906311035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3259096145629883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3259096145629883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3259878158569336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.335371971130371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3356447219848633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3356447219848633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.335679054260254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3400392532348633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3406248092651367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3406248092651367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3406877517700195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3491220474243164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.34959077835083  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.34959077835083  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3496403694152832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3566327095031738  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3571128845214844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3571128845214844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3571605682373047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.364217758178711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.364722728729248  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.364722728729248  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3647704124450684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3721613883972168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3725800514221191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3725800514221191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3726181983947754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.378798007965088  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3793559074401855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3793559074401855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3794035911560059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3874621391296387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([669, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4035134315490723  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4035134315490723  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 669, 256]), torch.Size([1, 669, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4047894477844238  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6296391487121582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 669, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6022224426269531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6026334762573242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6030445098876953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6026124954223633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2758, 40])
input nodes number: 16763
output nodes number: 2758
edges number: 30764
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6027584075927734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.6027588844299316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03498983383178711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 22 input nodes size: 48113
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03145599365234375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03145599365234375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05489349365234375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05491447448730469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0349736213684082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03640031814575195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03640031814575195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03640031814575195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([48113, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03640031814575195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([572, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11462879180908203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11462879180908203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1151742935180664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12050056457519531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([614, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12081336975097656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12081336975097656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 614, 128]), torch.Size([1, 614, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12139892578125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13018226623535156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 614, 128])
m.shape torch.Size([588, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13073062896728516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13073062896728516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 588, 128]), torch.Size([1, 588, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13129138946533203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14362812042236328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 588, 128])
m.shape torch.Size([568, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14444637298583984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14444637298583984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 568, 128]), torch.Size([1, 568, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1449880599975586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16113948822021484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 568, 128])
m.shape torch.Size([551, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16218233108520508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16218233108520508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 551, 128]), torch.Size([1, 551, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16270780563354492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18178176879882812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 551, 128])
m.shape torch.Size([539, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1830611228942871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1830611228942871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 539, 128]), torch.Size([1, 539, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18357515335083008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2060990333557129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 539, 128])
m.shape torch.Size([489, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2074742317199707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2074742317199707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.20794057846069336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23125791549682617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([511, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23297405242919922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23297405242919922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2334613800048828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.26123905181884766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([512, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.26319265365600586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.26319265365600586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.26368093490600586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.29493093490600586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([13559, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3593411445617676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3593411445617676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 13559, 128]), torch.Size([1, 13559, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3722720146179199  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2913084030151367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 13559, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.217245101928711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2348909378051758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2525367736816406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2347526550292969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([18503, 256])
first layer input nodes number: 48113
first layer output nodes number: 18503
edges number: 159534
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2528972625732422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.270543098449707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2749547958374023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2749547958374023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([336, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3060212135314941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3060212135314941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3066620826721191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.312389850616455  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([263, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.312575340270996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.312575340270996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3130769729614258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3234739303588867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([215, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3238434791564941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3238434791564941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3242535591125488  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.333275318145752  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([160, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3336853981018066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3336853981018066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3339905738830566  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3428406715393066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([146, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3433899879455566  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3433899879455566  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3436684608459473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3536934852600098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([104, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.354154109954834  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.354154109954834  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3543524742126465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.362882137298584  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([83, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3633418083190918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3633418083190918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3635001182556152  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.371415615081787  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([86, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3719978332519531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3719978332519531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.372161865234375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3815116882324219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([68, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3820180892944336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3820180892944336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3821477890014648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3904485702514648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3910951614379883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3910951614379883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3912363052368164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4012575149536133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.40191650390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.40191650390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.402048110961914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.412313461303711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.412928581237793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.412928581237793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.413041114807129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4226064682006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.423262596130371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.423262596130371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4233713150024414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4333734512329102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.433830738067627  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.433830738067627  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4339032173156738  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4410786628723145  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.441734790802002  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.441734790802002  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.441826343536377  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.451530933380127  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4521617889404297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4521617889404297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4522457122802734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4617290496826172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4622917175292969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4622917175292969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.462362289428711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4708309173583984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4714879989624023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4714879989624023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4715642929077148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4812536239624023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4817090034484863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4817090034484863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4817605018615723  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.488661289215088  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.489250659942627  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.489250659942627  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.489311695098877  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.497917652130127  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.49849271774292  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.49849271774292  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4985499382019043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5070185661315918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.507434368133545  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.507434368133545  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.507474422454834  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5136828422546387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5142154693603516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5142154693603516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5142631530761719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5219879150390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5224947929382324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5224947929382324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.522538661956787  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5299525260925293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([674, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.546125888824463  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.546125888824463  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 674, 256]), torch.Size([1, 674, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5474114418029785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.7844877243041992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 674, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.7560229301452637  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.756434440612793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.7568459510803223  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.756413459777832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2759, 40])
input nodes number: 18503
output nodes number: 2759
edges number: 31857
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.75657320022583  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.7565736770629883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03886985778808594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 23 input nodes size: 40121
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.034974098205566406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.034974098205566406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.054505348205566406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05452728271484375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031068801879882812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03252220153808594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03252220153808594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03252220153808594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([40121, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03252220153808594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([423, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10888195037841797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10888195037841797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 423, 128]), torch.Size([1, 423, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10928535461425781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11251258850097656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 423, 128])
m.shape torch.Size([447, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11273717880249023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11273717880249023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 447, 128]), torch.Size([1, 447, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11316347122192383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11955785751342773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 447, 128])
m.shape torch.Size([484, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12003707885742188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12003707885742188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1204986572265625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13065338134765625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([489, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13135528564453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13135528564453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1318216323852539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14534568786621094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([479, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1462545394897461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1462545394897461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1467113494873047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16315650939941406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([450, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1642155647277832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1642155647277832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 450, 128]), torch.Size([1, 450, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16464471817016602  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18309831619262695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 450, 128])
m.shape torch.Size([477, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18447589874267578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18447589874267578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 477, 128]), torch.Size([1, 477, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18493080139160156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.20767593383789062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 477, 128])
m.shape torch.Size([452, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.20917272567749023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.20917272567749023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 452, 128]), torch.Size([1, 452, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.20960378646850586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23417425155639648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 452, 128])
m.shape torch.Size([490, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23606157302856445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23606157302856445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23652887344360352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2664361000061035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([13470, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3304324150085449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3304324150085449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 13470, 128]), torch.Size([1, 13470, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3432784080505371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2580056190490723  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 13470, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1850743293762207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2019171714782715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2187600135803223  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2017855644226074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([17661, 256])
first layer input nodes number: 40121
first layer output nodes number: 17661
edges number: 155885
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2190608978271484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2359037399291992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.240114688873291  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.240114688873291  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([227, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2779898643493652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2779898643493652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2784228324890137  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2818865776062012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([193, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2820415496826172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2820415496826172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.28240966796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2879314422607422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([179, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2882637977600098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2882637977600098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2886052131652832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2961163520812988  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([148, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2965149879455566  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.2965149879455566  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.296797275543213  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3049836158752441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([121, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3054242134094238  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3054242134094238  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3056550025939941  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3139634132385254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([98, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3144135475158691  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3144135475158691  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3146004676818848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3226380348205566  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([91, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3231568336486816  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3231568336486816  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3233304023742676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3320088386535645  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([77, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3325142860412598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3325142860412598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3326611518859863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3410325050354004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3417291641235352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3417291641235352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3418989181518555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3527631759643555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3534088134765625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3534088134765625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3535537719726562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3638458251953125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.364534854888916  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.364534854888916  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3646721839904785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3753838539123535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([83, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3762726783752441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3762726783752441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3764309883117676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3898873329162598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3906707763671875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3906707763671875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.3908023834228516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4029102325439453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([64, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4037055969238281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4037055969238281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4038276672363281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4159126281738281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.416543960571289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.416543960571289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.416635513305664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.426340103149414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.427201747894287  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.427201747894287  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.427314281463623  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.440030574798584  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4406442642211914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4406442642211914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4407224655151367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4501066207885742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([70, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4514408111572266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4514408111572266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4515743255615234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4685306549072266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.469139575958252  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.469139575958252  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.469210147857666  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4786667823791504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4795351028442383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4795351028442383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4796247482299805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.492264747619629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([52, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.493880271911621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.493880271911621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.4939794540405273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5086584091186523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([39, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5094337463378906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5094337463378906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5095081329345703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5210380554199219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.521575927734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.521575927734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5216255187988281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5296592712402344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([45, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.531294345855713  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.531294345855713  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5313801765441895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5458855628967285  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([833, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5658583641052246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5658583641052246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 833, 256]), torch.Size([1, 833, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.5674471855163574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.8568434715270996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 833, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.8214893341064453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.8219194412231445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.8223495483398438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.8218975067138672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2884, 40])
input nodes number: 17661
output nodes number: 2884
edges number: 39047
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.8220696449279785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.8220701217651367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03501272201538086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 24 input nodes size: 18238
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031087398529052734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031087398529052734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03978395462036133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03980541229248047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020252227783203125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0207366943359375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0207366943359375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0207366943359375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([18238, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0207366943359375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([790, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.044089317321777344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.044089317321777344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04484272003173828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05132484436035156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 790, 128])
m.shape torch.Size([812, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05172252655029297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05172252655029297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.052496910095214844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06411266326904297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([745, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06483173370361328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06483173370361328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 745, 128]), torch.Size([1, 745, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06554222106933594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08128929138183594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 745, 128])
m.shape torch.Size([681, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08223295211791992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08223295211791992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 681, 128]), torch.Size([1, 681, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08288240432739258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10233068466186523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 681, 128])
m.shape torch.Size([627, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1035008430480957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1035008430480957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10409879684448242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12640380859375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([497, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12752676010131836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12752676010131836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 497, 128]), torch.Size([1, 497, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12800073623657227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14838171005249023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 497, 128])
m.shape torch.Size([414, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14952659606933594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14952659606933594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 414, 128]), torch.Size([1, 414, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14992141723632812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1696624755859375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 414, 128])
m.shape torch.Size([402, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17099857330322266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17099857330322266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 402, 128]), torch.Size([1, 402, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17138195037841797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19323444366455078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 402, 128])
m.shape torch.Size([312, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1943817138671875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1943817138671875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 312, 128]), torch.Size([1, 312, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19467926025390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.21372222900390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 312, 128])
m.shape torch.Size([2442, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2252178192138672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2252178192138672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 2442, 128]), torch.Size([1, 2442, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22754669189453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4018564224243164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 2442, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.381589412689209  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38895368576049805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3963179588317871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38889598846435547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([7722, 256])
first layer input nodes number: 18238
first layer output nodes number: 7722
edges number: 46832
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3964557647705078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4038200378417969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4058847427368164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4058847427368164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([512, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42387819290161133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42387819290161133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 512, 256]), torch.Size([1, 512, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42485475540161133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43300771713256836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 512, 256])
m.shape torch.Size([403, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43329429626464844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43329429626464844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4340629577636719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44597530364990234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([319, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44651079177856445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44651079177856445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44711923599243164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4611382484436035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([267, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46186065673828125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46186065673828125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4623699188232422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4771385192871094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([234, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4780087471008301  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4780087471008301  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4784550666809082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4945225715637207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4952106475830078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4952106475830078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4955120086669922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5084705352783203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5092415809631348  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5092415809631348  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5095028877258301  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5225682258605957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([124, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5233912467956543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5233912467956543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.523627758026123  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5371088981628418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5377955436706543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5377955436706543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5379729270935059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5493254661560059  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5499095916748047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5499095916748047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5500431060791016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5595226287841797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5601325035095215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5601325035095215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5602545738220215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5697760581970215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5702919960021973  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5702919960021973  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5703873634338379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.578493595123291  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5789461135864258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5789461135864258  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5790224075317383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5860414505004883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5864205360412598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5864205360412598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.586479663848877  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5923333168029785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5926933288574219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5926933288574219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5927448272705078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5982036590576172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5986084938049316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5986084938049316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5986618995666504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6046967506408691  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6050949096679688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6050949096679688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6051445007324219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6110954284667969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6114687919616699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6114687919616699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6115126609802246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6170840263366699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6173362731933594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6173362731933594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6173648834228516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6211986541748047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6216073036193848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6216073036193848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6216492652893066  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.627565860748291  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6277265548706055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6277265548706055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6277437210083008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.630284309387207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6304450035095215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6304450035095215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.630460262298584  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6328253746032715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6330389976501465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6330389976501465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6330580711364746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6361479759216309  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6363925933837891  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6363925933837891  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.63641357421875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6399593353271484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([143, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6439332962036133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6439332962036133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6442060470581055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6922101974487305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 143, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.677454948425293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6778759956359863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6782970428466797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6778545379638672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2824, 40])
input nodes number: 7722
output nodes number: 2824
edges number: 18075
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.677924633026123  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6779251098632812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.021689414978027344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 25 input nodes size: 38561
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020243167877197266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.020243167877197266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03863048553466797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.038651466369628906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.029933452606201172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03069448471069336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03069448471069336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03069448471069336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([38561, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03069448471069336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([892, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07216215133666992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07216215133666992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 892, 128]), torch.Size([1, 892, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0730128288269043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0798182487487793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 892, 128])
m.shape torch.Size([893, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08024454116821289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08024454116821289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 893, 128]), torch.Size([1, 893, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08109617233276367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09387063980102539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 893, 128])
m.shape torch.Size([780, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0945887565612793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0945887565612793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 780, 128]), torch.Size([1, 780, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09533262252807617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11201620101928711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 780, 128])
m.shape torch.Size([666, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1129145622253418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1129145622253418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11354970932006836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13268613815307617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([641, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1338968276977539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1338968276977539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 641, 128]), torch.Size([1, 641, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1345081329345703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1568770408630371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 641, 128])
m.shape torch.Size([526, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15807628631591797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15807628631591797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 526, 128]), torch.Size([1, 526, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15857791900634766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18049335479736328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 526, 128])
m.shape torch.Size([472, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18181800842285156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18181800842285156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 472, 128]), torch.Size([1, 472, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1822681427001953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2047748565673828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 472, 128])
m.shape torch.Size([412, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.20612144470214844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.20612144470214844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 412, 128]), torch.Size([1, 412, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2065143585205078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2289104461669922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 412, 128])
m.shape torch.Size([417, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23050355911254883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23050355911254883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 417, 128]), torch.Size([1, 417, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23090124130249023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25635290145874023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 417, 128])
m.shape torch.Size([5944, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28545093536376953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28545093536376953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 5944, 128]), torch.Size([1, 5944, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2911195755004883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.695091724395752  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 5944, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6576085090637207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6687121391296387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6798157691955566  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6686253547668457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([11643, 256])
first layer input nodes number: 38561
first layer output nodes number: 11643
edges number: 83836
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6801052093505859  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6912088394165039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6939849853515625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6939849853515625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([583, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7121729850769043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7121729850769043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 583, 256]), torch.Size([1, 583, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.713284969329834  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7230849266052246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 583, 256])
m.shape torch.Size([428, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7233519554138184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7233519554138184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7241683006286621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7417693138122559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([328, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.742307186126709  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.742307186126709  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7429327964782715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.757082462310791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([226, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7576389312744141  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7576389312744141  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7580699920654297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7705707550048828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([191, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.771273136138916  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.771273136138916  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7716374397277832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.784752368927002  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([137, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7853603363037109  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7853603363037109  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7856216430664062  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7968578338623047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7976288795471191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7976288795471191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.797884464263916  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8106637001037598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([80, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8111510276794434  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8111510276794434  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8113036155700684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8200011253356934  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([70, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8205304145812988  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8205304145812988  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8206639289855957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8292088508605957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([60, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.829719066619873  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.829719066619873  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8298335075378418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.837958812713623  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([53, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8384623527526855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8384623527526855  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8385634422302246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8464484214782715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8470902442932129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8470902442932129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8472046852111816  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8569321632385254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([30, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8572502136230469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8572502136230469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8573074340820312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8625717163085938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8630275726318359  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8630275726318359  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8630962371826172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8698940277099609  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8702635765075684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8702635765075684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8703169822692871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8759779930114746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([18, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8762283325195312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8762283325195312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8762626647949219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8801422119140625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8804845809936523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8804845809936523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8805265426635742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8855619430541992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8859219551086426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8859219551086426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8859639167785645  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8912930488586426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8915829658508301  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8915829658508301  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8916153907775879  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8959603309631348  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8962326049804688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8962326049804688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8962612152099609  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9002952575683594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9007048606872559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9007048606872559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9007449150085449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9066729545593262  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9068856239318848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9068856239318848  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9069066047668457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.910158634185791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9104137420654297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9104137420654297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9104366302490234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9141445159912109  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9143872261047363  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9143872261047363  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9144082069396973  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9179539680480957  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([191, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9225330352783203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9225330352783203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9228973388671875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9870147705078125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 191, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9723095893859863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.972724437713623  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9731392860412598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9727034568786621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2784, 40])
input nodes number: 11643
output nodes number: 2784
edges number: 18208
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9728050231933594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9728055000305176  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0321650505065918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 26 input nodes size: 36301
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02992725372314453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02992725372314453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04723691940307617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04725790023803711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02884960174560547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.029674530029296875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.029674530029296875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.029674530029296875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([36301, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.029674530029296875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([732, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07478046417236328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07478046417236328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 732, 128]), torch.Size([1, 732, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07547855377197266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08188867568969727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 732, 128])
m.shape torch.Size([862, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08236169815063477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08236169815063477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 862, 128]), torch.Size([1, 862, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08318376541137695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09551477432250977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 862, 128])
m.shape torch.Size([666, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09605646133422852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09605646133422852  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09669160842895508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11070013046264648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([638, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11159944534301758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11159944534301758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 638, 128]), torch.Size([1, 638, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11220788955688477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1298527717590332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 638, 128])
m.shape torch.Size([556, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1308741569519043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1308741569519043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 556, 128]), torch.Size([1, 556, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13140439987182617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15108633041381836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 556, 128])
m.shape torch.Size([516, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1522974967956543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1522974967956543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15278959274291992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17454099655151367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([457, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17582035064697266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17582035064697266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1762561798095703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19804763793945312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([426, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19945478439331055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19945478439331055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 426, 128]), torch.Size([1, 426, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1998610496520996  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22301816940307617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 426, 128])
m.shape torch.Size([409, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22457027435302734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22457027435302734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 409, 128]), torch.Size([1, 409, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2249603271484375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2499237060546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 409, 128])
m.shape torch.Size([6830, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28229665756225586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28229665756225586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 6830, 128]), torch.Size([1, 6830, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28881025314331055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7512755393981934  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 6830, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7114114761352539  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7229433059692383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7344751358032227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7228531837463379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([12092, 256])
first layer input nodes number: 36301
first layer output nodes number: 12092
edges number: 91470
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7351217269897461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7466535568237305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.750274658203125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.750274658203125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([492, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7693252563476562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7693252563476562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 492, 256]), torch.Size([1, 492, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.770263671875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.77777099609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 492, 256])
m.shape torch.Size([447, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7781610488891602  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7781610488891602  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7790136337280273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7918024063110352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([292, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7922182083129883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7922182083129883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7927751541137695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8083515167236328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([262, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8096232414245605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8096232414245605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8101229667663574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8256106376647949  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([182, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8262357711791992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8262357711791992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8265829086303711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8390798568725586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([154, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8397946357727051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8397946357727051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8400883674621582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8527188301086426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8533797264099121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8533797264099121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8536086082458496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8650527000427246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([98, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.865692138671875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.865692138671875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8658790588378906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8765335083007812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.877166748046875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.877166748046875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8773269653320312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8875808715820312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([62, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.888096809387207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.888096809387207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8882150650024414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.896611213684082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8971762657165527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8971762657165527  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8972887992858887  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9060664176940918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9065637588500977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9065637588500977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9066553115844727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9144372940063477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([32, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9147915840148926  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9147915840148926  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9148526191711426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9204678535461426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9208006858825684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9208006858825684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9208521842956543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9259505271911621  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9262566566467285  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9262566566467285  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9263005256652832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9309506416320801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9312825202941895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9312825202941895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9313263893127441  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9362835884094238  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9366211891174316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9366211891174316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9366631507873535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9416985511779785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9419546127319336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9419546127319336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9419851303100586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9458608627319336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9462294578552246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9462294578552246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9462695121765137  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.951636791229248  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9518861770629883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9518861770629883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9519128799438477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9556779861450195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9559879302978516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9559879302978516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9560184478759766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9605350494384766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9607524871826172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9607524871826172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9607734680175781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9640254974365234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9643688201904297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9643688201904297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9643993377685547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9693431854248047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.969627857208252  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.969627857208252  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9696526527404785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9738430976867676  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([229, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9793334007263184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9793334007263184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9797701835632324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0566439628601074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 229, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.041903018951416  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0423150062561035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.042726993560791  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0422940254211426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2763, 40])
input nodes number: 12092
output nodes number: 2763
edges number: 19200
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0424022674560547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.042402744293213  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031212806701660156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 27 input nodes size: 33139
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02884674072265625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02884674072265625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04464864730834961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04466962814331055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02733898162841797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.028247833251953125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.028247833251953125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.028247833251953125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([33139, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.028247833251953125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([717, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07656574249267578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07656574249267578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07724952697753906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08271980285644531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([782, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08312368392944336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08312368392944336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 782, 128]), torch.Size([1, 782, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08386945724487305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09505605697631836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 782, 128])
m.shape torch.Size([651, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09561443328857422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09561443328857422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 651, 128]), torch.Size([1, 651, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09623527526855469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11016845703125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 651, 128])
m.shape torch.Size([631, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11106157302856445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11106157302856445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 631, 128]), torch.Size([1, 631, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1116633415222168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1292424201965332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 631, 128])
m.shape torch.Size([577, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13057804107666016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13057804107666016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13112831115722656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1509380340576172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([560, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15226507186889648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15226507186889648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15279912948608398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1761164665222168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([531, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17762184143066406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17762184143066406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17812824249267578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.20434999465942383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([519, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.20607662200927734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.20607662200927734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 519, 128]), torch.Size([1, 519, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2065715789794922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2354426383972168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 519, 128])
m.shape torch.Size([428, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2370319366455078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2370319366455078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 428, 128]), torch.Size([1, 428, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2374401092529297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2635631561279297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 428, 128])
m.shape torch.Size([7334, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.29833030700683594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.29833030700683594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 7334, 128]), torch.Size([1, 7334, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3053245544433594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8019161224365234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 7334, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7574820518493652  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7696223258972168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7817625999450684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7695274353027344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([12730, 256])
first layer input nodes number: 33139
first layer output nodes number: 12730
edges number: 98064
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7820115089416504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.794151782989502  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7975306510925293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7975306510925293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([408, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.821662425994873  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.821662425994873  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8224406242370605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8298792839050293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([367, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8301959037780762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8301959037780762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8308959007263184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8452696800231934  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([265, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8456840515136719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8456840515136719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8461894989013672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8574047088623047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([203, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8579325675964355  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8579325675964355  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8583197593688965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8695483207702637  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([187, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8702535629272461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8702535629272461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.870610237121582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8834505081176758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([172, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.884315013885498  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.884315013885498  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8846430778503418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.898749828338623  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8994002342224121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8994002342224121  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.8996310234069824  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.911170482635498  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9119243621826172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9119243621826172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.912139892578125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9244251251220703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.925018310546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.925018310546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9251728057861328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9350605010986328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9358005523681641  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9358005523681641  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9359626770019531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9474735260009766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9481854438781738  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9481854438781738  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9483284950256348  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9594864845275879  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9601073265075684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9601073265075684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9602217674255371  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9699492454528809  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9703922271728516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9703922271728516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9704685211181641  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9774875640869141  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9780149459838867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9780149459838867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9780950546264648  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9860258102416992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9865627288818359  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9865627288818359  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9866390228271484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9947261810302734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9951186180114746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9951186180114746  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.9951720237731934  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.001206874847412  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0016870498657227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0016870498657227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0017461776733398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0088415145874023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.009331226348877  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.009331226348877  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0093884468078613  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.016655445098877  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0172114372253418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0172114372253418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0172724723815918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0254511833190918  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0259013175964355  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0259013175964355  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0259490013122559  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.03267240524292  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0331735610961914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0331735610961914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0332231521606445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.040562629699707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0408973693847656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0408973693847656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0409297943115234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0459556579589844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0461606979370117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0461606979370117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0461797714233398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.049269676208496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0498833656311035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0498833656311035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0499348640441895  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.058638095855713  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([323, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0663738250732422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0663738250732422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.0669898986816406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1877717971801758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 323, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1666321754455566  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.167050838470459  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1674695014953613  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.167029857635498  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2808, 40])
input nodes number: 12730
output nodes number: 2808
edges number: 23795
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1671524047851562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 1.1671528816223145  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02990436553955078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 28 input nodes size: 22162
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.027345657348632812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.027345657348632812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03791332244873047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03793478012084961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022111892700195312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022655487060546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022655487060546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022655487060546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([22162, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.022655487060546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([697, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04941272735595703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04941272735595703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 697, 128]), torch.Size([1, 697, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05007743835449219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05614614486694336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 697, 128])
m.shape torch.Size([822, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05659770965576172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05659770965576172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 822, 128]), torch.Size([1, 822, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.057381629943847656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06914043426513672  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 822, 128])
m.shape torch.Size([740, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06980705261230469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.06980705261230469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 740, 128]), torch.Size([1, 740, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07051277160644531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08642196655273438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 740, 128])
m.shape torch.Size([638, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08728599548339844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08728599548339844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 638, 128]), torch.Size([1, 638, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08789443969726562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10553932189941406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 638, 128])
m.shape torch.Size([573, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10660123825073242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10660123825073242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 573, 128]), torch.Size([1, 573, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1071476936340332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1268601417541504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 573, 128])
m.shape torch.Size([432, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1278228759765625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1278228759765625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 432, 128]), torch.Size([1, 432, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12823486328125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1459503173828125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 432, 128])
m.shape torch.Size([429, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14717626571655273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14717626571655273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 429, 128]), torch.Size([1, 429, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14758539199829102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16804170608520508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 429, 128])
m.shape torch.Size([415, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1694202423095703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1694202423095703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 415, 128]), torch.Size([1, 415, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1698160171508789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19237518310546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 415, 128])
m.shape torch.Size([368, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1937565803527832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1937565803527832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 368, 128]), torch.Size([1, 368, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1941075325012207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2165684700012207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 368, 128])
m.shape torch.Size([3171, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23151350021362305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23151350021362305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 3171, 128]), torch.Size([1, 3171, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23453760147094727  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44992494583129883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 3171, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4264960289001465  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43439722061157227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44229841232299805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43433523178100586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([8285, 256])
first layer input nodes number: 22162
first layer output nodes number: 8285
edges number: 53915
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44246578216552734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4503669738769531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4532656669616699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4532656669616699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([478, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47200632095336914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47200632095336914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 478, 256]), torch.Size([1, 478, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4729180335998535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48029375076293945  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 478, 256])
m.shape torch.Size([429, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48066282272338867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48066282272338867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48148107528686523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4947013854980469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([325, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49522972106933594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49522972106933594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.495849609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5108089447021484  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([269, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5115346908569336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5115346908569336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5120477676391602  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.529686450958252  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([213, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5304536819458008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5304536819458008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5308599472045898  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5454854965209961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([134, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5460553169250488  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5460553169250488  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5463109016418457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5573010444641113  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([115, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5579471588134766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5579471588134766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.55816650390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5691337585449219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([127, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5700006484985352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5700006484985352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5702428817749023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.584050178527832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5847945213317871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5847945213317871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5849852561950684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5971922874450684  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5977892875671387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5977892875671387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5979266166687012  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6076769828796387  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6082959175109863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6082959175109863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6084198951721191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6180901527404785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6185588836669922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6185588836669922  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6186466217041016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6261043548583984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6266231536865234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6266231536865234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.626708984375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6346054077148438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6351280212402344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6351280212402344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6352081298828125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6431388854980469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.643517017364502  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.643517017364502  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6435723304748535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6494355201721191  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6500387191772461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6500387191772461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6501169204711914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6589536666870117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6593561172485352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6593561172485352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6594076156616211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6655874252319336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6660981178283691  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6660981178283691  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6661572456359863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6736664772033691  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([13, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6738743782043457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6738743782043457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6738991737365723  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6772217750549316  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6775169372558594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6775169372558594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6775474548339844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6818504333496094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6822190284729004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6822190284729004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6822552680969238  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6876187324523926  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.687833309173584  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.687833309173584  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6878542900085449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6911063194274902  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6914496421813965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6914496421813965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6914801597595215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6964240074157715  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6966395378112793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6966395378112793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6966586112976074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6998820304870605  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([153, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7035489082336426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7035489082336426  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7038407325744629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7552018165588379  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 153, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.740290641784668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7407121658325195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7411336898803711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7406907081604004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2826, 40])
input nodes number: 8285
output nodes number: 2826
edges number: 18886
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7407770156860352  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.7407774925231934  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.023726940155029297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 29 input nodes size: 10873
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02211475372314453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02211475372314453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02729940414428711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.027321338653564453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.016732215881347656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01706409454345703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01706409454345703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01706409454345703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([10873, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01706409454345703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([940, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031948089599609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.031948089599609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 940, 128]), torch.Size([1, 940, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03284454345703125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04018545150756836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 940, 128])
m.shape torch.Size([967, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.040659427642822266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.040659427642822266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 967, 128]), torch.Size([1, 967, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04158163070678711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.055414676666259766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 967, 128])
m.shape torch.Size([785, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0560765266418457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0560765266418457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 785, 128]), torch.Size([1, 785, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05682516098022461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07329511642456055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 785, 128])
m.shape torch.Size([632, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0742945671081543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0742945671081543  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 632, 128]), torch.Size([1, 632, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07489728927612305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09265851974487305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 632, 128])
m.shape torch.Size([496, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09353971481323242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09353971481323242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09401273727416992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11104154586791992  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([380, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11191463470458984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11191463470458984  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 380, 128]), torch.Size([1, 380, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11227703094482422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12786006927490234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 380, 128])
m.shape torch.Size([305, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12869691848754883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12869691848754883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12898778915405273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14353132247924805  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([274, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14443111419677734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14443111419677734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 274, 128]), torch.Size([1, 274, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14469242095947266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15958690643310547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 274, 128])
m.shape torch.Size([219, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16039609909057617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16039609909057617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 219, 128]), torch.Size([1, 219, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.16060495376586914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17397165298461914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 219, 128])
m.shape torch.Size([1051, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1788787841796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1788787841796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17988109588623047  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25109052658081055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.23937082290649414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24513959884643555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25090837478637695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.24509429931640625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([6049, 256])
first layer input nodes number: 10873
first layer output nodes number: 6049
edges number: 29325
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2509913444519043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2567601203918457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25824975967407227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.25824975967407227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([578, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2734494209289551  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2734494209289551  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 578, 256]), torch.Size([1, 578, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2745518684387207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2840418815612793  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 578, 256])
m.shape torch.Size([481, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28441572189331055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28441572189331055  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28533315658569336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2993588447570801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 481, 256])
m.shape torch.Size([396, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3003702163696289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3003702163696289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.30112552642822266  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.31774234771728516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([279, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3188629150390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3188629150390625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3193950653076172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.33544158935546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([246, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.33635807037353516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.33635807037353516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.33682727813720703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35371875762939453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([167, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3544473648071289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3544473648071289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3547658920288086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36846256256103516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([110, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36904382705688477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36904382705688477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.36925363540649414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3797440528869629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([122, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38057756423950195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.38057756423950195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3808102607727051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3940739631652832  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39467573165893555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39467573165893555  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.394834041595459  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.404965877532959  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4055790901184082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4055790901184082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4057164192199707  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4154667854309082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([46, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41588449478149414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41588449478149414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4159722328186035  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42281579971313477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.423337459564209  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.423337459564209  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4234309196472168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43137502670288086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([36, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4317784309387207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4317784309387207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43184709548950195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43816423416137695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4385337829589844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4385337829589844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43859100341796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4442558288574219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44464540481567383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44464540481567383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4447007179260254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.450563907623291  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([19, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45082855224609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45082855224609375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4508647918701172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4549598693847656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45526885986328125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45526885986328125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4553070068359375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4598846435546875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([11, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4600563049316406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4600563049316406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46007728576660156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4627418518066406  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46302366256713867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46302366256713867  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46305418014526367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46714353561401367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4672245979309082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4672245979309082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46723413467407227  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4685788154602051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4687962532043457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4687962532043457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46881723403930664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4719223976135254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.472017765045166  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.472017765045166  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4720273017883301  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47350549697875977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47361135482788086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47361135482788086  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4736208915710449  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47516584396362305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4753456115722656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4753456115722656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4753608703613281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4779396057128906  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([60, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4793739318847656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4793739318847656  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4794883728027344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4996299743652344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 60, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48784685134887695  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48827695846557617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4887070655822754  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48825502395629883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2884, 40])
input nodes number: 6049
output nodes number: 2884
edges number: 15100
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4883308410644531  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48833131790161133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.01776742935180664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 30 input nodes size: 24019
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.016740798950195312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.016740798950195312  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.028193950653076172  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02821493148803711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.023008346557617188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02347850799560547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02347850799560547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02347850799560547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([24019, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02347850799560547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([890, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04800558090209961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04800558090209961  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04885435104370117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05616569519042969  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([973, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05666923522949219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05666923522949219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 973, 128]), torch.Size([1, 973, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05759716033935547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07151603698730469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 973, 128])
m.shape torch.Size([788, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07217931747436523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07217931747436523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 788, 128]), torch.Size([1, 788, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07293081283569336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08946371078491211  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 788, 128])
m.shape torch.Size([649, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09032583236694336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09032583236694336  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 649, 128]), torch.Size([1, 649, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.09094476699829102  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10943937301635742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 649, 128])
m.shape torch.Size([564, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1104745864868164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1104745864868164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.11101245880126953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13064289093017578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([446, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13164997100830078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13164997100830078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.13207530975341797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15036487579345703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 446, 128])
m.shape torch.Size([391, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1514573097229004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1514573097229004  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 391, 128]), torch.Size([1, 391, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15183019638061523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17047452926635742  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 391, 128])
m.shape torch.Size([316, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1714935302734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1714935302734375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 316, 128]), torch.Size([1, 316, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17179489135742188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18897247314453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 316, 128])
m.shape torch.Size([261, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1899418830871582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1899418830871582  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 261, 128]), torch.Size([1, 261, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.19019079208374023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.20612096786499023  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 261, 128])
m.shape torch.Size([2719, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2189617156982422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2189617156982422  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 2719, 128]), torch.Size([1, 2719, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.22175312042236328  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4065265655517578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 2719, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3855247497558594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39315128326416016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40077781677246094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.39309167861938477  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([7997, 256])
first layer input nodes number: 24019
first layer output nodes number: 7997
edges number: 48096
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4009590148925781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4085855484008789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41126203536987305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.41126203536987305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([592, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4262385368347168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4262385368347168  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 592, 256]), torch.Size([1, 592, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4273676872253418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4364008903503418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 592, 256])
m.shape torch.Size([480, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43675899505615234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43675899505615234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 480, 256]), torch.Size([1, 480, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43767452239990234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4517850875854492  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 480, 256])
m.shape torch.Size([355, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4530191421508789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4530191421508789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.45369625091552734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4701557159423828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([274, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4708709716796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4708709716796875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4713935852050781  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48654937744140625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([229, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48738861083984375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.48738861083984375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4878253936767578  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5035495758056641  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5042715072631836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5042715072631836  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.504582405090332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5179510116577148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([104, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5184955596923828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5184955596923828  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5186939239501953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5286121368408203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([98, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5292668342590332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5292668342590332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5294537544250488  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5401082038879395  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5406985282897949  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5406985282897949  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5408492088317871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5504927635192871  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5510807037353516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5510807037353516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5512123107910156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5605564117431641  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([39, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5609030723571777  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5609030723571777  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5609774589538574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.566779613494873  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.567169189453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.567169189453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5672397613525391  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5732383728027344  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([36, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5736532211303711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5736532211303711  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5737218856811523  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5800390243530273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([27, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5803680419921875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5803680419921875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5804195404052734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5855178833007812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5857806205749512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5857806205749512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5858187675476074  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5898623466491699  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([14, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5900588035583496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5900588035583496  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.590085506439209  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5931029319763184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5933022499084473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5933022499084473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5933270454406738  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5963025093078613  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5964980125427246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5964980125427246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5965209007263184  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5994277000427246  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5997271537780762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5997271537780762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.599759578704834  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6041045188903809  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6042613983154297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6042613983154297  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.604278564453125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6066989898681641  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6068520545959473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6068520545959473  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6068673133850098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6091256141662598  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6093087196350098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6093087196350098  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6093258857727051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6119866371154785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.612088680267334  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.612088680267334  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.612098217010498  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6136431694030762  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.613800048828125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.613800048828125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6138134002685547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6160697937011719  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([91, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6182498931884766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6182498931884766  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6184234619140625  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6489715576171875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 91, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6372995376586914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6377148628234863  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6381301879882812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6376938819885254  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2787, 40])
input nodes number: 7997
output nodes number: 2787
edges number: 14856
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6377596855163574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.6377601623535156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02443552017211914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

pseudo mini batch 31 input nodes size: 14482
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02299356460571289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02299356460571289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.029899120330810547  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.02992105484008789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018446922302246094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018827438354492188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018827438354492188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018827438354492188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([14482, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.018827438354492188  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([679, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03582000732421875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.03582000732421875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 679, 128]), torch.Size([1, 679, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.036467552185058594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04240608215332031  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 679, 128])
m.shape torch.Size([788, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.042833805084228516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.042833805084228516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 788, 128]), torch.Size([1, 788, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.04358530044555664  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05581998825073242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 788, 128])
m.shape torch.Size([627, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05634117126464844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.05634117126464844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.056939125061035156  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07088565826416016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([603, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07173681259155273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.07173681259155273  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 603, 128]), torch.Size([1, 603, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0723118782043457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0889887809753418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 603, 128])
m.shape torch.Size([493, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08987665176391602  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.08987665176391602  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 493, 128]), torch.Size([1, 493, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.0903468132019043  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10727262496948242  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 493, 128])
m.shape torch.Size([393, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10816192626953125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.10816192626953125  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 393, 128]), torch.Size([1, 393, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1085367202758789  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12465286254882812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 393, 128])
m.shape torch.Size([317, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12552356719970703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.12552356719970703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 317, 128]), torch.Size([1, 317, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1258258819580078  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14094161987304688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 317, 128])
m.shape torch.Size([296, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14191961288452148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14191961288452148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 296, 128]), torch.Size([1, 296, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.14220190048217773  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15829229354858398  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 296, 128])
m.shape torch.Size([250, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1592240333557129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.1592240333557129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 250, 128]), torch.Size([1, 250, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.15946245193481445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.17472124099731445  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 250, 128])
m.shape torch.Size([1573, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18210268020629883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18210268020629883  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 1573, 128]), torch.Size([1, 1573, 128])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.18360280990600586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2901120185852051  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 1573, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.27593040466308594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28167057037353516  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2874107360839844  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.28162527084350586  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([6019, 256])
first layer input nodes number: 14482
first layer output nodes number: 6019
edges number: 33938
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2875208854675293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.2932610511779785  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.29479074478149414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.29479074478149414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

m.shape torch.Size([471, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3116755485534668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3116755485534668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3125739097595215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.319760799407959  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([466, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3202075958251953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3202075958251953  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.32109642028808594  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3344287872314453  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([337, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.33495616912841797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.33495616912841797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3355989456176758  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.35234737396240234  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([301, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3531832695007324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3531832695007324  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.353757381439209  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3704066276550293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([258, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3721628189086914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3721628189086914  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.37265491485595703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3906440734863281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([177, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3914189338684082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.3914189338684082  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.391756534576416  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40627336502075195  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40700626373291016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40700626373291016  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.40726184844970703  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4200410842895508  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([123, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42085933685302734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.42085933685302734  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4210939407348633  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4344663619995117  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4352231025695801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4352231025695801  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.43541574478149414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44774484634399414  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4485039710998535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4485039710998535  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.44867372512817383  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.460726261138916  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46136045455932617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.46136045455932617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4614901542663574  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4716067314147949  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([43, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47203826904296875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47203826904296875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4721202850341797  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4790916442871094  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47972536087036133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.47972536087036133  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4798283576965332  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4893040657043457  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4898042678833008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4898042678833008  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4898824691772461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.49762439727783203  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4980611801147461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4980611801147461  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.4981241226196289  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.504796028137207  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5052413940429688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5052413940429688  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5053005218505859  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5119819641113281  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5122466087341309  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5122466087341309  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5122809410095215  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5164008140563965  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5166435241699219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5166435241699219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5166721343994141  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5203056335449219  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5205287933349609  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5205287933349609  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5205535888671875  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5238761901855469  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5240945816040039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5240945816040039  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5241174697875977  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5273447036743164  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5274949073791504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5274949073791504  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5275101661682129  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5297684669494629  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5299301147460938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5299301147460938  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5299453735351562  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5323104858398438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5324358940124512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5324358940124512  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.532447338104248  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5343012809753418  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.534480094909668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.534480094909668  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5344953536987305  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.537074089050293  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([80, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5389890670776367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5389890670776367  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5391416549682617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5659971237182617  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

rst.shape  torch.Size([1, 80, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.552431583404541  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5528631210327148  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes
Using backend: pytorch

----------------------------------------after rst
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5532946586608887  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5528411865234375  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

torch.Size([2895, 40])
input nodes number: 6019
output nodes number: 2895
edges number: 16959
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.552924633026123  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.5529251098632812  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019628524780273438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019628524780273438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.0389404296875 GB
    Memory Allocated: 0.019628524780273438  GigaBytes
Max Memory Allocated: 1.9121112823486328  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008568964898586273 |0.0015747025609016418 |0.1155938059091568 |8.594989776611328e-05 |0.07570800185203552 |0.004680156707763672 |
----------------------------------------------------------pseudo_mini_loss sum 3.879340171813965
Total (block generation + training)time/epoch 29.73155176639557
Training time/epoch 6.626257658004761
Training time without block to device /epoch 6.575867176055908
Training time without total dataloading part /epoch 6.129088401794434
load block tensor time/epoch 0.27420687675476074
block to device time/epoch 0.05039048194885254
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1127824
Number of first layer input nodes during this epoch:  807330
Number of first layer output nodes during this epoch:  320494
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
